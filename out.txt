# HG changeset patch
# User mpm@selenic.com
# Date 1125044488 25200
# Node ID 82e55d328c8ca4ee16520036c0aaace03a5beb65
# Parent  0a04b987be5ae354b710cefeba0e2d9de7ad41a9
Create a makefile

diff -r 0a04b987be5a -r 82e55d328c8c Makefile
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Makefile	Fri Aug 26 01:21:28 2005 -0700
@@ -0,0 +1,1 @@
+all: hello
# HG changeset patch
# User Firstname Lastname <a@example.net>
# Date 1281455486 18000
# Node ID 9881d5db150ac445917157469b9a613ed92f8c05
# Parent  82e55d328c8ca4ee16520036c0aaace03a5beb65
#bigone

diff -r 82e55d328c8c -r 9881d5db150a Dibujo.bmp
Binary file Dibujo.bmp has changed
diff -r 82e55d328c8c -r 9881d5db150a RegistrarDocs.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/RegistrarDocs.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,49 @@
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
+<title>Documento sin t&iacute;tulo</title>
+<style type="text/css">
+<!--
+.Estilo7 {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: x-small; }
+.Estilo9 {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: x-small; font-weight: bold; }
+.Estilo12 {font-size: small}
+.Estilo14 {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: small; }
+-->
+</style>
+</head>
+
+<body>
+<p align="center"><img src="file:///D|/Compartido/BORRADOR STD SERNANP/CABEZERA.JPG" width="921" height="78" /></p>
+<table width="100%" border="0">
+  <tr>
+    <td width="71%" class="Estilo9"><span class="breadcrumbs pathway"><a href="http://www.minam.gob.pe/" class="pathway">SERNANP</a> &gt;<a href="http://www.minam.gob.pe/" class="pathway">Sistema de Tr&aacute;mite Documentario</a>&gt;Registrar Documentos </span></td>
+    <td width="29%"><div align="right" class="Estilo9">Usuario del Sistema: JuanGabriel</div></td>
+  </tr>
+</table>
+<p><span class="Estilo9">LISTADO DE DOCUMENTOS </span></p>
+<table width="100%" border="1" align="center">
+    <tr>
+      <td width="5%"><div align="center"><span class="Estilo9">Reg. N&ordm; </span></div></td>
+      <td width="8%"><div align="center"><span class="Estilo9">Tipo de Doc.</span></div></td>
+      <td width="22%"><div align="center"><span class="Estilo9">Documento</span></div></td>
+      <td width="47%"><div align="center"><span class="Estilo9">Referencia</span></div></td>
+      <td width="18%"><div align="center" class="Estilo9">Fecha y Hora de Ingreso </div></td>
+    </tr>
+    <tr>
+      <td><span class="Estilo9"><a href="#">0006</a></span></td>
+      <td><span class="Estilo14">INFORME</span></td>
+      <td><span class="Estilo7">015-11-2008-JD</span></td>
+      <td class="Estilo7">PRFNP-C-CON-010-2008-PAN</td>
+      <td><span class="Estilo7">12/10/2008 3:00pm </span></td>
+    </tr>
+</table>
+
+
+<form id="form1" name="form1" method="post" action="file:///D|/Compartido/BORRADOR STD SERNANP/IngresarDatos.html">
+    <div align="center"><span class="Estilo9"><a href="../IngresarDatos.php">
+      <input type="submit" name="Submit" value="Registrar Nuevo" />
+    </a></span></div>
+</form>
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a Ventanillas_acceso_registro.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Ventanillas_acceso_registro.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,140 @@
+<?php
+    include("includes.php");
+	require_once("libs/lib.php");
+	require_once("cls/ventanillas_acceso_registro.cls.php");
+	if(!$_SESSION['session'][3] == "SI" ){?>
+		<script>location.href="error_permisos.php";</script>
+ 	<?
+	}    
+    if (!ini_get('display_errors')) {
+        #ini_set('display_errors', 1);
+    }
+    
+
+	$table="registro";
+	set_time_limit(100);
+
+    $menu = array(1,1,0,0,1,0);
+?>
+
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+    <head>
+        <?php include("includes/inc.header.php"); ?>
+		<style type="text/css">
+			@import url(public_root/js/calendar/calendar-blue2.css);
+		</style>
+		<script type="text/javascript" src="public_root/js/calendar/calendar.js"></script>
+		<script type="text/javascript" src="public_root/js/calendar/calendar-es.js"></script>
+		<script type="text/javascript" src="public_root/js/calendar/calendar-setup.js"></script>
+		<script type="text/javascript" src="public_root/js/jquery.autocomplete.js"></script>
+		<script type="text/javascript" src="public_root/js/leyendas/cargar_estados.js"></script>
+		<link href="public_root/css/jquery.autocomplete.css" rel="stylesheet" />
+        <title>M&Oacute;DULO DE TRAMITE DOCUMENTARIO/ REGISTRO	DE	DOCUMENTOS </title>
+    </head>
+<body>
+
+<table  id="principal"  align="left" cellpadding="0" cellspacing="0" width="100%" style="margin:0px; vertical-align:top">
+	<tr>		
+		<td colspan="2" align="left"> <?php Plantilla::PlantillaEncabezado("REGISTRO	DE DOCUMENTOS ");?> </td>		
+	</tr>
+	<tr>
+		<td class="menu"><?php Plantilla::PlantillaIzquierdo();?></td>	
+		<td>
+			<table  class="contenido" cellpadding="0" cellspacing="0" width="100%" align="left">	
+            	<tr>
+					<td><?php  Plantilla::menuSuperior("Ventanillas_acceso_registro.php",$menu,$_GET['id'],false);?></td>
+				</tr>									
+				<tr>								
+					<td style="width:100%; height:417px">								
+					<?php
+                        	$opcion = $_REQUEST['opcion'];
+				$id = $_REQUEST['id'];
+				$ide = $_REQUEST['ide'];
+				$campo = $_REQUEST['campo'];
+				$valor = $_REQUEST['valor'];
+				switch($opcion){
+							
+                            case 'new':
+                                Registro::RegistraAgregar();
+                            break;
+
+                            case 'edit':
+                                Registro::RegistraEditar($id);
+                            break;
+
+                            case 'update':
+                                Registro::RegistraUpdate($id);
+                                Registro::RegistraListado($ide);
+                            break;
+
+                            case 'delete':
+                                Registro::RegistraDelete($id);
+                            break;
+
+                            case 'list':
+                                Registro::RegistraListado($ide);
+                            break;
+
+                            case 'x';
+                                Registro::RegistraListado($ide);
+
+                            break;
+
+                            case 'guardar';
+                                Registro::RegistraGuardar();
+                                Registro::RegistraListado($ide);
+                            break;
+
+                            case 'agre';
+                                Registro::RegistraAgrega();
+                            break;
+
+                            case 'listremi';
+                                Registro::RegistraListRemitente();
+                            break;
+
+                            case 'newremi';
+                                Registro::RegistraNewRemitente();
+                            break;
+
+                            case 'editremi';
+                                Registro::RegistraEditRemitente($id);                                
+                            break;
+
+                            case 'Updateremi';
+                                Registro::RegistraUpdateRemitente($id);
+                                Registro::RegistraListRemitente();
+                            break;
+
+                            case 'guardremi';
+                                Registro::RegistraGuardarRemitente();
+                                Registro::RegistraAgregar();
+                            break;
+
+                            case 'filtrar';
+                                Registro::RegistraFiltrar();
+                            break;
+
+                            case 'busqueda';
+                                Registro::Busqueda($campo, $valor);
+                            break;
+
+                            default:
+                                Registro::RegistraListado($ide);
+                            break;
+
+                            }
+
+							?>							
+					</td>					
+				</tr>			
+			</table>
+		</td>		
+	</tr>
+	<tr>
+		<td colspan="2" class="pie"><?php Plantilla::PlantillaPie();?>	</td>
+	</tr>	
+</table>	
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/Xinha.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/Xinha.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,273 @@
+.htmlarea { background: #fff; }
+.htmlarea td { margin:0;padding:0; }
+
+.htmlarea .toolbarRow {
+  width:1px;
+}
+
+.htmlarea .toolbar {
+  cursor: default;
+  background: ButtonFace;
+  padding: 3px;
+  border: 1px solid;
+  border-color: ButtonHighlight ButtonShadow ButtonShadow ButtonHighlight;
+}
+.htmlarea .toolbar table { margin: 0; font-family: tahoma,verdana,sans-serif; font-size: 11px; }
+.htmlarea .toolbar img { border: none; vertical-align: top; }
+.htmlarea .toolbar .label { padding: 0px 3px; }
+
+.htmlarea .toolbar .button {
+  background: ButtonFace;
+  color: ButtonText;
+  border: 1px solid ButtonFace;
+  padding: 1px;
+  margin: 0px;
+  width: 18px;
+  height: 18px;
+}
+.htmlarea .toolbar a.button:hover {
+  border: 1px solid;
+  border-color: ButtonHighlight ButtonShadow ButtonShadow ButtonHighlight;
+}
+.htmlarea .toolbar a.buttonDisabled:hover {
+  border-color: ButtonFace;
+}
+.htmlarea .toolbar .buttonActive,
+.htmlarea .toolbar .buttonPressed
+{
+  padding: 2px 0px 0px 2px;
+  border: 1px solid;
+  border-color: ButtonShadow ButtonHighlight ButtonHighlight ButtonShadow;
+}
+.htmlarea .toolbar .buttonPressed {
+  background: ButtonHighlight;
+}
+.htmlarea .toolbar .indicator {
+  padding: 0px 3px;
+  overflow: hidden;
+  width: 20px;
+  text-align: center;
+  cursor: default;
+  border: 1px solid ButtonShadow;
+}
+
+.htmlarea .toolbar .buttonDisabled img {
+  filter: gray() alpha(opacity = 25);
+  -moz-opacity: 0.25;
+  opacity: 0.25;
+}
+
+.htmlarea .toolbar .separator {
+  /*position: relative;*/
+  margin:0 3px;
+  border-left: 1px solid ButtonShadow;
+  border-right: 1px solid ButtonHighlight;
+  width: 0px;
+  height: 18px;
+  padding: 0px;
+}
+
+.htmlarea .toolbar .space { width: 5px; }
+
+.htmlarea .toolbar select, .htmlarea .toolbar option { font: 11px Tahoma,Verdana,sans-serif;}
+
+.htmlarea .toolbar select,
+.htmlarea .toolbar select:hover,
+.htmlarea .toolbar select:active { 
+  position:relative;
+  top:-2px;
+  margin-bottom:-2px;
+  color: ButtonText;
+}
+
+.htmlarea iframe.xinha_iframe, .htmlarea textarea.xinha_textarea
+{
+  border: none; /*1px solid;*/
+}
+
+.htmlarea .statusBar {
+  border: 1px solid;
+  border-color: ButtonShadow ButtonHighlight ButtonHighlight ButtonShadow;
+  padding: 2px 4px;
+  background-color: ButtonFace;
+  color: ButtonText;
+  font: 11px Tahoma,Verdana,sans-serif;
+  height:16px;
+}
+
+.htmlarea .statusBar .statusBarTree a {
+  padding: 2px 5px;
+  color: #00f;
+}
+
+.htmlarea .statusBar .statusBarTree a:visited { color: #00f; }
+.htmlarea .statusBar .statusBarTree a:hover {
+  background-color: Highlight;
+  color: HighlightText;
+  padding: 1px 4px;
+  border: 1px solid HighlightText;
+}
+
+
+/* popup dialogs */
+
+.dialog {
+  color: ButtonText;
+  background: ButtonFace;
+}
+
+.dialog .content { padding: 2px; }
+
+.dialog, .dialog button, .dialog input, .dialog select, .dialog textarea, .dialog table {
+  font: 11px Tahoma,Verdana,sans-serif;
+}
+
+.dialog table { border-collapse: collapse; }
+
+.dialog .title, .dialog h1
+{
+  background: #008;
+  color: #ff8;
+  border-bottom: 1px solid #000;
+  padding: 1px 0px 2px 5px;
+  font-size: 12px;
+  font-weight: bold;
+  cursor: default;
+}
+.dialog h1 { margin:0px;}
+.dialog .title .button {
+  float: right;
+  border: 1px solid #66a;
+  padding: 0px 1px 0px 2px;
+  margin-right: 1px;
+  color: #fff;
+  text-align: center;
+}
+
+.dialog .title .button-hilite { border-color: #88f; background: #44c; }
+
+.dialog button {
+  width: 5em;
+  padding: 0px;
+}
+
+.dialog .buttonColor {
+  width :1em;
+  padding: 1px;
+  cursor: default;
+  border: 1px solid;
+  border-color: ButtonHighlight ButtonShadow ButtonShadow ButtonHighlight;
+}
+
+.dialog .buttonColor .chooser, .dialog .buttonColor .nocolor {
+  height: 0.6em;
+  border: 1px solid;
+  padding: 0px 1em;
+  border-color: ButtonShadow ButtonHighlight ButtonHighlight ButtonShadow;
+}
+
+.dialog .buttonClick {
+  border-color: ButtonShadow ButtonHighlight ButtonHighlight ButtonShadow;
+}
+.dialog .buttonColor-hilite {
+   border-color: ButtonShadow ButtonHighlight ButtonHighlight ButtonShadow;
+}
+
+.dialog .buttonColor .nocolor { padding: 0px; }
+.dialog .buttonColor .nocolor-hilite { background-color: #fff; color: #f00; }
+
+.dialog .label { text-align: right; width: 6em; }
+.dialog .value input { width: 100%; }
+.dialog .buttons { text-align: right; padding: 2px 4px 0px 4px; }
+
+.dialog legend { font-weight: bold; }
+.dialog fieldset table { margin: 2px 0px; }
+
+.popupwin {
+  padding: 0px;
+  margin: 0px;
+}
+
+.popupwin .title {
+  background: #fff;
+  color: #000;
+  font-weight: bold;
+  font-size: 120%;
+  padding: 3px 10px;
+  margin-bottom: 10px;
+  border-bottom: 1px solid black;
+  letter-spacing: 2px;
+}
+
+form { margin: 0px; border: none; }
+
+
+/** Panels **/
+.htmlarea .panels.top
+{
+  border-bottom : 1px solid;
+  border-color: ButtonShadow;
+}
+
+.htmlarea .panels.right
+{
+  border-left : 1px solid;
+  border-color: ButtonShadow;
+}
+
+.htmlarea .panels.left
+{
+  border-right : 1px solid;
+  border-color: ButtonShadow;
+}
+
+.htmlarea .panels.bottom
+{
+  border-top : 1px solid;
+  border-color: ButtonShadow;
+}
+
+.htmlarea .panel h1 {
+  background: ButtonFace;
+  border: 1px solid;
+  border-color: ButtonHighlight ButtonShadow ButtonShadow ButtonHighlight;
+  margin:   0px;
+  padding:  0px;
+  font-size:100%;
+  font-weight:bold;
+  padding: 2px;
+  clear:left;
+  
+}
+
+.htmlarea .panel { overflow:hidden; }
+.htmlarea .panels.left  .panel { border-right:none; border-left:none; }
+.htmlarea .panels.left  h1     { border-right:none;  }
+.htmlarea .panels.right .panel { border-right:none; border-left:none; }
+.htmlarea .panels.left  h1     { border-left:none;  }
+.htmlarea { border: 1px solid black; }
+
+.loading
+{
+  font-family:sans-serif;
+  position:absolute;
+  z-index:998;
+  text-align:center;
+  width:212px;
+  padding: 55px 0 5px 0;
+  border:2px solid #ccc;
+  /* border-color: ButtonHighlight ButtonShadow ButtonShadow ButtonHighlight;*/
+  background: url(images/xinha_logo.gif) no-repeat #fff center 5px;
+}
+.loading_main
+{
+  font-size:11px;
+  color:#000;
+ 
+}
+.loading_sub
+{
+  font-size:9px;
+  color:#666;
+  text-align:center;
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/XinhaCore.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/XinhaCore.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,3815 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/XinhaCore.js */
+  /*--------------------------------------------------------------------------
+    --  Xinha (is not htmlArea) - http://xinha.org
+    --
+    --  Use of Xinha is granted by the terms of the htmlArea License (based on
+    --  BSD license)  please read license.txt in this package for details.
+    --
+    --  Copyright (c) 2005-2008 Xinha Developer Team and contributors
+    --  
+    --  Xinha was originally based on work by Mihai Bazon which is:
+    --      Copyright (c) 2003-2004 dynarch.com.
+    --      Copyright (c) 2002-2003 interactivetools.com, inc.
+    --      This copyright notice MUST stay intact for use.
+    -------------------------------------------------------------------------*/
+
+Xinha.version={"Release":"0.95","Head":"$HeadURL:http://svn.xinha.webfactional.com/trunk/XinhaCore.js $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1"),"Date":"$LastChangedDate:2008-05-01 14:33:36 +0200 (Do, 01 Mai 2008) $".replace(/^[^:]*:\s*([0-9-]*) ([0-9:]*) ([+0-9]*) \((.*)\)\s*\$/,"$4 $2 $3"),"Revision":"$LastChangedRevision:999 $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1"),"RevisionBy":"$LastChangedBy:ray $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1")};
+Xinha._resolveRelativeUrl=function(_1,_2){
+if(_2.match(/^([^:]+\:)?\/\//)){
+return _2;
+}else{
+var b=_1.split("/");
+if(b[b.length-1]==""){
+b.pop();
+}
+var p=_2.split("/");
+if(p[0]=="."){
+p.shift();
+}
+while(p[0]==".."){
+b.pop();
+p.shift();
+}
+return b.join("/")+"/"+p.join("/");
+}
+};
+if(typeof _editor_url=="string"){
+_editor_url=_editor_url.replace(/\x2f*$/,"/");
+if(!_editor_url.match(/^([^:]+\:)?\//)){
+var path=window.location.toString().split("/");
+path.pop();
+_editor_url=Xinha._resolveRelativeUrl(path.join("/"),_editor_url);
+}
+}else{
+alert("WARNING: _editor_url is not set!  You should set this variable to the editor files path; it should preferably be an absolute path, like in '/htmlarea/', but it can be relative if you prefer.  Further we will try to load the editor files correctly but we'll probably fail.");
+_editor_url="";
+}
+if(typeof _editor_lang=="string"){
+_editor_lang=_editor_lang.toLowerCase();
+}else{
+_editor_lang="en";
+}
+if(typeof _editor_skin!=="string"){
+_editor_skin="";
+}
+var __xinhas=[];
+Xinha.agt=navigator.userAgent.toLowerCase();
+Xinha.is_ie=((Xinha.agt.indexOf("msie")!=-1)&&(Xinha.agt.indexOf("opera")==-1));
+Xinha.ie_version=parseFloat(Xinha.agt.substring(Xinha.agt.indexOf("msie")+5));
+Xinha.is_opera=(Xinha.agt.indexOf("opera")!=-1);
+if(Xinha.is_opera&&Xinha.agt.match(/opera[\/ ]([0-9.]+)/)){
+Xinha.opera_version=parseFloat(RegExp.$1);
+}else{
+Xinha.opera_version=0;
+}
+Xinha.is_khtml=(Xinha.agt.indexOf("khtml")!=-1);
+Xinha.is_webkit=(Xinha.agt.indexOf("applewebkit")!=-1);
+Xinha.webkit_version=parseInt(navigator.appVersion.replace(/.*?AppleWebKit\/([\d]).*?/,"$1"));
+Xinha.is_safari=(Xinha.agt.indexOf("safari")!=-1);
+Xinha.is_mac=(Xinha.agt.indexOf("mac")!=-1);
+Xinha.is_mac_ie=(Xinha.is_ie&&Xinha.is_mac);
+Xinha.is_win_ie=(Xinha.is_ie&&!Xinha.is_mac);
+Xinha.is_gecko=(navigator.product=="Gecko")||Xinha.is_opera;
+Xinha.is_real_gecko=(navigator.product=="Gecko"&&!Xinha.is_webkit);
+Xinha.is_ff3=Xinha.is_real_gecko&&parseInt(navigator.productSub)>=2007121016;
+Xinha.is_ff2=Xinha.is_real_gecko&&parseInt(navigator.productSub)<2007121016;
+Xinha.isRunLocally=document.URL.toLowerCase().search(/^file:/)!=-1;
+Xinha.is_designMode=(typeof document.designMode!="undefined"&&!Xinha.is_ie);
+Xinha.checkSupportedBrowser=function(){
+return Xinha.is_real_gecko||(Xinha.is_opera&&Xinha.opera_version>=9.2)||Xinha.ie_version>=5.5||Xinha.webkit_version>=522;
+};
+Xinha.isSupportedBrowser=Xinha.checkSupportedBrowser();
+if(Xinha.isRunLocally&&Xinha.isSupportedBrowser){
+alert("Xinha *must* be installed on a web server. Locally opened files (those that use the \"file://\" protocol) cannot properly function. Xinha will try to initialize but may not be correctly loaded.");
+}
+function Xinha(_5,_6){
+if(!Xinha.isSupportedBrowser){
+return;
+}
+if(!_5){
+throw new Error("Tried to create Xinha without textarea specified.");
+}
+if(typeof _6=="undefined"){
+this.config=new Xinha.Config();
+}else{
+this.config=_6;
+}
+if(typeof _5!="object"){
+_5=Xinha.getElementById("textarea",_5);
+}
+this._textArea=_5;
+this._textArea.spellcheck=false;
+Xinha.freeLater(this,"_textArea");
+this._initial_ta_size={w:_5.style.width?_5.style.width:(_5.offsetWidth?(_5.offsetWidth+"px"):(_5.cols+"em")),h:_5.style.height?_5.style.height:(_5.offsetHeight?(_5.offsetHeight+"px"):(_5.rows+"em"))};
+if(document.getElementById("loading_"+_5.id)||this.config.showLoading){
+if(!document.getElementById("loading_"+_5.id)){
+Xinha.createLoadingMessage(_5);
+}
+this.setLoadingMessage(Xinha._lc("Constructing object"));
+}
+this._editMode="wysiwyg";
+this.plugins={};
+this._timerToolbar=null;
+this._timerUndo=null;
+this._undoQueue=[this.config.undoSteps];
+this._undoPos=-1;
+this._customUndo=true;
+this._mdoc=document;
+this.doctype="";
+this.__htmlarea_id_num=__xinhas.length;
+__xinhas[this.__htmlarea_id_num]=this;
+this._notifyListeners={};
+var _7={right:{on:true,container:document.createElement("td"),panels:[]},left:{on:true,container:document.createElement("td"),panels:[]},top:{on:true,container:document.createElement("td"),panels:[]},bottom:{on:true,container:document.createElement("td"),panels:[]}};
+for(var i in _7){
+if(!_7[i].container){
+continue;
+}
+_7[i].div=_7[i].container;
+_7[i].container.className="panels "+i;
+Xinha.freeLater(_7[i],"container");
+Xinha.freeLater(_7[i],"div");
+}
+this._panels=_7;
+this._statusBar=null;
+this._statusBarTree=null;
+this._statusBarTextMode=null;
+this._statusBarItems=[];
+this._framework={};
+this._htmlArea=null;
+this._iframe=null;
+this._doc=null;
+this._toolBar=this._toolbar=null;
+this._toolbarObjects={};
+}
+Xinha.onload=function(){
+};
+Xinha.init=function(){
+Xinha.onload();
+};
+Xinha.RE_tagName=/(<\/|<)\s*([^ \t\n>]+)/ig;
+Xinha.RE_doctype=/(<!doctype((.|\n)*?)>)\n?/i;
+Xinha.RE_head=/<head>((.|\n)*?)<\/head>/i;
+Xinha.RE_body=/<body[^>]*>((.|\n|\r|\t)*?)<\/body>/i;
+Xinha.RE_Specials=/([\/\^$*+?.()|{}[\]])/g;
+Xinha.escapeStringForRegExp=function(_9){
+return _9.replace(Xinha.RE_Specials,"\\$1");
+};
+Xinha.RE_email=/^[_a-z\d\-\.]{3,}@[_a-z\d\-]{2,}(\.[_a-z\d\-]{2,})+$/i;
+Xinha.RE_url=/(https?:\/\/)?(([a-z0-9_]+:[a-z0-9_]+@)?[a-z0-9_-]{2,}(\.[a-z0-9_-]{2,}){2,}(:[0-9]+)?(\/\S+)*)/i;
+Xinha.Config=function(){
+this.version=Xinha.version.Revision;
+this.width="auto";
+this.height="auto";
+this.sizeIncludesBars=true;
+this.sizeIncludesPanels=true;
+this.panel_dimensions={left:"200px",right:"200px",top:"100px",bottom:"100px"};
+this.iframeWidth=null;
+this.statusBar=true;
+this.htmlareaPaste=false;
+this.mozParaHandler="best";
+this.getHtmlMethod="DOMwalk";
+this.undoSteps=20;
+this.undoTimeout=500;
+this.changeJustifyWithDirection=false;
+this.fullPage=false;
+this.pageStyle="";
+this.pageStyleSheets=[];
+this.baseHref=null;
+this.expandRelativeUrl=true;
+this.stripBaseHref=true;
+this.stripSelfNamedAnchors=true;
+this.only7BitPrintablesInURLs=true;
+this.sevenBitClean=false;
+this.specialReplacements={};
+this.inwardHtml=function(_a){
+return _a;
+};
+this.outwardHtml=function(_b){
+return _b;
+};
+this.killWordOnPaste=true;
+this.makeLinkShowsTarget=true;
+this.charSet=(typeof document.characterSet!="undefined")?document.characterSet:document.charset;
+this.browserQuirksMode=null;
+this.imgURL="images/";
+this.popupURL="popups/";
+this.htmlRemoveTags=null;
+this.flowToolbars=true;
+this.toolbarAlign="left";
+this.showLoading=false;
+this.stripScripts=true;
+this.convertUrlsToLinks=true;
+this.colorPickerCellSize="6px";
+this.colorPickerGranularity=18;
+this.colorPickerPosition="bottom,right";
+this.colorPickerWebSafe=false;
+this.colorPickerSaveColors=20;
+this.fullScreen=false;
+this.fullScreenMargins=[0,0,0,0];
+this.toolbar=[["popupeditor"],["separator","formatblock","fontname","fontsize","bold","italic","underline","strikethrough"],["separator","forecolor","hilitecolor","textindicator"],["separator","subscript","superscript"],["linebreak","separator","justifyleft","justifycenter","justifyright","justifyfull"],["separator","insertorderedlist","insertunorderedlist","outdent","indent"],["separator","inserthorizontalrule","createlink","insertimage","inserttable"],["linebreak","separator","undo","redo","selectall","print"],(Xinha.is_gecko?[]:["cut","copy","paste","overwrite","saveas"]),["separator","killword","clearfonts","removeformat","toggleborders","splitblock","lefttoright","righttoleft"],["separator","htmlmode","showhelp","about"]];
+this.fontname={"&mdash; font &mdash;":"","Arial":"arial,helvetica,sans-serif","Courier New":"courier new,courier,monospace","Georgia":"georgia,times new roman,times,serif","Tahoma":"tahoma,arial,helvetica,sans-serif","Times New Roman":"times new roman,times,serif","Verdana":"verdana,arial,helvetica,sans-serif","impact":"impact","WingDings":"wingdings"};
+this.fontsize={"&mdash; size &mdash;":"","1 (8 pt)":"1","2 (10 pt)":"2","3 (12 pt)":"3","4 (14 pt)":"4","5 (18 pt)":"5","6 (24 pt)":"6","7 (36 pt)":"7"};
+this.formatblock={"&mdash; format &mdash;":"","Heading 1":"h1","Heading 2":"h2","Heading 3":"h3","Heading 4":"h4","Heading 5":"h5","Heading 6":"h6","Normal":"p","Address":"address","Formatted":"pre"};
+this.customSelects={};
+this.debug=true;
+this.URIs={"blank":_editor_url+"popups/blank.html","link":_editor_url+"modules/CreateLink/link.html","insert_image":_editor_url+"modules/InsertImage/insert_image.html","insert_table":_editor_url+"modules/InsertTable/insert_table.html","select_color":_editor_url+"popups/select_color.html","about":_editor_url+"popups/about.html","help":_editor_url+"popups/editor_help.html"};
+this.btnList={bold:["Bold",Xinha._lc({key:"button_bold",string:["ed_buttons_main.gif",3,2]},"Xinha"),false,function(e){
+e.execCommand("bold");
+}],italic:["Italic",Xinha._lc({key:"button_italic",string:["ed_buttons_main.gif",2,2]},"Xinha"),false,function(e){
+e.execCommand("italic");
+}],underline:["Underline",Xinha._lc({key:"button_underline",string:["ed_buttons_main.gif",2,0]},"Xinha"),false,function(e){
+e.execCommand("underline");
+}],strikethrough:["Strikethrough",Xinha._lc({key:"button_strikethrough",string:["ed_buttons_main.gif",3,0]},"Xinha"),false,function(e){
+e.execCommand("strikethrough");
+}],subscript:["Subscript",Xinha._lc({key:"button_subscript",string:["ed_buttons_main.gif",3,1]},"Xinha"),false,function(e){
+e.execCommand("subscript");
+}],superscript:["Superscript",Xinha._lc({key:"button_superscript",string:["ed_buttons_main.gif",2,1]},"Xinha"),false,function(e){
+e.execCommand("superscript");
+}],justifyleft:["Justify Left",["ed_buttons_main.gif",0,0],false,function(e){
+e.execCommand("justifyleft");
+}],justifycenter:["Justify Center",["ed_buttons_main.gif",1,1],false,function(e){
+e.execCommand("justifycenter");
+}],justifyright:["Justify Right",["ed_buttons_main.gif",1,0],false,function(e){
+e.execCommand("justifyright");
+}],justifyfull:["Justify Full",["ed_buttons_main.gif",0,1],false,function(e){
+e.execCommand("justifyfull");
+}],orderedlist:["Ordered List",["ed_buttons_main.gif",0,3],false,function(e){
+e.execCommand("insertorderedlist");
+}],unorderedlist:["Bulleted List",["ed_buttons_main.gif",1,3],false,function(e){
+e.execCommand("insertunorderedlist");
+}],insertorderedlist:["Ordered List",["ed_buttons_main.gif",0,3],false,function(e){
+e.execCommand("insertorderedlist");
+}],insertunorderedlist:["Bulleted List",["ed_buttons_main.gif",1,3],false,function(e){
+e.execCommand("insertunorderedlist");
+}],outdent:["Decrease Indent",["ed_buttons_main.gif",1,2],false,function(e){
+e.execCommand("outdent");
+}],indent:["Increase Indent",["ed_buttons_main.gif",0,2],false,function(e){
+e.execCommand("indent");
+}],forecolor:["Font Color",["ed_buttons_main.gif",3,3],false,function(e){
+e.execCommand("forecolor");
+}],hilitecolor:["Background Color",["ed_buttons_main.gif",2,3],false,function(e){
+e.execCommand("hilitecolor");
+}],undo:["Undoes your last action",["ed_buttons_main.gif",4,2],false,function(e){
+e.execCommand("undo");
+}],redo:["Redoes your last action",["ed_buttons_main.gif",5,2],false,function(e){
+e.execCommand("redo");
+}],cut:["Cut selection",["ed_buttons_main.gif",5,0],false,function(e,cmd){
+e.execCommand(cmd);
+}],copy:["Copy selection",["ed_buttons_main.gif",4,0],false,function(e,cmd){
+e.execCommand(cmd);
+}],paste:["Paste from clipboard",["ed_buttons_main.gif",4,1],false,function(e,cmd){
+e.execCommand(cmd);
+}],selectall:["Select all","ed_selectall.gif",false,function(e){
+e.execCommand("selectall");
+}],inserthorizontalrule:["Horizontal Rule",["ed_buttons_main.gif",6,0],false,function(e){
+e.execCommand("inserthorizontalrule");
+}],createlink:["Insert Web Link",["ed_buttons_main.gif",6,1],false,function(e){
+e._createLink();
+}],insertimage:["Insert/Modify Image",["ed_buttons_main.gif",6,3],false,function(e){
+e.execCommand("insertimage");
+}],inserttable:["Insert Table",["ed_buttons_main.gif",6,2],false,function(e){
+e.execCommand("inserttable");
+}],htmlmode:["Toggle HTML Source",["ed_buttons_main.gif",7,0],true,function(e){
+e.execCommand("htmlmode");
+}],toggleborders:["Toggle Borders",["ed_buttons_main.gif",7,2],false,function(e){
+e._toggleBorders();
+}],print:["Print document",["ed_buttons_main.gif",8,1],false,function(e){
+if(Xinha.is_gecko){
+e._iframe.contentWindow.print();
+}else{
+e.focusEditor();
+print();
+}
+}],saveas:["Save as","ed_saveas.gif",false,function(e){
+e.execCommand("saveas",false,"noname.htm");
+}],about:["About this editor",["ed_buttons_main.gif",8,2],true,function(e){
+e.execCommand("about");
+}],showhelp:["Help using editor",["ed_buttons_main.gif",9,2],true,function(e){
+e.execCommand("showhelp");
+}],splitblock:["Split Block","ed_splitblock.gif",false,function(e){
+e._splitBlock();
+}],lefttoright:["Direction left to right",["ed_buttons_main.gif",0,4],false,function(e){
+e.execCommand("lefttoright");
+}],righttoleft:["Direction right to left",["ed_buttons_main.gif",1,4],false,function(e){
+e.execCommand("righttoleft");
+}],overwrite:["Insert/Overwrite","ed_overwrite.gif",false,function(e){
+e.execCommand("overwrite");
+}],wordclean:["MS Word Cleaner",["ed_buttons_main.gif",5,3],false,function(e){
+e._wordClean();
+}],clearfonts:["Clear Inline Font Specifications",["ed_buttons_main.gif",5,4],true,function(e){
+e._clearFonts();
+}],removeformat:["Remove formatting",["ed_buttons_main.gif",4,4],false,function(e){
+e.execCommand("removeformat");
+}],killword:["Clear MSOffice tags",["ed_buttons_main.gif",4,3],false,function(e){
+e.execCommand("killword");
+}]};
+for(var i in this.btnList){
+var btn=this.btnList[i];
+if(typeof btn!="object"){
+continue;
+}
+if(typeof btn[1]!="string"){
+btn[1][0]=_editor_url+this.imgURL+btn[1][0];
+}else{
+btn[1]=_editor_url+this.imgURL+btn[1];
+}
+btn[0]=Xinha._lc(btn[0]);
+}
+};
+Xinha.Config.prototype.registerButton=function(id,_3c,_3d,_3e,_3f,_40){
+var _41;
+if(typeof id=="string"){
+_41=id;
+}else{
+if(typeof id=="object"){
+_41=id.id;
+}else{
+alert("ERROR [Xinha.Config::registerButton]:\ninvalid arguments");
+return false;
+}
+}
+switch(typeof id){
+case "string":
+this.btnList[id]=[_3c,_3d,_3e,_3f,_40];
+break;
+case "object":
+this.btnList[id.id]=[id.tooltip,id.image,id.textMode,id.action,id.context];
+break;
+}
+};
+Xinha.prototype.registerPanel=function(_42,_43){
+if(!_42){
+_42="right";
+}
+this.setLoadingMessage("Register "+_42+" panel ");
+var _44=this.addPanel(_42);
+if(_43){
+_43.drawPanelIn(_44);
+}
+};
+Xinha.Config.prototype.registerDropdown=function(_45){
+this.customSelects[_45.id]=_45;
+};
+Xinha.Config.prototype.hideSomeButtons=function(_46){
+var _47=this.toolbar;
+for(var i=_47.length;--i>=0;){
+var _49=_47[i];
+for(var j=_49.length;--j>=0;){
+if(_46.indexOf(" "+_49[j]+" ")>=0){
+var len=1;
+if(/separator|space/.test(_49[j+1])){
+len=2;
+}
+_49.splice(j,len);
+}
+}
+}
+};
+Xinha.Config.prototype.addToolbarElement=function(id,_4d,_4e){
+var _4f=this.toolbar;
+var a,i,j,o,sid;
+var _51=false;
+var _52=false;
+var _53=0;
+var _54=0;
+var _55=0;
+var _56=false;
+var _57=false;
+if((id&&typeof id=="object")&&(id.constructor==Array)){
+_51=true;
+}
+if((_4d&&typeof _4d=="object")&&(_4d.constructor==Array)){
+_52=true;
+_53=_4d.length;
+}
+if(_51){
+for(i=0;i<id.length;++i){
+if((id[i]!="separator")&&(id[i].indexOf("T[")!==0)){
+sid=id[i];
+}
+}
+}else{
+sid=id;
+}
+for(i=0;i<_4f.length;++i){
+a=_4f[i];
+for(j=0;j<a.length;++j){
+if(a[j]==sid){
+return;
+}
+}
+}
+for(i=0;!_57&&i<_4f.length;++i){
+a=_4f[i];
+for(j=0;!_57&&j<a.length;++j){
+if(_52){
+for(o=0;o<_53;++o){
+if(a[j]==_4d[o]){
+if(o===0){
+_57=true;
+j--;
+break;
+}else{
+_55=i;
+_54=j;
+_53=o;
+}
+}
+}
+}else{
+if(a[j]==_4d){
+_57=true;
+break;
+}
+}
+}
+}
+if(!_57&&_52){
+if(_4d.length!=_53){
+j=_54;
+a=_4f[_55];
+_57=true;
+}
+}
+if(_57){
+if(_4e===0){
+if(_51){
+a[j]=id[id.length-1];
+for(i=id.length-1;--i>=0;){
+a.splice(j,0,id[i]);
+}
+}else{
+a[j]=id;
+}
+}else{
+if(_4e<0){
+j=j+_4e+1;
+}else{
+if(_4e>0){
+j=j+_4e;
+}
+}
+if(_51){
+for(i=id.length;--i>=0;){
+a.splice(j,0,id[i]);
+}
+}else{
+a.splice(j,0,id);
+}
+}
+}else{
+_4f[0].splice(0,0,"separator");
+if(_51){
+for(i=id.length;--i>=0;){
+_4f[0].splice(0,0,id[i]);
+}
+}else{
+_4f[0].splice(0,0,id);
+}
+}
+};
+Xinha.Config.prototype.removeToolbarElement=Xinha.Config.prototype.hideSomeButtons;
+Xinha.replaceAll=function(_58){
+var tas=document.getElementsByTagName("textarea");
+for(var i=tas.length;i>0;(new Xinha(tas[--i],_58)).generate()){
+}
+};
+Xinha.replace=function(id,_5c){
+var ta=Xinha.getElementById("textarea",id);
+return ta?(new Xinha(ta,_5c)).generate():null;
+};
+Xinha.prototype._createToolbar=function(){
+this.setLoadingMessage(Xinha._lc("Create Toolbar"));
+var _5e=this;
+var _5f=document.createElement("div");
+this._toolBar=this._toolbar=_5f;
+_5f.className="toolbar";
+_5f.unselectable="1";
+_5f.align=this.config.toolbarAlign;
+Xinha.freeLater(this,"_toolBar");
+Xinha.freeLater(this,"_toolbar");
+var _60=null;
+var _61={};
+this._toolbarObjects=_61;
+this._createToolbar1(_5e,_5f,_61);
+this._htmlArea.appendChild(_5f);
+return _5f;
+};
+Xinha.prototype._setConfig=function(_62){
+this.config=_62;
+};
+Xinha.prototype._addToolbar=function(){
+this._createToolbar1(this,this._toolbar,this._toolbarObjects);
+};
+Xinha._createToolbarBreakingElement=function(){
+var brk=document.createElement("div");
+brk.style.height="1px";
+brk.style.width="1px";
+brk.style.lineHeight="1px";
+brk.style.fontSize="1px";
+brk.style.clear="both";
+return brk;
+};
+Xinha.prototype._createToolbar1=function(_64,_65,_66){
+var _67;
+if(_64.config.flowToolbars){
+_65.appendChild(Xinha._createToolbarBreakingElement());
+}
+function newLine(){
+if(typeof _67!="undefined"&&_67.childNodes.length===0){
+return;
+}
+var _68=document.createElement("table");
+_68.border="0px";
+_68.cellSpacing="0px";
+_68.cellPadding="0px";
+if(_64.config.flowToolbars){
+if(Xinha.is_ie){
+_68.style.styleFloat="left";
+}else{
+_68.style.cssFloat="left";
+}
+}
+_65.appendChild(_68);
+var _69=document.createElement("tbody");
+_68.appendChild(_69);
+_67=document.createElement("tr");
+_69.appendChild(_67);
+_68.className="toolbarRow";
+}
+newLine();
+function setButtonStatus(id,_6b){
+var _6c=this[id];
+var el=this.element;
+if(_6c!=_6b){
+switch(id){
+case "enabled":
+if(_6b){
+Xinha._removeClass(el,"buttonDisabled");
+el.disabled=false;
+}else{
+Xinha._addClass(el,"buttonDisabled");
+el.disabled=true;
+}
+break;
+case "active":
+if(_6b){
+Xinha._addClass(el,"buttonPressed");
+}else{
+Xinha._removeClass(el,"buttonPressed");
+}
+break;
+}
+this[id]=_6b;
+}
+}
+function createSelect(txt){
+var _6f=null;
+var el=null;
+var cmd=null;
+var _72=_64.config.customSelects;
+var _73=null;
+var _74="";
+switch(txt){
+case "fontsize":
+case "fontname":
+case "formatblock":
+_6f=_64.config[txt];
+cmd=txt;
+break;
+default:
+cmd=txt;
+var _75=_72[cmd];
+if(typeof _75!="undefined"){
+_6f=_75.options;
+_73=_75.context;
+if(typeof _75.tooltip!="undefined"){
+_74=_75.tooltip;
+}
+}else{
+alert("ERROR [createSelect]:\nCan't find the requested dropdown definition");
+}
+break;
+}
+if(_6f){
+el=document.createElement("select");
+el.title=_74;
+var obj={name:txt,element:el,enabled:true,text:false,cmd:cmd,state:setButtonStatus,context:_73};
+Xinha.freeLater(obj);
+_66[txt]=obj;
+for(var i in _6f){
+if(typeof (_6f[i])!="string"){
+continue;
+}
+var op=document.createElement("option");
+op.innerHTML=Xinha._lc(i);
+op.value=_6f[i];
+el.appendChild(op);
+}
+Xinha._addEvent(el,"change",function(){
+_64._comboSelected(el,txt);
+});
+}
+return el;
+}
+function createButton(txt){
+var el,btn,obj=null;
+switch(txt){
+case "separator":
+if(_64.config.flowToolbars){
+newLine();
+}
+el=document.createElement("div");
+el.className="separator";
+break;
+case "space":
+el=document.createElement("div");
+el.className="space";
+break;
+case "linebreak":
+newLine();
+return false;
+case "textindicator":
+el=document.createElement("div");
+el.appendChild(document.createTextNode("A"));
+el.className="indicator";
+el.title=Xinha._lc("Current style");
+obj={name:txt,element:el,enabled:true,active:false,text:false,cmd:"textindicator",state:setButtonStatus};
+Xinha.freeLater(obj);
+_66[txt]=obj;
+break;
+default:
+btn=_64.config.btnList[txt];
+}
+if(!el&&btn){
+el=document.createElement("a");
+el.style.display="block";
+el.href="javascript:void(0)";
+el.style.textDecoration="none";
+el.title=btn[0];
+el.className="button";
+el.style.direction="ltr";
+obj={name:txt,element:el,enabled:true,active:false,text:btn[2],cmd:btn[3],state:setButtonStatus,context:btn[4]||null};
+Xinha.freeLater(el);
+Xinha.freeLater(obj);
+_66[txt]=obj;
+el.ondrag=function(){
+return false;
+};
+Xinha._addEvent(el,"mouseout",function(ev){
+if(obj.enabled){
+Xinha._removeClass(el,"buttonActive");
+if(obj.active){
+Xinha._addClass(el,"buttonPressed");
+}
+}
+});
+Xinha._addEvent(el,"mousedown",function(ev){
+if(obj.enabled){
+Xinha._addClass(el,"buttonActive");
+Xinha._removeClass(el,"buttonPressed");
+Xinha._stopEvent(Xinha.is_ie?window.event:ev);
+}
+});
+Xinha._addEvent(el,"click",function(ev){
+ev=Xinha.is_ie?window.event:ev;
+_64.btnClickEvent=ev;
+if(obj.enabled){
+Xinha._removeClass(el,"buttonActive");
+if(Xinha.is_gecko){
+_64.activateEditor();
+}
+obj.cmd(_64,obj.name,obj);
+Xinha._stopEvent(ev);
+}
+});
+var _7e=Xinha.makeBtnImg(btn[1]);
+var img=_7e.firstChild;
+Xinha.freeLater(_7e);
+Xinha.freeLater(img);
+el.appendChild(_7e);
+obj.imgel=img;
+obj.swapImage=function(_80){
+if(typeof _80!="string"){
+img.src=_80[0];
+img.style.position="relative";
+img.style.top=_80[2]?("-"+(18*(_80[2]+1))+"px"):"-18px";
+img.style.left=_80[1]?("-"+(18*(_80[1]+1))+"px"):"-18px";
+}else{
+obj.imgel.src=_80;
+img.style.top="0px";
+img.style.left="0px";
+}
+};
+}else{
+if(!el){
+el=createSelect(txt);
+}
+}
+return el;
+}
+var _81=true;
+for(var i=0;i<this.config.toolbar.length;++i){
+if(!_81){
+}else{
+_81=false;
+}
+if(this.config.toolbar[i]===null){
+this.config.toolbar[i]=["separator"];
+}
+var _83=this.config.toolbar[i];
+for(var j=0;j<_83.length;++j){
+var _85=_83[j];
+var _86;
+if(/^([IT])\[(.*?)\]/.test(_85)){
+var _87=RegExp.$1=="I";
+var _88=RegExp.$2;
+if(_87){
+_88=Xinha._lc(_88);
+}
+_86=document.createElement("td");
+_67.appendChild(_86);
+_86.className="label";
+_86.innerHTML=_88;
+}else{
+if(typeof _85!="function"){
+var _89=createButton(_85);
+if(_89){
+_86=document.createElement("td");
+_86.className="toolbarElement";
+_67.appendChild(_86);
+_86.appendChild(_89);
+}else{
+if(_89===null){
+alert("FIXME: Unknown toolbar item: "+_85);
+}
+}
+}
+}
+}
+}
+if(_64.config.flowToolbars){
+_65.appendChild(Xinha._createToolbarBreakingElement());
+}
+return _65;
+};
+var use_clone_img=false;
+Xinha.makeBtnImg=function(_8a,doc){
+if(!doc){
+doc=document;
+}
+if(!doc._xinhaImgCache){
+doc._xinhaImgCache={};
+Xinha.freeLater(doc._xinhaImgCache);
+}
+var _8c=null;
+if(Xinha.is_ie&&((!doc.compatMode)||(doc.compatMode&&doc.compatMode=="BackCompat"))){
+_8c=doc.createElement("span");
+}else{
+_8c=doc.createElement("div");
+_8c.style.position="relative";
+}
+_8c.style.overflow="hidden";
+_8c.style.width="18px";
+_8c.style.height="18px";
+_8c.className="buttonImageContainer";
+var img=null;
+if(typeof _8a=="string"){
+if(doc._xinhaImgCache[_8a]){
+img=doc._xinhaImgCache[_8a].cloneNode();
+}else{
+img=doc.createElement("img");
+img.src=_8a;
+img.style.width="18px";
+img.style.height="18px";
+if(use_clone_img){
+doc._xinhaImgCache[_8a]=img.cloneNode();
+}
+}
+}else{
+if(doc._xinhaImgCache[_8a[0]]){
+img=doc._xinhaImgCache[_8a[0]].cloneNode();
+}else{
+img=doc.createElement("img");
+img.src=_8a[0];
+img.style.position="relative";
+if(use_clone_img){
+doc._xinhaImgCache[_8a[0]]=img.cloneNode();
+}
+}
+img.style.top=_8a[2]?("-"+(18*(_8a[2]+1))+"px"):"-18px";
+img.style.left=_8a[1]?("-"+(18*(_8a[1]+1))+"px"):"-18px";
+}
+_8c.appendChild(img);
+return _8c;
+};
+Xinha.prototype._createStatusBar=function(){
+this.setLoadingMessage(Xinha._lc("Create Statusbar"));
+var _8e=document.createElement("div");
+_8e.className="statusBar";
+this._statusBar=_8e;
+Xinha.freeLater(this,"_statusBar");
+var div=document.createElement("span");
+div.className="statusBarTree";
+div.innerHTML=Xinha._lc("Path")+": ";
+this._statusBarTree=div;
+Xinha.freeLater(this,"_statusBarTree");
+this._statusBar.appendChild(div);
+div=document.createElement("span");
+div.innerHTML=Xinha._lc("You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.");
+div.style.display="none";
+this._statusBarTextMode=div;
+Xinha.freeLater(this,"_statusBarTextMode");
+this._statusBar.appendChild(div);
+if(!this.config.statusBar){
+_8e.style.display="none";
+}
+return _8e;
+};
+Xinha.prototype.generate=function(){
+if(!Xinha.isSupportedBrowser){
+return;
+}
+var i;
+var _91=this;
+var url;
+var _93=false;
+var _94=document.getElementsByTagName("link");
+if(!document.getElementById("XinhaCoreDesign")){
+_editor_css=(typeof _editor_css=="string")?_editor_css:"Xinha.css";
+for(i=0;i<_94.length;i++){
+if((_94[i].rel=="stylesheet")&&(_94[i].href==_editor_url+_editor_css)){
+_93=true;
+}
+}
+if(!_93){
+Xinha.loadStyle(_editor_css,null,"XinhaCoreDesign",true);
+}
+}
+if(_editor_skin!==""&&!document.getElementById("XinhaSkin")){
+_93=false;
+for(i=0;i<_94.length;i++){
+if((_94[i].rel=="stylesheet")&&(_94[i].href==_editor_url+"skins/"+_editor_skin+"/skin.css")){
+_93=true;
+}
+}
+if(!_93){
+Xinha.loadStyle("skins/"+_editor_skin+"/skin.css",null,"XinhaSkin");
+}
+}
+if(Xinha.is_ie){
+url=_editor_url+"modules/InternetExplorer/InternetExplorer.js";
+if(!Xinha.loadPlugins([{plugin:"InternetExplorer",url:url}],function(){
+_91.generate();
+})){
+return false;
+}
+_91._browserSpecificPlugin=_91.registerPlugin("InternetExplorer");
+}else{
+if(Xinha.is_webkit){
+url=_editor_url+"modules/WebKit/WebKit.js";
+if(!Xinha.loadPlugins([{plugin:"WebKit",url:url}],function(){
+_91.generate();
+})){
+return false;
+}
+_91._browserSpecificPlugin=_91.registerPlugin("WebKit");
+}else{
+if(Xinha.is_opera){
+url=_editor_url+"modules/Opera/Opera.js";
+if(!Xinha.loadPlugins([{plugin:"Opera",url:url}],function(){
+_91.generate();
+})){
+return false;
+}
+_91._browserSpecificPlugin=_91.registerPlugin("Opera");
+}else{
+if(Xinha.is_gecko){
+url=_editor_url+"modules/Gecko/Gecko.js";
+if(!Xinha.loadPlugins([{plugin:"Gecko",url:url}],function(){
+_91.generate();
+})){
+return false;
+}
+_91._browserSpecificPlugin=_91.registerPlugin("Gecko");
+}
+}
+}
+}
+if(typeof Dialog=="undefined"&&!Xinha._loadback(_editor_url+"modules/Dialogs/dialog.js",this.generate,this)){
+return false;
+}
+if(typeof Xinha.Dialog=="undefined"&&!Xinha._loadback(_editor_url+"modules/Dialogs/inline-dialog.js",this.generate,this)){
+return false;
+}
+url=_editor_url+"modules/FullScreen/full-screen.js";
+if(!Xinha.loadPlugins([{plugin:"FullScreen",url:url}],function(){
+_91.generate();
+})){
+return false;
+}
+url=_editor_url+"modules/ColorPicker/ColorPicker.js";
+if(!Xinha.loadPlugins([{plugin:"ColorPicker",url:url}],function(){
+_91.generate();
+})){
+return false;
+}else{
+if(typeof ColorPicker!="undefined"){
+_91.registerPlugin("ColorPicker");
+}
+}
+var _95=_91.config.toolbar;
+for(i=_95.length;--i>=0;){
+for(var j=_95[i].length;--j>=0;){
+switch(_95[i][j]){
+case "popupeditor":
+_91.registerPlugin("FullScreen");
+break;
+case "insertimage":
+url=_editor_url+"modules/InsertImage/insert_image.js";
+if(typeof Xinha.prototype._insertImage=="undefined"&&!Xinha.loadPlugins([{plugin:"InsertImage",url:url}],function(){
+_91.generate();
+})){
+return false;
+}else{
+if(typeof InsertImage!="undefined"){
+_91.registerPlugin("InsertImage");
+}
+}
+break;
+case "createlink":
+url=_editor_url+"modules/CreateLink/link.js";
+if(typeof Linker=="undefined"&&!Xinha.loadPlugins([{plugin:"CreateLink",url:url}],function(){
+_91.generate();
+})){
+return false;
+}else{
+if(typeof CreateLink!="undefined"){
+_91.registerPlugin("CreateLink");
+}
+}
+break;
+case "inserttable":
+url=_editor_url+"modules/InsertTable/insert_table.js";
+if(!Xinha.loadPlugins([{plugin:"InsertTable",url:url}],function(){
+_91.generate();
+})){
+return false;
+}else{
+if(typeof InsertTable!="undefined"){
+_91.registerPlugin("InsertTable");
+}
+}
+break;
+}
+}
+}
+if(Xinha.is_gecko&&_91.config.mozParaHandler!="built-in"){
+if(!Xinha.loadPlugins([{plugin:"EnterParagraphs",url:_editor_url+"modules/Gecko/paraHandlerBest.js"}],function(){
+_91.generate();
+})){
+return false;
+}
+_91.registerPlugin("EnterParagraphs");
+}
+if(Xinha.ie_version==8){
+this.config.getHtmlMethod="TransformInnerHTML";
+}
+switch(this.config.getHtmlMethod){
+case "TransformInnerHTML":
+var _97=_editor_url+"modules/GetHtml/TransformInnerHTML.js";
+break;
+default:
+var _97=_editor_url+"modules/GetHtml/DOMwalk.js";
+break;
+}
+if(!Xinha.loadPlugins([{plugin:"GetHtmlImplementation",url:_97}],function(){
+_91.generate();
+})){
+return false;
+}else{
+_91.registerPlugin("GetHtmlImplementation");
+}
+this.setLoadingMessage(Xinha._lc("Generate Xinha framework"));
+this._framework={"table":document.createElement("table"),"tbody":document.createElement("tbody"),"tb_row":document.createElement("tr"),"tb_cell":document.createElement("td"),"tp_row":document.createElement("tr"),"tp_cell":this._panels.top.container,"ler_row":document.createElement("tr"),"lp_cell":this._panels.left.container,"ed_cell":document.createElement("td"),"rp_cell":this._panels.right.container,"bp_row":document.createElement("tr"),"bp_cell":this._panels.bottom.container,"sb_row":document.createElement("tr"),"sb_cell":document.createElement("td")};
+Xinha.freeLater(this._framework);
+var fw=this._framework;
+fw.table.border="0";
+fw.table.cellPadding="0";
+fw.table.cellSpacing="0";
+fw.tb_row.style.verticalAlign="top";
+fw.tp_row.style.verticalAlign="top";
+fw.ler_row.style.verticalAlign="top";
+fw.bp_row.style.verticalAlign="top";
+fw.sb_row.style.verticalAlign="top";
+fw.ed_cell.style.position="relative";
+fw.tb_row.appendChild(fw.tb_cell);
+fw.tb_cell.colSpan=3;
+fw.tp_row.appendChild(fw.tp_cell);
+fw.tp_cell.colSpan=3;
+fw.ler_row.appendChild(fw.lp_cell);
+fw.ler_row.appendChild(fw.ed_cell);
+fw.ler_row.appendChild(fw.rp_cell);
+fw.bp_row.appendChild(fw.bp_cell);
+fw.bp_cell.colSpan=3;
+fw.sb_row.appendChild(fw.sb_cell);
+fw.sb_cell.colSpan=3;
+fw.tbody.appendChild(fw.tb_row);
+fw.tbody.appendChild(fw.tp_row);
+fw.tbody.appendChild(fw.ler_row);
+fw.tbody.appendChild(fw.bp_row);
+fw.tbody.appendChild(fw.sb_row);
+fw.table.appendChild(fw.tbody);
+var _99=this._framework.table;
+this._htmlArea=_99;
+Xinha.freeLater(this,"_htmlArea");
+_99.className="htmlarea";
+this._framework.tb_cell.appendChild(this._createToolbar());
+var _9a=document.createElement("iframe");
+_9a.src=this.popupURL(_91.config.URIs.blank);
+_9a.id="XinhaIFrame_"+this._textArea.id;
+this._framework.ed_cell.appendChild(_9a);
+this._iframe=_9a;
+this._iframe.className="xinha_iframe";
+Xinha.freeLater(this,"_iframe");
+var _9b=this._createStatusBar();
+this._framework.sb_cell.appendChild(_9b);
+var _9c=this._textArea;
+_9c.parentNode.insertBefore(_99,_9c);
+_9c.className="xinha_textarea";
+Xinha.removeFromParent(_9c);
+this._framework.ed_cell.appendChild(_9c);
+Xinha.addDom0Event(this._textArea,"click",function(){
+if(Xinha._currentlyActiveEditor!=this){
+_91.updateToolbar();
+}
+return true;
+});
+if(_9c.form){
+Xinha.prependDom0Event(this._textArea.form,"submit",function(){
+_91.firePluginEvent("onBeforeSubmit");
+_91._textArea.value=_91.outwardHtml(_91.getHTML());
+return true;
+});
+var _9d=_9c.value;
+Xinha.prependDom0Event(this._textArea.form,"reset",function(){
+_91.setHTML(_91.inwardHtml(_9d));
+_91.updateToolbar();
+return true;
+});
+if(!_9c.form.xinha_submit){
+try{
+_9c.form.xinha_submit=_9c.form.submit;
+_9c.form.submit=function(){
+this.onsubmit();
+this.xinha_submit();
+};
+}
+catch(ex){
+}
+}
+}
+Xinha.prependDom0Event(window,"unload",function(){
+_91.firePluginEvent("onBeforeUnload");
+_9c.value=_91.outwardHtml(_91.getHTML());
+if(!Xinha.is_ie){
+_99.parentNode.replaceChild(_9c,_99);
+}
+return true;
+});
+_9c.style.display="none";
+_91.initSize();
+this.setLoadingMessage(Xinha._lc("Finishing"));
+_91._iframeLoadDone=false;
+if(Xinha.is_opera){
+_91.initIframe();
+}else{
+Xinha._addEvent(this._iframe,"load",function(e){
+if(!_91._iframeLoadDone){
+_91._iframeLoadDone=true;
+_91.initIframe();
+}
+return true;
+});
+}
+};
+Xinha.prototype.initSize=function(){
+this.setLoadingMessage(Xinha._lc("Init editor size"));
+var _9f=this;
+var _a0=null;
+var _a1=null;
+switch(this.config.width){
+case "auto":
+_a0=this._initial_ta_size.w;
+break;
+case "toolbar":
+_a0=this._toolBar.offsetWidth+"px";
+break;
+default:
+_a0=/[^0-9]/.test(this.config.width)?this.config.width:this.config.width+"px";
+break;
+}
+switch(this.config.height){
+case "auto":
+_a1=this._initial_ta_size.h;
+break;
+default:
+_a1=/[^0-9]/.test(this.config.height)?this.config.height:this.config.height+"px";
+break;
+}
+this.sizeEditor(_a0,_a1,this.config.sizeIncludesBars,this.config.sizeIncludesPanels);
+this.notifyOn("panel_change",function(){
+_9f.sizeEditor();
+});
+};
+Xinha.prototype.sizeEditor=function(_a2,_a3,_a4,_a5){
+if(this._risizing){
+return;
+}
+this._risizing=true;
+this.notifyOf("before_resize",{width:_a2,height:_a3});
+this.firePluginEvent("onBeforeResize",_a2,_a3);
+this._iframe.style.height="100%";
+this._textArea.style.height="100%";
+this._iframe.style.width="";
+this._textArea.style.width="";
+if(_a4!==null){
+this._htmlArea.sizeIncludesToolbars=_a4;
+}
+if(_a5!==null){
+this._htmlArea.sizeIncludesPanels=_a5;
+}
+if(_a2){
+this._htmlArea.style.width=_a2;
+if(!this._htmlArea.sizeIncludesPanels){
+var _a6=this._panels.right;
+if(_a6.on&&_a6.panels.length&&Xinha.hasDisplayedChildren(_a6.div)){
+this._htmlArea.style.width=(this._htmlArea.offsetWidth+parseInt(this.config.panel_dimensions.right,10))+"px";
+}
+var _a7=this._panels.left;
+if(_a7.on&&_a7.panels.length&&Xinha.hasDisplayedChildren(_a7.div)){
+this._htmlArea.style.width=(this._htmlArea.offsetWidth+parseInt(this.config.panel_dimensions.left,10))+"px";
+}
+}
+}
+if(_a3){
+this._htmlArea.style.height=_a3;
+if(!this._htmlArea.sizeIncludesToolbars){
+this._htmlArea.style.height=(this._htmlArea.offsetHeight+this._toolbar.offsetHeight+this._statusBar.offsetHeight)+"px";
+}
+if(!this._htmlArea.sizeIncludesPanels){
+var _a8=this._panels.top;
+if(_a8.on&&_a8.panels.length&&Xinha.hasDisplayedChildren(_a8.div)){
+this._htmlArea.style.height=(this._htmlArea.offsetHeight+parseInt(this.config.panel_dimensions.top,10))+"px";
+}
+var _a9=this._panels.bottom;
+if(_a9.on&&_a9.panels.length&&Xinha.hasDisplayedChildren(_a9.div)){
+this._htmlArea.style.height=(this._htmlArea.offsetHeight+parseInt(this.config.panel_dimensions.bottom,10))+"px";
+}
+}
+}
+_a2=this._htmlArea.offsetWidth;
+_a3=this._htmlArea.offsetHeight;
+var _aa=this._panels;
+var _ab=this;
+var _ac=1;
+function panel_is_alive(pan){
+if(_aa[pan].on&&_aa[pan].panels.length&&Xinha.hasDisplayedChildren(_aa[pan].container)){
+_aa[pan].container.style.display="";
+return true;
+}else{
+_aa[pan].container.style.display="none";
+return false;
+}
+}
+if(panel_is_alive("left")){
+_ac+=1;
+}
+if(panel_is_alive("right")){
+_ac+=1;
+}
+this._framework.tb_cell.colSpan=_ac;
+this._framework.tp_cell.colSpan=_ac;
+this._framework.bp_cell.colSpan=_ac;
+this._framework.sb_cell.colSpan=_ac;
+if(!this._framework.tp_row.childNodes.length){
+Xinha.removeFromParent(this._framework.tp_row);
+}else{
+if(!Xinha.hasParentNode(this._framework.tp_row)){
+this._framework.tbody.insertBefore(this._framework.tp_row,this._framework.ler_row);
+}
+}
+if(!this._framework.bp_row.childNodes.length){
+Xinha.removeFromParent(this._framework.bp_row);
+}else{
+if(!Xinha.hasParentNode(this._framework.bp_row)){
+this._framework.tbody.insertBefore(this._framework.bp_row,this._framework.ler_row.nextSibling);
+}
+}
+if(!this.config.statusBar){
+Xinha.removeFromParent(this._framework.sb_row);
+}else{
+if(!Xinha.hasParentNode(this._framework.sb_row)){
+this._framework.table.appendChild(this._framework.sb_row);
+}
+}
+this._framework.lp_cell.style.width=this.config.panel_dimensions.left;
+this._framework.rp_cell.style.width=this.config.panel_dimensions.right;
+this._framework.tp_cell.style.height=this.config.panel_dimensions.top;
+this._framework.bp_cell.style.height=this.config.panel_dimensions.bottom;
+this._framework.tb_cell.style.height=this._toolBar.offsetHeight+"px";
+this._framework.sb_cell.style.height=this._statusBar.offsetHeight+"px";
+var _ae=_a3-this._toolBar.offsetHeight-this._statusBar.offsetHeight;
+if(panel_is_alive("top")){
+_ae-=parseInt(this.config.panel_dimensions.top,10);
+}
+if(panel_is_alive("bottom")){
+_ae-=parseInt(this.config.panel_dimensions.bottom,10);
+}
+this._iframe.style.height=_ae+"px";
+var _af=_a2;
+if(panel_is_alive("left")){
+_af-=parseInt(this.config.panel_dimensions.left,10);
+}
+if(panel_is_alive("right")){
+_af-=parseInt(this.config.panel_dimensions.right,10);
+}
+var _b0=(this.config.iframeWidth)?parseInt(this.config.iframeWidth,10):null;
+this._iframe.style.width=(_b0&&_b0<_af)?_b0+"px":_af+"px";
+this._textArea.style.height=this._iframe.style.height;
+this._textArea.style.width=this._iframe.style.width;
+this.notifyOf("resize",{width:this._htmlArea.offsetWidth,height:this._htmlArea.offsetHeight});
+this.firePluginEvent("onResize",this._htmlArea.offsetWidth,this._htmlArea.offsetWidth);
+this._risizing=false;
+};
+Xinha.prototype.registerPanel=function(_b1,_b2){
+if(!_b1){
+_b1="right";
+}
+this.setLoadingMessage("Register "+_b1+" panel ");
+var _b3=this.addPanel(_b1);
+if(_b2){
+_b2.drawPanelIn(_b3);
+}
+};
+Xinha.prototype.addPanel=function(_b4){
+var div=document.createElement("div");
+div.side=_b4;
+if(_b4=="left"||_b4=="right"){
+div.style.width=this.config.panel_dimensions[_b4];
+if(this._iframe){
+div.style.height=this._iframe.style.height;
+}
+}
+Xinha.addClasses(div,"panel");
+this._panels[_b4].panels.push(div);
+this._panels[_b4].div.appendChild(div);
+this.notifyOf("panel_change",{"action":"add","panel":div});
+this.firePluginEvent("onPanelChange","add",div);
+return div;
+};
+Xinha.prototype.removePanel=function(_b6){
+this._panels[_b6.side].div.removeChild(_b6);
+var _b7=[];
+for(var i=0;i<this._panels[_b6.side].panels.length;i++){
+if(this._panels[_b6.side].panels[i]!=_b6){
+_b7.push(this._panels[_b6.side].panels[i]);
+}
+}
+this._panels[_b6.side].panels=_b7;
+this.notifyOf("panel_change",{"action":"remove","panel":_b6});
+this.firePluginEvent("onPanelChange","remove",_b6);
+};
+Xinha.prototype.hidePanel=function(_b9){
+if(_b9&&_b9.style.display!="none"){
+try{
+var pos=this.scrollPos(this._iframe.contentWindow);
+}
+catch(e){
+}
+_b9.style.display="none";
+this.notifyOf("panel_change",{"action":"hide","panel":_b9});
+this.firePluginEvent("onPanelChange","hide",_b9);
+try{
+this._iframe.contentWindow.scrollTo(pos.x,pos.y);
+}
+catch(e){
+}
+}
+};
+Xinha.prototype.showPanel=function(_bb){
+if(_bb&&_bb.style.display=="none"){
+try{
+var pos=this.scrollPos(this._iframe.contentWindow);
+}
+catch(e){
+}
+_bb.style.display="";
+this.notifyOf("panel_change",{"action":"show","panel":_bb});
+this.firePluginEvent("onPanelChange","show",_bb);
+try{
+this._iframe.contentWindow.scrollTo(pos.x,pos.y);
+}
+catch(e){
+}
+}
+};
+Xinha.prototype.hidePanels=function(_bd){
+if(typeof _bd=="undefined"){
+_bd=["left","right","top","bottom"];
+}
+var _be=[];
+for(var i=0;i<_bd.length;i++){
+if(this._panels[_bd[i]].on){
+_be.push(_bd[i]);
+this._panels[_bd[i]].on=false;
+}
+}
+this.notifyOf("panel_change",{"action":"multi_hide","sides":_bd});
+this.firePluginEvent("onPanelChange","multi_hide",_bd);
+};
+Xinha.prototype.showPanels=function(_c0){
+if(typeof _c0=="undefined"){
+_c0=["left","right","top","bottom"];
+}
+var _c1=[];
+for(var i=0;i<_c0.length;i++){
+if(!this._panels[_c0[i]].on){
+_c1.push(_c0[i]);
+this._panels[_c0[i]].on=true;
+}
+}
+this.notifyOf("panel_change",{"action":"multi_show","sides":_c0});
+this.firePluginEvent("onPanelChange","multi_show",_c0);
+};
+Xinha.objectProperties=function(obj){
+var _c4=[];
+for(var x in obj){
+_c4[_c4.length]=x;
+}
+return _c4;
+};
+Xinha.prototype.editorIsActivated=function(){
+try{
+return Xinha.is_designMode?this._doc.designMode=="on":this._doc.body.contentEditable;
+}
+catch(ex){
+return false;
+}
+};
+Xinha._someEditorHasBeenActivated=false;
+Xinha._currentlyActiveEditor=null;
+Xinha.prototype.activateEditor=function(){
+if(Xinha._currentlyActiveEditor){
+if(Xinha._currentlyActiveEditor==this){
+return true;
+}
+Xinha._currentlyActiveEditor.deactivateEditor();
+}
+if(Xinha.is_designMode&&this._doc.designMode!="on"){
+try{
+if(this._iframe.style.display=="none"){
+this._iframe.style.display="";
+this._doc.designMode="on";
+this._iframe.style.display="none";
+}else{
+this._doc.designMode="on";
+}
+}
+catch(ex){
+}
+}else{
+if(Xinha.is_ie&&this._doc.body.contentEditable!==true){
+this._doc.body.contentEditable=true;
+}
+}
+Xinha._someEditorHasBeenActivated=true;
+Xinha._currentlyActiveEditor=this;
+var _c6=this;
+this.enableToolbar();
+};
+Xinha.prototype.deactivateEditor=function(){
+this.disableToolbar();
+if(Xinha.is_designMode&&this._doc.designMode!="off"){
+try{
+this._doc.designMode="off";
+}
+catch(ex){
+}
+}else{
+if(!Xinha.is_designMode&&this._doc.body.contentEditable!==false){
+this._doc.body.contentEditable=false;
+}
+}
+if(Xinha._currentlyActiveEditor!=this){
+return;
+}
+Xinha._currentlyActiveEditor=false;
+};
+Xinha.prototype.initIframe=function(){
+this.disableToolbar();
+var doc=null;
+var _c8=this;
+try{
+if(_c8._iframe.contentDocument){
+this._doc=_c8._iframe.contentDocument;
+}else{
+this._doc=_c8._iframe.contentWindow.document;
+}
+doc=this._doc;
+if(!doc){
+if(Xinha.is_gecko){
+setTimeout(function(){
+_c8.initIframe();
+},50);
+return false;
+}else{
+alert("ERROR: IFRAME can't be initialized.");
+}
+}
+}
+catch(ex){
+setTimeout(function(){
+_c8.initIframe();
+},50);
+}
+Xinha.freeLater(this,"_doc");
+doc.open("text/html","replace");
+var _c9="";
+if(_c8.config.browserQuirksMode===false){
+var _ca="<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">";
+}else{
+if(_c8.config.browserQuirksMode===true){
+var _ca="";
+}else{
+var _ca=Xinha.getDoctype(document);
+}
+}
+if(!_c8.config.fullPage){
+_c9+=_ca+"\n";
+_c9+="<html>\n";
+_c9+="<head>\n";
+_c9+="<meta http-equiv=\"Content-Type\" content=\"text/html; charset="+_c8.config.charSet+"\">\n";
+if(typeof _c8.config.baseHref!="undefined"&&_c8.config.baseHref!==null){
+_c9+="<base href=\""+_c8.config.baseHref+"\"/>\n";
+}
+_c9+=Xinha.addCoreCSS();
+if(typeof _c8.config.pageStyleSheets!=="undefined"){
+for(var i=0;i<_c8.config.pageStyleSheets.length;i++){
+if(_c8.config.pageStyleSheets[i].length>0){
+_c9+="<link rel=\"stylesheet\" type=\"text/css\" href=\""+_c8.config.pageStyleSheets[i]+"\">";
+}
+}
+}
+if(_c8.config.pageStyle){
+_c9+="<style type=\"text/css\">\n"+_c8.config.pageStyle+"\n</style>";
+}
+_c9+="</head>\n";
+_c9+="<body"+(_c8.config.bodyID?(" id=\""+_c8.config.bodyID+"\""):"")+">\n";
+_c9+=_c8.inwardHtml(_c8._textArea.value);
+_c9+="</body>\n";
+_c9+="</html>";
+}else{
+_c9=_c8.inwardHtml(_c8._textArea.value);
+if(_c9.match(Xinha.RE_doctype)){
+_c8.setDoctype(RegExp.$1);
+}
+var _cc=_c9.match(/<link\s+[\s\S]*?["']\s*\/?>/gi);
+_c9=_c9.replace(/<link\s+[\s\S]*?["']\s*\/?>\s*/gi,"");
+_cc?_c9=_c9.replace(/<\/head>/i,_cc.join("\n")+"\n</head>"):null;
+}
+doc.write(_c9);
+doc.close();
+if(this.config.fullScreen){
+this._fullScreen();
+}
+this.setEditorEvents();
+};
+Xinha.prototype.whenDocReady=function(f){
+var e=this;
+if(this._doc&&this._doc.body){
+f();
+}else{
+setTimeout(function(){
+e.whenDocReady(f);
+},50);
+}
+};
+Xinha.prototype.setMode=function(_cf){
+var _d0;
+if(typeof _cf=="undefined"){
+_cf=this._editMode=="textmode"?"wysiwyg":"textmode";
+}
+switch(_cf){
+case "textmode":
+this.firePluginEvent("onBeforeMode","textmode");
+this.setCC("iframe");
+_d0=this.outwardHtml(this.getHTML());
+this.setHTML(_d0);
+this.deactivateEditor();
+this._iframe.style.display="none";
+this._textArea.style.display="";
+if(this.config.statusBar){
+this._statusBarTree.style.display="none";
+this._statusBarTextMode.style.display="";
+}
+this.findCC("textarea");
+this.notifyOf("modechange",{"mode":"text"});
+this.firePluginEvent("onMode","textmode");
+break;
+case "wysiwyg":
+this.firePluginEvent("onBeforeMode","wysiwyg");
+this.setCC("textarea");
+_d0=this.inwardHtml(this.getHTML());
+this.deactivateEditor();
+this.setHTML(_d0);
+this._iframe.style.display="";
+this._textArea.style.display="none";
+this.activateEditor();
+if(this.config.statusBar){
+this._statusBarTree.style.display="";
+this._statusBarTextMode.style.display="none";
+}
+this.findCC("iframe");
+this.notifyOf("modechange",{"mode":"wysiwyg"});
+this.firePluginEvent("onMode","wysiwyg");
+break;
+default:
+alert("Mode <"+_cf+"> not defined!");
+return false;
+}
+this._editMode=_cf;
+};
+Xinha.prototype.setFullHTML=function(_d1){
+var _d2=RegExp.multiline;
+RegExp.multiline=true;
+if(_d1.match(Xinha.RE_doctype)){
+this.setDoctype(RegExp.$1);
+}
+RegExp.multiline=_d2;
+if(0){
+if(_d1.match(Xinha.RE_head)){
+this._doc.getElementsByTagName("head")[0].innerHTML=RegExp.$1;
+}
+if(_d1.match(Xinha.RE_body)){
+this._doc.getElementsByTagName("body")[0].innerHTML=RegExp.$1;
+}
+}else{
+var _d3=this.editorIsActivated();
+if(_d3){
+this.deactivateEditor();
+}
+var _d4=/<html>((.|\n)*?)<\/html>/i;
+_d1=_d1.replace(_d4,"$1");
+this._doc.open("text/html","replace");
+this._doc.write(_d1);
+this._doc.close();
+if(_d3){
+this.activateEditor();
+}
+this.setEditorEvents();
+return true;
+}
+};
+Xinha.prototype.setEditorEvents=function(){
+var _d5=this;
+var doc=this._doc;
+_d5.whenDocReady(function(){
+Xinha._addEvents(doc,["mousedown"],function(){
+_d5.activateEditor();
+return true;
+});
+if(Xinha.is_ie){
+Xinha._addEvent(_d5._doc.getElementsByTagName("html")[0],"click",function(){
+if(_d5._iframe.contentWindow.event.srcElement.tagName.toLowerCase()=="html"){
+var r=_d5._doc.body.createTextRange();
+r.collapse();
+r.select();
+}
+return true;
+});
+}
+Xinha._addEvents(doc,["keydown","keypress","mousedown","mouseup","drag"],function(_d8){
+return _d5._editorEvent(Xinha.is_ie?_d5._iframe.contentWindow.event:_d8);
+});
+for(var i in _d5.plugins){
+var _da=_d5.plugins[i].instance;
+Xinha.refreshPlugin(_da);
+}
+if(typeof _d5._onGenerate=="function"){
+_d5._onGenerate();
+}
+Xinha.addDom0Event(window,"resize",function(e){
+_d5.sizeEditor();
+});
+_d5.removeLoadingMessage();
+});
+};
+Xinha.prototype.registerPlugin=function(){
+if(!Xinha.isSupportedBrowser){
+return;
+}
+var _dc=arguments[0];
+if(_dc===null||typeof _dc=="undefined"||(typeof _dc=="string"&&typeof window[_dc]=="undefined")){
+return false;
+}
+var _dd=[];
+for(var i=1;i<arguments.length;++i){
+_dd.push(arguments[i]);
+}
+return this.registerPlugin2(_dc,_dd);
+};
+Xinha.prototype.registerPlugin2=function(_df,_e0){
+if(typeof _df=="string"&&typeof window[_df]=="function"){
+_df=window[_df];
+}
+if(typeof _df=="undefined"){
+return false;
+}
+var obj=new _df(this,_e0);
+if(obj){
+var _e2={};
+var _e3=_df._pluginInfo;
+for(var i in _e3){
+_e2[i]=_e3[i];
+}
+_e2.instance=obj;
+_e2.args=_e0;
+this.plugins[_df._pluginInfo.name]=_e2;
+return obj;
+}else{
+alert("Can't register plugin "+_df.toString()+".");
+}
+};
+Xinha.getPluginDir=function(_e5){
+if(Xinha.externalPlugins[_e5]){
+return Xinha.externalPlugins[_e5][0];
+}else{
+return _editor_url+"plugins/"+_e5;
+}
+};
+Xinha.loadPlugin=function(_e6,_e7,_e8){
+if(!Xinha.isSupportedBrowser){
+return;
+}
+Xinha.setLoadingMessage(Xinha._lc("Loading plugin $plugin="+_e6+"$"));
+if(typeof window["pluginName"]!="undefined"){
+if(_e7){
+_e7(_e6);
+}
+return true;
+}
+if(!_e8){
+var dir=this.getPluginDir(_e6);
+var _ea=_e6.replace(/([a-z])([A-Z])([a-z])/g,function(str,l1,l2,l3){
+return l1+"-"+l2.toLowerCase()+l3;
+}).toLowerCase()+".js";
+_e8=dir+"/"+_ea;
+}
+Xinha._loadback(_e8,_e7?function(){
+_e7(_e6);
+}:null);
+return false;
+};
+Xinha._pluginLoadStatus={};
+Xinha.externalPlugins={};
+Xinha.loadPlugins=function(_ef,_f0,url){
+if(!Xinha.isSupportedBrowser){
+return;
+}
+Xinha.setLoadingMessage(Xinha._lc("Loading plugins"));
+var m;
+for(var i=0;i<_ef.length;i++){
+if(typeof _ef[i]=="object"){
+m=_ef[i].url.match(/(.*)(\/[^\/]*)$/);
+Xinha.externalPlugins[_ef[i].plugin]=[m[1],m[2]];
+_ef[i]=_ef[i].plugin;
+}
+}
+var _f4=true;
+var _f5=Xinha.cloneObject(_ef);
+while(_f5.length){
+var p=_f5.pop();
+if(p=="FullScreen"&&!Xinha.externalPlugins["FullScreen"]){
+continue;
+}
+if(typeof Xinha._pluginLoadStatus[p]=="undefined"){
+Xinha._pluginLoadStatus[p]="loading";
+Xinha.loadPlugin(p,function(_f7){
+if(typeof window[_f7]!="undefined"){
+Xinha._pluginLoadStatus[_f7]="ready";
+}else{
+Xinha._pluginLoadStatus[_f7]="failed";
+}
+},(Xinha.externalPlugins[p]?Xinha.externalPlugins[p][0]+Xinha.externalPlugins[p][1]:url));
+_f4=false;
+}else{
+switch(Xinha._pluginLoadStatus[p]){
+case "failed":
+case "ready":
+break;
+default:
+_f4=false;
+break;
+}
+}
+}
+if(_f4){
+return true;
+}
+if(_f0){
+setTimeout(function(){
+if(Xinha.loadPlugins(_ef,_f0)){
+_f0();
+}
+},150);
+}
+return _f4;
+};
+Xinha.refreshPlugin=function(_f8){
+if(_f8&&typeof _f8.onGenerate=="function"){
+_f8.onGenerate();
+}
+if(_f8&&typeof _f8.onGenerateOnce=="function"){
+_f8.onGenerateOnce();
+_f8.onGenerateOnce=null;
+}
+};
+Xinha.prototype.firePluginEvent=function(_f9){
+var _fa=[];
+for(var i=1;i<arguments.length;i++){
+_fa[i-1]=arguments[i];
+}
+for(var i in this.plugins){
+var _fc=this.plugins[i].instance;
+if(_fc==this._browserSpecificPlugin){
+continue;
+}
+if(_fc&&typeof _fc[_f9]=="function"){
+if(_fc[_f9].apply(_fc,_fa)){
+return true;
+}
+}
+}
+var _fc=this._browserSpecificPlugin;
+if(_fc&&typeof _fc[_f9]=="function"){
+if(_fc[_f9].apply(_fc,_fa)){
+return true;
+}
+}
+return false;
+};
+Xinha.loadStyle=function(_fd,_fe,id,_100){
+var url=_editor_url||"";
+if(_fe){
+url=Xinha.getPluginDir(_fe)+"/";
+}
+url+=_fd;
+if(/^\//.test(_fd)){
+url=_fd;
+}
+var head=document.getElementsByTagName("head")[0];
+var link=document.createElement("link");
+link.rel="stylesheet";
+link.href=url;
+link.type="text/css";
+if(id){
+link.id=id;
+}
+if(_100&&head.getElementsByTagName("link")[0]){
+head.insertBefore(link,head.getElementsByTagName("link")[0]);
+}else{
+head.appendChild(link);
+}
+};
+Xinha.prototype.debugTree=function(){
+var ta=document.createElement("textarea");
+ta.style.width="100%";
+ta.style.height="20em";
+ta.value="";
+function debug(_105,str){
+for(;--_105>=0;){
+ta.value+=" ";
+}
+ta.value+=str+"\n";
+}
+function _dt(root,_108){
+var tag=root.tagName.toLowerCase(),i;
+var ns=Xinha.is_ie?root.scopeName:root.prefix;
+debug(_108,"- "+tag+" ["+ns+"]");
+for(i=root.firstChild;i;i=i.nextSibling){
+if(i.nodeType==1){
+_dt(i,_108+2);
+}
+}
+}
+_dt(this._doc.body,0);
+document.body.appendChild(ta);
+};
+Xinha.getInnerText=function(el){
+var txt="",i;
+for(i=el.firstChild;i;i=i.nextSibling){
+if(i.nodeType==3){
+txt+=i.data;
+}else{
+if(i.nodeType==1){
+txt+=Xinha.getInnerText(i);
+}
+}
+}
+return txt;
+};
+Xinha.prototype._wordClean=function(){
+var _10d=this;
+var _10e={empty_tags:0,mso_class:0,mso_style:0,mso_xmlel:0,orig_len:this._doc.body.innerHTML.length,T:(new Date()).getTime()};
+var _10f={empty_tags:"Empty tags removed: ",mso_class:"MSO class names removed: ",mso_style:"MSO inline style removed: ",mso_xmlel:"MSO XML elements stripped: "};
+function showStats(){
+var txt="Xinha word cleaner stats: \n\n";
+for(var i in _10e){
+if(_10f[i]){
+txt+=_10f[i]+_10e[i]+"\n";
+}
+}
+txt+="\nInitial document length: "+_10e.orig_len+"\n";
+txt+="Final document length: "+_10d._doc.body.innerHTML.length+"\n";
+txt+="Clean-up took "+(((new Date()).getTime()-_10e.T)/1000)+" seconds";
+alert(txt);
+}
+function clearClass(node){
+var newc=node.className.replace(/(^|\s)mso.*?(\s|$)/ig," ");
+if(newc!=node.className){
+node.className=newc;
+if(!(/\S/.test(node.className))){
+node.removeAttribute("className");
+++_10e.mso_class;
+}
+}
+}
+function clearStyle(node){
+var _115=node.style.cssText.split(/\s*;\s*/);
+for(var i=_115.length;--i>=0;){
+if((/^mso|^tab-stops/i.test(_115[i]))||(/^margin\s*:\s*0..\s+0..\s+0../i.test(_115[i]))){
+++_10e.mso_style;
+_115.splice(i,1);
+}
+}
+node.style.cssText=_115.join("; ");
+}
+var _117=null;
+if(Xinha.is_ie){
+_117=function(el){
+el.outerHTML=Xinha.htmlEncode(el.innerText);
+++_10e.mso_xmlel;
+};
+}else{
+_117=function(el){
+var txt=document.createTextNode(Xinha.getInnerText(el));
+el.parentNode.insertBefore(txt,el);
+Xinha.removeFromParent(el);
+++_10e.mso_xmlel;
+};
+}
+function checkEmpty(el){
+if(/^(span|b|strong|i|em|font|div|p)$/i.test(el.tagName)&&!el.firstChild){
+Xinha.removeFromParent(el);
+++_10e.empty_tags;
+}
+}
+function parseTree(root){
+var tag=root.tagName.toLowerCase(),i,next;
+if((Xinha.is_ie&&root.scopeName!="HTML")||(!Xinha.is_ie&&(/:/.test(tag)))){
+_117(root);
+return false;
+}else{
+clearClass(root);
+clearStyle(root);
+for(i=root.firstChild;i;i=next){
+next=i.nextSibling;
+if(i.nodeType==1&&parseTree(i)){
+checkEmpty(i);
+}
+}
+}
+return true;
+}
+parseTree(this._doc.body);
+this.updateToolbar();
+};
+Xinha.prototype._clearFonts=function(){
+var D=this.getInnerHTML();
+if(confirm(Xinha._lc("Would you like to clear font typefaces?"))){
+D=D.replace(/face="[^"]*"/gi,"");
+D=D.replace(/font-family:[^;}"']+;?/gi,"");
+}
+if(confirm(Xinha._lc("Would you like to clear font sizes?"))){
+D=D.replace(/size="[^"]*"/gi,"");
+D=D.replace(/font-size:[^;}"']+;?/gi,"");
+}
+if(confirm(Xinha._lc("Would you like to clear font colours?"))){
+D=D.replace(/color="[^"]*"/gi,"");
+D=D.replace(/([^-])color:[^;}"']+;?/gi,"$1");
+}
+D=D.replace(/(style|class)="\s*"/gi,"");
+D=D.replace(/<(font|span)\s*>/gi,"");
+this.setHTML(D);
+this.updateToolbar();
+};
+Xinha.prototype._splitBlock=function(){
+this._doc.execCommand("formatblock",false,"div");
+};
+Xinha.prototype.forceRedraw=function(){
+this._doc.body.style.visibility="hidden";
+this._doc.body.style.visibility="";
+};
+Xinha.prototype.focusEditor=function(){
+switch(this._editMode){
+case "wysiwyg":
+try{
+if(Xinha._someEditorHasBeenActivated){
+this.activateEditor();
+this._iframe.contentWindow.focus();
+}
+}
+catch(ex){
+}
+break;
+case "textmode":
+try{
+this._textArea.focus();
+}
+catch(e){
+}
+break;
+default:
+alert("ERROR: mode "+this._editMode+" is not defined");
+}
+return this._doc;
+};
+Xinha.prototype._undoTakeSnapshot=function(){
+++this._undoPos;
+if(this._undoPos>=this.config.undoSteps){
+this._undoQueue.shift();
+--this._undoPos;
+}
+var take=true;
+var txt=this.getInnerHTML();
+if(this._undoPos>0){
+take=(this._undoQueue[this._undoPos-1]!=txt);
+}
+if(take){
+this._undoQueue[this._undoPos]=txt;
+}else{
+this._undoPos--;
+}
+};
+Xinha.prototype.undo=function(){
+if(this._undoPos>0){
+var txt=this._undoQueue[--this._undoPos];
+if(txt){
+this.setHTML(txt);
+}else{
+++this._undoPos;
+}
+}
+};
+Xinha.prototype.redo=function(){
+if(this._undoPos<this._undoQueue.length-1){
+var txt=this._undoQueue[++this._undoPos];
+if(txt){
+this.setHTML(txt);
+}else{
+--this._undoPos;
+}
+}
+};
+Xinha.prototype.disableToolbar=function(_123){
+if(this._timerToolbar){
+clearTimeout(this._timerToolbar);
+}
+if(typeof _123=="undefined"){
+_123=[];
+}else{
+if(typeof _123!="object"){
+_123=[_123];
+}
+}
+for(var i in this._toolbarObjects){
+var btn=this._toolbarObjects[i];
+if(_123.contains(i)){
+continue;
+}
+if(typeof (btn.state)!="function"){
+continue;
+}
+btn.state("enabled",false);
+}
+};
+Xinha.prototype.enableToolbar=function(){
+this.updateToolbar();
+};
+Xinha.prototype.updateToolbar=function(_126){
+var doc=this._doc;
+var text=(this._editMode=="textmode");
+var _129=null;
+if(!text){
+_129=this.getAllAncestors();
+if(this.config.statusBar&&!_126){
+while(this._statusBarItems.length){
+var item=this._statusBarItems.pop();
+item.el=null;
+item.editor=null;
+item.onclick=null;
+item.oncontextmenu=null;
+item._xinha_dom0Events["click"]=null;
+item._xinha_dom0Events["contextmenu"]=null;
+item=null;
+}
+this._statusBarTree.innerHTML=Xinha._lc("Path")+": ";
+for(var i=_129.length;--i>=0;){
+var el=_129[i];
+if(!el){
+continue;
+}
+var a=document.createElement("a");
+a.href="javascript:void(0)";
+a.el=el;
+a.editor=this;
+this._statusBarItems.push(a);
+Xinha.addDom0Event(a,"click",function(){
+this.blur();
+this.editor.selectNodeContents(this.el);
+this.editor.updateToolbar(true);
+return false;
+});
+Xinha.addDom0Event(a,"contextmenu",function(){
+this.blur();
+var info="Inline style:\n\n";
+info+=this.el.style.cssText.split(/;\s*/).join(";\n");
+alert(info);
+return false;
+});
+var txt=el.tagName.toLowerCase();
+if(typeof el.style!="undefined"){
+a.title=el.style.cssText;
+}
+if(el.id){
+txt+="#"+el.id;
+}
+if(el.className){
+txt+="."+el.className;
+}
+a.appendChild(document.createTextNode(txt));
+this._statusBarTree.appendChild(a);
+if(i!==0){
+this._statusBarTree.appendChild(document.createTextNode(String.fromCharCode(187)));
+}
+Xinha.freeLater(a);
+}
+}
+}
+for(var cmd in this._toolbarObjects){
+var btn=this._toolbarObjects[cmd];
+var _132=true;
+if(typeof (btn.state)!="function"){
+continue;
+}
+if(btn.context&&!text){
+_132=false;
+var _133=btn.context;
+var _134=[];
+if(/(.*)\[(.*?)\]/.test(_133)){
+_133=RegExp.$1;
+_134=RegExp.$2.split(",");
+}
+_133=_133.toLowerCase();
+var _135=(_133=="*");
+for(var k=0;k<_129.length;++k){
+if(!_129[k]){
+continue;
+}
+if(_135||(_129[k].tagName.toLowerCase()==_133)){
+_132=true;
+var _137=null;
+var att=null;
+var comp=null;
+var _13a=null;
+for(var ka=0;ka<_134.length;++ka){
+_137=_134[ka].match(/(.*)(==|!=|===|!==|>|>=|<|<=)(.*)/);
+att=_137[1];
+comp=_137[2];
+_13a=_137[3];
+if(!eval(_129[k][att]+comp+_13a)){
+_132=false;
+break;
+}
+}
+if(_132){
+break;
+}
+}
+}
+}
+btn.state("enabled",(!text||btn.text)&&_132);
+if(typeof cmd=="function"){
+continue;
+}
+var _13c=this.config.customSelects[cmd];
+if((!text||btn.text)&&(typeof _13c!="undefined")){
+_13c.refresh(this);
+continue;
+}
+switch(cmd){
+case "fontname":
+case "fontsize":
+if(!text){
+try{
+var _13d=(""+doc.queryCommandValue(cmd)).toLowerCase();
+if(!_13d){
+btn.element.selectedIndex=0;
+break;
+}
+var _13e=this.config[cmd];
+var _13f=0;
+for(var j in _13e){
+if((j.toLowerCase()==_13d)||(_13e[j].substr(0,_13d.length).toLowerCase()==_13d)){
+btn.element.selectedIndex=_13f;
+throw "ok";
+}
+++_13f;
+}
+btn.element.selectedIndex=0;
+}
+catch(ex){
+}
+}
+break;
+case "formatblock":
+var _141=[];
+for(var _142 in this.config.formatblock){
+if(typeof this.config.formatblock[_142]=="string"){
+_141[_141.length]=this.config.formatblock[_142];
+}
+}
+var _143=this._getFirstAncestor(this.getSelection(),_141);
+if(_143){
+for(var x=0;x<_141.length;x++){
+if(_141[x].toLowerCase()==_143.tagName.toLowerCase()){
+btn.element.selectedIndex=x;
+}
+}
+}else{
+btn.element.selectedIndex=0;
+}
+break;
+case "textindicator":
+if(!text){
+try{
+var _145=btn.element.style;
+_145.backgroundColor=Xinha._makeColor(doc.queryCommandValue(Xinha.is_ie?"backcolor":"hilitecolor"));
+if(/transparent/i.test(_145.backgroundColor)){
+_145.backgroundColor=Xinha._makeColor(doc.queryCommandValue("backcolor"));
+}
+_145.color=Xinha._makeColor(doc.queryCommandValue("forecolor"));
+_145.fontFamily=doc.queryCommandValue("fontname");
+_145.fontWeight=doc.queryCommandState("bold")?"bold":"normal";
+_145.fontStyle=doc.queryCommandState("italic")?"italic":"normal";
+}
+catch(ex){
+}
+}
+break;
+case "htmlmode":
+btn.state("active",text);
+break;
+case "lefttoright":
+case "righttoleft":
+var _146=this.getParentElement();
+while(_146&&!Xinha.isBlockElement(_146)){
+_146=_146.parentNode;
+}
+if(_146){
+btn.state("active",(_146.style.direction==((cmd=="righttoleft")?"rtl":"ltr")));
+}
+break;
+default:
+cmd=cmd.replace(/(un)?orderedlist/i,"insert$1orderedlist");
+try{
+btn.state("active",(!text&&doc.queryCommandState(cmd)));
+}
+catch(ex){
+}
+break;
+}
+}
+if(this._customUndo&&!this._timerUndo){
+this._undoTakeSnapshot();
+var _147=this;
+this._timerUndo=setTimeout(function(){
+_147._timerUndo=null;
+},this.config.undoTimeout);
+}
+this.firePluginEvent("onUpdateToolbar");
+};
+Xinha.getEditor=function(ref){
+for(var i=__xinhas.length;i--;){
+var _14a=__xinhas[i];
+if(_14a&&(_14a._textArea.id==ref||_14a._textArea.name==ref||_14a._textArea==ref)){
+return _14a;
+}
+}
+return null;
+};
+Xinha.prototype.getPluginInstance=function(_14b){
+if(this.plugins[_14b]){
+return this.plugins[_14b].instance;
+}else{
+return null;
+}
+};
+Xinha.prototype.getAllAncestors=function(){
+var p=this.getParentElement();
+var a=[];
+while(p&&(p.nodeType==1)&&(p.tagName.toLowerCase()!="body")){
+a.push(p);
+p=p.parentNode;
+}
+a.push(this._doc.body);
+return a;
+};
+Xinha.prototype._getFirstAncestor=function(sel,_14f){
+var prnt=this.activeElement(sel);
+if(prnt===null){
+try{
+prnt=(Xinha.is_ie?this.createRange(sel).parentElement():this.createRange(sel).commonAncestorContainer);
+}
+catch(ex){
+return null;
+}
+}
+if(typeof _14f=="string"){
+_14f=[_14f];
+}
+while(prnt){
+if(prnt.nodeType==1){
+if(_14f===null){
+return prnt;
+}
+if(_14f.contains(prnt.tagName.toLowerCase())){
+return prnt;
+}
+if(prnt.tagName.toLowerCase()=="body"){
+break;
+}
+if(prnt.tagName.toLowerCase()=="table"){
+break;
+}
+}
+prnt=prnt.parentNode;
+}
+return null;
+};
+Xinha.prototype._getAncestorBlock=function(sel){
+var prnt=(Xinha.is_ie?this.createRange(sel).parentElement:this.createRange(sel).commonAncestorContainer);
+while(prnt&&(prnt.nodeType==1)){
+switch(prnt.tagName.toLowerCase()){
+case "div":
+case "p":
+case "address":
+case "blockquote":
+case "center":
+case "del":
+case "ins":
+case "pre":
+case "h1":
+case "h2":
+case "h3":
+case "h4":
+case "h5":
+case "h6":
+case "h7":
+return prnt;
+case "body":
+case "noframes":
+case "dd":
+case "li":
+case "th":
+case "td":
+case "noscript":
+return null;
+default:
+break;
+}
+}
+return null;
+};
+Xinha.prototype._createImplicitBlock=function(type){
+var sel=this.getSelection();
+if(Xinha.is_ie){
+sel.empty();
+}else{
+sel.collapseToStart();
+}
+var rng=this.createRange(sel);
+};
+Xinha.prototype.surroundHTML=function(_156,_157){
+var html=this.getSelectedHTML();
+this.insertHTML(_156+html+_157);
+};
+Xinha.prototype.hasSelectedText=function(){
+return this.getSelectedHTML()!=="";
+};
+Xinha.prototype._comboSelected=function(el,txt){
+this.focusEditor();
+var _15b=el.options[el.selectedIndex].value;
+switch(txt){
+case "fontname":
+case "fontsize":
+this.execCommand(txt,false,_15b);
+break;
+case "formatblock":
+if(!_15b){
+this.updateToolbar();
+break;
+}
+if(!Xinha.is_gecko||_15b!=="blockquote"){
+_15b="<"+_15b+">";
+}
+this.execCommand(txt,false,_15b);
+break;
+default:
+var _15c=this.config.customSelects[txt];
+if(typeof _15c!="undefined"){
+_15c.action(this);
+}else{
+alert("FIXME: combo box "+txt+" not implemented");
+}
+break;
+}
+};
+Xinha.prototype._colorSelector=function(_15d){
+var _15e=this;
+if(Xinha.is_gecko){
+try{
+_15e._doc.execCommand("useCSS",false,false);
+_15e._doc.execCommand("styleWithCSS",false,true);
+}
+catch(ex){
+}
+}
+var btn=_15e._toolbarObjects[_15d].element;
+var _160;
+if(_15d=="hilitecolor"){
+if(Xinha.is_ie){
+_15d="backcolor";
+_160=Xinha._colorToRgb(_15e._doc.queryCommandValue("backcolor"));
+}else{
+_160=Xinha._colorToRgb(_15e._doc.queryCommandValue("hilitecolor"));
+}
+}else{
+_160=Xinha._colorToRgb(_15e._doc.queryCommandValue("forecolor"));
+}
+var _161=function(_162){
+_15e._doc.execCommand(_15d,false,_162);
+};
+if(Xinha.is_ie){
+var _163=_15e.createRange(_15e.getSelection());
+_161=function(_164){
+_163.select();
+_15e._doc.execCommand(_15d,false,_164);
+};
+}
+var _165=new Xinha.colorPicker({cellsize:_15e.config.colorPickerCellSize,callback:_161,granularity:_15e.config.colorPickerGranularity,websafe:_15e.config.colorPickerWebSafe,savecolors:_15e.config.colorPickerSaveColors});
+_165.open(_15e.config.colorPickerPosition,btn,_160);
+};
+Xinha.prototype.execCommand=function(_166,UI,_168){
+var _169=this;
+this.focusEditor();
+_166=_166.toLowerCase();
+if(this.firePluginEvent("onExecCommand",_166,UI,_168)){
+this.updateToolbar();
+return false;
+}
+switch(_166){
+case "htmlmode":
+this.setMode();
+break;
+case "hilitecolor":
+case "forecolor":
+this._colorSelector(_166);
+break;
+case "createlink":
+this._createLink();
+break;
+case "undo":
+case "redo":
+if(this._customUndo){
+this[_166]();
+}else{
+this._doc.execCommand(_166,UI,_168);
+}
+break;
+case "inserttable":
+this._insertTable();
+break;
+case "insertimage":
+this._insertImage();
+break;
+case "about":
+this._popupDialog(_169.config.URIs.about,null,this);
+break;
+case "showhelp":
+this._popupDialog(_169.config.URIs.help,null,this);
+break;
+case "killword":
+this._wordClean();
+break;
+case "cut":
+case "copy":
+case "paste":
+this._doc.execCommand(_166,UI,_168);
+if(this.config.killWordOnPaste){
+this._wordClean();
+}
+break;
+case "lefttoright":
+case "righttoleft":
+if(this.config.changeJustifyWithDirection){
+this._doc.execCommand((_166=="righttoleft")?"justifyright":"justifyleft",UI,_168);
+}
+var dir=(_166=="righttoleft")?"rtl":"ltr";
+var el=this.getParentElement();
+while(el&&!Xinha.isBlockElement(el)){
+el=el.parentNode;
+}
+if(el){
+if(el.style.direction==dir){
+el.style.direction="";
+}else{
+el.style.direction=dir;
+}
+}
+break;
+case "justifyleft":
+case "justifyright":
+_166.match(/^justify(.*)$/);
+var ae=this.activeElement(this.getSelection());
+if(ae&&ae.tagName.toLowerCase()=="img"){
+ae.align=ae.align==RegExp.$1?"":RegExp.$1;
+}else{
+this._doc.execCommand(_166,UI,_168);
+}
+break;
+default:
+try{
+this._doc.execCommand(_166,UI,_168);
+}
+catch(ex){
+if(this.config.debug){
+alert(ex+"\n\nby execCommand("+_166+");");
+}
+}
+break;
+}
+this.updateToolbar();
+return false;
+};
+Xinha.prototype._editorEvent=function(ev){
+var _16e=this;
+if(typeof _16e._textArea["on"+ev.type]=="function"){
+_16e._textArea["on"+ev.type]();
+}
+if(this.isKeyEvent(ev)){
+if(_16e.firePluginEvent("onKeyPress",ev)){
+return false;
+}
+if(this.isShortCut(ev)){
+this._shortCuts(ev);
+}
+}
+if(ev.type=="mousedown"){
+if(_16e.firePluginEvent("onMouseDown",ev)){
+return false;
+}
+}
+if(_16e._timerToolbar){
+clearTimeout(_16e._timerToolbar);
+}
+_16e._timerToolbar=setTimeout(function(){
+_16e.updateToolbar();
+_16e._timerToolbar=null;
+},250);
+};
+Xinha.prototype._shortCuts=function(ev){
+var key=this.getKey(ev).toLowerCase();
+var cmd=null;
+var _172=null;
+switch(key){
+case "b":
+cmd="bold";
+break;
+case "i":
+cmd="italic";
+break;
+case "u":
+cmd="underline";
+break;
+case "s":
+cmd="strikethrough";
+break;
+case "l":
+cmd="justifyleft";
+break;
+case "e":
+cmd="justifycenter";
+break;
+case "r":
+cmd="justifyright";
+break;
+case "j":
+cmd="justifyfull";
+break;
+case "z":
+cmd="undo";
+break;
+case "y":
+cmd="redo";
+break;
+case "v":
+cmd="paste";
+break;
+case "n":
+cmd="formatblock";
+_172="p";
+break;
+case "0":
+cmd="killword";
+break;
+case "1":
+case "2":
+case "3":
+case "4":
+case "5":
+case "6":
+cmd="formatblock";
+_172="h"+key;
+break;
+}
+if(cmd){
+this.execCommand(cmd,false,_172);
+Xinha._stopEvent(ev);
+}
+};
+Xinha.prototype.convertNode=function(el,_174){
+var _175=this._doc.createElement(_174);
+while(el.firstChild){
+_175.appendChild(el.firstChild);
+}
+return _175;
+};
+Xinha.prototype.scrollToElement=function(e){
+if(!e){
+e=this.getParentElement();
+if(!e){
+return;
+}
+}
+var _177=Xinha.getElementTopLeft(e);
+this._iframe.contentWindow.scrollTo(_177.left,_177.top);
+};
+Xinha.prototype.getEditorContent=function(){
+return this.outwardHtml(this.getHTML());
+};
+Xinha.prototype.setEditorContent=function(html){
+this.setHTML(this.inwardHtml(html));
+};
+Xinha.prototype.getHTML=function(){
+var html="";
+switch(this._editMode){
+case "wysiwyg":
+if(!this.config.fullPage){
+html=Xinha.getHTML(this._doc.body,false,this).trim();
+}else{
+html=this.doctype+"\n"+Xinha.getHTML(this._doc.documentElement,true,this);
+}
+break;
+case "textmode":
+html=this._textArea.value;
+break;
+default:
+alert("Mode <"+this._editMode+"> not defined!");
+return false;
+}
+return html;
+};
+Xinha.prototype.outwardHtml=function(html){
+for(var i in this.plugins){
+var _17c=this.plugins[i].instance;
+if(_17c&&typeof _17c.outwardHtml=="function"){
+html=_17c.outwardHtml(html);
+}
+}
+html=html.replace(/<(\/?)b(\s|>|\/)/ig,"<$1strong$2");
+html=html.replace(/<(\/?)i(\s|>|\/)/ig,"<$1em$2");
+html=html.replace(/<(\/?)strike(\s|>|\/)/ig,"<$1del$2");
+html=html.replace(/(<[^>]*on(click|mouse(over|out|up|down))=['"])if\(window\.parent &amp;&amp; window\.parent\.Xinha\)\{return false\}/gi,"$1");
+var _17d=location.href.replace(/(https?:\/\/[^\/]*)\/.*/,"$1")+"/";
+html=html.replace(/https?:\/\/null\//g,_17d);
+html=html.replace(/((href|src|background)=[\'\"])\/+/ig,"$1"+_17d);
+html=this.outwardSpecialReplacements(html);
+html=this.fixRelativeLinks(html);
+if(this.config.sevenBitClean){
+html=html.replace(/[^ -~\r\n\t]/g,function(c){
+return "&#"+c.charCodeAt(0)+";";
+});
+}
+html=html.replace(/(<script[^>]*((type=[\"\']text\/)|(language=[\"\'])))(freezescript)/gi,"$1javascript");
+if(this.config.fullPage){
+html=Xinha.stripCoreCSS(html);
+}
+if(typeof this.config.outwardHtml=="function"){
+html=this.config.outwardHtml(html);
+}
+return html;
+};
+Xinha.prototype.inwardHtml=function(html){
+for(var i in this.plugins){
+var _181=this.plugins[i].instance;
+if(_181&&typeof _181.inwardHtml=="function"){
+html=_181.inwardHtml(html);
+}
+}
+html=html.replace(/<(\/?)del(\s|>|\/)/ig,"<$1strike$2");
+html=html.replace(/(<[^>]*on(click|mouse(over|out|up|down))=["'])/gi,"$1if(window.parent &amp;&amp; window.parent.Xinha){return false}");
+html=this.inwardSpecialReplacements(html);
+html=html.replace(/(<script[^>]*((type=[\"\']text\/)|(language=[\"\'])))(javascript)/gi,"$1freezescript");
+var _182=new RegExp("((href|src|background)=['\"])/+","gi");
+html=html.replace(_182,"$1"+location.href.replace(/(https?:\/\/[^\/]*)\/.*/,"$1")+"/");
+html=this.fixRelativeLinks(html);
+if(this.config.fullPage){
+html=Xinha.addCoreCSS(html);
+}
+if(typeof this.config.inwardHtml=="function"){
+html=this.config.inwardHtml(html);
+}
+return html;
+};
+Xinha.prototype.outwardSpecialReplacements=function(html){
+for(var i in this.config.specialReplacements){
+var from=this.config.specialReplacements[i];
+var to=i;
+if(typeof from.replace!="function"||typeof to.replace!="function"){
+continue;
+}
+var reg=new RegExp(Xinha.escapeStringForRegExp(from),"g");
+html=html.replace(reg,to.replace(/\$/g,"$$$$"));
+}
+return html;
+};
+Xinha.prototype.inwardSpecialReplacements=function(html){
+for(var i in this.config.specialReplacements){
+var from=i;
+var to=this.config.specialReplacements[i];
+if(typeof from.replace!="function"||typeof to.replace!="function"){
+continue;
+}
+var reg=new RegExp(Xinha.escapeStringForRegExp(from),"g");
+html=html.replace(reg,to.replace(/\$/g,"$$$$"));
+}
+return html;
+};
+Xinha.prototype.fixRelativeLinks=function(html){
+if(typeof this.config.expandRelativeUrl!="undefined"&&this.config.expandRelativeUrl){
+var src=html.match(/(src|href)="([^"]*)"/gi);
+}
+var b=document.location.href;
+if(src){
+var url,url_m,relPath,base_m,absPath;
+for(var i=0;i<src.length;++i){
+url=src[i].match(/(src|href)="([^"]*)"/i);
+url_m=url[2].match(/\.\.\//g);
+if(url_m){
+relPath=new RegExp("(.*?)(([^/]*/){"+url_m.length+"})[^/]*$");
+base_m=b.match(relPath);
+absPath=url[2].replace(/(\.\.\/)*/,base_m[1]);
+html=html.replace(new RegExp(Xinha.escapeStringForRegExp(url[2])),absPath);
+}
+}
+}
+if(typeof this.config.stripSelfNamedAnchors!="undefined"&&this.config.stripSelfNamedAnchors){
+var _192=new RegExp("((href|src|background)=\")("+Xinha.escapeStringForRegExp(unescape(document.location.href.replace(/&/g,"&amp;")))+")([#?][^'\" ]*)","g");
+html=html.replace(_192,"$1$4");
+}
+if(typeof this.config.stripBaseHref!="undefined"&&this.config.stripBaseHref){
+var _193=null;
+if(typeof this.config.baseHref!="undefined"&&this.config.baseHref!==null){
+_193=new RegExp("((href|src|background|action)=\")("+Xinha.escapeStringForRegExp(this.config.baseHref.replace(/([^\/]\/)(?=.+\.)[^\/]*$/,"$1"))+")","g");
+html=html.replace(_193,"$1");
+}
+_193=new RegExp("((href|src|background|action)=\")("+Xinha.escapeStringForRegExp(document.location.href.replace(/^(https?:\/\/[^\/]*)(.*)/,"$1"))+")","g");
+html=html.replace(_193,"$1");
+}
+return html;
+};
+Xinha.prototype.getInnerHTML=function(){
+if(!this._doc.body){
+return "";
+}
+var html="";
+switch(this._editMode){
+case "wysiwyg":
+if(!this.config.fullPage){
+html=this._doc.body.innerHTML;
+}else{
+html=this.doctype+"\n"+this._doc.documentElement.innerHTML;
+}
+break;
+case "textmode":
+html=this._textArea.value;
+break;
+default:
+alert("Mode <"+this._editMode+"> not defined!");
+return false;
+}
+return html;
+};
+Xinha.prototype.setHTML=function(html){
+if(!this.config.fullPage){
+this._doc.body.innerHTML=html;
+}else{
+this.setFullHTML(html);
+}
+this._textArea.value=html;
+};
+Xinha.prototype.setDoctype=function(_196){
+this.doctype=_196;
+};
+Xinha._object=null;
+Array.prototype.isArray=true;
+RegExp.prototype.isRegExp=true;
+Xinha.cloneObject=function(obj){
+if(!obj){
+return null;
+}
+var _198=(obj.isArray)?[]:{};
+if(obj.constructor.toString().match(/\s*function Function\(/)||typeof obj=="function"){
+_198=obj;
+}else{
+if(obj.isRegExp){
+_198=eval(obj.toString());
+}else{
+for(var n in obj){
+var node=obj[n];
+if(typeof node=="object"){
+_198[n]=Xinha.cloneObject(node);
+}else{
+_198[n]=node;
+}
+}
+}
+}
+return _198;
+};
+Xinha.flushEvents=function(){
+var x=0;
+var e=Xinha._eventFlushers.pop();
+while(e){
+try{
+if(e.length==3){
+Xinha._removeEvent(e[0],e[1],e[2]);
+x++;
+}else{
+if(e.length==2){
+e[0]["on"+e[1]]=null;
+e[0]._xinha_dom0Events[e[1]]=null;
+x++;
+}
+}
+}
+catch(ex){
+}
+e=Xinha._eventFlushers.pop();
+}
+};
+Xinha._eventFlushers=[];
+if(document.addEventListener){
+Xinha._addEvent=function(el,_19e,func){
+el.addEventListener(_19e,func,true);
+Xinha._eventFlushers.push([el,_19e,func]);
+};
+Xinha._removeEvent=function(el,_1a1,func){
+el.removeEventListener(_1a1,func,true);
+};
+Xinha._stopEvent=function(ev){
+ev.preventDefault();
+ev.stopPropagation();
+};
+}else{
+if(document.attachEvent){
+Xinha._addEvent=function(el,_1a5,func){
+el.attachEvent("on"+_1a5,func);
+Xinha._eventFlushers.push([el,_1a5,func]);
+};
+Xinha._removeEvent=function(el,_1a8,func){
+el.detachEvent("on"+_1a8,func);
+};
+Xinha._stopEvent=function(ev){
+try{
+ev.cancelBubble=true;
+ev.returnValue=false;
+}
+catch(ex){
+}
+};
+}else{
+Xinha._addEvent=function(el,_1ac,func){
+alert("_addEvent is not supported");
+};
+Xinha._removeEvent=function(el,_1af,func){
+alert("_removeEvent is not supported");
+};
+Xinha._stopEvent=function(ev){
+alert("_stopEvent is not supported");
+};
+}
+}
+Xinha._addEvents=function(el,evs,func){
+for(var i=evs.length;--i>=0;){
+Xinha._addEvent(el,evs[i],func);
+}
+};
+Xinha._removeEvents=function(el,evs,func){
+for(var i=evs.length;--i>=0;){
+Xinha._removeEvent(el,evs[i],func);
+}
+};
+Xinha.addOnloadHandler=function(func,_1bb){
+_1bb=_1bb?_1bb:window;
+var init=function(){
+if(arguments.callee.done){
+return;
+}
+arguments.callee.done=true;
+if(Xinha.onloadTimer){
+clearInterval(Xinha.onloadTimer);
+}
+func();
+};
+if(Xinha.is_ie){
+_1bb.document.write("<sc"+"ript id=__ie_onload defer src=javascript:void(0)></script>");
+var _1bd=_1bb.document.getElementById("__ie_onload");
+_1bd.onreadystatechange=function(){
+if(this.readyState=="loaded"){
+this.parentNode.removeChild(_1bd);
+init();
+}
+};
+}else{
+if(/applewebkit|KHTML/i.test(navigator.userAgent)){
+Xinha.onloadTimer=_1bb.setInterval(function(){
+if(/loaded|complete/.test(_1bb.document.readyState)){
+init();
+}
+},10);
+}else{
+_1bb.document.addEventListener("DOMContentLoaded",init,false);
+}
+}
+Xinha._addEvent(_1bb,"load",init);
+};
+Xinha.addDom0Event=function(el,ev,fn){
+Xinha._prepareForDom0Events(el,ev);
+el._xinha_dom0Events[ev].unshift(fn);
+};
+Xinha.prependDom0Event=function(el,ev,fn){
+Xinha._prepareForDom0Events(el,ev);
+el._xinha_dom0Events[ev].push(fn);
+};
+Xinha._prepareForDom0Events=function(el,ev){
+if(typeof el._xinha_dom0Events=="undefined"){
+el._xinha_dom0Events={};
+Xinha.freeLater(el,"_xinha_dom0Events");
+}
+if(typeof el._xinha_dom0Events[ev]=="undefined"){
+el._xinha_dom0Events[ev]=[];
+if(typeof el["on"+ev]=="function"){
+el._xinha_dom0Events[ev].push(el["on"+ev]);
+}
+el["on"+ev]=function(_1c6){
+var a=el._xinha_dom0Events[ev];
+var _1c8=true;
+for(var i=a.length;--i>=0;){
+el._xinha_tempEventHandler=a[i];
+if(el._xinha_tempEventHandler(_1c6)===false){
+el._xinha_tempEventHandler=null;
+_1c8=false;
+break;
+}
+el._xinha_tempEventHandler=null;
+}
+return _1c8;
+};
+Xinha._eventFlushers.push([el,ev]);
+}
+};
+Xinha.prototype.notifyOn=function(ev,fn){
+if(typeof this._notifyListeners[ev]=="undefined"){
+this._notifyListeners[ev]=[];
+Xinha.freeLater(this,"_notifyListeners");
+}
+this._notifyListeners[ev].push(fn);
+};
+Xinha.prototype.notifyOf=function(ev,args){
+if(this._notifyListeners[ev]){
+for(var i=0;i<this._notifyListeners[ev].length;i++){
+this._notifyListeners[ev][i](ev,args);
+}
+}
+};
+Xinha._blockTags=" body form textarea fieldset ul ol dl li div "+"p h1 h2 h3 h4 h5 h6 quote pre table thead "+"tbody tfoot tr td th iframe address blockquote ";
+Xinha.isBlockElement=function(el){
+return el&&el.nodeType==1&&(Xinha._blockTags.indexOf(" "+el.tagName.toLowerCase()+" ")!=-1);
+};
+Xinha._paraContainerTags=" body td th caption fieldset div";
+Xinha.isParaContainer=function(el){
+return el&&el.nodeType==1&&(Xinha._paraContainerTags.indexOf(" "+el.tagName.toLowerCase()+" ")!=-1);
+};
+Xinha._closingTags=" a abbr acronym address applet b bdo big blockquote button caption center cite code del dfn dir div dl em fieldset font form frameset h1 h2 h3 h4 h5 h6 i iframe ins kbd label legend map menu noframes noscript object ol optgroup pre q s samp script select small span strike strong style sub sup table textarea title tt u ul var ";
+Xinha.needsClosingTag=function(el){
+return el&&el.nodeType==1&&(Xinha._closingTags.indexOf(" "+el.tagName.toLowerCase()+" ")!=-1);
+};
+Xinha.htmlEncode=function(str){
+if(typeof str.replace=="undefined"){
+str=str.toString();
+}
+str=str.replace(/&/ig,"&amp;");
+str=str.replace(/</ig,"&lt;");
+str=str.replace(/>/ig,"&gt;");
+str=str.replace(/\xA0/g,"&nbsp;");
+str=str.replace(/\x22/g,"&quot;");
+return str;
+};
+Xinha.prototype.stripBaseURL=function(_1d3){
+if(this.config.baseHref===null||!this.config.stripBaseHref){
+return _1d3;
+}
+var _1d4=this.config.baseHref.replace(/^(https?:\/\/[^\/]+)(.*)$/,"$1");
+var _1d5=new RegExp(_1d4);
+return _1d3.replace(_1d5,"");
+};
+String.prototype.trim=function(){
+return this.replace(/^\s+/,"").replace(/\s+$/,"");
+};
+Xinha._makeColor=function(v){
+if(typeof v!="number"){
+return v;
+}
+var r=v&255;
+var g=(v>>8)&255;
+var b=(v>>16)&255;
+return "rgb("+r+","+g+","+b+")";
+};
+Xinha._colorToRgb=function(v){
+if(!v){
+return "";
+}
+var r,g,b;
+function hex(d){
+return (d<16)?("0"+d.toString(16)):d.toString(16);
+}
+if(typeof v=="number"){
+r=v&255;
+g=(v>>8)&255;
+b=(v>>16)&255;
+return "#"+hex(r)+hex(g)+hex(b);
+}
+if(v.substr(0,3)=="rgb"){
+var re=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/;
+if(v.match(re)){
+r=parseInt(RegExp.$1,10);
+g=parseInt(RegExp.$2,10);
+b=parseInt(RegExp.$3,10);
+return "#"+hex(r)+hex(g)+hex(b);
+}
+return null;
+}
+if(v.substr(0,1)=="#"){
+return v;
+}
+return null;
+};
+Xinha.prototype._popupDialog=function(url,_1df,init){
+Dialog(this.popupURL(url),_1df,init);
+};
+Xinha.prototype.imgURL=function(file,_1e2){
+if(typeof _1e2=="undefined"){
+return _editor_url+file;
+}else{
+return _editor_url+"plugins/"+_1e2+"/img/"+file;
+}
+};
+Xinha.prototype.popupURL=function(file){
+var url="";
+if(file.match(/^plugin:\/\/(.*?)\/(.*)/)){
+var _1e5=RegExp.$1;
+var _1e6=RegExp.$2;
+if(!(/\.(html?|php)$/.test(_1e6))){
+_1e6+=".html";
+}
+url=Xinha.getPluginDir(_1e5)+"/popups/"+_1e6;
+}else{
+if(file.match(/^\/.*?/)||file.match(/^https?:\/\//)){
+url=file;
+}else{
+url=_editor_url+this.config.popupURL+file;
+}
+}
+return url;
+};
+Xinha.getElementById=function(tag,id){
+var el,i,objs=document.getElementsByTagName(tag);
+for(i=objs.length;--i>=0&&(el=objs[i]);){
+if(el.id==id){
+return el;
+}
+}
+return null;
+};
+Xinha.prototype._toggleBorders=function(){
+var _1ea=this._doc.getElementsByTagName("TABLE");
+if(_1ea.length!==0){
+if(!this.borders){
+this.borders=true;
+}else{
+this.borders=false;
+}
+for(var i=0;i<_1ea.length;i++){
+if(this.borders){
+Xinha._addClass(_1ea[i],"htmtableborders");
+}else{
+Xinha._removeClass(_1ea[i],"htmtableborders");
+}
+}
+}
+return true;
+};
+Xinha.addCoreCSS=function(html){
+var _1ed="<style title=\"XinhaInternalCSS\" type=\"text/css\">"+".htmtableborders, .htmtableborders td, .htmtableborders th {border : 1px dashed lightgrey ! important;}\n"+"html, body { border: 0px; } \n"+"body { background-color: #ffffff; } \n"+"img, hr { cursor: default } \n"+"</style>\n";
+if(html&&/<head>/i.test(html)){
+return html.replace(/<head>/i,"<head>"+_1ed);
+}else{
+if(html){
+return _1ed+html;
+}else{
+return _1ed;
+}
+}
+};
+Xinha.prototype.addEditorStylesheet=function(_1ee){
+var _1ef=this._doc.createElement("link");
+_1ef.rel="stylesheet";
+_1ef.type="text/css";
+_1ef.title="XinhaInternalCSS";
+_1ef.href=_1ee;
+this._doc.getElementsByTagName("HEAD")[0].appendChild(_1ef);
+};
+Xinha.stripCoreCSS=function(html){
+return html.replace(/<style[^>]+title="XinhaInternalCSS"(.|\n)*?<\/style>/ig,"").replace(/<link[^>]+title="XinhaInternalCSS"(.|\n)*?>/ig,"");
+};
+Xinha._removeClass=function(el,_1f2){
+if(!(el&&el.className)){
+return;
+}
+var cls=el.className.split(" ");
+var ar=[];
+for(var i=cls.length;i>0;){
+if(cls[--i]!=_1f2){
+ar[ar.length]=cls[i];
+}
+}
+el.className=ar.join(" ");
+};
+Xinha._addClass=function(el,_1f7){
+Xinha._removeClass(el,_1f7);
+el.className+=" "+_1f7;
+};
+Xinha.addClasses=function(el,_1f9){
+if(el!==null){
+var _1fa=el.className.trim().split(" ");
+var ours=_1f9.split(" ");
+for(var x=0;x<ours.length;x++){
+var _1fd=false;
+for(var i=0;_1fd===false&&i<_1fa.length;i++){
+if(_1fa[i]==ours[x]){
+_1fd=true;
+}
+}
+if(_1fd===false){
+_1fa[_1fa.length]=ours[x];
+}
+}
+el.className=_1fa.join(" ").trim();
+}
+};
+Xinha.removeClasses=function(el,_200){
+var _201=el.className.trim().split();
+var _202=[];
+var _203=_200.trim().split();
+for(var i=0;i<_201.length;i++){
+var _205=false;
+for(var x=0;x<_203.length&&!_205;x++){
+if(_201[i]==_203[x]){
+_205=true;
+}
+}
+if(!_205){
+_202[_202.length]=_201[i];
+}
+}
+return _202.join(" ");
+};
+Xinha.addClass=Xinha._addClass;
+Xinha.removeClass=Xinha._removeClass;
+Xinha._addClasses=Xinha.addClasses;
+Xinha._removeClasses=Xinha.removeClasses;
+Xinha._hasClass=function(el,_208){
+if(!(el&&el.className)){
+return false;
+}
+var cls=el.className.split(" ");
+for(var i=cls.length;i>0;){
+if(cls[--i]==_208){
+return true;
+}
+}
+return false;
+};
+Xinha._postback_send_charset=true;
+Xinha._postback=function(url,data,_20d){
+var req=null;
+req=Xinha.getXMLHTTPRequestObject();
+var _20f="";
+if(typeof data=="string"){
+_20f=data;
+}else{
+if(typeof data=="object"){
+for(var i in data){
+_20f+=(_20f.length?"&":"")+i+"="+encodeURIComponent(data[i]);
+}
+}
+}
+function callBack(){
+if(req.readyState==4){
+if(req.status==200||Xinha.isRunLocally&&req.status==0){
+if(typeof _20d=="function"){
+_20d(req.responseText,req);
+}
+}else{
+if(Xinha._postback_send_charset){
+Xinha._postback_send_charset=false;
+Xinha._postback(url,data,_20d);
+}else{
+alert("An error has occurred: "+req.statusText+"\nURL: "+url);
+}
+}
+}
+}
+req.onreadystatechange=callBack;
+req.open("POST",url,true);
+req.setRequestHeader("Content-Type","application/x-www-form-urlencoded"+(Xinha._postback_send_charset?"; charset=UTF-8":""));
+req.send(_20f);
+};
+Xinha._getback=function(url,_212){
+var req=null;
+req=Xinha.getXMLHTTPRequestObject();
+function callBack(){
+if(req.readyState==4){
+if(req.status==200||Xinha.isRunLocally&&req.status==0){
+_212(req.responseText,req);
+}else{
+alert("An error has occurred: "+req.statusText+"\nURL: "+url);
+}
+}
+}
+req.onreadystatechange=callBack;
+req.open("GET",url,true);
+req.send(null);
+};
+Xinha._geturlcontent=function(url){
+var req=null;
+req=Xinha.getXMLHTTPRequestObject();
+req.open("GET",url,false);
+req.send(null);
+if(req.status==200||Xinha.isRunLocally&&req.status==0){
+return req.responseText;
+}else{
+return "";
+}
+};
+if(typeof dumpValues=="undefined"){
+function dumpValues(o){
+var s="";
+for(var prop in o){
+if(window.console&&typeof window.console.log=="function"){
+if(typeof console.firebug!="undefined"){
+console.log(o);
+}else{
+console.log(prop+" = "+o[prop]+"\n");
+}
+}else{
+s+=prop+" = "+o[prop]+"\n";
+}
+}
+if(s){
+if(document.getElementById("errors")){
+document.getElementById("errors").value+=s;
+}else{
+var x=window.open("","debugger");
+x.document.write("<pre>"+s+"</pre>");
+}
+}
+}
+}
+if(!Array.prototype.contains){
+Array.prototype.contains=function(_21a){
+var _21b=this;
+for(var i=0;i<_21b.length;i++){
+if(_21a==_21b[i]){
+return true;
+}
+}
+return false;
+};
+}
+if(!Array.prototype.indexOf){
+Array.prototype.indexOf=function(_21d){
+var _21e=this;
+for(var i=0;i<_21e.length;i++){
+if(_21d==_21e[i]){
+return i;
+}
+}
+return null;
+};
+}
+if(!Array.prototype.append){
+Array.prototype.append=function(a){
+for(var i=0;i<a.length;i++){
+this.push(a[i]);
+}
+return this;
+};
+}
+Xinha.arrayContainsArray=function(a1,a2){
+var _224=true;
+for(var x=0;x<a2.length;x++){
+var _226=false;
+for(var i=0;i<a1.length;i++){
+if(a1[i]==a2[x]){
+_226=true;
+break;
+}
+}
+if(!_226){
+_224=false;
+break;
+}
+}
+return _224;
+};
+Xinha.arrayFilter=function(a1,_229){
+var _22a=[];
+for(var x=0;x<a1.length;x++){
+if(_229(a1[x])){
+_22a[_22a.length]=a1[x];
+}
+}
+return _22a;
+};
+Xinha.collectionToArray=function(_22c){
+var _22d=[];
+for(var i=0;i<_22c.length;i++){
+_22d.push(_22c.item(i));
+}
+return _22d;
+};
+Xinha.uniq_count=0;
+Xinha.uniq=function(_22f){
+return _22f+Xinha.uniq_count++;
+};
+Xinha._loadlang=function(_230,url){
+var lang;
+if(typeof _editor_lcbackend=="string"){
+url=_editor_lcbackend;
+url=url.replace(/%lang%/,_editor_lang);
+url=url.replace(/%context%/,_230);
+}else{
+if(!url){
+if(_230!="Xinha"){
+url=Xinha.getPluginDir(_230)+"/lang/"+_editor_lang+".js";
+}else{
+Xinha.setLoadingMessage("Loading language");
+url=_editor_url+"lang/"+_editor_lang+".js";
+}
+}
+}
+var _233=Xinha._geturlcontent(url);
+if(_233!==""){
+try{
+eval("lang = "+_233);
+}
+catch(ex){
+alert("Error reading Language-File ("+url+"):\n"+Error.toString());
+lang={};
+}
+}else{
+lang={};
+}
+return lang;
+};
+Xinha._lc=function(_234,_235,_236){
+var url,ret;
+if(typeof _235=="object"&&_235.url&&_235.context){
+url=_235.url+_editor_lang+".js";
+_235=_235.context;
+}
+var m=null;
+if(typeof _234=="string"){
+m=_234.match(/\$(.*?)=(.*?)\$/g);
+}
+if(m){
+if(!_236){
+_236={};
+}
+for(var i=0;i<m.length;i++){
+var n=m[i].match(/\$(.*?)=(.*?)\$/);
+_236[n[1]]=n[2];
+_234=_234.replace(n[0],"$"+n[1]);
+}
+}
+if(_editor_lang=="en"){
+if(typeof _234=="object"&&_234.string){
+ret=_234.string;
+}else{
+ret=_234;
+}
+}else{
+if(typeof Xinha._lc_catalog=="undefined"){
+Xinha._lc_catalog=[];
+}
+if(typeof _235=="undefined"){
+_235="Xinha";
+}
+if(typeof Xinha._lc_catalog[_235]=="undefined"){
+Xinha._lc_catalog[_235]=Xinha._loadlang(_235,url);
+}
+var key;
+if(typeof _234=="object"&&_234.key){
+key=_234.key;
+}else{
+if(typeof _234=="object"&&_234.string){
+key=_234.string;
+}else{
+key=_234;
+}
+}
+if(typeof Xinha._lc_catalog[_235][key]=="undefined"){
+if(_235=="Xinha"){
+if(typeof _234=="object"&&_234.string){
+ret=_234.string;
+}else{
+ret=_234;
+}
+}else{
+return Xinha._lc(_234,"Xinha",_236);
+}
+}else{
+ret=Xinha._lc_catalog[_235][key];
+}
+}
+if(typeof _234=="object"&&_234.replace){
+_236=_234.replace;
+}
+if(typeof _236!="undefined"){
+for(var i in _236){
+ret=ret.replace("$"+i,_236[i]);
+}
+}
+return ret;
+};
+Xinha.hasDisplayedChildren=function(el){
+var _23d=el.childNodes;
+for(var i=0;i<_23d.length;i++){
+if(_23d[i].tagName){
+if(_23d[i].style.display!="none"){
+return true;
+}
+}
+}
+return false;
+};
+Xinha._loadback=function(url,_240,_241,_242){
+if(document.getElementById(url)){
+return true;
+}
+var t=!Xinha.is_ie?"onload":"onreadystatechange";
+var s=document.createElement("script");
+s.type="text/javascript";
+s.src=url;
+s.id=url;
+if(_240){
+s[t]=function(){
+if(Xinha.is_ie&&(!(/loaded|complete/.test(window.event.srcElement.readyState)))){
+return;
+}
+_240.call(_241?_241:this,_242);
+s[t]=null;
+};
+}
+document.getElementsByTagName("head")[0].appendChild(s);
+return false;
+};
+Xinha.makeEditors=function(_245,_246,_247){
+if(!Xinha.isSupportedBrowser){
+return;
+}
+if(typeof _246=="function"){
+_246=_246();
+}
+var _248={};
+var _249;
+for(var x=0;x<_245.length;x++){
+if(typeof _245[x]=="string"){
+_249=Xinha.getElementById("textarea",_245[x]);
+if(!_249){
+_245[x]=null;
+continue;
+}
+}else{
+if(typeof _245[x]=="object"&&_245[x].tagName&&_245[x].tagName.toLowerCase()=="textarea"){
+_249=_245[x];
+if(!_249.id){
+_249.id="xinha_id_"+x;
+}
+}
+}
+var _24b=new Xinha(_249,Xinha.cloneObject(_246));
+_24b.registerPlugins(_247);
+_248[_249.id]=_24b;
+}
+return _248;
+};
+Xinha.startEditors=function(_24c){
+if(!Xinha.isSupportedBrowser){
+return;
+}
+for(var i in _24c){
+if(_24c[i].generate){
+_24c[i].generate();
+}
+}
+};
+Xinha.prototype.registerPlugins=function(_24e){
+if(!Xinha.isSupportedBrowser){
+return;
+}
+if(_24e){
+for(var i=0;i<_24e.length;i++){
+this.setLoadingMessage(Xinha._lc("Register plugin $plugin","Xinha",{"plugin":_24e[i]}));
+this.registerPlugin(_24e[i]);
+}
+}
+};
+Xinha.base64_encode=function(_250){
+var _251="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
+var _252="";
+var chr1,chr2,chr3;
+var enc1,enc2,enc3,enc4;
+var i=0;
+do{
+chr1=_250.charCodeAt(i++);
+chr2=_250.charCodeAt(i++);
+chr3=_250.charCodeAt(i++);
+enc1=chr1>>2;
+enc2=((chr1&3)<<4)|(chr2>>4);
+enc3=((chr2&15)<<2)|(chr3>>6);
+enc4=chr3&63;
+if(isNaN(chr2)){
+enc3=enc4=64;
+}else{
+if(isNaN(chr3)){
+enc4=64;
+}
+}
+_252=_252+_251.charAt(enc1)+_251.charAt(enc2)+_251.charAt(enc3)+_251.charAt(enc4);
+}while(i<_250.length);
+return _252;
+};
+Xinha.base64_decode=function(_256){
+var _257="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
+var _258="";
+var chr1,chr2,chr3;
+var enc1,enc2,enc3,enc4;
+var i=0;
+_256=_256.replace(/[^A-Za-z0-9\+\/\=]/g,"");
+do{
+enc1=_257.indexOf(_256.charAt(i++));
+enc2=_257.indexOf(_256.charAt(i++));
+enc3=_257.indexOf(_256.charAt(i++));
+enc4=_257.indexOf(_256.charAt(i++));
+chr1=(enc1<<2)|(enc2>>4);
+chr2=((enc2&15)<<4)|(enc3>>2);
+chr3=((enc3&3)<<6)|enc4;
+_258=_258+String.fromCharCode(chr1);
+if(enc3!=64){
+_258=_258+String.fromCharCode(chr2);
+}
+if(enc4!=64){
+_258=_258+String.fromCharCode(chr3);
+}
+}while(i<_256.length);
+return _258;
+};
+Xinha.removeFromParent=function(el){
+if(!el.parentNode){
+return;
+}
+var pN=el.parentNode;
+pN.removeChild(el);
+return el;
+};
+Xinha.hasParentNode=function(el){
+if(el.parentNode){
+if(el.parentNode.nodeType==11){
+return false;
+}
+return true;
+}
+return false;
+};
+Xinha.viewportSize=function(_25f){
+_25f=(_25f)?_25f:window;
+var x,y;
+if(_25f.innerHeight){
+x=_25f.innerWidth;
+y=_25f.innerHeight;
+}else{
+if(_25f.document.documentElement&&_25f.document.documentElement.clientHeight){
+x=_25f.document.documentElement.clientWidth;
+y=_25f.document.documentElement.clientHeight;
+}else{
+if(_25f.document.body){
+x=_25f.document.body.clientWidth;
+y=_25f.document.body.clientHeight;
+}
+}
+}
+return {"x":x,"y":y};
+};
+Xinha.pageSize=function(_261){
+_261=(_261)?_261:window;
+var x,y;
+var _263=_261.document.body.scrollHeight;
+var _264=_261.document.documentElement.scrollHeight;
+if(_263>_264){
+x=_261.document.body.scrollWidth;
+y=_261.document.body.scrollHeight;
+}else{
+x=_261.document.documentElement.scrollWidth;
+y=_261.document.documentElement.scrollHeight;
+}
+return {"x":x,"y":y};
+};
+Xinha.prototype.scrollPos=function(_265){
+_265=(_265)?_265:window;
+var x,y;
+if(_265.pageYOffset){
+x=_265.pageXOffset;
+y=_265.pageYOffset;
+}else{
+if(_265.document.documentElement&&document.documentElement.scrollTop){
+x=_265.document.documentElement.scrollLeft;
+y=_265.document.documentElement.scrollTop;
+}else{
+if(_265.document.body){
+x=_265.document.body.scrollLeft;
+y=_265.document.body.scrollTop;
+}
+}
+}
+return {"x":x,"y":y};
+};
+Xinha.getElementTopLeft=function(_267){
+var _268=curtop=0;
+if(_267.offsetParent){
+_268=_267.offsetLeft;
+curtop=_267.offsetTop;
+while(_267=_267.offsetParent){
+_268+=_267.offsetLeft;
+curtop+=_267.offsetTop;
+}
+}
+return {top:curtop,left:_268};
+};
+Xinha.findPosX=function(obj){
+var _26a=0;
+if(obj.offsetParent){
+return Xinha.getElementTopLeft(obj).left;
+}else{
+if(obj.x){
+_26a+=obj.x;
+}
+}
+return _26a;
+};
+Xinha.findPosY=function(obj){
+var _26c=0;
+if(obj.offsetParent){
+return Xinha.getElementTopLeft(obj).top;
+}else{
+if(obj.y){
+_26c+=obj.y;
+}
+}
+return _26c;
+};
+Xinha.createLoadingMessages=function(_26d){
+if(Xinha.loadingMessages||!Xinha.isSupportedBrowser){
+return;
+}
+Xinha.loadingMessages=[];
+for(var i=0;i<_26d.length;i++){
+if(!document.getElementById(_26d[i])){
+continue;
+}
+Xinha.loadingMessages.push(Xinha.createLoadingMessage(Xinha.getElementById("textarea",_26d[i])));
+}
+};
+Xinha.createLoadingMessage=function(_26f,text){
+if(document.getElementById("loading_"+_26f.id)||!Xinha.isSupportedBrowser){
+return;
+}
+var _271=document.createElement("div");
+_271.id="loading_"+_26f.id;
+_271.className="loading";
+_271.style.left=(Xinha.findPosX(_26f)+_26f.offsetWidth/2)-106+"px";
+_271.style.top=(Xinha.findPosY(_26f)+_26f.offsetHeight/2)-50+"px";
+var _272=document.createElement("div");
+_272.className="loading_main";
+_272.id="loading_main_"+_26f.id;
+_272.appendChild(document.createTextNode(Xinha._lc("Loading in progress. Please wait!")));
+var _273=document.createElement("div");
+_273.className="loading_sub";
+_273.id="loading_sub_"+_26f.id;
+text=text?text:Xinha._lc("Loading Core");
+_273.appendChild(document.createTextNode(text));
+_271.appendChild(_272);
+_271.appendChild(_273);
+document.body.appendChild(_271);
+Xinha.freeLater(_271);
+Xinha.freeLater(_272);
+Xinha.freeLater(_273);
+return _273;
+};
+Xinha.prototype.setLoadingMessage=function(_274,_275){
+if(!document.getElementById("loading_sub_"+this._textArea.id)){
+return;
+}
+document.getElementById("loading_main_"+this._textArea.id).innerHTML=_275?_275:Xinha._lc("Loading in progress. Please wait!");
+document.getElementById("loading_sub_"+this._textArea.id).innerHTML=_274;
+};
+Xinha.setLoadingMessage=function(_276){
+if(!Xinha.loadingMessages){
+return;
+}
+for(var i=0;i<Xinha.loadingMessages.length;i++){
+Xinha.loadingMessages[i].innerHTML=_276;
+}
+};
+Xinha.prototype.removeLoadingMessage=function(){
+if(document.getElementById("loading_"+this._textArea.id)){
+document.body.removeChild(document.getElementById("loading_"+this._textArea.id));
+}
+};
+Xinha.removeLoadingMessages=function(_278){
+for(var i=0;i<_278.length;i++){
+if(!document.getElementById(_278[i])){
+continue;
+}
+var main=document.getElementById("loading_"+document.getElementById(_278[i]).id);
+main.parentNode.removeChild(main);
+}
+Xinha.loadingMessages=null;
+};
+Xinha.toFree=[];
+Xinha.freeLater=function(obj,prop){
+Xinha.toFree.push({o:obj,p:prop});
+};
+Xinha.free=function(obj,prop){
+if(obj&&!prop){
+for(var p in obj){
+Xinha.free(obj,p);
+}
+}else{
+if(obj){
+if(prop.indexOf("src")==-1){
+try{
+obj[prop]=null;
+}
+catch(x){
+}
+}
+}
+}
+};
+Xinha.collectGarbageForIE=function(){
+Xinha.flushEvents();
+for(var x=0;x<Xinha.toFree.length;x++){
+Xinha.free(Xinha.toFree[x].o,Xinha.toFree[x].p);
+Xinha.toFree[x].o=null;
+}
+};
+Xinha.prototype.insertNodeAtSelection=function(_281){
+Xinha.notImplemented("insertNodeAtSelection");
+};
+Xinha.prototype.getParentElement=function(sel){
+Xinha.notImplemented("getParentElement");
+};
+Xinha.prototype.activeElement=function(sel){
+Xinha.notImplemented("activeElement");
+};
+Xinha.prototype.selectionEmpty=function(sel){
+Xinha.notImplemented("selectionEmpty");
+};
+Xinha.prototype.saveSelection=function(){
+Xinha.notImplemented("saveSelection");
+};
+Xinha.prototype.restoreSelection=function(_285){
+Xinha.notImplemented("restoreSelection");
+};
+Xinha.prototype.selectNodeContents=function(node,pos){
+Xinha.notImplemented("selectNodeContents");
+};
+Xinha.prototype.insertHTML=function(html){
+Xinha.notImplemented("insertHTML");
+};
+Xinha.prototype.getSelectedHTML=function(){
+Xinha.notImplemented("getSelectedHTML");
+};
+Xinha.prototype.getSelection=function(){
+Xinha.notImplemented("getSelection");
+};
+Xinha.prototype.createRange=function(sel){
+Xinha.notImplemented("createRange");
+};
+Xinha.prototype.isKeyEvent=function(_28a){
+Xinha.notImplemented("isKeyEvent");
+};
+Xinha.prototype.isShortCut=function(_28b){
+if(_28b.ctrlKey&&!_28b.altKey){
+return true;
+}
+return false;
+};
+Xinha.prototype.getKey=function(_28c){
+Xinha.notImplemented("getKey");
+};
+Xinha.getOuterHTML=function(_28d){
+Xinha.notImplemented("getOuterHTML");
+};
+Xinha.getXMLHTTPRequestObject=function(){
+try{
+if(typeof XMLHttpRequest!="undefined"&&typeof XMLHttpRequest.constructor=="function"){
+return new XMLHttpRequest();
+}else{
+if(typeof ActiveXObject=="function"){
+return new ActiveXObject("Microsoft.XMLHTTP");
+}
+}
+}
+catch(e){
+Xinha.notImplemented("getXMLHTTPRequestObject");
+}
+};
+Xinha.prototype._activeElement=function(sel){
+return this.activeElement(sel);
+};
+Xinha.prototype._selectionEmpty=function(sel){
+return this.selectionEmpty(sel);
+};
+Xinha.prototype._getSelection=function(){
+return this.getSelection();
+};
+Xinha.prototype._createRange=function(sel){
+return this.createRange(sel);
+};
+HTMLArea=Xinha;
+Xinha.init();
+if(Xinha.ie_version<8){
+Xinha.addDom0Event(window,"unload",Xinha.collectGarbageForIE);
+}
+Xinha.notImplemented=function(_291){
+throw new Error("Method Not Implemented","Part of Xinha has tried to call the "+_291+" method which has not been implemented.");
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/XinhaLoader.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/XinhaLoader.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,173 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/XinhaLoader.js */
+var Xinha={};
+_editor_url=_editor_url.replace(/\x2f*$/,"/");
+Xinha.agt=navigator.userAgent.toLowerCase();
+Xinha.is_ie=((Xinha.agt.indexOf("msie")!=-1)&&(Xinha.agt.indexOf("opera")==-1));
+Xinha.ie_version=parseFloat(Xinha.agt.substring(Xinha.agt.indexOf("msie")+5));
+Xinha.is_opera=(Xinha.agt.indexOf("opera")!=-1);
+Xinha.is_khtml=(Xinha.agt.indexOf("khtml")!=-1);
+Xinha.is_webkit=(Xinha.agt.indexOf("applewebkit")!=-1);
+Xinha.is_safari=(Xinha.agt.indexOf("safari")!=-1);
+Xinha.opera_version=navigator.appVersion.substring(0,navigator.appVersion.indexOf(" "))*1;
+Xinha.is_mac=(Xinha.agt.indexOf("mac")!=-1);
+Xinha.is_mac_ie=(Xinha.is_ie&&Xinha.is_mac);
+Xinha.is_win_ie=(Xinha.is_ie&&!Xinha.is_mac);
+Xinha.is_gecko=(navigator.product=="Gecko"&&!Xinha.is_safari);
+Xinha.isRunLocally=document.URL.toLowerCase().search(/^file:/)!=-1;
+Xinha.is_designMode=(typeof document.designMode!="undefined"&&!Xinha.is_ie);
+Xinha.isSupportedBrowser=Xinha.is_gecko||(Xinha.is_opera&&Xinha.opera_version>=9.1)||Xinha.ie_version>=5.5||Xinha.is_safari;
+Xinha.loadPlugins=function(_1,_2){
+if(!Xinha.isSupportedBrowser){
+return;
+}
+Xinha.loadStyle(typeof _editor_css=="string"?_editor_css:"Xinha.css","XinhaCoreDesign");
+Xinha.createLoadingMessages(xinha_editors);
+var _3=Xinha.loadingMessages;
+Xinha._loadback(_editor_url+"XinhaCore.js",function(){
+Xinha.removeLoadingMessages(xinha_editors);
+Xinha.createLoadingMessages(xinha_editors);
+_2();
+});
+return false;
+};
+Xinha._loadback=function(_4,_5,_6,_7){
+var T=!Xinha.is_ie?"onload":"onreadystatechange";
+var S=document.createElement("script");
+S.type="text/javascript";
+S.src=_4;
+if(_5){
+S[T]=function(){
+if(Xinha.is_ie&&(!(/loaded|complete/.test(window.event.srcElement.readyState)))){
+return;
+}
+_5.call(_6?_6:this,_7);
+S[T]=null;
+};
+}
+document.getElementsByTagName("head")[0].appendChild(S);
+};
+Xinha.getElementTopLeft=function(_a){
+var _b=curtop=0;
+if(_a.offsetParent){
+_b=_a.offsetLeft;
+curtop=_a.offsetTop;
+while(_a=_a.offsetParent){
+_b+=_a.offsetLeft;
+curtop+=_a.offsetTop;
+}
+}
+return {top:curtop,left:_b};
+};
+Xinha.findPosX=function(_c){
+var _d=0;
+if(_c.offsetParent){
+return Xinha.getElementTopLeft(_c).left;
+}else{
+if(_c.x){
+_d+=_c.x;
+}
+}
+return _d;
+};
+Xinha.findPosY=function(_e){
+var _f=0;
+if(_e.offsetParent){
+return Xinha.getElementTopLeft(_e).top;
+}else{
+if(_e.y){
+_f+=_e.y;
+}
+}
+return _f;
+};
+Xinha.createLoadingMessages=function(_10){
+if(Xinha.loadingMessages||!Xinha.isSupportedBrowser){
+return;
+}
+Xinha.loadingMessages=[];
+for(var i=0;i<_10.length;i++){
+if(!document.getElementById(_10[i])){
+continue;
+}
+Xinha.loadingMessages.push(Xinha.createLoadingMessage(document.getElementById(_10[i])));
+}
+};
+Xinha.createLoadingMessage=function(_12,_13){
+if(document.getElementById("loading_"+_12.id)||!Xinha.isSupportedBrowser){
+return;
+}
+var _14=document.createElement("div");
+_14.id="loading_"+_12.id;
+_14.className="loading";
+_14.style.left=(Xinha.findPosX(_12)+_12.offsetWidth/2)-106+"px";
+_14.style.top=(Xinha.findPosY(_12)+_12.offsetHeight/2)-50+"px";
+var _15=document.createElement("div");
+_15.className="loading_main";
+_15.id="loading_main_"+_12.id;
+_15.appendChild(document.createTextNode(Xinha._lc("Loading in progress. Please wait!")));
+var _16=document.createElement("div");
+_16.className="loading_sub";
+_16.id="loading_sub_"+_12.id;
+_13=_13?_13:Xinha._lc("Loading Core");
+_16.appendChild(document.createTextNode(_13));
+_14.appendChild(_15);
+_14.appendChild(_16);
+document.body.appendChild(_14);
+return _16;
+};
+Xinha.loadStyle=function(_17,id){
+var url=_editor_url||"";
+url+=_17;
+var _1a=document.getElementsByTagName("head")[0];
+var _1b=document.createElement("link");
+_1b.rel="stylesheet";
+_1b.href=url;
+if(id){
+_1b.id=id;
+}
+_1a.appendChild(_1b);
+};
+Xinha._lc=function(_1c){
+return _1c;
+};
+Xinha._addEvent=function(el,_1e,_1f){
+if(document.addEventListener){
+el.addEventListener(_1e,_1f,true);
+}else{
+el.attachEvent("on"+_1e,_1f);
+}
+};
+Xinha.addOnloadHandler=function(_20){
+var _21=function(){
+if(arguments.callee.done){
+return;
+}
+arguments.callee.done=true;
+if(Xinha.onloadTimer){
+clearInterval(Xinha.onloadTimer);
+}
+_20.call();
+};
+if(Xinha.is_ie){
+document.write("<sc"+"ript id=__ie_onload defer src=javascript:void(0)></script>");
+var _22=document.getElementById("__ie_onload");
+_22.onreadystatechange=function(){
+if(this.readyState=="loaded"){
+_21();
+}
+};
+}else{
+if(/WebKit/i.test(navigator.userAgent)){
+Xinha.onloadTimer=setInterval(function(){
+if(/loaded|complete/.test(document.readyState)){
+_21();
+}
+},10);
+}else{
+document.addEventListener("DOMContentLoaded",_21,false);
+}
+}
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/XinhaLoader_readme.txt
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/XinhaLoader_readme.txt	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,5 @@
+The XinhaLoader is a subset of Xinha only containing functions to fetch further files from the server and displaying a loading message. 
+It gives visual feedback to the user quite quickly so they don't have to watch the plain textarea and wonder if anything is happening.
+
+Usage in short: Follow the NewbieGuide, but load XinhaLoader.js instead of XinhaCore.js. 
+Make shure you define xinha_editors before calling Xinha.loadPlugins! This is different to earlier versions of the NewbieGuide (steps 1 and 2 reversed)
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/compression_readme.txt
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/compression_readme.txt	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,8 @@
+You can use the contrib/compress.php to batch-convert the current Xinha snapshot. To use this script, open it in a text editor, comment out the die() command at the top and open it in your browser.
+ 
+You can use the contrib/compress.bat to compress JavaScript files by drag&drop in Windows.
+
+Please be aware that the language files cannot be compressed.
+
+If you want the original files to be kept, open compress.bat and remvove the # in the line
+# FOR %%V IN (%*) DO del %%V_uncompressed.js
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/contrib/contrib/php-xinha.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/contrib/contrib/php-xinha.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,208 @@
+<?php
+  /** Write the appropriate xinha_config directives to pass data to a PHP (Plugin) backend file.
+   *
+   *  ImageManager Example:
+   *  The following would be placed in step 3 of your configuration (see the NewbieGuide 
+   *  (http://xinha.python-hosting.com/wiki/NewbieGuide)
+   *
+   * <script language="javascript">
+   *  with (xinha_config.ImageManager)
+   *  { 
+   *    <?php 
+   *      xinha_pass_to_php_backend
+   *      (       
+   *        array
+   *        (
+   *         'images_dir' => '/home/your/directory',
+   *         'images_url' => '/directory'
+   *        )
+   *      )
+   *    ?>
+   *  }
+   *  </script>
+   * 
+   */
+      
+  function xinha_pass_to_php_backend($Data, $KeyLocation = 'Xinha:BackendKey', $ReturnPHP = FALSE)
+  {
+   
+    $bk = array();
+    $bk['data']       = serialize($Data);
+    
+    @session_start();
+    if(!isset($_SESSION[$KeyLocation]))
+    {
+      $_SESSION[$KeyLocation] = uniqid('Key_');
+    }
+    
+    $bk['session_name'] = session_name();      
+    $bk['key_location'] = $KeyLocation;      
+    $bk['hash']         = 
+      function_exists('sha1') ? 
+        sha1($_SESSION[$KeyLocation] . $bk['data']) 
+      : md5($_SESSION[$KeyLocation] . $bk['data']);
+      
+      
+    // The data will be passed via a postback to the 
+    // backend, we want to make sure these are going to come
+    // out from the PHP as an array like $bk above, so 
+    // we need to adjust the keys.
+    $backend_data = array();
+    foreach($bk as $k => $v)
+    {
+      $backend_data["backend_data[$k]"] = $v; 
+    }
+    
+    // The session_start() above may have been after data was sent, so cookies
+    // wouldn't have worked.
+    $backend_data[session_name()] = session_id();
+    
+    if($ReturnPHP)
+    {      
+      return array('backend_data' => $backend_data);      
+    }
+    else
+    {      
+      echo 'backend_data = ' . xinha_to_js($backend_data) . "; \n";  
+    }                
+  }  
+   
+  /** Convert PHP data structure to Javascript */
+  
+  function xinha_to_js($var, $tabs = 0)
+  {
+    if(is_numeric($var))
+    {
+      return $var;
+    }
+  
+    if(is_string($var))
+    {
+      return "'" . xinha_js_encode($var) . "'";
+    }
+  
+    if(is_array($var))
+    {
+      $useObject = false;
+      foreach(array_keys($var) as $k) {
+          if(!is_numeric($k)) $useObject = true;
+      }
+      $js = array();
+      foreach($var as $k => $v)
+      {
+        $i = "";
+        if($useObject) {
+          if(preg_match('#^[a-zA-Z]+[a-zA-Z0-9]*$#', $k)) {
+            $i .= "$k: ";
+          } else {
+            $i .= "'$k': ";
+          }
+        }
+        $i .= xinha_to_js($v, $tabs + 1);
+        $js[] = $i;
+      }
+      if($useObject) {
+          $ret = "{\n" . xinha_tabify(implode(",\n", $js), $tabs) . "\n}";
+      } else {
+          $ret = "[\n" . xinha_tabify(implode(",\n", $js), $tabs) . "\n]";
+      }
+      return $ret;
+    }
+  
+    return 'null';
+  }
+    
+  /** Like htmlspecialchars() except for javascript strings. */
+  
+  function xinha_js_encode($string)
+  {
+    static $strings = "\\,\",',%,&,<,>,{,},@,\n,\r";
+  
+    if(!is_array($strings))
+    {
+      $tr = array();
+      foreach(explode(',', $strings) as $chr)
+      {
+        $tr[$chr] = sprintf('\x%02X', ord($chr));
+      }
+      $strings = $tr;
+    }
+  
+    return strtr($string, $strings);
+  }
+        
+   
+  /** Used by plugins to get the config passed via 
+  *   xinha_pass_to_backend()
+  *  returns either the structure given, or NULL
+  *  if none was passed or a security error was encountered.
+  */
+  
+  function xinha_read_passed_data()
+  {
+   if(isset($_REQUEST['backend_data']) && is_array($_REQUEST['backend_data']))
+   {
+     $bk = $_REQUEST['backend_data'];
+     session_name($bk['session_name']);
+     @session_start();
+     if(!isset($_SESSION[$bk['key_location']])) return NULL;
+     
+     if($bk['hash']         === 
+        function_exists('sha1') ? 
+          sha1($_SESSION[$bk['key_location']] . $bk['data']) 
+        : md5($_SESSION[$bk['key_location']] . $bk['data']))
+     {
+       return unserialize(ini_get('magic_quotes_gpc') ? stripslashes($bk['data']) : $bk['data']);
+     }
+   }
+   
+   return NULL;
+  }
+   
+  /** Used by plugins to get a query string that can be sent to the backend 
+  * (or another part of the backend) to send the same data.
+  */
+  
+  function xinha_passed_data_querystring()
+  {
+   $qs = array();
+   if(isset($_REQUEST['backend_data']) && is_array($_REQUEST['backend_data']))
+   {
+     foreach($_REQUEST['backend_data'] as $k => $v)
+     {
+       $v =  ini_get('magic_quotes_gpc') ? stripslashes($v) : $v;
+       $qs[] = "backend_data[" . rawurlencode($k) . "]=" . rawurlencode($v);
+     }       
+   }
+   
+   $qs[] = session_name() . '=' . session_id();
+   return implode('&', $qs);
+  }
+   
+    
+  /** Just space-tab indent some text */
+  function xinha_tabify($text, $tabs)
+  {
+    if($text)
+    {
+      return str_repeat("  ", $tabs) . preg_replace('/\n(.)/', "\n" . str_repeat("  ", $tabs) . "\$1", $text);
+    }
+  }       
+
+  /** Return upload_max_filesize value from php.ini in kilobytes (function adapted from php.net)**/
+  function upload_max_filesize_kb() 
+  {
+    $val = ini_get('upload_max_filesize');
+    $val = trim($val);
+    $last = strtolower($val{strlen($val)-1});
+    switch($last) 
+    {
+      // The 'G' modifier is available since PHP 5.1.0
+      case 'g':
+        $val *= 1024;
+      case 'm':
+        $val *= 1024;
+   }
+   return $val;
+}
+?>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/contrib/php-xinha.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/contrib/php-xinha.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,208 @@
+<?php
+  /** Write the appropriate xinha_config directives to pass data to a PHP (Plugin) backend file.
+   *
+   *  ImageManager Example:
+   *  The following would be placed in step 3 of your configuration (see the NewbieGuide 
+   *  (http://xinha.python-hosting.com/wiki/NewbieGuide)
+   *
+   * <script language="javascript">
+   *  with (xinha_config.ImageManager)
+   *  { 
+   *    <?php 
+   *      xinha_pass_to_php_backend
+   *      (       
+   *        array
+   *        (
+   *         'images_dir' => '/home/your/directory',
+   *         'images_url' => '/directory'
+   *        )
+   *      )
+   *    ?>
+   *  }
+   *  </script>
+   * 
+   */
+      
+  function xinha_pass_to_php_backend($Data, $KeyLocation = 'Xinha:BackendKey', $ReturnPHP = FALSE)
+  {
+   
+    $bk = array();
+    $bk['data']       = serialize($Data);
+    
+    @session_start();
+    if(!isset($_SESSION[$KeyLocation]))
+    {
+      $_SESSION[$KeyLocation] = uniqid('Key_');
+    }
+    
+    $bk['session_name'] = session_name();      
+    $bk['key_location'] = $KeyLocation;      
+    $bk['hash']         = 
+      function_exists('sha1') ? 
+        sha1($_SESSION[$KeyLocation] . $bk['data']) 
+      : md5($_SESSION[$KeyLocation] . $bk['data']);
+      
+      
+    // The data will be passed via a postback to the 
+    // backend, we want to make sure these are going to come
+    // out from the PHP as an array like $bk above, so 
+    // we need to adjust the keys.
+    $backend_data = array();
+    foreach($bk as $k => $v)
+    {
+      $backend_data["backend_data[$k]"] = $v; 
+    }
+    
+    // The session_start() above may have been after data was sent, so cookies
+    // wouldn't have worked.
+    $backend_data[session_name()] = session_id();
+    
+    if($ReturnPHP)
+    {      
+      return array('backend_data' => $backend_data);      
+    }
+    else
+    {      
+      echo 'backend_data = ' . xinha_to_js($backend_data) . "; \n";  
+    }                
+  }  
+   
+  /** Convert PHP data structure to Javascript */
+  
+  function xinha_to_js($var, $tabs = 0)
+  {
+    if(is_numeric($var))
+    {
+      return $var;
+    }
+  
+    if(is_string($var))
+    {
+      return "'" . xinha_js_encode($var) . "'";
+    }
+  
+    if(is_array($var))
+    {
+      $useObject = false;
+      foreach(array_keys($var) as $k) {
+          if(!is_numeric($k)) $useObject = true;
+      }
+      $js = array();
+      foreach($var as $k => $v)
+      {
+        $i = "";
+        if($useObject) {
+          if(preg_match('#^[a-zA-Z]+[a-zA-Z0-9]*$#', $k)) {
+            $i .= "$k: ";
+          } else {
+            $i .= "'$k': ";
+          }
+        }
+        $i .= xinha_to_js($v, $tabs + 1);
+        $js[] = $i;
+      }
+      if($useObject) {
+          $ret = "{\n" . xinha_tabify(implode(",\n", $js), $tabs) . "\n}";
+      } else {
+          $ret = "[\n" . xinha_tabify(implode(",\n", $js), $tabs) . "\n]";
+      }
+      return $ret;
+    }
+  
+    return 'null';
+  }
+    
+  /** Like htmlspecialchars() except for javascript strings. */
+  
+  function xinha_js_encode($string)
+  {
+    static $strings = "\\,\",',%,&,<,>,{,},@,\n,\r";
+  
+    if(!is_array($strings))
+    {
+      $tr = array();
+      foreach(explode(',', $strings) as $chr)
+      {
+        $tr[$chr] = sprintf('\x%02X', ord($chr));
+      }
+      $strings = $tr;
+    }
+  
+    return strtr($string, $strings);
+  }
+        
+   
+  /** Used by plugins to get the config passed via 
+  *   xinha_pass_to_backend()
+  *  returns either the structure given, or NULL
+  *  if none was passed or a security error was encountered.
+  */
+  
+  function xinha_read_passed_data()
+  {
+   if(isset($_REQUEST['backend_data']) && is_array($_REQUEST['backend_data']))
+   {
+     $bk = $_REQUEST['backend_data'];
+     session_name($bk['session_name']);
+     @session_start();
+     if(!isset($_SESSION[$bk['key_location']])) return NULL;
+     
+     if($bk['hash']         === 
+        function_exists('sha1') ? 
+          sha1($_SESSION[$bk['key_location']] . $bk['data']) 
+        : md5($_SESSION[$bk['key_location']] . $bk['data']))
+     {
+       return unserialize(ini_get('magic_quotes_gpc') ? stripslashes($bk['data']) : $bk['data']);
+     }
+   }
+   
+   return NULL;
+  }
+   
+  /** Used by plugins to get a query string that can be sent to the backend 
+  * (or another part of the backend) to send the same data.
+  */
+  
+  function xinha_passed_data_querystring()
+  {
+   $qs = array();
+   if(isset($_REQUEST['backend_data']) && is_array($_REQUEST['backend_data']))
+   {
+     foreach($_REQUEST['backend_data'] as $k => $v)
+     {
+       $v =  ini_get('magic_quotes_gpc') ? stripslashes($v) : $v;
+       $qs[] = "backend_data[" . rawurlencode($k) . "]=" . rawurlencode($v);
+     }       
+   }
+   
+   $qs[] = session_name() . '=' . session_id();
+   return implode('&', $qs);
+  }
+   
+    
+  /** Just space-tab indent some text */
+  function xinha_tabify($text, $tabs)
+  {
+    if($text)
+    {
+      return str_repeat("  ", $tabs) . preg_replace('/\n(.)/', "\n" . str_repeat("  ", $tabs) . "\$1", $text);
+    }
+  }       
+
+  /** Return upload_max_filesize value from php.ini in kilobytes (function adapted from php.net)**/
+  function upload_max_filesize_kb() 
+  {
+    $val = ini_get('upload_max_filesize');
+    $val = trim($val);
+    $last = strtolower($val{strlen($val)-1});
+    switch($last) 
+    {
+      // The 'G' modifier is available since PHP 5.1.0
+      case 'g':
+        $val *= 1024;
+      case 'm':
+        $val *= 1024;
+   }
+   return $val;
+}
+?>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/examples/ExtendedDemo.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/examples/ExtendedDemo.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,16 @@
+<html>
+<head><title>Xinha Extended Example</title></head>
+  <!--------------------------------------:noTabs=true:tabSize=2:indentSize=2:--
+    --  Xinha example frameset.
+    --
+    --  $HeadURL:http://svn.xinha.webfactional.com/trunk/examples/ExtendedDemo.html $
+    --  $LastChangedDate:2008-02-04 01:43:21 +0100 (Mo, 04 Feb 2008) $
+    --  $LastChangedRevision:962 $
+    --  $LastChangedBy:ray $
+    --------------------------------------------------------------------------->
+
+  <frameset cols="240,*">
+    <frame src="files/ext_example-menu.php" name="menu" id="menu">
+    <frame src="about:blank" name="body" id="body">
+  </frameset>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/examples/Newbie.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/examples/Newbie.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,24 @@
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
+    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
+<head>
+  <title>Xinha Newbie Guide</title>
+  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
+  
+  <script type="text/javascript">
+    _editor_url  = "../"  // (preferably absolute) URL (including trailing slash) where Xinha is installed
+    _editor_lang = "en";      // And the language we need to use in the editor.
+    _editor_skin = "blue-metallic";   // If you want use skin, add the name here
+  </script>
+  <script type="text/javascript" src="../XinhaLoader.js"></script>
+  <script type="text/javascript" src="XinhaConfig.js"></script>
+</head>
+<body>
+
+<form action="">
+<div>
+<textarea id="myTextArea" name="myTextArea" rows="25" cols="50" style="width: 100%"></textarea>
+</div>
+</form>
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/examples/XinhaConfig.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/examples/XinhaConfig.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,20 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/examples/XinhaConfig.js */
+xinha_editors=null;
+xinha_init=null;
+xinha_config=null;
+xinha_plugins=null;
+xinha_init=xinha_init?xinha_init:function(){
+xinha_editors=xinha_editors?xinha_editors:["myTextArea","anotherOne"];
+xinha_plugins=xinha_plugins?xinha_plugins:["CharacterMap","ContextMenu","SmartReplace","Stylist","Linker","SuperClean","TableOperations"];
+if(!Xinha.loadPlugins(xinha_plugins,xinha_init)){
+return;
+}
+xinha_config=xinha_config?xinha_config():new Xinha.Config();
+xinha_config.pageStyleSheets=[_editor_url+"examples/full_example.css"];
+xinha_editors=Xinha.makeEditors(xinha_editors,xinha_config,xinha_plugins);
+Xinha.startEditors(xinha_editors);
+};
+Xinha.addOnloadHandler(xinha_init);
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/examples/files/Extended.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/examples/files/Extended.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,317 @@
+<html>
+
+<head>
+  <title>Settings</title>
+  <link rel="stylesheet" type="text/css" href="../../popups/popup.css" />
+  <script type="text/javascript">
+
+function getAbsolutePos(el) {
+  var r = { x: el.offsetLeft, y: el.offsetTop };
+  if (el.offsetParent) {
+    var tmp = getAbsolutePos(el.offsetParent);
+    r.x += tmp.x;
+    r.y += tmp.y;
+  }
+  return r;
+};
+
+function getSelectedValue(el) {
+  if(!el)
+    return "";
+  return el[el.selectedIndex].value;
+}
+
+function setSelectedValue(el, val) {
+  if(!el)
+    return "";
+  var ops = el.getElementsByTagName("option");
+  for (var i = ops.length; --i >= 0;) {
+    var op = ops[i];
+    op.selected = (op.value == val);
+  }
+  el.value = val;
+}
+
+function getCheckedValue(el) {
+  if(!el)
+    return "";
+  var radioLength = el.length;
+  if(radioLength == undefined)
+    if(el.checked)
+      return el.value;
+    else
+      return "false";
+  for(var i = 0; i < radioLength; i++) {
+    if(el[i].checked) {
+      return el[i].value;
+    }
+  }
+  return "";
+}
+
+function setCheckedValue(el, val) {
+  if(!el)
+    return;
+  var radioLength = el.length;
+  if(radioLength == undefined) {
+    el.checked = (el.value == val.toString());
+    return;
+  }
+  for(var i = 0; i < radioLength; i++) {
+    el[i].checked = false;
+    if(el[i].value == val.toString()) {
+      el[i].checked = true;
+    }
+  }
+}
+
+function __dlg_onclose() {
+  opener.Dialog._return(null);
+};
+
+// closes the dialog and passes the return info upper.
+function __dlg_close(val) {
+  opener.Dialog._return(val);
+  window.close();
+};
+
+function __dlg_close_on_esc(ev) {
+  ev || (ev = window.event);
+  if (ev.keyCode == 27) {
+    window.close();
+    return false;
+  }
+  return true;
+};
+
+function __dlg_init(bottom) {
+  var body = document.body;
+  var body_height = 0;
+  if (typeof bottom == "undefined") {
+    var div = document.createElement("div");
+    body.appendChild(div);
+    var pos = getAbsolutePos(div);
+    body_height = pos.y;
+  } else {
+    var pos = getAbsolutePos(bottom);
+    body_height = pos.y + bottom.offsetHeight;
+  }
+  if (!window.dialogArguments && opener.Dialog._arguments)
+  {
+    window.dialogArguments = opener.Dialog._arguments;
+  }
+  if (!document.all) {
+    window.sizeToContent();
+    window.sizeToContent();  // for reasons beyond understanding,
+          // only if we call it twice we get the
+          // correct size.
+    window.addEventListener("unload", __dlg_onclose, true);
+    window.innerWidth = body.offsetWidth + 5;
+    window.innerHeight = body_height + 2;
+    // center on parent
+    var x = opener.screenX + (opener.outerWidth - window.outerWidth) / 2;
+    var y = opener.screenY + (opener.outerHeight - window.outerHeight) / 2;
+    window.moveTo(x, y);
+  } else {
+    // window.dialogHeight = body.offsetHeight + 50 + "px";
+    // window.dialogWidth = body.offsetWidth + "px";
+    window.resizeTo(body.offsetWidth, body_height);
+    var ch = body.clientHeight;
+    var cw = body.clientWidth;
+    window.resizeBy(body.offsetWidth - cw, body_height - ch);
+    var W = body.offsetWidth;
+    var H = 2 * body_height - ch;
+    var x = (screen.availWidth - W) / 2;
+    var y = (screen.availHeight - H) / 2;
+    window.moveTo(x, y);
+  }
+  document.body.onkeypress = __dlg_close_on_esc;
+};
+
+function placeFocus() {
+var bFound = false;
+  // for each form
+  for (f=0; f < document.forms.length; f++) {
+    // for each element in each form
+    for(i=0; i < document.forms[f].length; i++) {
+      // if it's not a hidden element
+      if (document.forms[f][i].type != "hidden") {
+        // and it's not disabled
+        if (document.forms[f][i].disabled != true) {
+            // set the focus to it
+            document.forms[f][i].focus();
+            var bFound = true;
+        }
+      }
+      // if found in this element, stop looking
+      if (bFound == true)
+        break;
+    }
+    // if found in this form, stop looking
+    if (bFound == true)
+      break;
+  }
+}
+
+function Init() {
+  __dlg_init();
+  var param = window.dialogArguments;
+  if(param) {
+    var el;
+    for (var field in param) {
+      //alert(field + '="' + param[field] + '"');
+      el = document.getElementById(field);
+      if (el.tagName.toLowerCase()=="input"){
+        if ((el.type.toLowerCase()=="radio") || (el.type.toLowerCase()=="checkbox")){
+          setCheckedValue(el, param[field]);
+        } else {
+          el.value = param[field];
+        }
+      } else if (el.tagName.toLowerCase()=="select"){
+        setSelectedValue(el, param[field]);
+      } else if (el.tagName.toLowerCase()=="textarea"){
+        el.value = param[field];
+      }
+    }
+  }
+  placeFocus();
+};
+
+// pass data back to the calling window
+function onOK() {
+  var param = new Object();
+  var el = document.getElementsByTagName('input');
+  for (var i=0; i<el.length;i++){
+    if ((el[i].type.toLowerCase()=="radio") || (el[i].type.toLowerCase()=="checkbox")){
+      if (getCheckedValue(el[i])!=''){
+        param[el[i].id] = getCheckedValue(el[i]);
+      }
+    } else {
+      param[el[i].id] = el[i].value;
+    }
+  }
+  el = document.getElementsByTagName('select');
+  for (var i=0; i<el.length;i++){
+    param[el[i].id] = getSelectedValue(el[i]);
+  }
+  el = document.getElementsByTagName('textarea');
+  for (var i=0; i<el.length;i++){
+    param[el[i].id] = el[i].value;
+  }
+  __dlg_close(param);
+  return false;
+};
+
+function onCancel() {
+  __dlg_close(null);
+  return false;
+};
+
+</script>
+
+<style type="text/css">
+  label { width: 16em; float: left; padding: 2px 5px; text-align: right; }
+  br { clear: both; }
+</style>
+
+</head>
+
+<body class="dialog" onload="Init(); window.resizeTo(420, 820);">
+<div class="title">Settings</div>
+  <form action="" method="get">
+  <fieldset>
+    <legend>Xinha options</legend>
+    <label for="width">Editor width:</label>
+    <input type="text" name="width" id="width" title="Allowed values are 'auto', 'toolbar' or a numeric value followed by 'px'." /><br />
+    <label for="height">Editor height:</label>
+    <input type="text" name="height" id="height" title="Allowed values are 'auto' or a numeric value followed by 'px'." /><br />
+    <label for="sizeIncludesBars">Size includes bars</label>
+    <input type="checkbox" name="sizeIncludesBars" id="sizeIncludesBars" value="true" title="Specifies whether the toolbar should be included in the size, or are extra to it." /><br />
+    <label for="sizeIncludesPanels">Size includes panels</label>
+    <input type="checkbox" name="sizeIncludesPanels" id="sizeIncludesPanels" value="true" title="Specifies whether the panels should be included in the size, or are extra to it." /><br />
+    <label for="statusBar">Status Bar</label>
+    <input type="checkbox" name="statusBar" id="statusBar" value="true" title="Enable creation of the status bar?" /><br />
+    <label for="htmlareaPaste">Htmlarea Paste</label>
+    <input type="checkbox" name="htmlareaPaste" id="htmlareaPaste" value="true" title="Intercept ^V and use the Xinha paste command" /><br />
+    <label for="mozParaHandler">Mozilla Parameter Handler:</label>
+    <select name="mozParaHandler" id="mozParaHandler" title="Gecko only: Let the built-in routine for handling the return key decide if to enter br or p tags or use a custom implementation.">
+    <option value="built-in">built-in</option>
+    <option value="dirty">dirty</option>
+    <option value="best">best</option>
+    </select><br />
+    <label for="getHtmlMethod">GetHtml Method:</label>
+    <select name="getHtmlMethod" id="getHtmlMethod" title="This determines the method how the HTML output is generated.">
+    <option value="DOMwalk">DOMwalk</option>
+    <option value="TransformInnerHTML">TransformInnerHTML</option>
+    </select><br />
+    <label for="undoSteps">Undo steps:</label>
+    <input type="text" name="undoSteps" id="undoSteps" title="Maximum size of the undo queue."  /><br />
+    <label for="undoTimeout">Undo Timeout:</label>
+    <input type="text" name="undoTimeout" id="undoTimeout" title="The time interval at which undo samples are taken, default: 500 (1/2 sec)."  /><br />
+    <label for="changeJustifyWithDirection">change justify with direction</label>
+    <input type="checkbox" name="changeJustifyWithDirection" id="changeJustifyWithDirection" value="true" title="Set this to true if you want to explicitly right-justify when setting the text direction to right-to-left" /><br />
+    <label for="fullPage">full Page</label>
+    <input type="checkbox" name="fullPage" id="fullPage" value="true" title="If true then Xinha will retrieve the full HTML, starting with the HTML-tag." /><br />
+    <label for="pageStyle">Page style:</label>
+    <textarea name="pageStyle" id="pageStyle" title="Raw style definitions included in the edited document"></textarea>
+<!--    pageStyleSheets -->
+    <label for="baseHref">Base href:</label>
+    <input type="text" name="baseHref" id="baseHref" title="specify a base href for relative links" /><br />
+    <label for="expandRelativeUrl">expand relative Url</label>
+    <input type="checkbox" name="expandRelativeUrl" id="expandRelativeUrl" value="true" title="If true, relative URLs (../) will be made absolute"/><br />
+    <label for="stripBaseHref">Strip base href</label>
+    <input type="checkbox" name="stripBaseHref" id="stripBaseHref" value="true" title="We can strip the server part out of URL to make/leave them semi-absolute" /><br />
+    <label for="stripSelfNamedAnchors">Strip self named anchors</label>
+    <input type="checkbox" name="stripSelfNamedAnchors" id="stripSelfNamedAnchors" value="true" title="We can strip the url of the editor page from named links" /><br />
+    <label for="only7BitPrintablesInURLs">only 7bit printables in URLs</label>
+    <input type="checkbox" name="only7BitPrintablesInURLs" id="only7BitPrintablesInURLs" value="true" title="In URLs all characters above ASCII value 127 have to be encoded using % codes" /><br />
+    <label for="sevenBitClean">7bit Clean</label>
+    <input type="checkbox" name="sevenBitClean" id="sevenBitClean" value="true" title="If you are putting the HTML written in Xinha into an email you might want it to be 7-bit characters only." /><br />
+    <label for="killWordOnPaste">kill Word on paste</label>
+    <input type="checkbox" name="killWordOnPaste" id="killWordOnPaste" value="true" title="Set to true if you want Word code to be cleaned upon Paste." /><br />
+    <label for="makeLinkShowsTarget">make Link Shows Target</label>
+    <input type="checkbox" name="makeLinkShowsTarget" id="makeLinkShowsTarget" value="true" title="Enable the 'Target' field in the Make Link dialog." /><br />
+    <label for="flowToolbars">flow toolbars</label>
+    <input type="checkbox" name="flowToolbars" id="flowToolbars" value="true" /><br />
+    <label for="stripScripts">strip Scripts</label>
+    <input type="checkbox" name="stripScripts" id="stripScripts" value="true" title="Set to false if you want to allow JavaScript in the content" /><br />
+    <label for="showLoading">show loading</label>
+    <input type="checkbox" name="showLoading" id="showLoading" value="true" /><br />
+  </fieldset>
+
+  <fieldset id="CharacterMapOptions" class="options">
+    <legend>CharacterMap options</legend>
+    <label for="CharacterMapMode">Mode :</label>
+    <select id="CharacterMapMode" name="CharacterMapMode">
+    <option value="popup">popup</option>
+    <option value="panel">panel</option>
+    </select>
+  </fieldset>
+
+  <fieldset id="ListTypeOptions" class="options">
+    <legend>ListType options</legend>
+    <label class="ListTypeMode">Mode :</label>
+    <select id="ListTypeMode" name="ListTypeMode">
+    <option value="toolbar">toolbar</option>
+    <option value="panel">panel</option>
+    </select>
+  </fieldset>
+
+  <fieldset id="CharCounterOptions" class="options">
+    <legend>CharCounter options</legend>
+    <label for="showChar">show Char :</label>
+    <input type="checkbox" name="showChar" id="showChar" value="true" /><br />
+    <label for="showWord">show Word :</label>
+    <input type="checkbox" name="showWord" id="showWord" value="true" /><br />
+    <label for="showHtml">show Html :</label>
+    <input type="checkbox" name="showHtml" id="showHtml" value="true" /><br />
+  </fieldset>
+  <br />
+
+  <div id="buttons">
+    <button type="submit" name="ok" onclick="return onOK();">OK</button>
+    <button type="button" name="cancel" onclick="return onCancel();">Cancel</button>
+  </div>
+</form>
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/examples/files/custom.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/examples/files/custom.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,40 @@
+  /*--------------------------------------:noTabs=true:tabSize=2:indentSize=2:--
+    --  CSS plugin example CSS file.  This file is used by full_example.js
+    --  when the CSS plugin is included in an auto-generated example.
+    --  @TODO Make this CSS more useful.
+    --
+    --  $HeadURL:http://svn.xinha.webfactional.com/trunk/examples/files/custom.css $
+    --  $LastChangedDate:2008-02-04 01:43:21 +0100 (Mo, 04 Feb 2008) $
+    --  $LastChangedRevision:962 $
+    --  $LastChangedBy:ray $
+    --------------------------------------------------------------------------*/
+
+body { background-color: #234; color: #dd8; font-family: tahoma; font-size: 12px; }
+
+a:link, a:visited { color: #8cf; }
+a:hover { color: #ff8; }
+
+h1 { background-color: #456; color: #ff8; padding: 2px 5px; border: 1px solid; border-color: #678 #012 #012 #678; }
+
+/* syntax highlighting (used by the first combo defined for the CSS plugin) */
+
+pre { margin: 0px 1em; padding: 5px 1em; background-color: #000; border: 1px dotted #02d; border-left: 2px solid #04f; }
+.code { color: #f5deb3; }
+.string { color: #00ffff; }
+.comment { color: #8fbc8f; }
+.variable-name { color: #fa8072; }
+.type { color: #90ee90; font-weight: bold; }
+.reference { color: #ee82ee; }
+.preprocessor { color: #faf; }
+.keyword { color: #ffffff; font-weight: bold; }
+.function-name { color: #ace; }
+.html-tag { font-weight: bold; }
+.html-helper-italic { font-style: italic; }
+.warning { color: #ffa500; font-weight: bold; }
+.html-helper-bold { font-weight: bold; }
+
+/* info combo */
+
+.quote { font-style: italic; color: #ee9; }
+.highlight { background-color: yellow; color: #000; }
+.deprecated { text-decoration: line-through; color: #aaa; }
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/examples/files/dynamic.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/examples/files/dynamic.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,56 @@
+  /*--------------------------------------:noTabs=true:tabSize=2:indentSize=2:--
+    --  DynamicCSS plugin example CSS file.  Used by full_example.js
+    --  when the DynamicCSS plugin is included in an auto-generated example.
+    --  @TODO Make this CSS more useful.
+    --
+    --  $HeadURL:http://svn.xinha.webfactional.com/trunk/examples/files/dynamic.css $
+    --  $LastChangedDate:2008-02-04 01:43:21 +0100 (Mo, 04 Feb 2008) $
+    --  $LastChangedRevision:962 $
+    --  $LastChangedBy:ray $
+    --------------------------------------------------------------------------*/
+
+p {
+  FONT-FAMILY: Arial, Helvetica;
+  FONT-SIZE: 9pt;
+  FONT-WEIGHT: normal;
+  COLOR: #000000;
+}
+
+p.p1 {
+  FONT-FAMILY: Arial, Helvetica;
+  FONT-SIZE: 11pt;
+  FONT-WEIGHT: normal;
+  COLOR: #000000;
+}
+
+p.p2 {
+  FONT-FAMILY: Arial, Helvetica;
+  FONT-SIZE: 13pt;
+  FONT-WEIGHT: normal;
+  COLOR: #000000;
+}
+
+div {
+  FONT-FAMILY: Arial, Helvetica;
+  FONT-SIZE: 9pt;
+  FONT-WEIGHT: bold;
+  COLOR: #000000;
+}
+
+div.div1 {
+  FONT-FAMILY: Arial, Helvetica;
+  FONT-SIZE: 11pt;
+  FONT-WEIGHT: bold;
+  COLOR: #000000;
+}
+
+div.div2 {
+  FONT-FAMILY: Arial, Helvetica;
+  FONT-SIZE: 13pt;
+  FONT-WEIGHT: bold;
+  COLOR: #000000;
+}
+
+.quote { font-style: italic; color: #ee9; }
+.highlight { background-color: yellow; color: #000; }
+.deprecated { text-decoration: line-through; color: #aaa; }
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/examples/files/ext_example-body.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/examples/files/ext_example-body.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,206 @@
+<!DOCTYPE BHTML PUBLIC "-//BC//DTD BHTML 3.2 Final//EN">
+<html>
+<head>
+
+  <!-- ---------------------------------------------------------------------
+    --  $HeadURL:http://svn.xinha.webfactional.com/trunk/examples/files/ext_example-body.html $
+    --  $LastChangedDate:2008-02-04 01:43:21 +0100 (Mo, 04 Feb 2008) $
+    --  $LastChangedRevision:962 $
+    --  $LastChangedBy:ray $
+    ------------------------------------------------------------------------ -->
+
+  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
+  <title>Example of Xinha</title>
+  <link rel="stylesheet" type="text/css" href="full_example.css" />
+
+  <script type="text/javascript">
+    function showError( sMsg, sUrl, sLine){
+      document.getElementById('errors').value += 'Error: ' + sMsg + '\n' +
+                                                 'Source File: ' + sUrl + '\n' +
+                                                 'Line: ' + sLine + '\n';
+      return false;
+    }
+    // You must set _editor_url to the URL (including trailing slash) where
+    // where xinha is installed, it's highly recommended to use an absolute URL
+    //  eg: _editor_url = "/path/to/xinha/";
+    // You may try a relative URL if you wish]
+    //  eg: _editor_url = "../";
+    // in this example we do a little regular expression to find the absolute path.
+    _editor_url  = document.location.href.replace(/examples\/files\/ext_example-body\.html.*/, '')
+    //moved _editor_lang & _editor_skin to init function because of error thrown when frame document not ready
+  </script>
+
+  <!-- Load up the actual editor core -->
+  <script type="text/javascript" src="../../XinhaCore.js"></script>
+
+  <script type="text/javascript">
+    xinha_editors = null;
+    xinha_init    = null;
+    xinha_config  = null;
+    xinha_plugins = null;
+
+    xinha_init = xinha_init ? xinha_init : function() {
+      window.onerror = showError;
+      document.onerror = showError;
+
+      var f = top.frames["menu"].document.forms["fsettings"];
+      _editor_lang = f.lang[f.lang.selectedIndex].value; // the language we need to use in the editor.
+      _editor_skin = f.skin[f.skin.selectedIndex].value; // the skin we use in the editor
+// What are the plugins you will be using in the editors on this page.
+// List all the plugins you will need, even if not all the editors will use all the plugins.
+      xinha_plugins = [ ];
+      for(var x = 0; x < f.plugins.length; x++) {
+        if(f.plugins[x].checked) xinha_plugins.push(f.plugins[x].value);
+      }
+
+      // THIS BIT OF JAVASCRIPT LOADS THE PLUGINS, NO TOUCHING  :)
+      if(!Xinha.loadPlugins(xinha_plugins, xinha_init)) return;
+
+// What are the names of the textareas you will be turning into editors?
+      var num = 1;
+      num = parseInt(f.num.value);
+      if(isNaN(num)) {
+        num = 1;
+        f.num.value = 1;
+      }
+      var dest = document.getElementById("editors_here");
+      var lipsum = window.parent.menu.document.getElementById('myTextarea0').value;
+
+      xinha_editors = [ ]
+      for(var x = 0; x < num; x++) {
+        var ta = 'myTextarea' + x;
+        xinha_editors.push(ta);
+
+        var div = document.createElement('div');
+        div.className = 'area_holder';
+
+        var txta = document.createElement('textarea');
+        txta.id   = ta;
+        txta.name = ta;
+        txta.value = lipsum;
+        txta.style.width="100%";
+        txta.style.height="420px";
+
+        div.appendChild(txta);
+        dest.appendChild(div);
+      }
+
+// Create a default configuration to be used by all the editors.
+      settings = top.frames["menu"].settings;
+      xinha_config = new Xinha.Config();
+      xinha_config.width = settings.width;
+      xinha_config.height = settings.height;
+      xinha_config.sizeIncludesBars = settings.sizeIncludesBars;
+      xinha_config.sizeIncludesPanels = settings.sizeIncludesPanels;
+      xinha_config.statusBar = settings.statusBar;
+      xinha_config.htmlareaPaste = settings.htmlareaPaste;
+      xinha_config.mozParaHandler = settings.mozParaHandler;
+      xinha_config.getHtmlMethod = settings.getHtmlMethod;
+      xinha_config.undoSteps = settings.undoSteps;
+      xinha_config.undoTimeout = settings.undoTimeout;
+      xinha_config.changeJustifyWithDirection = settings.changeJustifyWithDirection;
+      xinha_config.fullPage = settings.fullPage;
+      xinha_config.pageStyle = settings.pageStyle;
+      xinha_config.baseHref = settings.baseHref;
+      xinha_config.expandRelativeUrl = settings.expandRelativeUrl;
+      xinha_config.stripBaseHref = settings.stripBaseHref;
+      xinha_config.stripSelfNamedAnchors = settings.stripSelfNamedAnchors;
+      xinha_config.only7BitPrintablesInURLs = settings.only7BitPrintablesInURLs;
+      xinha_config.sevenBitClean = settings.sevenBitClean;
+      xinha_config.killWordOnPaste = settings.killWordOnPaste;
+      xinha_config.makeLinkShowsTarget = settings.makeLinkShowsTarget;
+      xinha_config.flowToolbars = settings.flowToolbars;
+      xinha_config.stripScripts = settings.stripScripts;
+      xinha_config.flowToolbars = settings.flowToolbars;
+      xinha_config.showLoading = settings.showLoading;
+      xinha_config.pageStyleSheets = ["own.css"];
+
+// Create a default configuration for the plugins
+      if (typeof CharCounter != 'undefined') {
+        xinha_config.CharCounter.showChar = settings.showChar;
+        xinha_config.CharCounter.showWord = settings.showWord;
+        xinha_config.CharCounter.showHtml = settings.showHtml;
+      }
+
+      if(typeof CharacterMap != 'undefined') xinha_config.CharacterMap.mode = settings.CharacterMapMode;
+      if(typeof ListType != 'undefined') xinha_config.ListType.mode = settings.ListTypeMode;
+      if(typeof CSS != 'undefined') xinha_config.pageStyle = xinha_config.pageStyle + "\n" + "@import url(custom.css);";
+      if(typeof DynamicCSS != 'undefined') xinha_config.pageStyle = "@import url(dynamic.css);";
+      if(typeof Filter != 'undefined') xinha_config.Filters = ["Word", "Paragraph"];
+
+      if(typeof Stylist != 'undefined') {
+        // We can load an external stylesheet like this - NOTE : YOU MUST GIVE AN ABSOLUTE URL
+        //  otherwise it won't work!
+        xinha_config.stylistLoadStylesheet(document.location.href.replace(/[^\/]*\.html/, 'stylist.css'));
+
+        // Or we can load styles directly
+        xinha_config.stylistLoadStyles('p.red_text { color:red }');
+
+        // If you want to provide "friendly" names you can do so like
+        // (you can do this for stylistLoadStylesheet as well)
+        xinha_config.stylistLoadStyles('p.pink_text { color:pink }', {'p.pink_text' : 'Pretty Pink'});
+      }
+
+      if(typeof InsertWords != 'undefined') {
+        // Register the keyword/replacement list
+        var keywrds1 = new Object();
+        var keywrds2 = new Object();
+
+        keywrds1['-- Dropdown Label --'] = '';
+        keywrds1['onekey'] = 'onevalue';
+        keywrds1['twokey'] = 'twovalue';
+        keywrds1['threekey'] = 'threevalue';
+
+        keywrds2['-- Insert Keyword --'] = '';
+        keywrds2['Username'] = '%user%';
+        keywrds2['Last login date'] = '%last_login%';
+        xinha_config.InsertWords = {
+          combos : [ { options: keywrds1, context: "body" },
+                     { options: keywrds2, context: "li" } ]
+        }
+      }
+
+// First create editors for the textareas.
+// You can do this in two ways, either
+//   xinha_editors   = Xinha.makeEditors(xinha_editors, xinha_config, xinha_plugins);
+// if you want all the editor objects to use the same set of plugins, OR;
+//   xinha_editors = Xinha.makeEditors(xinha_editors, xinha_config);
+//   xinha_editors['myTextarea0'].registerPlugins(['Stylist']);
+//   xinha_editors['myTextarea1'].registerPlugins(['CSS','SuperClean']);
+// if you want to use a different set of plugins for one or more of the editors.
+      xinha_editors = Xinha.makeEditors(xinha_editors, xinha_config, xinha_plugins);
+
+// If you want to change the configuration variables of any of the editors,
+// this is the place to do that, for example you might want to
+// change the width and height of one of the editors, like this...
+//   xinha_editors['myTextarea0'].config.width  = '640px';
+//   xinha_editors['myTextarea0'].config.height = '480px';
+
+// Finally we "start" the editors, this turns the textareas into Xinha editors.
+      Xinha.startEditors(xinha_editors);
+    }
+
+// javascript submit handler
+// this shows how to create a javascript submit button that works with the htmleditor.
+    submitHandler = function(formname) {
+      var form = document.getElementById(formname);
+      // in order for the submit to work both of these methods have to be called.
+      form.onsubmit();
+      window.parent.menu.document.getElementById('myTextarea0').value = document.getElementById('myTextarea0').value;
+      form.submit();
+      return true;
+    }
+
+    window.onload = xinha_init;
+//    window.onunload = Xinha.collectGarbageForIE;
+  </script>
+</head>
+
+<body>
+  <form id="to_submit" name="to_submit" method="post" action="ext_example-dest.php">
+  <div id="editors_here"></div>
+  <button type="button" onclick="submitHandler('to_submit');">Submit</button>
+  <textarea id="errors" name="errors" style="width:100%; height:100px; background:silver;"></textarea><!-- style="display:none;" -->
+  </form>
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/examples/files/ext_example-dest.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/examples/files/ext_example-dest.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,23 @@
+<html>
+<head>
+  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
+  <title>Example of Xinha</title>
+  <link rel="stylesheet" href="full_example.css" />
+</head>
+<body>
+<?php
+if (get_magic_quotes_gpc()) {
+  $_REQUEST = array_map('stripslashes',$_REQUEST);
+}
+// or in php.ini
+//; Magic quotes for incoming GET/POST/Cookie data.
+//magic_quotes_gpc = Off
+  foreach($_REQUEST as $key=>$value){
+    if(substr($key,0,10) == 'myTextarea') {
+      echo '<h3 style="border-bottom:1px solid black;">'.$key.'(source):</h3><xmp style="border:1px solid black; width: 100%; height: 200px; overflow: auto;">'.$value.'</xmp><br/>';
+      echo '<h3 style="border-bottom:1px solid black;">'.$key.'(preview):</h3>'.$value;
+    }
+  }
+?>
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/examples/files/ext_example-menu.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/examples/files/ext_example-menu.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,357 @@
+<?php
+  $LocalPluginPath = dirname(dirname(dirname(__FILE__))).DIRECTORY_SEPARATOR.'plugins';
+  $LocalSkinPath = dirname(dirname(dirname(__File__))).DIRECTORY_SEPARATOR.'skins';
+?>
+<html>
+<head>
+
+  <!--------------------------------------:noTabs=true:tabSize=2:indentSize=2:--
+    --  Xinha example menu.  This file is used by full_example.html within a
+    --  frame to provide a menu for generating example editors using
+    --  full_example-body.html, and full_example.js.
+    --
+    --  $HeadURL:http://svn.xinha.webfactional.com/trunk/examples/files/ext_example-menu.php $
+    --  $LastChangedDate:2008-04-12 23:23:17 +0200 (Sa, 12 Apr 2008) $
+    --  $LastChangedRevision:993 $
+    --  $LastChangedBy:ray $
+    --------------------------------------------------------------------------->
+
+  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
+  <title>Example of Xinha</title>
+  <link rel="stylesheet" href="full_example.css" />
+  <style type="text/css">
+    h1 {font: bold 22px "Staccato222 BT", cursive;}
+    form, p {margin: 0px; padding: 0px;}
+    label { display:block;}
+  </style>
+  <script language="JavaScript" type="text/javascript">
+  var settings = null;
+  settings = {
+    width: "auto",
+    height: "auto",
+    sizeIncludesBars: true,
+    sizeIncludesPanels: true,
+    statusBar: true,
+    htmlareaPaste: false,
+    mozParaHandler: "best",
+    getHtmlMethod: "DOMwalk",
+    undoSteps: 20,
+    undoTimeout: 500,
+    changeJustifyWithDirection: false,
+    fullPage: false,
+    pageStyle: "",
+    baseHref: null,
+    expandRelativeUrl: true,
+    stripBaseHref: true,
+    stripSelfNamedAnchors: true,
+    only7BitPrintablesInURLs: true,
+    sevenBitClean: false,
+    killWordOnPaste: true,
+    makeLinkShowsTarget: true,
+    flowToolbars: true,
+    stripScripts: false,
+    CharacterMapMode: "popup",
+    ListTypeMode: "toolbar",
+    showLoading: false,
+    showChar: true,
+    showWord: true,
+    showHtml: true
+  };
+
+
+    function getCookieVal (offset) {
+      var endstr = document.cookie.indexOf (";", offset);
+      if (endstr == -1)
+        endstr = document.cookie.length;
+      return unescape(document.cookie.substring(offset, endstr));
+    }
+
+    function getCookie (name) {
+      var arg = name + "=";
+      var alen = arg.length;
+      var clen = document.cookie.length;
+      var i = 0;
+      while (i < clen) {
+        var j = i + alen;
+        if (document.cookie.substring(i, j) == arg)
+          return getCookieVal (j);
+        i = document.cookie.indexOf(" ", i) + 1;
+        if (i == 0) break;
+      }
+      return null;
+    }
+
+    function setCookie (name, value) {
+      var argv = setCookie.arguments;
+      var argc = setCookie.arguments.length;
+      var expires = (argc > 2) ? argv[2] : null;
+      var path = (argc > 3) ? argv[3] : null;
+      var domain = (argc > 4) ? argv[4] : null;
+      var secure = (argc > 5) ? argv[5] : false;
+      document.cookie = name + "=" + escape (value) +
+        ((expires == null) ? "" : ("; expires=" + expires.toGMTString())) +
+        ((path == null) ? "" : ("; path=" + path)) +
+        ((domain == null) ? "" : ("; domain=" + domain)) +
+        ((secure == true) ? "; secure" : "");
+    }
+
+  function _onResize() {
+    var sHeight;
+    if (window.innerHeight) sHeight = window.innerHeight;
+    else if (document.body && document.body.offsetHeight) sHeight = document.body.offsetHeight;
+    else return;
+    if (sHeight>270) {
+      sHeight = sHeight - 245;
+    } else {
+      sHeight = 30
+    }
+    var div = document.getElementById("div_plugins");
+    div.style.height = sHeight + "px";
+  }
+
+function Dialog(url, action, init) {
+	if (typeof init == "undefined") {
+		init = window;	// pass this window object by default
+	}
+	if (typeof window.showModalDialog == 'function')
+	{
+		Dialog._return = action;
+		var r = window.showModalDialog(url, init, "dialogheight=10;dialogheight=10;scroll=yes;resizable=yes");
+	}
+	else
+	{
+		Dialog._geckoOpenModal(url, action, init);
+	}
+};
+
+Dialog._parentEvent = function(ev) {
+  setTimeout( function() { if (Dialog._modal && !Dialog._modal.closed) { Dialog._modal.focus() } }, 50);
+  if (Dialog._modal && !Dialog._modal.closed) {
+    agt = navigator.userAgent.toLowerCase();
+    is_ie = ((agt.indexOf("msie") != -1) && (agt.indexOf("opera") == -1));
+    if (is_ie) {
+      ev.cancelBubble = true;
+      ev.returnValue = false;
+    } else {
+      ev.preventDefault();
+      ev.stopPropagation();
+    }
+  }
+};
+
+
+// should be a function, the return handler of the currently opened dialog.
+Dialog._return = null;
+
+// constant, the currently opened dialog
+Dialog._modal = null;
+
+// the dialog will read it's args from this variable
+Dialog._arguments = null;
+
+Dialog._geckoOpenModal = function(url, action, init) {
+  var dlg = window.open(url, "hadialog",
+            "toolbar=no,menubar=no,personalbar=no,width=10,height=10," +
+            "scrollbars=no,resizable=yes,modal=yes,dependable=yes");
+  Dialog._modal = dlg;
+  Dialog._arguments = init;
+
+  // capture some window's events
+  function capwin(w) {
+//		Xinha._addEvent(w, "click", Dialog._parentEvent);
+//		Xinha._addEvent(w, "mousedown", Dialog._parentEvent);
+//		Xinha._addEvent(w, "focus", Dialog._parentEvent);
+  };
+  // release the captured events
+  function relwin(w) {
+//		Xinha._removeEvent(w, "click", Dialog._parentEvent);
+//		Xinha._removeEvent(w, "mousedown", Dialog._parentEvent);
+//		Xinha._removeEvent(w, "focus", Dialog._parentEvent);
+  };
+  capwin(window);
+  // capture other frames
+  for (var i = 0; i < window.frames.length; capwin(window.frames[i++]));
+  // make up a function to be called when the Dialog ends.
+  Dialog._return = function (val) {
+    if (val && action) {
+      action(val);
+    }
+    relwin(window);
+    // capture other frames
+    for (var i = 0; i < window.frames.length; relwin(window.frames[i++]));
+    Dialog._modal = null;
+  };
+};
+
+  function fExtended () {
+    Dialog("Extended.html", function(param) {
+      if(param) {
+        settings.width = param["width"];
+        settings.height = param["height"];
+        settings.sizeIncludesBars = (param["sizeIncludesBars"]=="true");
+        settings.sizeIncludesPanels = (param["sizeIncludesPanels"]=="true");
+        settings.statusBar = (param["statusBar"]=="true");
+        settings.htmlareaPaste = (param["htmlareaPaste"]=="true");
+        settings.mozParaHandler = param["mozParaHandler"];
+        settings.getHtmlMethod = param["getHtmlMethod"];
+        settings.undoSteps = param["undoSteps"];
+        settings.undoTimeout = param["undoTimeout"];
+        settings.changeJustifyWithDirection = (param["changeJustifyWithDirection"]=="true");
+        settings.fullPage = (param["fullPage"]=="true");
+        settings.pageStyle = param["pageStyle"];
+        settings.baseHref = param["baseHref"];
+        settings.expandRelativeUrl = (param["expandRelativeUrl"]=="true");
+        settings.stripBaseHref = (param["stripBaseHref"]=="true");
+        settings.stripSelfNamedAnchors = (param["stripSelfNamedAnchors"]=="true");
+        settings.only7BitPrintablesInURLs = (param["only7BitPrintablesInURLs"]=="true");
+        settings.sevenBitClean = (param["sevenBitClean"]=="true");
+        settings.killWordOnPaste = (param["killWordOnPaste"]=="true");
+        settings.makeLinkShowsTarget = (param["makeLinkShowsTarget"]=="true");
+        settings.flowToolbars = (param["flowToolbars"]=="true");
+        settings.stripScripts = (param["stripScripts"]=="true");
+        settings.CharacterMapMode = param["CharacterMapMode"];
+        settings.ListTypeMode = param["ListTypeMode"];
+        settings.showLoading = (param["showLoading"]=="true");
+        settings.showChar = (param["showChar"]=="true");
+        settings.showWord = (param["showWord"]=="true");
+        settings.showHtml = (param["showHtml"]=="true");
+      }
+    }, settings );
+  }
+
+  function init(){
+    var co = getCookie('co_ext_Xinha');
+    if(co!=null){
+      var co_values;
+      var co_entries = co.split('###');
+      for (var i in co_entries) {
+        co_values = co_entries[i].split('=');
+        if(co_values[0]=='plugins') {
+          for(var x = 0; x < document.forms[0].plugins.length; x++) {
+            if(co_values[1].indexOf(document.forms[0].plugins[x].value)!=-1) {
+              document.forms[0].plugins[x].checked = true;
+            }
+          }
+        } else if(co_values[0]!='') {
+          document.getElementById(co_values[0]).value = co_values[1];
+        }
+      }
+    }
+    _onResize();
+  };
+
+  window.onresize = _onResize;
+  window.onload = init;
+  </script>
+</head>
+
+<body>
+  <form action="ext_example-body.html" target="body" name="fsettings" id="fsettings">
+  <h1>Xinha Example</h1>
+    <fieldset>
+      <legend>Settings</legend>
+        <label>
+          Number of Editors: <input type="text" name="num" id="num" value="1" style="width:25;" maxlength="2"/>
+        </label>
+        <label>
+          Language:
+          <select name="lang" id="lang">
+          <option value="en">English</option>
+          <option value="de">German</option>
+          <option value="fr">French</option>
+          <option value="it">Italian</option>
+          <option value="no">Norwegian</option>
+          <option value="pl">Polish</option>
+          <option value="ja">Japanese</option>
+          </select>
+        </label>
+        <label>
+          Skin:
+          <select name="skin" id="skin">
+          <option value="">-- no skin --</option>
+<?php
+  $d = @dir($LocalSkinPath);
+  while (false !== ($entry = $d->read()))  //not a dot file or directory
+  { if(substr($entry,0,1) != '.')
+    { echo '<option value="' . $entry . '"> ' . $entry . '</option>'."\n";
+    }
+  }
+  $d->close();
+?>
+          </select>
+        </label>
+        <center><input type="button" value="extended Settings" onClick="fExtended();" /></center>
+
+    </fieldset>
+    <fieldset>
+      <legend>Plugins</legend>
+      <div id="div_plugins" style="width:100%; overflow:auto">
+<?php
+  $d = @dir($LocalPluginPath);
+  $dir_array = array();
+  while (false !== ($entry = $d->read()))  //not a dot file or directory
+  { if(substr($entry,0,1) != '.')
+    { $dir_array[] = $entry;
+    }
+  }
+  $d->close();
+  sort($dir_array);
+  foreach ($dir_array as $entry)
+  { echo '<label><input type="checkbox" name="plugins" id="plugins" value="' . $entry . '"> ' . $entry . '</label>'."\n";
+  }
+
+?>
+      </div>
+    </fieldset>
+    <center><button type="submit">reload editor</button></center>
+
+        <textarea id="myTextarea0" style="display:none">
+          <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.
+          Aliquam et tellus vitae justo varius placerat. Suspendisse iaculis
+          velit semper dolor. Donec gravida tincidunt mi. Curabitur tristique
+          ante elementum turpis. Aliquam nisl. Nulla posuere neque non
+          tellus. Morbi vel nibh. Cum sociis natoque penatibus et magnis dis
+          parturient montes, nascetur ridiculus mus. Nam nec wisi. In wisi.
+          Curabitur pharetra bibendum lectus.</p>
+
+          <ul>
+            <li> Phasellus et massa sed diam viverra semper.  </li>
+            <li> Mauris tincidunt felis in odio.              </li>
+            <li> Nulla placerat nunc ut pede.                 </li>
+            <li> Vivamus ultrices mi sit amet urna.           </li>
+            <li> Quisque sed augue quis nunc laoreet volutpat.</li>
+            <li> Nunc sit amet metus in tortor semper mattis. </li>
+          </ul>
+        </textarea>
+
+  </form>
+  <script type="text/javascript">
+    top.frames["body"].location.href = document.location.href.replace(/ext_example-menu\.php.*/, 'ext_example-body.html')
+    var _oldSubmitHandler = null;
+    if (document.forms[0].onsubmit != null) {
+      _oldSubmitHandler = document.forms[0].onsubmit;
+    }
+    function frame_onSubmit(){
+      var thenewdate = new Date ();
+      thenewdate.setTime(thenewdate.getTime() + (5*24*60*60*1000));
+      var co_value = 'skin=' + document.getElementById('skin').options[document.getElementById('skin').selectedIndex].value + '###' +
+                     'lang=' + document.getElementById('lang').options[document.getElementById('lang').selectedIndex].value + '###' +
+                     'num=' + document.getElementById('num').value + '###';
+      var s_value='';
+      for(var x = 0; x < document.forms[0].plugins.length; x++) {
+        if(document.forms[0].plugins[x].checked)
+          s_value += document.forms[0].plugins[x].value + '/';
+      }
+      if(s_value!='') {
+        co_value += 'plugins=' + s_value + '###'
+      }
+      setCookie('co_ext_Xinha', co_value, thenewdate);
+      if (_oldSubmitHandler != null) {
+        _oldSubmitHandler();
+      }
+    }
+    document.forms[0].onsubmit = frame_onSubmit;
+  </script>
+
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/examples/files/full_example.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/examples/files/full_example.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,48 @@
+   /*--------------------------------------:noTabs=true:tabSize=2:indentSize=2:--
+    --  Xinha example CSS file.  This is ripped from Trac ;)
+    --
+    --  $HeadURL:http://svn.xinha.webfactional.com/trunk/examples/files/full_example.css $
+    --  $LastChangedDate:2008-02-04 01:43:21 +0100 (Mo, 04 Feb 2008) $
+    --  $LastChangedRevision:962 $
+    --  $LastChangedBy:ray $
+    --------------------------------------------------------------------------*/
+
+ body {
+   background: #fff;
+   color: #000;
+   margin: 10px;
+  }
+  body, th, td {
+   font: normal 13px verdana,arial,'Bitstream Vera Sans',helvetica,sans-serif;
+  }
+  h1, h2, h3, h4 {
+   font-family: arial,verdana,'Bitstream Vera Sans',helvetica,sans-serif;
+   font-weight: bold;
+   letter-spacing: -0.018em;
+  }
+  h1 { font-size: 21px; margin: .15em 1em 0 0 }
+  h2 { font-size: 16px; margin: 2em 0 .5em; }
+  h3 { font-size: 14px; margin: 1.5em 0 .5em; }
+  hr { border: none;  border-top: 1px solid #ccb; margin: 2em 0; }
+  address { font-style: normal }
+  img { border: none }
+
+  :link, :visited {
+   text-decoration: none;
+   color: #b00;
+   border-bottom: 1px dotted #bbb;
+  }
+  :link:hover, :visited:hover {
+   background-color: #eee;
+   color: #555;
+  }
+  h1 :link, h1 :visited ,h2 :link, h2 :visited, h3 :link, h3 :visited,
+  h4 :link, h4 :visited, h5 :link, h5 :visited, h6 :link, h6 :visited {
+   color: inherit;
+  }
+
+  .area_holder
+  {
+    margin:10px;
+  }
+  label {font-size: 11px;}
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/examples/files/stylist.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/examples/files/stylist.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,31 @@
+  /*--------------------------------------:noTabs=true:tabSize=2:indentSize=2:--
+    --  Stylist plugin example CSS file.  Used by full_example.js
+    --  when the Stylist plugin is included in an auto-generated example.
+    --
+    --  $HeadURL:http://svn.xinha.webfactional.com/trunk/examples/files/stylist.css $
+    --  $LastChangedDate:2008-02-04 01:43:21 +0100 (Mo, 04 Feb 2008) $
+    --  $LastChangedRevision:962 $
+    --  $LastChangedBy:ray $
+    --------------------------------------------------------------------------*/
+
+.bluetext
+{
+  color:blue;
+}
+
+p.blue_paragraph
+{
+  color:darkblue;
+}
+
+li.green_list_item
+{
+  color:green;
+}
+
+h1.webdings_lvl_1
+{
+  font-family:webdings;
+}
+
+img.polaroid { border:1px solid black; background-color:white; padding:10px; padding-bottom:30px; }
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/examples/simple_example.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/examples/simple_example.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,56 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
+<html>
+<head>
+<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
+<title>Simple example of Xinha</title>
+<script type="text/javascript">
+var _editor_url  = document.location.href.replace(/examples\/simple_example\.html.*/, '')
+var _editor_lang = "en";
+var _editor_skin = "blue-metallic";
+</script>
+<!-- Load up the actual editor core -->
+<script type="text/javascript" src="../XinhaCore.js"></script>
+<script type="text/javascript">
+
+var xinha_plugins =
+[
+ 'Linker',
+ 'SpellChecker'
+];
+var xinha_editors =
+[
+  'myTextArea',
+  'anotherOne'
+];
+
+function xinha_init()
+{
+  if(!Xinha.loadPlugins(xinha_plugins, xinha_init)) return;
+
+  var xinha_config = new Xinha.Config();
+
+  xinha_editors = Xinha.makeEditors(xinha_editors, xinha_config, xinha_plugins);
+
+  Xinha.startEditors(xinha_editors);
+}
+Xinha.addOnloadHandler(xinha_init);
+</script>
+
+</head>
+
+<body>
+
+<form onsubmit="alert(this.myTextArea.value); return false;">
+<textarea id="myTextArea" name="myTextArea" rows="25" cols="80">
+&lt;p&gt;Lorem ipsum dolor sit amet, consectetuer adipiscing elit.
+Aliquam et tellus vitae justo varius placerat. Suspendisse iaculis
+velit semper dolor. Donec gravida tincidunt mi. Curabitur tristique
+ante elementum turpis. Aliquam nisl. Nulla posuere neque non
+tellus. Morbi vel nibh. Cum sociis natoque penatibus et magnis dis
+parturient montes, nascetur ridiculus mus. Nam nec wisi. In wisi.
+Curabitur pharetra bibendum lectus.&lt;/p&gt;
+</textarea>
+<input type="submit" /> <input type="reset" />
+</form>
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/examples/testbed.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/examples/testbed.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,195 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!DOCTYPE html
+     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
+    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
+<head>
+
+  <!--------------------------------------:noTabs=true:tabSize=2:indentSize=2:--
+    --  Xinha example usage.  This file shows how a developer might make use of
+    --  Xinha, it forms the primary example file for the entire Xinha project.
+    --  This file can be copied and used as a template for development by the
+    --  end developer who should simply removed the area indicated at the bottom
+    --  of the file to remove the auto-example-generating code and allow for the
+    --  use of the file as a boilerplate.
+    --
+    --  $HeadURL:http://svn.xinha.webfactional.com/trunk/examples/testbed.html $
+    --  $LastChangedDate:2008-04-12 14:39:04 +0200 (Sa, 12 Apr 2008) $
+    --  $LastChangedRevision:987 $
+    --  $LastChangedBy:ray $
+    --------------------------------------------------------------------------->
+
+  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
+  <title>Example of Xinha</title>
+  <link rel="stylesheet" href="full_example.css" />
+
+  <script type="text/javascript">
+    // You must set _editor_url to the URL (including trailing slash) where
+    // where xinha is installed, it's highly recommended to use an absolute URL
+    //  eg: _editor_url = "/path/to/xinha/";
+    // You may try a relative URL if you wish]
+    //  eg: _editor_url = "../";
+    // in this example we do a little regular expression to find the absolute path.
+    _editor_url  = document.location.href.replace(/examples\/.*/, '')
+    _editor_lang = "en";      // And the language we need to use in the editor.
+  </script>
+
+  <!-- Load up the actual editor core -->
+  <script type="text/javascript" src="../XinhaCore.js"></script>
+
+  <script type="text/javascript">
+    xinha_editors = null;
+    xinha_init    = null;
+    xinha_config  = null;
+    xinha_plugins = null;
+
+    // This contains the names of textareas we will make into Xinha editors
+    xinha_init = xinha_init ? xinha_init : function()
+    {
+      /** STEP 1 ***************************************************************
+       * First, what are the plugins you will be using in the editors on this
+       * page.  List all the plugins you will need, even if not all the editors
+       * will use all the plugins.
+       ************************************************************************/
+
+      xinha_plugins = xinha_plugins ? xinha_plugins :
+      [
+        'CharacterMap', 'SpellChecker', 'Linker'
+      ];
+             // THIS BIT OF JAVASCRIPT LOADS THE PLUGINS, NO TOUCHING  :)
+             if(!Xinha.loadPlugins(xinha_plugins, xinha_init)) return;
+
+      /** STEP 2 ***************************************************************
+       * Now, what are the names of the textareas you will be turning into
+       * editors?
+       ************************************************************************/
+
+      xinha_editors = xinha_editors ? xinha_editors :
+      [
+        'myTextArea'
+      ];
+
+      /** STEP 3 ***************************************************************
+       * We create a default configuration to be used by all the editors.
+       * If you wish to configure some of the editors differently this will be
+       * done in step 4.
+       *
+       * If you want to modify the default config you might do something like this.
+       *
+       *   xinha_config = new Xinha.Config();
+       *   xinha_config.width  = 640;
+       *   xinha_config.height = 420;
+       *
+       *************************************************************************/
+
+       xinha_config = xinha_config ? xinha_config : new Xinha.Config();
+       xinha_config.fullPage = true;
+       xinha_config.CharacterMap.mode = 'panel';
+/*
+       // We can load an external stylesheet like this - NOTE : YOU MUST GIVE AN ABSOLUTE URL
+      //  otherwise it won't work!
+      xinha_config.stylistLoadStylesheet(document.location.href.replace(/[^\/]*\.html/, 'stylist.css'));
+
+      // Or we can load styles directly
+      xinha_config.stylistLoadStyles('p.red_text { color:red }');
+
+      // If you want to provide "friendly" names you can do so like
+      // (you can do this for stylistLoadStylesheet as well)
+      xinha_config.stylistLoadStyles('p.pink_text { color:pink }', {'p.pink_text' : 'Pretty Pink'});
+*/
+      /** STEP 3 ***************************************************************
+       * We first create editors for the textareas.
+       *
+       * You can do this in two ways, either
+       *
+       *   xinha_editors   = Xinha.makeEditors(xinha_editors, xinha_config, xinha_plugins);
+       *
+       * if you want all the editor objects to use the same set of plugins, OR;
+       *
+       *   xinha_editors = Xinha.makeEditors(xinha_editors, xinha_config);
+       *   xinha_editors['myTextArea'].registerPlugins(['Stylist']);
+       *   xinha_editors['anotherOne'].registerPlugins(['CSS','SuperClean']);
+       *
+       * if you want to use a different set of plugins for one or more of the
+       * editors.
+       ************************************************************************/
+
+      xinha_editors   = Xinha.makeEditors(xinha_editors, xinha_config, xinha_plugins);
+
+      /** STEP 4 ***************************************************************
+       * If you want to change the configuration variables of any of the
+       * editors,  this is the place to do that, for example you might want to
+       * change the width and height of one of the editors, like this...
+       *
+       *   xinha_editors.myTextArea.config.width  = 640;
+       *   xinha_editors.myTextArea.config.height = 480;
+       *
+       ************************************************************************/
+
+
+      /** STEP 5 ***************************************************************
+       * Finally we "start" the editors, this turns the textareas into
+       * Xinha editors.
+       ************************************************************************/
+
+      Xinha.startEditors(xinha_editors);
+      window.onload = null;
+    }
+
+    window.onload   = xinha_init;
+  </script>
+</head>
+
+<body>
+
+  <form action="javascript:void(0);" id="editors_here" onsubmit="alert(this.myTextArea.value);">
+ <div>
+     <textarea id="myTextArea" name="myTextArea" style="width:100%;height:320px;">
+      &lt;html&gt;
+      &lt;head&gt;
+        &lt;title&gt;Hello&lt;/title&gt;
+        &lt;style type="text/css"&gt;
+          li { color:red; }
+        &lt;/style&gt;
+      &lt;/head&gt;
+      &lt;body&gt;&lt;span style="color:purple"&gt;
+      &lt;img src="../images/xinha_logo.gif" usemap="#m1"&gt;
+      &lt;map name="m1"&gt;
+      &lt;area shape="rect" coords="137,101,255,124" href="http://www.mydomain.com"&gt;
+      &lt;/map&gt;
+
+      &lt;p&gt;
+        Lorem ipsum dolor sit amet, consectetuer adipiscing elit.
+        Aliquam et tellus vitae justo varius placerat. Suspendisse iaculis
+        velit semper dolor. Donec gravida tincidunt mi. Curabitur tristique
+        ante elementum turpis.  &lt;span style="color:green"&gt;Aliquam &lt;/span&gt; nisl. Nulla posuere neque non
+        tellus. Morbi vel nibh. &lt;font face="Arial"&gt;&lt;font color="#009933"&gt;Cum  sociis natoque&lt;/font&gt;&lt;/font&gt; penatibus et magnis dis
+        parturient montes, nascetur ridiculus mus. Nam nec wisi. In wisi.
+        Curabitur pharetra bibendum lectus.
+      &lt;/p&gt;
+
+      &lt;ul&gt;
+        &lt;li style="color:green"&gt; Phasellus et massa sed diam viverra semper.  &lt;/li&gt;
+        &lt;li&gt; Mauris tincidunt felis in odio.              &lt;/li&gt;
+        &lt;li&gt; Nulla placerat nunc ut pede.                 &lt;/li&gt;
+        &lt;li&gt; Vivamus ultrices mi sit amet urna.           &lt;/li&gt;
+        &lt;li&gt; Quisque sed augue quis nunc laoreet volutpat.&lt;/li&gt;
+        &lt;li&gt; Nunc sit amet metus in tortor semper mattis. &lt;/li&gt;
+      &lt;/ul&gt;
+      &lt;/span&gt;&lt;/body&gt;
+      &lt;/html&gt;
+    </textarea>
+
+    <input type="submit" /> <input type="reset" />
+</div>
+  </form>
+  <script type="text/javascript">
+    document.write(document.compatMode);
+  </script>
+<div>
+  <a href="#" onclick="xinha_editors.myTextArea.hidePanels();">Hide</a>
+  <a href="#" onclick="xinha_editors.myTextArea.showPanels();">Show</a>
+</div>
+
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/htmlarea.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/htmlarea.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,11 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/htmlarea.js */
+if(typeof _editor_url=="string"){
+_editor_url=_editor_url.replace(/\x2f*$/,"/");
+}else{
+alert("WARNING: _editor_url is not set!  You should set this variable to the editor files path; it should preferably be an absolute path, like in '/htmlarea/', but it can be relative if you prefer.  Further we will try to load the editor files correctly but we'll probably fail.");
+_editor_url="";
+}
+document.write("<script type=\"text/javascript\" src=\""+_editor_url+"XinhaCore.js\"></script>");
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/de/bold.gif
Binary file Xinha_0.95/images/de/bold.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/de/italic.gif
Binary file Xinha_0.95/images/de/italic.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/de/underline.gif
Binary file Xinha_0.95/images/de/underline.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_about.gif
Binary file Xinha_0.95/images/ed_about.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_align.gif
Binary file Xinha_0.95/images/ed_align.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_align_center.gif
Binary file Xinha_0.95/images/ed_align_center.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_align_justify.gif
Binary file Xinha_0.95/images/ed_align_justify.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_align_left.gif
Binary file Xinha_0.95/images/ed_align_left.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_align_right.gif
Binary file Xinha_0.95/images/ed_align_right.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_blank.gif
Binary file Xinha_0.95/images/ed_blank.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_buttons_main.gif
Binary file Xinha_0.95/images/ed_buttons_main.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_charmap.gif
Binary file Xinha_0.95/images/ed_charmap.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_clearfonts.gif
Binary file Xinha_0.95/images/ed_clearfonts.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_color_bg.gif
Binary file Xinha_0.95/images/ed_color_bg.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_color_fg.gif
Binary file Xinha_0.95/images/ed_color_fg.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_copy.gif
Binary file Xinha_0.95/images/ed_copy.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_custom.gif
Binary file Xinha_0.95/images/ed_custom.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_cut.gif
Binary file Xinha_0.95/images/ed_cut.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_delete.gif
Binary file Xinha_0.95/images/ed_delete.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_format_bold.gif
Binary file Xinha_0.95/images/ed_format_bold.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_format_italic.gif
Binary file Xinha_0.95/images/ed_format_italic.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_format_strike.gif
Binary file Xinha_0.95/images/ed_format_strike.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_format_sub.gif
Binary file Xinha_0.95/images/ed_format_sub.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_format_sup.gif
Binary file Xinha_0.95/images/ed_format_sup.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_format_underline.gif
Binary file Xinha_0.95/images/ed_format_underline.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_help.gif
Binary file Xinha_0.95/images/ed_help.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_hr.gif
Binary file Xinha_0.95/images/ed_hr.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_html.gif
Binary file Xinha_0.95/images/ed_html.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_image.gif
Binary file Xinha_0.95/images/ed_image.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_indent_less.gif
Binary file Xinha_0.95/images/ed_indent_less.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_indent_more.gif
Binary file Xinha_0.95/images/ed_indent_more.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_killword.gif
Binary file Xinha_0.95/images/ed_killword.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_left_to_right.gif
Binary file Xinha_0.95/images/ed_left_to_right.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_link.gif
Binary file Xinha_0.95/images/ed_link.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_list_bullet.gif
Binary file Xinha_0.95/images/ed_list_bullet.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_list_num.gif
Binary file Xinha_0.95/images/ed_list_num.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_overwrite.gif
Binary file Xinha_0.95/images/ed_overwrite.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_paste.gif
Binary file Xinha_0.95/images/ed_paste.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_print.gif
Binary file Xinha_0.95/images/ed_print.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_redo.gif
Binary file Xinha_0.95/images/ed_redo.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_right_to_left.gif
Binary file Xinha_0.95/images/ed_right_to_left.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_rmformat.gif
Binary file Xinha_0.95/images/ed_rmformat.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_save.gif
Binary file Xinha_0.95/images/ed_save.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_save.png
Binary file Xinha_0.95/images/ed_save.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_saveas.gif
Binary file Xinha_0.95/images/ed_saveas.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_selectall.gif
Binary file Xinha_0.95/images/ed_selectall.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_show_border.gif
Binary file Xinha_0.95/images/ed_show_border.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_splitblock.gif
Binary file Xinha_0.95/images/ed_splitblock.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_splitcel.gif
Binary file Xinha_0.95/images/ed_splitcel.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_undo.gif
Binary file Xinha_0.95/images/ed_undo.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/ed_word_cleaner.gif
Binary file Xinha_0.95/images/ed_word_cleaner.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/fr/bold.gif
Binary file Xinha_0.95/images/fr/bold.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/fr/strikethrough.gif
Binary file Xinha_0.95/images/fr/strikethrough.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/fr/underline.gif
Binary file Xinha_0.95/images/fr/underline.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/fullscreen_maximize.gif
Binary file Xinha_0.95/images/fullscreen_maximize.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/fullscreen_minimize.gif
Binary file Xinha_0.95/images/fullscreen_minimize.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/insert_table.gif
Binary file Xinha_0.95/images/insert_table.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/insertfilelink.gif
Binary file Xinha_0.95/images/insertfilelink.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/insertmacro.png
Binary file Xinha_0.95/images/insertmacro.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/tidy.gif
Binary file Xinha_0.95/images/tidy.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/toggle_borders.gif
Binary file Xinha_0.95/images/toggle_borders.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/images/xinha_logo.gif
Binary file Xinha_0.95/images/xinha_logo.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/b5.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/b5.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,29 @@
+// I18N constants -- UTF-8
+// by Dave Lo -- dlo@interactivetools.com
+{
+  "Bold": "",
+  "Italic": "",
+  "Underline": "",
+  "Strikethrough": "",
+  "Subscript": "",
+  "Superscript": "",
+  "Justify Left": "",
+  "Justify Center": "",
+  "Justify Right": "",
+  "Justify Full": "",
+  "Ordered List": "",
+  "Bulleted List": "",
+  "Decrease Indent": "",
+  "Increase Indent": "",
+  "Font Color": "",
+  "Background Color": "",
+  "Horizontal Rule": "",
+  "Insert Web Link": "",
+  "Insert/Modify Image": "",
+  "Insert Table": "",
+  "Toggle HTML Source": "HTML",
+  "Enlarge Editor": "",
+  "About this editor": " Xinha",
+  "Help using editor": "",
+  "Current style": ""
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/ch.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/ch.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,56 @@
+// I18N constants
+
+// LANG: "ch", ENCODING: UTF-8
+// Samuel Stone, http://stonemicro.com/
+
+{
+  "Bold": "",
+  "Italic": "",
+  "Underline": "",
+  "Strikethrough": "",
+  "Subscript": "",
+  "Superscript": "",
+  "Justify Left": "",
+  "Justify Center": "",
+  "Justify Right": "",
+  "Justify Full": "",
+  "Ordered List": "",
+  "Bulleted List": "",
+  "Decrease Indent": "",
+  "Increase Indent": "",
+  "Font Color": "",
+  "Background Color": "",
+  "Horizontal Rule": "",
+  "Insert Web Link": "",
+  "Insert/Modify Image": "",
+  "Insert Table": "",
+  "Toggle HTML Source": "HTML",
+  "Enlarge Editor": "",
+  "About this editor": " Xinha",
+  "Help using editor": "",
+  "Current style": "",
+  "Undoes your last action": "",
+  "Redoes your last action": "",
+  "Cut selection": "",
+  "Copy selection": "",
+  "Paste from clipboard": "",
+  "Direction left to right": "",
+  "Direction right to left": "",
+  "OK": "",
+  "Cancel": "",
+  "Path": "",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": ".   [<>]   .",
+  "The full screen mode is known to cause problems with Internet Explorer, due to browser bugs that we weren": "Internet Explorer ,  Internet Explorer .    .",
+  "The Paste button does not work in Mozilla based web browsers (technical security reasons). Press CTRL-V on your keyboard to paste directly.": "The Paste button does not work in Mozilla based web browsers (technical security reasons). Press CTRL-V on your keyboard to paste directly.",
+  "Cancel": "",
+  "Insert/Modify Link": "/",
+  "New window (_blank)": "(_blank)",
+  "None (use implicit)": "(use implicit)",
+  "Other": "",
+  "Same frame (_self)": " (_self)",
+  "Target:": ":",
+  "Title (tooltip):": " (tooltip):",
+  "Top frame (_top)": " (_top)",
+  "URL:": ":",
+  "You must enter the URL where this link points to": ""
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/cz.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/cz.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,50 @@
+// I18N constants
+
+// LANG: "cz", ENCODING: UTF-8
+// Author: Jiri Lw, <jirilow@jirilow.com>
+
+// FOR TRANSLATORS:
+//
+//   1. PLEASE PUT YOUR CONTACT INFO IN THE ABOVE LINE
+//      (at least a valid email address)
+//
+//   2. PLEASE TRY TO USE UTF-8 FOR ENCODING;
+//      (if this is not possible, please include a comment
+//       that states what encoding is necessary.)
+
+{
+  "Bold": "Tun",
+  "Italic": "Kurzva",
+  "Underline": "Podtren",
+  "Strikethrough": "Pekrtnut",
+  "Subscript": "Doln index",
+  "Superscript": "Horn index",
+  "Justify Left": "Zarovnat doleva",
+  "Justify Center": "Na sted",
+  "Justify Right": "Zarovnat doprava",
+  "Justify Full": "Zarovnat do stran",
+  "Ordered List": "Seznam",
+  "Bulleted List": "Odrky",
+  "Decrease Indent": "Pedsadit",
+  "Increase Indent": "Odsadit",
+  "Font Color": "Barva psma",
+  "Background Color": "Barva pozad",
+  "Horizontal Rule": "Vodorovn ra",
+  "Insert Web Link": "Vloit odkaz",
+  "Insert/Modify Image": "Vloit obrzek",
+  "Insert Table": "Vloit tabulku",
+  "Toggle HTML Source": "Pepnout HTML",
+  "Enlarge Editor": "Nov okno editoru",
+  "About this editor": "O tto aplikaci",
+  "Help using editor": "Npovda aplikace",
+  "Current style": "Zvolen styl",
+  "Undoes your last action": "Vrt posledn akci",
+  "Redoes your last action": "Opakuje posledn akci",
+  "Cut selection": "Vyjmout",
+  "Copy selection": "Koprovat",
+  "Paste from clipboard": "Vloit",
+  "OK": "OK",
+  "Cancel": "Zruit",
+  "Path": "Cesta",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "Jste v TEXTOVM REIMU.  Pouijte tlatko [<>] pro pepnut do WYSIWIG."
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/da.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/da.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,30 @@
+// LANG: "da", ENCODING: UTF-8
+// Author: rene, <rene@laerke.net>
+
+{
+  "Bold": "Fed",
+  "Italic": "Kursiv",
+  "Underline": "Understregning",
+  "Strikethrough": "Overstregning ",
+  "Subscript": "Snket skrift",
+  "Superscript": "Hvet skrift",
+  "Justify Left": "Venstrejuster",
+  "Justify Center": "Centrer",
+  "Justify Right": "Hjrejuster",
+  "Justify Full": "Lige margener",
+  "Ordered List": "Opstilling med tal",
+  "Bulleted List": "Opstilling med punkttegn",
+  "Decrease Indent": "Formindsk indrykning",
+  "Increase Indent": "Forg indrykning",
+  "Font Color": "Skriftfarve",
+  "Background Color": "Baggrundsfarve",
+  "Horizontal Rule": "Horisontal linie",
+  "Insert Web Link": "Indst hyperlink",
+  "Insert/Modify Image": "Indst billede",
+  "Insert Table": "Indst tabel",
+  "Toggle HTML Source": "HTML visning",
+  "Enlarge Editor": "Vis editor i popup",
+  "About this editor": "Om htmlarea",
+  "Help using editor": "Hjlp",
+  "Current style": "Anvendt stil"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/de.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/de.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,169 @@
+// I18N constants
+// LANG: "de", ENCODING: UTF-8
+{
+  "Bold": "Fett",
+  "Italic": "Kursiv",
+  "Underline": "Unterstrichen",
+  "Strikethrough": "Durchgestrichen",
+  "Subscript": "Tiefgestellt",
+  "Superscript": "Hochgestellt",
+  "Justify Left": "Linksbndig",
+  "Justify Center": "Zentriert",
+  "Justify Right": "Rechtsbndig",
+  "Justify Full": "Blocksatz",
+  "Ordered List": "Nummerierte Liste",
+  "Bulleted List": "Aufzhlungsliste",
+  "Decrease Indent": "Einzug verkleinern",
+  "Increase Indent": "Einzug vergrern",
+  "Font Color": "Schriftfarbe",
+  "Background Color": "Hindergrundfarbe",
+  "Horizontal Rule": "Horizontale Linie",
+  "Insert Web Link": "Hyperlink einfgen",
+  "Insert/Modify Image": "Bild einfgen/verndern",
+  "Insert Table": "Tabelle einfgen",
+  "Toggle HTML Source": "HTML Quelltext ein/ausschalten",
+  "Enlarge Editor": "Editor vergrern",
+  "About this editor": "ber diesen Editor",
+  "Help using editor": "Hilfe",
+  "Current style": "Derzeitiger Stil",
+  "Undoes your last action": "Rckgngig",
+  "Redoes your last action": "Wiederholen",
+  "Cut selection": "Ausschneiden",
+  "Copy selection": "Kopieren",
+  "Paste from clipboard": "Einfgen aus der Zwischenablage",
+  "Direction left to right": "Textrichtung von Links nach Rechts",
+  "Direction right to left": "Textrichtung von Rechts nach Links",
+  "Remove formatting": "Formatierung entfernen",
+  "Select all": "Alles markieren",
+  "Print document": "Dokument ausdrucken",
+  "Clear MSOffice tags": "MSOffice filter",
+  "Clear Inline Font Specifications": "Zeichensatz Formatierungen entfernen",
+  "Would you like to clear font typefaces?": "Wollen Sie Zeichensatztypen entfernen",
+  "Would you like to clear font sizes?": "Wollen Sie Zeichensatzgren entfernen",
+  "Would you like to clear font colours?": "Wollen sie Zeichensatzfarben entfernen",
+  "Split Block": "Block teilen",
+  "Toggle Borders": "Tabellenrnder ein/ausblenden",
+  "Save as": "speichern unter",
+  "Insert/Overwrite": "Einfgen/berschreiben",
+  "&mdash; format &mdash;": "&mdash; Format &mdash;",
+  "Heading 1": "berschrift 1",
+  "Heading 2": "berschrift 2",
+  "Heading 3": "berschrift 3",
+  "Heading 4": "berschrift 4",
+  "Heading 5": "berschrift 5",
+  "Heading 6": "berschrift 6",
+  "Normal": "Normal (Absatz)",
+  "Address": "Adresse",
+  "Formatted": "Formatiert",
+
+  //dialogs
+  "OK": "OK",
+  "Cancel": "Abbrechen",
+  "Path": "Pfad",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "Sie sind im Text-Modus. Benutzen Sie den [<>] Button, um in den visuellen Modus (WYSIWIG) zu gelangen.",
+   "The Paste button does not work in Mozilla based web browsers (technical security reasons). Press CTRL-V on your keyboard to paste directly.": "Aus Sicherheitsgrnden drfen Skripte normalerweise nicht auf Ausschneiden/Kopieren/Einfgen zugreifen. Benutzen Sie bitte die entsprechenden Tastatur-Kommandos (Strg + x/c/v).",
+
+  "You need to select some text before create a link": "Sie mssen einen Text markieren, um einen Link zu erstellen",
+  "Your Document is not well formed. Check JavaScript console for details.": "Ihr Dokument ist in keinem sauberen Format. Benutzen Sie die Javascript Console fr weitere Informationen.",
+
+  "Alignment:": "Ausrichtung:",
+  "Not set": "nicht eingestellt",
+  "Left": "links",
+  "Right": "rechts",
+  "Texttop": "oben bndig",
+  "Absmiddle": "mittig",
+  "Baseline": "Grundlinie",
+  "Absbottom": "unten bndig",
+  "Bottom": "unten",
+  "Middle": "zentriert",
+  "Top": "oben",
+
+  "Layout": "Layout",
+  "Spacing": "Abstand",
+  "Horizontal:": "horizontal:",
+  "Horizontal padding": "horizontaler Inhaltsabstand",
+  "Vertical:": "vertikal:",
+  "Vertical padding": "vertikaler Inhaltsabstand",
+  "Border thickness:": "Randstrke:",
+  "Leave empty for no border": "leer lassen fr keinen Rand",
+
+  //Insert Link
+  "Insert/Modify Link": "Verknpfung hinzufgen/ndern",
+  "None (use implicit)": "k.A. (implizit)",
+  "New window (_blank)": "Neues Fenster (_blank)",
+  "Same frame (_self)": "Selber Rahmen (_self)",
+  "Top frame (_top)": "Oberster Rahmen (_top)",
+  "Other": "Anderes",
+  "Target:": "Ziel:",
+  "Title (tooltip):": "Titel (Tooltip):",
+  "URL:": "URL:",
+  "You must enter the URL where this link points to": "Sie mssen eine Ziel-URL angeben fr die Verknpfung angeben",
+
+  // Insert Table
+  "Insert Table": "Tabelle einfgen",
+  "Rows:": "Zeilen:",
+  "Number of rows": "Zeilenanzahl",
+  "Cols:": "Spalten:",
+  "Number of columns": "Spaltenanzahl",
+  "Width:": "Breite:",
+  "Width of the table": "Tabellenbreite",
+  "Percent": "Prozent",
+  "Pixels": "Pixel",
+  "Em": "Geviert",
+  "Width unit": "Greneinheit",
+  "Fixed width columns": "Spalten mit fester Breite",
+  "Positioning of this table": "Positionierung der Tabelle",
+  "Cell spacing:": "Zellenabstand:",
+  "Space between adjacent cells": "Raum zwischen angrenzenden Zellen",
+  "Cell padding:": "Innenabstand:",
+  "Space between content and border in cell": "Raum zwischen Inhalt und Rand der Zelle",
+  "You must enter a number of rows": "Bitte geben Sie die Anzahl der Zeilen an",
+  "You must enter a number of columns": "Bitte geben Sie die Anzahl der Spalten an",
+
+  // Insert Image
+  "Insert Image": "Bild einfgen",
+  "Image URL:": "Bild URL:",
+  "Enter the image URL here": "Bitte geben sie hier die Bild URL ein",
+  "Preview": "Voransicht",
+  "Preview the image in a new window": "Voransicht des Bildes in einem neuen Fenster",
+  "Alternate text:": "Alternativer Text:",
+  "For browsers that don't support images": "fr Browser, die keine Bilder untersttzen",
+  "Positioning of this image": "Positionierung dieses Bildes",
+  "Image Preview:": "Bild Voransicht:",
+  "You must enter the URL": "Bitte geben Sie die URL ein",
+
+  "button_bold": "de/bold.gif",
+  "button_italic": "de/italic.gif",
+  "button_underline": "de/underline.gif",
+
+  // Editor Help
+  "Keyboard shortcuts": "Tastaturkrzel",
+  "The editor provides the following key combinations:": "Der Editor untersttzt die folgenden kombinationen:",
+  "new paragraph": "Neuer Absatz(Paragraph)",
+  "insert linebreak": "Harter Umbruch einfgen",
+  "Set format to paragraph": "Setze Formatierung auf Absatz",
+  "Clean content pasted from Word": "Von Word eingefgter Text bereinigen",
+  "Headings": "berschrift Typ 1 bis 6",
+  "Close": "Schlieen",
+
+  // Loading messages
+  "Loading in progress. Please wait!": "Editor wird geladen. Bitte warten !",
+  "Loading plugin $plugin" : "Plugin $plugin wird geladen",
+  "Register plugin $plugin" : "Plugin $plugin wird registriert", 
+  "Constructing object": "Objekt wird generiert",
+  "Generate Xinha framework": "Xinha Framework wird generiert",
+  "Init editor size":"Gre wird berechnet", 
+  "Create Toolbar": "Werkzeugleiste wird generiert",
+  "Create Statusbar" : "Statusleiste wird generiert",
+  "Register right panel" : "Rechtes Panel wird generiert", 
+  "Register left panel" : "Linkes Panel wird generiert", 
+  "Register bottom panel" : "Unteres Panel wird generiert", 
+  "Register top panel" : "Oberes Panel wird generiert", 
+  "Finishing" : "Laden wird abgeschlossen", 
+  
+  // ColorPicker
+  "Click a color..." : "Farbe whlen",
+  "Sample" : "Beispiel",
+  "Web Safe: " : "Web Safe: ",
+  "Color: " : "Farbe: "
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/ee.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/ee.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,50 @@
+// I18N constants
+
+// LANG: "ee", ENCODING: UTF-8
+// Author: Martin Raie, <albertvill@hot.ee>
+
+// FOR TRANSLATORS:
+//
+//   1. PLEASE PUT YOUR CONTACT INFO IN THE ABOVE LINE
+//      (at least a valid email address)
+//
+//   2. PLEASE TRY TO USE UTF-8 FOR ENCODING;
+//      (if this is not possible, please include a comment
+//       that states what encoding is necessary.)
+
+{
+  "Bold": "Paks",
+  "Italic": "Kursiiv",
+  "Underline": "Allakriipsutatud",
+  "Strikethrough": "Lbikriipsutatud",
+  "Subscript": "Allindeks",
+  "Superscript": "laindeks",
+  "Justify Left": "Joonda vasakule",
+  "Justify Center": "Joonda keskele",
+  "Justify Right": "Joonda paremale",
+  "Justify Full": "Rpjoonda",
+  "Ordered List": "Nummerdus",
+  "Bulleted List": "Tpploend",
+  "Decrease Indent": "Vhenda taanet",
+  "Increase Indent": "Suurenda taanet",
+  "Font Color": "Fondi vrv",
+  "Background Color": "Tausta vrv",
+  "Horizontal Rule": "Horisontaaljoon",
+  "Insert Web Link": "Lisa viit",
+  "Insert/Modify Image": "Lisa pilt",
+  "Insert Table": "Lisa tabel",
+  "Toggle HTML Source": "HTML/tavaline vaade",
+  "Enlarge Editor": "Suurenda toimeti aken",
+  "About this editor": "Teave toimeti kohta",
+  "Help using editor": "Spikker",
+  "Current style": "Kirjastiil",
+  "Undoes your last action": "Vta tagasi",
+  "Redoes your last action": "Tee uuesti",
+  "Cut selection": "Lika",
+  "Copy selection": "Kopeeri",
+  "Paste from clipboard": "Kleebi",
+  "OK": "OK",
+  "Cancel": "Loobu",
+  "Path": "Path",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "Sa oled tekstireziimis.  Kasuta nuppu [<>] llitamaks tagasi WYSIWIG reziimi."
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/el.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/el.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,55 @@
+// I18N constants
+
+// LANG: "el", ENCODING: UTF-8
+// Author: Dimitris Glezos, dimitris@glezos.com
+
+{
+  "Bold": "",
+  "Italic": "",
+  "Underline": "",
+  "Strikethrough": "",
+  "Subscript": "",
+  "Superscript": "",
+  "Justify Left": " ",
+  "Justify Center": " ",
+  "Justify Right": " ",
+  "Justify Full": " ",
+  "Ordered List": "",
+  "Bulleted List": "",
+  "Decrease Indent": " ",
+  "Increase Indent": " ",
+  "Font Color": " ",
+  "Background Color": " ",
+  "Horizontal Rule": " ",
+  "Insert Web Link": " ",
+  "Insert/Modify Image": "/ ",
+  "Insert Table": " ",
+  "Toggle HTML Source": " / HTML",
+  "Enlarge Editor": " ",
+  "About this editor": "",
+  "Help using editor": "",
+  "Current style": " ",
+  "Undoes your last action": "  ",
+  "Redoes your last action": "  ",
+  "Cut selection": "",
+  "Copy selection": "",
+  "Paste from clipboard": "",
+  "Direction left to right": "   ",
+  "Direction right to left": "     ",
+  "OK": "OK",
+  "Cancel": "",
+  "Path": "",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "  TEXT MODE.     [<>]     WYSIWIG.",
+  "The full screen mode is known to cause problems with Internet Explorer, due to browser bugs that we weren": "        Internet Explorer,      browser.       Windows 9x     reboot.   ,  .",
+  "Cancel": "",
+  "Insert/Modify Link": "/ ",
+  "New window (_blank)": "  (_blank)",
+  "None (use implicit)": " ( )",
+  "Other": "",
+  "Same frame (_self)": " frame (_self)",
+  "Target:": "Target:",
+  "Title (tooltip):": " (tooltip):",
+  "Top frame (_top)": " frame (_top)",
+  "URL:": "URL:",
+  "You must enter the URL where this link points to": "    URL     "
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/es.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/es.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,167 @@
+// I18N constants
+// LANG: "de", ENCODING: UTF-8
+{
+  "Bold": "Negrita",
+  "Italic": "Cursiva",
+  "Underline": "Subrayado",
+  "Strikethrough": "Tachado",
+  "Subscript": "Subndice",
+  "Superscript": "Superndice",
+  "Justify Left": "Alinear a la izquierda",
+  "Justify Center": "Alinear al centro",
+  "Justify Right": "Alinear a la derecha",
+  "Justify Full": "Justificar",
+  "Ordered List": "Lista numerada",
+  "Bulleted List": "Lista no numerada",
+  "Decrease Indent": "Reducir sangra",
+  "Increase Indent": "Aumentar sangra",
+  "Font Color": "Color de la fuente",
+  "Background Color": "Color de fondo",
+  "Horizontal Rule": "Regla horizontal",
+  "Insert Web Link": "Insertar enlace web",
+  "Insert/Modify Image": "Insertar/modificar imagen",
+  "Insert Table": "Insertar una tabla",
+  "Toggle HTML Source": "Ver HTML",
+  "Enlarge Editor": "Editor a pantalla completa",
+  "About this editor": "Sobre este Editor",
+  "Help using editor": "Ayuda",
+  "Current style": "Estilo actual",
+  "Undoes your last action": "Deshacer",
+  "Redoes your last action": "Rehacer",
+  "Cut selection": "Cortar",
+  "Copy selection": "Copiar",
+  "Paste from clipboard": "Pegar desde el portapapeles",
+  "Direction left to right": "Direccin de izquierda a derecha",
+  "Direction right to left": "Direccin de derecha a izquierda",
+  "Remove formatting": "Borrar formato",
+  "Select all": "Seleccionar todo",
+  "Print document": "Imprimir documento",
+  "Clear MSOffice tags": "Borrar etiquetas de MSOffice",
+  "Clear Inline Font Specifications": "Borrar las etiquetas de fuente",
+  "Would you like to clear font typefaces?": "Desea eliminar las definiciaones de tipo de fuente?",
+  "Would you like to clear font sizes?": "Desea eliminar las definiciones de tamao de fuente?",
+  "Would you like to clear font colours?": "Desea eliminar las definiciones de color de fuente?",
+  "Split Block": "Dividir el bloque",
+  "Toggle Borders": "Aadir/Quitar bordes",
+  "Save as": "Guardar como",
+  "Insert/Overwrite": "Insertar/Sobreescribir",
+  "&mdash; format &mdash;": "&mdash; formato &mdash;",
+  "&mdash; font &mdash;": "&mdash; fuente &mdash;",
+  "&mdash; size &mdash;": "&mdash; tamao &mdash;",
+  "Heading 1": "Cabecera 1",
+  "Heading 2": "Cabecera 2",
+  "Heading 3": "Cabecera 3",
+  "Heading 4": "Cabecera 4",
+  "Heading 5": "Cabecera 5",
+  "Heading 6": "Cabecera 6",
+  "Normal": "Normal",
+  "Address": "Direccin",
+  "Formatted": "Formateado",
+
+  //dialogs
+  "OK": "Aceptar",
+  "Cancel": "Cancelar",
+  "Path": "Ruta",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "Se encuentra en MODO TEXTO. Use el botn [<>] para cambiar de nuevo al modo WYSIWYG",
+   "The Paste button does not work in Mozilla based web browsers (technical security reasons). Press CTRL-V on your keyboard to paste directly.": "El botn de pegar no funciona en los navegadores de Mozilla por motivos de seguridad. Presione CTRL-V en su teclado para pegarlo directamente",
+
+  "You need to select some text before create a link": "Necesita seleccionar algn texto antes de crear un link",
+  "Your Document is not well formed. Check JavaScript console for details.": "Su documento no est bien formado. Compruebe la consola de JavaScript para obtener ms detalles",
+
+  "Alignment:": "Alineacin:",
+  "Not set": "No definido",
+  "Left": "Izquierda",
+  "Right": "Derecha",
+  "Texttop": "Texto Superior",
+  "Absmiddle": "Medio Absoluto",
+  "Baseline": "Lnea base",
+  "Absbottom": "Inferior absoluto",
+  "Bottom": "Inferior",
+  "Middle": "Medio",
+  "Top": "Superior",
+
+  "Layout": "Distribucin",
+  "Spacing": "Espaciado",
+  "Horizontal:": "horizontal:",
+  "Horizontal padding": "Relleno horizontal",
+  "Vertical:": "Vertical:",
+  "Vertical padding": "Relleno Vertical",
+  "Border thickness:": "Tamao del borde:",
+  "Leave empty for no border": "Vaco si no desea ningn borde",
+
+  //Insert Link
+  "Insert/Modify Link": "Insertar/Modificar un enlace",
+  "None (use implicit)": "Vaco ( usar implcito )",
+  "New window (_blank)": "Nueva ventana (_blank)",
+  "Same frame (_self)": "Mismo marco (_self)",
+  "Top frame (_top)": "Marco superior (_top)",
+  "Other": "Otro",
+  "Target:": "Destino:",
+  "Title (tooltip):": "Ttulo (Tooltip):",
+  "URL:": "URL:",
+  "You must enter the URL where this link points to": "Debe introducir la URL a donde apunta este enlace",
+
+  // Insert Table
+  "Insert Table": "Aadir una tabla",
+  "Rows:": "Filas:",
+  "Number of rows": "Nmero de filas",
+  "Cols:": "Columnas:",
+  "Number of columns": "Nmero de columnas",
+  "Width:": "Ancho:",
+  "Width of the table": "Ancho de la tabla",
+  "Percent": "Porcentaje",
+  "Pixels": "Pixels",
+  "Em": "Em",
+  "Width unit": "Unidad de anchura",
+  "Fixed width columns": "Columnas de ancho fijo",
+  "Positioning of this table": "Posicin de esta tabla",
+  "Cell spacing:": "Espaciado entre celdas:",
+  "Space between adjacent cells": "Espaciado entre celdas adyacentes",
+  "Cell padding:": "Relleno de celdas:",
+  "Space between content and border in cell": "Escapcio entre el contenido y el borde de la celda",
+  "You must enter a number of rows": "Debe introducir un nmero de filas",
+  "You must enter a number of columns": "Debe introducir un nmero de columnas",
+
+  // Insert Image
+  "Insert Image": "Insertar una imagen",
+  "Image URL:": "Imagen URL:",
+  "Enter the image URL here": "",
+  "Preview": "Previsualizar",
+  "Preview the image in a new window": "Previsualizar en una nueva ventana",
+  "Alternate text:": "Texto alternativo:",
+  "For browsers that don't support images": "Para navegadores que no soportan imgenes",
+  "Positioning of this image": "Posicin de la imagen",
+  "Image Preview:": "Previsualizacin de la imagen:",
+  "You must enter the URL": "Debe introducir la URL",
+
+  // Editor Help
+  "Keyboard shortcuts": "Atajos de teclado",
+  "The editor provides the following key combinations:": "El editor proporciona las siguientes combinaciones:",
+  "new paragraph": "Nuevo parrafo",
+  "insert linebreak": "Insertar salto de lnea",
+  "Set format to paragraph": "EStablecer el formato a parrafo",
+  "Clean content pasted from Word": "Limpiar el contenido pegado desde Word",
+  "Headings": "Cabeceras",
+  "Close": "Cerrar",
+
+  // Loading messages
+  "Loading in progress. Please wait!": "Carga en proceso. Por favor espere.",
+  "Loading plugin $plugin" : "Cargando el plugin $plugin",
+  "Register plugin $plugin" : "Registro de plugin $plugin", 
+  "Constructing object": "Construyendo objeto",
+  "Generate Xinha framework": "Generar Xinha framework",
+  "Init editor size":"Iniciar el tamao del editor", 
+  "Create Toolbar": "Crear barra de herramientas",
+  "Create Statusbar" : "Crear barra de estado",
+  "Register right panel" : "Registrar panel derecho", 
+  "Register left panel" : "Registrar panel izquierdo", 
+  "Register bottom panel" : "Registar panel inferior", 
+  "Register top panel" : "Registar panel superior", 
+  "Finishing" : "Finalizando",
+  
+  // ColorPicker
+  "Click a color..." : "Seleccione un color...",
+  "Sample" : "Muestra",
+  "Web Safe: " : "Color web: ",
+  "Color: " : "Color: "
+}
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/eu.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/eu.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,169 @@
+// I18N constants
+// LANG: "eu", ENCODING: UTF-8
+{
+  "Bold": "Lodia",
+  "Italic": "Etzana",
+  "Underline": "Azpimarratua",
+  "Strikethrough": "Marratua",
+  "Subscript": "Azpindizea",
+  "Superscript": "Goi-indizea",
+  "Justify Left": "Ezkerretara lerrokatu",
+  "Justify Center": "Zentratu",
+  "Justify Right": "Eskuinetara lerrokatu",
+  "Justify Full": "Justifikatu",
+  "Ordered List": "Zerrenda ordenatua",
+  "Bulleted List": "Zerrenda ez ordenatua",
+  "Decrease Indent": "Koska handitu",
+  "Increase Indent": "Koska txikitu",
+  "Font Color": "Testu-kolorea",
+  "Background Color": "Atzeko kolorea",
+  "Horizontal Rule": "Marra horizontala",
+  "Insert Web Link": "Lotura txertatu",
+  "Insert/Modify Image": "Irudia txertatu",
+  "Insert Table": "Taula txertatu",
+  "Toggle HTML Source": "Ikusi dokumentua HTML-n",
+  "Enlarge Editor": "Editorea handitu",
+  "About this editor": "Editoreari buruz...",
+  "Help using editor": "Laguntza",
+  "Current style": "Uneko estiloa",
+  "Undoes your last action": "Desegin",
+  "Redoes your last action": "Berregin",
+  "Cut selection": "Ebaki hautaketa",
+  "Copy selection": "Kopiatu hautaketa",
+  "Paste from clipboard": "Itsatsi arbelean dagoena",
+  "Direction left to right": "Ezkerretik eskuinetarako norabidea",
+  "Direction right to left": "Eskuinetik ezkerretarako norabidea",
+  "Remove formatting": "Formatoa kendu",
+  "Select all": "Dena aukeratu",
+  "Print document": "Dokumentua inprimatu",
+  "Clear MSOffice tags": "MSOffice etiketak ezabatu",
+  "Clear Inline Font Specifications": "Ezabatu testuaren ezaugarriak",
+  "Would you like to clear font typefaces?": "Letra-tipoak ezabatu nahi al dituzu?",
+  "Would you like to clear font sizes?": "Letra-tipoen neurriak ezabatu nahi al dituzu?",
+  "Would you like to clear font colours?": "Letra-tipoen koloreak ezabatu nahi al dituzu?",
+  "Split Block": "Blokea zatitu",
+  "Toggle Borders": "Ertzak trukatu",
+  "Save as": "Gorde honela:",
+  "Insert/Overwrite": "Txertatu/Gainidatzi",
+  "&mdash; format &mdash;": "&mdash; Formatua &mdash;",
+  "Heading 1": "Goiburua 1",
+  "Heading 2": "Goiburua 2",
+  "Heading 3": "Goiburua 3",
+  "Heading 4": "Goiburua 4",
+  "Heading 5": "Goiburua 5",
+  "Heading 6": "Goiburua 6",
+  "Normal": "Normala",
+  "Address": "Helbidea",
+  "Formatted": "Formateatua",
+
+  //dialogs
+  "OK": "Ados",
+  "Cancel": "Utzi",
+  "Path": "Bidea",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "TESTU eran ari zara. Erabil ezazu [<>] botoia WYSIWIG erara itzultzeko.",
+   "The Paste button does not work in Mozilla based web browsers (technical security reasons). Press CTRL-V on your keyboard to paste directly.": "Itsatsi botoia ez dabil Mozillan oinarritutako nabigatzaileetan (arrazoi teknikoengatik). Sacatu CTRL-V zure teklatuan, zuzenean itsasteko.",
+
+  "You need to select some text before create a link": "Testu-atal bat aukeratu behar duzu lehendabizi, lotura bat sortzeko",
+  "Your Document is not well formed. Check JavaScript console for details.": "Zure dokumentuak ez du formatu zuzena. Begira ezazu JavaScript kontsola xehetasunetarako.",
+
+  "Alignment:": "Lerrokatzea:",
+  "Not set": "Ez gaitua",
+  "Left": "Ezkerretara",
+  "Right": "Eskuinetara",
+  "Texttop": "Irudiaren goialdean",
+  "Absmiddle": "Irudiaren erdian",
+  "Baseline": "Irudiaren oinean",
+  "Absbottom": "Irudiaren behekaldean",
+  "Bottom": "Behean",
+  "Middle": "Erdian",
+  "Top": "Goian",
+
+  "Layout": "Diseinua",
+  "Spacing": "Tartea",
+  "Horizontal:": "Horizontala:",
+  "Horizontal padding": "Betegarri horizontala",
+  "Vertical:": "Bertikala:",
+  "Vertical padding": "Betegarri bertikala",
+  "Border thickness:": "Ertzaren lodiera:",
+  "Leave empty for no border": "Uztazu hutsik ertzik ez sortzeko",
+
+  //Insert Link
+  "Insert/Modify Link": "Lotura txertatu/aldatu",
+  "None (use implicit)": "Bat ere ez (implizituki erabili)",
+  "New window (_blank)": "Lehio berrian (_blank)",
+  "Same frame (_self)": "Frame berean (_self)",
+  "Top frame (_top)": "Goiko frame-an (_top)",
+  "Other": "Beste bat",
+  "Target:": "Helburua:",
+  "Title (tooltip):": "Izenburua (argibidea):",
+  "URL:": "URL-a:",
+  "You must enter the URL where this link points to": "Loturaren helburu den URL-a idatzi behar duzu",
+
+  // Insert Table
+  "Insert Table": "Taula txertatu",
+  "Rows:": "Lerroak:",
+  "Number of rows": "Lerro-kopurua",
+  "Cols:": "Zutabeak:",
+  "Number of columns": "Zutabe-kopurua",
+  "Width:": "Zabalera:",
+  "Width of the table": "Taularen zabalera",
+  "Percent": "Portzentaia",
+  "Pixels": "Pixelak",
+  "Em": "Em",
+  "Width unit": "Zabalera-unitatea",
+  "Fixed width columns": "Zabalera finkodun zutabeak",
+  "Positioning of this table": "Taula honen kokapena",
+  "Cell spacing:": "Gelaxka-tartea:",
+  "Space between adjacent cells": "Gelaxka auzokideen arteko tartea",
+  "Cell padding:": "Gelaxkaren betegarria:",
+  "Space between content and border in cell": "Gelaxkaren edukia eta ertzaren arteko tartea",
+  "You must enter a number of rows": "Lerro-kopurua idatzi behar duzu",
+  "You must enter a number of columns": "Zutabe-kopurua idatzi behar duzu",
+
+  // Insert Image
+  "Insert Image": "Irudia txertatu",
+  "Image URL:": "Irudiaren URL-a:",
+  "Enter the image URL here": "Idatz ezazu irudiaren URL-a hemen",
+  "Preview": "Aurrebista",
+  "Preview the image in a new window": "Aurreikusi irudia beste lehio batean",
+  "Alternate text:": "Testu alternatiboa:",
+  "For browsers that don't support images": "Irudirik onartzen ez duten nabigatzaileentzat",
+  "Positioning of this image": "Irudiaren kokapena",
+  "Image Preview:": "Irudiaren aurrebista:",
+  "You must enter the URL": "URL-a idatzi behar duzu",
+
+  "button_bold": "de/bold.gif",
+  "button_italic": "de/italic.gif",
+  "button_underline": "de/underline.gif",
+
+  // Editor Help
+  "Keyboard shortcuts": "Laster-teklak",
+  "The editor provides the following key combinations:": "Editoreak ondorengo tekla-konbinazioak eskaintzen ditu:",
+  "new paragraph": "Paragrafo berria",
+  "insert linebreak": "Lerro-jauzia txertatu",
+  "Set format to paragraph": "Formatua ezarri paragrafoari",
+  "Clean content pasted from Word": "Word-etik itsatsitako edukia ezabatu",
+  "Headings": "Goiburuak",
+  "Close": "Itxi",
+
+  // Loading messages
+  "Loading in progress. Please wait!": "Kargatzen. Itxaron mesedez",
+  "Loading plugin $plugin" : "$plugin plugina kargatzen",
+  "Register plugin $plugin" : "$plugin plugina erregistratu", 
+  "Constructing object": "Objektua eraikitzen",
+  "Generate Xinha framework": "Xinha Framework sortzen",
+  "Init editor size":"Editorearen hasierako neurria", 
+  "Create Toolbar": "Tresna-barra sortu",
+  "Create Statusbar" : "Egoera-barra sortu",
+  "Register right panel" : "Eskuin-panela erregistratu", 
+  "Register left panel" : "Ezker-panela erregistratu", 
+  "Register bottom panel" : "Beheko panela erregistratu", 
+  "Register top panel" : "Goiko panela erregistratu", 
+  "Finishing" : "Bukatzen", 
+  
+  // ColorPicker
+  "Click a color..." : "Kolore bat aukeratu...",
+  "Sample" : "Lagina",
+  "Web Safe: " : "Web Safe: ",
+  "Color: " : "Kolorea: "
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/fa.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/fa.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,169 @@
+// I18N constants
+// LANG: "fa", ENCODING: UTF-8
+{
+  "Bold": "",
+  "Italic": "",
+  "Underline": " ",
+  "Strikethrough": " ",
+  "Subscript": "",
+  "Superscript": "",
+  "Justify Left": "  ",
+  "Justify Center": "  ",
+  "Justify Right": "  ",
+  "Justify Full": "    ",
+  "Ordered List": " ",
+  "Bulleted List": "  ",
+  "Decrease Indent": "  ",
+  "Increase Indent": "  ",
+  "Font Color": " ",
+  "Background Color": "  ",
+  "Horizontal Rule": " ",
+  "Insert Web Link": "  ",
+  "Insert/Modify Image": "   ",
+  "Insert Table": " ",
+  "Toggle HTML Source": "       HTML",
+  "Enlarge Editor": "   ",
+  "About this editor": "   ",
+  "Help using editor": "   ",
+  "Current style": " ",
+  "Undoes your last action": "  ",
+  "Redoes your last action": "   ",
+  "Cut selection": "  ",
+  "Copy selection": "  ",
+  "Paste from clipboard": "   ",
+  "Direction left to right": "    ",
+  "Direction right to left": "    ",
+  "Remove formatting": "  ",
+  "Select all": " ",
+  "Print document": " ",
+  "Clear MSOffice tags": "      MSOffice",
+  "Clear Inline Font Specifications": "     ",
+  "Would you like to clear font typefaces?": "       ",
+  "Would you like to clear font sizes?": "       ",
+  "Would you like to clear font colours?": "       ",
+  "Split Block": " ",
+  "Toggle Borders": "/    ",
+  "Save as": " ...",
+  "Insert/Overwrite": "/",
+  "&mdash; format &mdash;": "&mdash;  &mdash;",
+  "Heading 1": " 1",
+  "Heading 2": " 2",
+  "Heading 3": " 3",
+  "Heading 4": " 4",
+  "Heading 5": " 5",
+  "Heading 6": " 6",
+  "Normal": "",
+  "Address": "",
+  "Formatted": "  ",
+
+  //dialogs
+  "OK": "",
+  "Cancel": "",
+  "Path": "",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "   .    [<>]      WYSIWYG .",
+  "The Paste button does not work in Mozilla based web browsers (technical security reasons). Press CTRL-V on your keyboard to paste directly.": "     Mozilla    (   ).     CTRL-V     .",
+  "Your Document is not well formed. Check JavaScript console for details.": "      .         .",
+
+  "Alignment:": " ",
+  "Not set": " ",
+  "Left": "",
+  "Right": "",
+  "Texttop": " ",
+  "Absmiddle": " ",
+  "Baseline": " ",
+  "Absbottom": " ",
+  "Bottom": "",
+  "Middle": "",
+  "Top": "",
+
+  "Layout": "",
+  "Spacing": " ",
+  "Horizontal:": "",
+  "Horizontal padding": " ",
+  "Vertical:": "",
+  "Vertical padding": " ",
+  "Border thickness:": " ",
+  "Leave empty for no border": "     ",
+
+  //Insert Link
+  "Insert/Modify Link": " /  ",
+  "None (use implicit)": " (   )",
+  "New window (_blank)": "  (_blank)",
+  "Same frame (_self)": "  (_self)",
+  "Top frame (_top)": "  (_top)",
+  "Other": "",
+  "Target:": "",
+  "Title (tooltip):": " (  )",
+  "URL:": "URL:",
+  "You must enter the URL where this link points to": " URL          ",
+  "You need to select some text before creating a link": "         ",
+
+  // Insert Table
+  "Insert Table": " ",
+  "Rows:": " ",
+  "Number of rows": "  ",
+  "Cols:": " ",
+  "Number of columns": "  ",
+  "Width:": "",
+  "Width of the table": " ",
+  "Percent": "",
+  "Pixels": " ",
+  "Em": "Em",
+  "Width unit": " ",
+  "Fixed width columns": "   ",
+  "Positioning of this table": "   ",
+  "Cell spacing:": "  ",
+  "Space between adjacent cells": "    ",
+  "Cell padding:": "  ",
+  "Space between content and border in cell": "      ",
+  "You must enter a number of rows": "      ",
+  "You must enter a number of columns": "      ",
+
+  // Insert Image
+  "Insert Image": " ",
+  "Image URL:": "URL ",
+  "Enter the image URL here": "URL     ",
+  "Preview": " ",
+  "Preview the image in a new window": "      ",
+  "Alternate text:": " ",
+  "For browsers that don't support images": "       ",
+  "Positioning of this image": "  ",
+  "Image Preview:": "  ",
+  "You must enter the URL": "  URL   ",
+
+  // toolbar
+  /*
+  "button_bold": "fr/bold.gif",
+  "button_underline": "fr/underline.gif",
+  "button_strikethrough": "fr/strikethrough.gif",
+  */
+
+  // Editor Help
+  "Xinha Help": " Xinha",
+  "Editor Help": " ",
+  "Keyboard shortcuts": "  ",
+  "The editor provides the following key combinations:": "           :",
+  "ENTER": "ENTREE",
+  "new paragraph": " ",
+  "SHIFT-ENTER": "SHIFT+ENTREE",
+  "insert linebreak": "   ",
+  "Set format to paragraph": "   ",
+  "Clean content pasted from Word": "      Word",
+  "Headings": " ",
+  "Close": "",
+
+  // Loading messages
+  "Loading in progress. Please wait !": "    .    !",
+  "Constructing main object": "  ",
+  "Constructing object": " ",
+  "Register panel right": "  ",
+  "Register panel left": "  ",
+  "Register panel top": "  ",
+  "Register panel bottom": "  ",
+  "Create Toolbar": "  ",
+  "Create StatusBar": "  ",
+  "Generate Xinha object": "  Xinha",
+  "Init editor size": "   ",
+  "Init IFrame": "  IFrame",
+  "Register plugin $plugin": "  $plugin"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/fi.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/fi.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,38 @@
+// I18N constants
+
+// LANG: "en", ENCODING: UTF-8
+
+{
+  "Bold": "Lihavoitu",
+  "Italic": "Kursivoitu",
+  "Underline": "Alleviivattu",
+  "Strikethrough": "Yliviivattu",
+  "Subscript": "Alaindeksi",
+  "Superscript": "Ylindeksi",
+  "Justify Left": "Tasaa vasemmat reunat",
+  "Justify Center": "Keskit",
+  "Justify Right": "Tasaa oikeat reunat",
+  "Justify Full": "Tasaa molemmat reunat",
+  "Ordered List": "Numerointi",
+  "Bulleted List": "Luettelomerkit",
+  "Decrease Indent": "Pienenn sisennyst",
+  "Increase Indent": "Lis sisennyst",
+  "Font Color": "Fontin vri",
+  "Background Color": "Taustavri",
+  "Horizontal Rule": "Vaakaviiva",
+  "Insert Web Link": "Lis linkki",
+  "Insert/Modify Image": "Lis kuva",
+  "Insert Table": "Lis taulukko",
+  "Toggle HTML Source": "HTML-lhdekoodi vs WYSIWYG",
+  "Enlarge Editor": "Suurenna editori",
+  "About this editor": "Tietoja editorista",
+  "Help using editor": "Nyt ohje",
+  "Current style": "Nykyinen tyyli",
+  "Undoes your last action": "Peruuta viimeinen toiminto",
+  "Redoes your last action": "Palauta viimeinen toiminto",
+  "Cut selection": "Leikkaa maalattu",
+  "Copy selection": "Kopioi maalattu",
+  "Paste from clipboard": "Liit leikepydlt",
+  "OK": "Hyvksy",
+  "Cancel": "Peruuta"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/fr.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/fr.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,169 @@
+// I18N constants
+// LANG: "fr", ENCODING: UTF-8
+{
+  "Bold": "Gras",
+  "Italic": "Italique",
+  "Underline": "Soulign",
+  "Strikethrough": "Barr",
+  "Subscript": "Indice",
+  "Superscript": "Exposant",
+  "Justify Left": "Aligner  gauche",
+  "Justify Center": "Centrer",
+  "Justify Right": "Aligner  droite",
+  "Justify Full": "Justifier",
+  "Ordered List": "Liste numrote",
+  "Bulleted List": "Liste  puces",
+  "Decrease Indent": "Diminuer le retrait",
+  "Increase Indent": "Augmenter le retrait",
+  "Font Color": "Couleur de police",
+  "Background Color": "Surlignage",
+  "Horizontal Rule": "Ligne horizontale",
+  "Insert Web Link": "Insrer un lien",
+  "Insert/Modify Image": "Insrer / Modifier une image",
+  "Insert Table": "Insrer un tableau",
+  "Toggle HTML Source": "Afficher / Masquer code source",
+  "Enlarge Editor": "Agrandir l'diteur",
+  "About this editor": "A propos",
+  "Help using editor": "Aide",
+  "Current style": "Style courant",
+  "Undoes your last action": "Annuler la dernire action",
+  "Redoes your last action": "Rpter la dernire action",
+  "Cut selection": "Couper la slection",
+  "Copy selection": "Copier la slection",
+  "Paste from clipboard": "Coller depuis le presse-papier",
+  "Direction left to right": "Direction de gauche  droite",
+  "Direction right to left": "Direction de droite  gauche",
+  "Remove formatting": "Supprimer mise en forme",
+  "Select all": "Tout slectionner",
+  "Print document": "Imprimer document",
+  "Clear MSOffice tags": "Supprimer tags MSOffice",
+  "Clear Inline Font Specifications": "Supprimer paramtres inline de la police",
+  "Would you like to clear font typefaces?": "Voulez-vous supprimer les types ?",
+  "Would you like to clear font sizes?": "Voulez-vous supprimer les tailles ?",
+  "Would you like to clear font colours?": "Voulez-vous supprimer les couleurs ?",
+  "Split Block": "Sparer les blocs",
+  "Toggle Borders": "Afficher / Masquer les bordures",
+  "Save as": "Enregistrer sous",
+  "Insert/Overwrite": "Insertion / Remplacement",
+  "&mdash; format &mdash;": "&mdash; Format &mdash;",
+  "Heading 1": "Titre 1",
+  "Heading 2": "Titre 2",
+  "Heading 3": "Titre 3",
+  "Heading 4": "Titre 4",
+  "Heading 5": "Titre 5",
+  "Heading 6": "Titre 6",
+  "Normal": "Normal",
+  "Address": "Adresse",
+  "Formatted": "Format",
+
+  //dialogs
+  "OK": "OK",
+  "Cancel": "Annuler",
+  "Path": "Chemin",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "Vous tes en MODE TEXTE.  Appuyez sur le bouton [<>] pour retourner au mode WYSIWYG.",
+  "The Paste button does not work in Mozilla based web browsers (technical security reasons). Press CTRL-V on your keyboard to paste directly.": "Le bouton Coller ne fonctionne pas sur les navigateurs bass sur Mozilla (pour des raisons de scurit). Pressez CTRL-V au clavier pour coller directement.",
+  "Your Document is not well formed. Check JavaScript console for details.": "Le document est mal form. Vrifiez la console JavaScript pour plus de dtails.",
+
+  "Alignment:": "Alignement",
+  "Not set": "Indfini",
+  "Left": "Gauche",
+  "Right": "Droite",
+  "Texttop": "Texttop",
+  "Absmiddle": "Absmiddle",
+  "Baseline": "Baseline",
+  "Absbottom": "Absbottom",
+  "Bottom": "Bas",
+  "Middle": "Milieu",
+  "Top": "Haut",
+
+  "Layout": "Mise en page",
+  "Spacing": "Espacement",
+  "Horizontal:": "Horizontal",
+  "Horizontal padding": "Marge horizontale interne",
+  "Vertical:": "Vertical",
+  "Vertical padding": "Marge verticale interne",
+  "Border thickness:": "Epaisseur de bordure",
+  "Leave empty for no border": "Laisser vide pour pas de bordure",
+
+  //Insert Link
+  "Insert/Modify Link": "Insrer / Modifier un lien",
+  "None (use implicit)": "Aucune (implicite)",
+  "New window (_blank)": "Nouvelle fentre (_blank)",
+  "Same frame (_self)": "Mme frame (_self)",
+  "Top frame (_top)": "Frame principale (_top)",
+  "Other": "Autre",
+  "Target:": "Cible",
+  "Title (tooltip):": "Texte alternatif",
+  "URL:": "URL:",
+  "You must enter the URL where this link points to": "Vous devez entrer l'URL de ce lien",
+  "You need to select some text before creating a link": "Vous devez slectionner du texte avant de crer un lien",
+
+  // Insert Table
+  "Insert Table": "Insrer un tableau",
+  "Rows:": "Lignes",
+  "Number of rows": "Nombre de lignes",
+  "Cols:": "Colonnes",
+  "Number of columns": "Nombre de colonnes",
+  "Width:": "Largeur",
+  "Width of the table": "Largeur du tableau",
+  "Percent": "Pourcent",
+  "Pixels": "Pixels",
+  "Em": "Em",
+  "Width unit": "Units de largeur",
+  "Fixed width columns": "Colonnes  taille fixe",
+  "Positioning of this table": "Position du tableau",
+  "Cell spacing:": "Espacement",
+  "Space between adjacent cells": "Espace entre les cellules adjacentes",
+  "Cell padding:": "Marge interne",
+  "Space between content and border in cell": "Espace entre le contenu et la bordure d'une cellule",
+  "You must enter a number of rows": "Vous devez entrer le nombre de lignes",
+  "You must enter a number of columns": "Vous devez entrer le nombre de colonnes",
+
+  // Insert Image
+  "Insert Image": "Insrer une image",
+  "Image URL:": "URL image",
+  "Enter the image URL here": "Entrer l'URL de l'image ici",
+  "Preview": "Prvisualiser",
+  "Preview the image in a new window": "Prvisualiser l'image dans une nouvelle fentre",
+  "Alternate text:": "Texte alternatif",
+  "For browsers that don't support images": "Pour les navigateurs qui ne supportent pas les images",
+  "Positioning of this image": "Position de l'image",
+  "Image Preview:": "Prvisualisation",
+  "You must enter the URL": "Vous devez entrer l'URL",
+
+  // toolbar
+  "button_bold": "fr/bold.gif",
+  "button_underline": "fr/underline.gif",
+  "button_strikethrough": "fr/strikethrough.gif",
+
+  // Editor Help
+  "Xinha Help": "Aide Xinha",
+  "Editor Help": "Aide de l'diteur",
+  "Keyboard shortcuts": "Raccourcis clavier",
+  "The editor provides the following key combinations:": "L'diteur fournit les combinaisons de touches suivantes :",
+  "ENTER": "ENTREE",
+  "new paragraph": "Nouveau paragraphe",
+  "SHIFT-ENTER": "SHIFT+ENTREE",
+  "insert linebreak": "Insre un saut de ligne",
+  "Set format to paragraph": "Applique le format paragraphe",
+  "Clean content pasted from Word": "Nettoyage du contenu copi depuis Word",
+  "Headings": "Titres",
+  "Close": "Fermer",
+
+  // Loading messages
+  "Loading in progress. Please wait!": "Chargement en cours. Veuillez patienter!",
+  "Finishing" : "Chargement bientt termin", 
+  "Constructing object": "Construction de l'objet",
+  "Create Toolbar": "Construction de la barre d'icones",
+  "Create Statusbar": "Construction de la barre de status",
+  "Register right panel" : "Enregistrement du panneau droit", 
+  "Register left panel" : "Enregistrement du panneau gauche", 
+  "Register bottom panel" : "Enregistrement du panneau suprieur", 
+  "Register top panel" : "Enregistrement du panneau infrieur", 
+  "Generate Xinha framework": "Gnration de Xinha",
+  "Init editor size": "Initialisation de la taille d'dition",
+  "Init IFrame": "Initialisation de l'iframe",
+  "Register plugin $plugin": "Enregistrement du plugin $plugin",
+  "Loading plugin $plugin" : "Chargement du plugin $plugin"
+
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/gb.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/gb.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,29 @@
+// I18N constants -- Chinese GB
+// by Dave Lo -- dlo@interactivetools.com
+{
+  "Bold": "",
+  "Italic": "",
+  "Underline": "",
+  "Strikethrough": "",
+  "Subscript": "",
+  "Superscript": "",
+  "Justify Left": "",
+  "Justify Center": "",
+  "Justify Right": "",
+  "Justify Full": "",
+  "Ordered List": "",
+  "Bulleted List": "",
+  "Decrease Indent": "",
+  "Increase Indent": "",
+  "Font Color": "",
+  "Background Color": "",
+  "Horizontal Rule": "",
+  "Insert Web Link": "",
+  "Insert/Modify Image": "",
+  "Insert Table": "",
+  "Toggle HTML Source": "HTML",
+  "Enlarge Editor": "",
+  "About this editor": " Xinha",
+  "Help using editor": "",
+  "Current style": ""
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/he.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/he.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,64 @@
+// I18N constants
+
+// LANG: "he", ENCODING: UTF-8
+// Author: Liron Newman, http://www.eesh.net, <plastish at ultinet dot org>
+
+// FOR TRANSLATORS:
+//
+//   1. PLEASE PUT YOUR CONTACT INFO IN THE ABOVE LINE
+//      (at least a valid email address)
+//
+//   2. PLEASE TRY TO USE UTF-8 FOR ENCODING;
+//      (if this is not possible, please include a comment
+//       that states what encoding is necessary.)
+
+{
+  "Bold": "",
+  "Italic": "",
+  "Underline": " ",
+  "Strikethrough": " ",
+  "Subscript": " ",
+  "Superscript": " ",
+  "Justify Left": "  ",
+  "Justify Center": " ",
+  "Justify Right": " ",
+  "Justify Full": "  ",
+  "Ordered List": " ",
+  "Bulleted List": "  ",
+  "Decrease Indent": " ",
+  "Increase Indent": " ",
+  "Font Color": " ",
+  "Background Color": " ",
+  "Horizontal Rule": " ",
+  "Insert Web Link": " -",
+  "Insert/Modify Image": "/ ",
+  "Insert Table": " ",
+  "Toggle HTML Source": "   HTML",
+  "Enlarge Editor": "  ",
+  "About this editor": "  ",
+  "Help using editor": "  ",
+  "Current style": " ",
+  "Undoes your last action": "   ",
+  "Redoes your last action": "     ",
+  "Cut selection": " ",
+  "Copy selection": " ",
+  "Paste from clipboard": " ",
+  "Direction left to right": "  ",
+  "Direction right to left": "  ",
+  "OK": "",
+  "Cancel": "",
+  "Path": " ",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "    ().   [<>]    WYSIWYG ( ).",
+  "The full screen mode is known to cause problems with Internet Explorer, due to browser bugs that we weren": "      Internet Explorer,        .  / /   ,     /   .      Windows 9x   / ",
+  "Cancel": "",
+  "Insert/Modify Link": "/ ",
+  "New window (_blank)": "  (_blank)",
+  "None (use implicit)": " ( -frame )",
+  "Other": "",
+  "Same frame (_self)": " frame (_self)",
+  "Target:": ":",
+  "Title (tooltip):": " (tooltip):",
+  "Top frame (_top)": "Frame  (_top)",
+  "URL:": "URL:",
+  "You must enter the URL where this link points to": "  URL    "
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/hu.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/hu.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,64 @@
+// I18N constants
+
+// LANG: "hu", ENCODING: UTF-8
+// Author: Mikls Somogyi, <somogyine@vnet.hu>
+
+// FOR TRANSLATORS:
+//
+//   1. PLEASE PUT YOUR CONTACT INFO IN THE ABOVE LINE
+//      (at least a valid email address)
+//
+//   2. PLEASE TRY TO USE UTF-8 FOR ENCODING;
+//      (if this is not possible, please include a comment
+//       that states what encoding is necessary.)
+
+{
+  "Bold": "Flkvr",
+  "Italic": "Dlt",
+  "Underline": "Alhzott",
+  "Strikethrough": "thzott",
+  "Subscript": "Als index",
+  "Superscript": "Fels index",
+  "Justify Left": "Balra zrt",
+  "Justify Center": "Kzpre zrt",
+  "Justify Right": "Jobbra zrt",
+  "Justify Full": "Sorkizrt",
+  "Ordered List": "Szmozott lista",
+  "Bulleted List": "Szmozatlan lista",
+  "Decrease Indent": "Behzs cskkentse",
+  "Increase Indent": "Behzs nvelse",
+  "Font Color": "Karakterszn",
+  "Background Color": "Httrszn",
+  "Horizontal Rule": "Elvlaszt vonal",
+  "Insert Web Link": "Hiperhivatkozs beszrsa",
+  "Insert/Modify Image": "Kp beszrsa",
+  "Insert Table": "Tblzat beszrsa",
+  "Toggle HTML Source": "HTML forrs be/ki",
+  "Enlarge Editor": "Szerkeszt kln ablakban",
+  "About this editor": "Nvjegy",
+  "Help using editor": "Sg",
+  "Current style": "Aktulis stlus",
+  "Undoes your last action": "Visszavons",
+  "Redoes your last action": "jra vgrehajts",
+  "Cut selection": "Kivgs",
+  "Copy selection": "Msols",
+  "Paste from clipboard": "Beilleszts",
+  "Direction left to right": "Irny balrl jobbra",
+  "Direction right to left": "Irny jobbrl balra",
+  "OK": "Rendben",
+  "Cancel": "Mgsem",
+  "Path": "Hierarchia",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "Forrs md. Visszavlts [<>] gomb",
+  "The full screen mode is known to cause problems with Internet Explorer, due to browser bugs that we weren": "A teljeskprenys szerkeszts hibt okozhat Internet Explorer hasznlata esetn, ez a bngsz a hibja, amit nem tudunk kikerlni. Szemetet szlelhet a kprenyn, illetve nhny funkci hinyozhat s/vagy vletlenszeren lefagyhat a bngsz. Windows 9x operacis futtatsa esetn elg valszn, hogy ",
+  "Cancel": "Mgsem",
+  "Insert/Modify Link": "Hivatkozs Beszrsa/Mdostsa",
+  "New window (_blank)": "j ablak (_blank)",
+  "None (use implicit)": "Nincs (use implicit)",
+  "Other": "Ms",
+  "Same frame (_self)": "Ugyanabba a keretbe (_self)",
+  "Target:": "Cl:",
+  "Title (tooltip):": "Cm (tooltip):",
+  "Top frame (_top)": "Fels keret (_top)",
+  "URL:": "URL:",
+  "You must enter the URL where this link points to": "Be kell rnia az URL-t, ahova a hivatkozs mutasson"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/it.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/it.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,55 @@
+// I18N constants
+
+// LANG: "it", ENCODING: UTF-8
+// Author: Mattia Landoni, http://www.webpresident.org/
+
+{
+  "Bold": "Grassetto",
+  "Italic": "Corsivo",
+  "Underline": "Sottolineato",
+  "Strikethrough": "Barrato",
+  "Subscript": "Pedice",
+  "Superscript": "Apice",
+  "Justify Left": "Sinistra",
+  "Justify Center": "Centrato",
+  "Justify Right": "Destra",
+  "Justify Full": "Giustificato",
+  "Ordered List": "Lista numerata",
+  "Bulleted List": "Lista non numerata",
+  "Decrease Indent": "Diminuisci indentazione",
+  "Increase Indent": "Aumenta indentazione",
+  "Font Color": "Colore font",
+  "Background Color": "Colore sfondo",
+  "Horizontal Rule": "Righello orizzontale",
+  "Insert Web Link": "Inserisci link",
+  "Insert/Modify Image": "Inserisci/modifica Immagine",
+  "Insert Table": "Inserisci tabella",
+  "Toggle HTML Source": "Visualizza/nascondi sorgente HTML",
+  "Enlarge Editor": "Allarga editor",
+  "About this editor": "Informazioni su Xinha",
+  "Help using editor": "Aiuto",
+  "Current style": "Stile corrente",
+  "Undoes your last action": "Annulla ultima azione",
+  "Redoes your last action": "Ripeti ultima azione",
+  "Cut selection": "Taglia",
+  "Copy selection": "Copia",
+  "Paste from clipboard": "Incolla",
+  "Direction left to right": "Testo da sx a dx",
+  "Direction right to left": "Testo da dx a sx",
+  "OK": "OK",
+  "Cancel": "Annulla",
+  "Path": "Percorso",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "Sei in MODALITA",
+  "The full screen mode is known to cause problems with Internet Explorer, due to browser bugs that we weren": "E",
+  "Cancel": "Annulla",
+  "Insert/Modify Link": "Inserisci/modifica link",
+  "New window (_blank)": "Nuova finestra (_blank)",
+  "None (use implicit)": "Niente (usa implicito)",
+  "Other": "Altro",
+  "Same frame (_self)": "Stessa frame (_self)",
+  "Target:": "Target:",
+  "Title (tooltip):": "Title (suggerimento):",
+  "Top frame (_top)": "Pagina intera (_top)",
+  "URL:": "URL:",
+  "You must enter the URL where this link points to": "Devi inserire l'indirizzo a cui punta il link"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/ja.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/ja.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,175 @@
+// I18N constants
+// LANG: "ja", ENCODING: UTF-8N
+
+{
+  "Bold": "",
+  "Italic": "",
+  "Underline": "",
+  "Strikethrough": "",
+  "Subscript": "",
+  "Superscript": "",
+  "Justify Left": "",
+  "Justify Center": "",
+  "Justify Right": "",
+  "Justify Full": "",
+  "Ordered List": "",
+  "Bulleted List": "",
+  "Decrease Indent": "",
+  "Increase Indent": "",
+  "Font Color": "",
+  "Background Color": "",
+  "Horizontal Rule": "",
+  "Insert Web Link": "",
+  "Insert/Modify Image": "/",
+  "Insert Table": "",
+  "Toggle HTML Source": "HTML",
+  "Enlarge Editor": "",
+  "About this editor": "",
+  "Help using editor": "",
+  "Current style": "",
+  "Undoes your last action": "",
+  "Redoes your last action": "",
+  "Cut selection": "",
+  "Copy selection": "",
+  "Paste from clipboard": "",
+  "Direction left to right": "",
+  "Direction right to left": "",
+  "Remove formatting": "",
+  "Select all": "",
+  "Print document": "",
+  "Clear MSOffice tags": "MSOffice",
+  "Clear Inline Font Specifications": "",
+  "Would you like to clear font typefaces?": "?",
+  "Would you like to clear font sizes?": "?",
+  "Would you like to clear font colours?": "?",
+  "Split Block": "",
+  "Toggle Borders": "",
+  "Save as": "",
+  "Insert/Overwrite": "/",
+  "&mdash; format &mdash;": "&mdash;  &mdash;",
+  "Heading 1": "1",
+  "Heading 2": "2",
+  "Heading 3": "3",
+  "Heading 4": "4",
+  "Heading 5": "5",
+  "Heading 6": "6",
+  "Normal": "",
+  "Address": "",
+  "Formatted": "",
+  "&mdash; font &mdash;": "&mdash;  &mdash;",
+  "&mdash; size &mdash;": "&mdash;  &mdash;",
+  
+  //dialogs
+  "OK": "OK",
+  "Cancel": "",
+  "Path": "",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "WYSIWYG[<>]",
+  "The Paste button does not work in Mozilla based web browsers (technical security reasons). Press CTRL-V on your keyboard to paste directly.": "MozillaWebCtrl+V",
+  "Your Document is not well formed. Check JavaScript console for details.": "JavaScript",
+  "You need to select some text before creating a link": "",
+
+  "Alignment:": ":",
+  "Not set": "",
+  "Left": "",
+  "Right": "",
+  "Texttop": "",
+  "Absmiddle": "()",
+  "Baseline": "",
+  "Absbottom": "()",
+  "Bottom": "",
+  "Middle": "",
+  "Top": "",
+
+  "Layout": "",
+  "Spacing": "",
+  "Horizontal:": ":",
+  "Horizontal padding": "",
+  "Vertical:": ":",
+  "Vertical padding": "",
+  "Border thickness:": ":",
+  "Leave empty for no border": "",
+
+  //Insert Link
+  "Insert/Modify Link": "/",
+  "None (use implicit)": " ()",
+  "New window (_blank)": " (_blank)",
+  "Same frame (_self)": " (_self)",
+  "Top frame (_top)": " (_top)",
+  "Other": "",
+  "Target:": ":",
+  "Title (tooltip):": ":",
+  "URL:": "URL:",
+  "You must enter the URL where this link points to": "URL",
+
+  // Insert Table
+  "Insert Table": "",
+  "Rows:": ":",
+  "Number of rows": "",
+  "Cols:": ":",
+  "Number of columns": "",
+  "Width:": ":",
+  "Width of the table": "",
+  "Percent": "(%)",
+  "Pixels": "(px)",
+  "Em": "(em)",
+  "Width unit": "",
+  "Fixed width columns": "",
+  "Positioning of this table": "",
+  "Cell spacing:": ":",
+  "Space between adjacent cells": "",
+  "Cell padding:": ":",
+  "Space between content and border in cell": "",
+  "You must enter a number of rows": "",
+  "You must enter a number of columns": "",
+
+  // Insert Image
+  "Insert Image": "",
+  "Image URL:": "URL:",
+  "Enter the image URL here": "URL",
+  "Preview": "",
+  "Preview the image in a new window": "",
+  "Alternate text:": ":",
+  "For browsers that don't support images": "",
+  "Positioning of this image": "",
+  "Image Preview:": ":",
+  "You must enter the URL": "URL",
+
+  //"button_bold": "fr/bold.gif",
+  //"button_underline": "fr/underline.gif",
+  //"button_strikethrough": "fr/strikethrough.gif",
+
+  // Editor Help
+  "Xinha Help": "",
+  "Editor Help": "",
+  "Keyboard shortcuts": "",
+  "The editor provides the following key combinations:": ":",
+  "ENTER": "ENTER",
+  "new paragraph": "",
+  "SHIFT-ENTER": "SHIFT+ENTER",
+  "insert linebreak": "",
+  "Set format to paragraph": "",
+  "Clean content pasted from Word": "Word",
+  "Headings": "",
+  "Close": "",
+
+  // Loading messages
+  "Loading in progress. Please wait!": "",
+  "Loading plugin $plugin" : " $plugin",
+  "Register plugin $plugin" : " $plugin", 
+  "Constructing object": "",
+  "Generate Xinha framework": "Xinha",
+  "Init editor size":"", 
+  "Create Toolbar": "",
+  "Create Statusbar" : "",
+  "Register right panel" : " ", 
+  "Register left panel" : " ", 
+  "Register bottom panel" : " ", 
+  "Register top panel" : " ", 
+  "Finishing" : "",
+  
+  // ColorPicker
+  "Click a color..." : "...",
+  "Sample" : "",
+  "Web Safe: " : "Web: ",
+  "Color: " : ": "  
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/lt.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/lt.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,53 @@
+// I18N constants
+
+// LANG: "lt", ENCODING: UTF-8
+// Author: Jaroslav atkevi, <jaro@akl.lt>
+
+{
+  "Bold": "Parykinti",
+  "Italic": "Kursyvas",
+  "Underline": "Pabraukti",
+  "Strikethrough": "Perbraukti",
+  "Subscript": "Apatinis indeksas",
+  "Superscript": "Virutinis indeksas",
+  "Justify Left": "Lygiavimas pagal kair",
+  "Justify Center": "Lygiavimas pagal centr",
+  "Justify Right": "Lygiavimas pagal dein",
+  "Justify Full": "Lygiuoti pastraip",
+  "Ordered List": "Numeruotas sraas",
+  "Bulleted List": "Suenklintas sraas",
+  "Decrease Indent": "Sumainti parat",
+  "Increase Indent": "Padidinti parat",
+  "Font Color": "rifto spalva",
+  "Background Color": "Fono spalva",
+  "Horizontal Rule": "Horizontali linija",
+  "Insert Web Link": "terpti nuorod",
+  "Insert/Modify Image": "terpti paveiksliuk",
+  "Insert Table": "terpti lentel",
+  "Toggle HTML Source": "Perjungti  HTML/WYSIWYG",
+  "Enlarge Editor": "Iplstas redagavimo ekranas/Enlarge Editor",
+  "About this editor": "Apie redaktori",
+  "Help using editor": "Pagalba naudojant redaktori",
+  "Current style": "Dabartinis stilius",
+  "Undoes your last action": "Ataukia paskutini js veiksm",
+  "Redoes your last action": "Pakartoja paskutin ataukt js veiksm",
+  "Cut selection": "Ikirpti",
+  "Copy selection": "Kopijuoti",
+  "Paste from clipboard": "terpti",
+  "OK": "OK",
+  "Cancel": "Ataukti",
+  "Path": "Kelias",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "Js esete teksto reime.  Naudokite [<>] mygtuk grimui  WYSIWYG.",
+  "The full screen mode is known to cause problems with Internet Explorer, due to browser bugs that we weren": "The full screen mode is known to cause problems with Internet Explorer, due to browser bugs that we weren",
+  "Cancel": "Ataukti",
+  "Insert/Modify Link": "Idti/Modifikuoti",
+  "New window (_blank)": "Naujas langas (_blank)",
+  "None (use implicit)": "None (use implicit)",
+  "Other": "Kitas",
+  "Same frame (_self)": "Same frame (_self)",
+  "Target:": "Target:",
+  "Title (tooltip):": "Pavadinimas (tooltip):",
+  "Top frame (_top)": "Top frame (_top)",
+  "URL:": "URL:",
+  "You must enter the URL where this link points to": "Jus privalote nurodyti URL  kuri rodo it nuoroda"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/lv.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/lv.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,42 @@
+// I18N constants
+
+// LANG: "lv", ENCODING: UTF-8
+// Author: Mihai Bazon, http://dynarch.com/mishoo
+// Translated by: Janis Klavins, <janis.klavins@devia.lv>
+
+{
+  "Bold": "Trekniem burtiem",
+  "Italic": "Kursv",
+  "Underline": "Pasvtrots",
+  "Strikethrough": "Prsvtrots",
+  "Subscript": "Novietot zem rindas",
+  "Superscript": "Novietot virs rindas",
+  "Justify Left": "Izldzint pa kreisi",
+  "Justify Center": "Izldzint centr",
+  "Justify Right": "Izldzint pa labi",
+  "Justify Full": "Izldzint pa visu lapu",
+  "Ordered List": "Numurts saraksts",
+  "Bulleted List": "Saraksts",
+  "Decrease Indent": "Samazint atkpi",
+  "Increase Indent": "Palielint atkpi",
+  "Font Color": "Burtu krsa",
+  "Background Color": "Fona krsa",
+  "Horizontal Rule": "Horizontla atdaltjsvtra",
+  "Insert Web Link": "Ievietot hipersaiti",
+  "Insert/Modify Image": "Ievietot attlu",
+  "Insert Table": "Ievietot tabulu",
+  "Toggle HTML Source": "Skatt HTML kodu",
+  "Enlarge Editor": "Palielint Reditju",
+  "About this editor": "Par o reditju",
+  "Help using editor": "Reditja palgs",
+  "Current style": "Patreizjais stils",
+  "Undoes your last action": "Atcelt pdjo darbbu",
+  "Redoes your last action": "Atkrtot pdjo darbbu",
+  "Cut selection": "Izgriezt iezmto",
+  "Copy selection": "Kopt iezmto",
+  "Paste from clipboard": "Ievietot iezmto",
+  "OK": "Labi",
+  "Cancel": "Atcelt",
+  "Path": "Ce",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "Js patlaban darbojaties TEKSTA REM. Lai prietu atpaka uz GRAFISKO REMU (WYSIWIG), lietojiet [<>] pogu."
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/nb.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/nb.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,78 @@
+// I18N constants
+
+// LANG: "nb", ENCODING: UTF-8
+
+// - translated by ses<ses@online.no>
+// Additional translations by Hvard Wigtil <havardw@extend.no>
+// Additional translations by Kim Steinhaug <kim@steinhaug.com>
+
+{
+  "Bold": "Fet",
+  "Italic": "Kursiv",
+  "Underline": "Understreket",
+  "Strikethrough": "Gjennomstreket",
+  "Subscript": "Nedsenket",
+  "Superscript": "Opphyet",
+  "Justify Left": "Venstrejuster",
+  "Justify Center": "Midtjuster",
+  "Justify Right": "Hyrejuster",
+  "Justify Full": "Blokkjuster",
+  "Ordered List": "Nummerert liste",
+  "Bulleted List": "Punktliste",
+  "Decrease Indent": "Reduser innrykk",
+  "Increase Indent": "ke innrykk",
+  "Font Color": "Tekstfarge",
+  "Background Color": "Bakgrundsfarge",
+  "Horizontal Rule": "Vannrett linje",
+  "Insert Web Link": "Lag lenke",
+  "Insert/Modify Image": "Sett inn bilde",
+  "Insert Table": "Sett inn tabell",
+  "Toggle HTML Source": "Vis kildekode",
+  "Enlarge Editor": "Vis i eget vindu",
+  "About this editor": "Om denne editor",
+  "Help using editor": "Hjelp",
+  "Current style": "Nvrende stil",
+  "Undoes your last action": "Angrer siste redigering",
+  "Redoes your last action": "Gjr om siste angring",
+  "Cut selection": "Klipp ut omrde",
+  "Copy selection": "Kopier omrde",
+  "Save as": "Lagre som",
+  "Paste from clipboard": "Lim inn",
+  "Remove formatting": "Fjern formattering",
+  "Direction left to right": "Fra venstre mot hyre",
+  "Direction right to left": "Fra hyre mot venstre",
+  "Insert/Overwrite": "Sett inn/Overskriv",
+  "OK": "OK",
+  "Cancel": "Avbryt",
+  "Path": "Tekstvelger",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "Du er i tekstmodus  Klikk p [<>] for  g tilbake til WYSIWIG.",
+  "The full screen mode is known to cause problems with Internet Explorer, due to browser bugs that we weren": "Visning i eget vindu har kjente problemer med Internet Explorer, p grunn av problemer med denne nettleseren. Mulige problemer er et uryddig skjermbilde, manglende editorfunksjoner og/eller at nettleseren crasher. Hvis du bruker Windows 95 eller Windows 98 er det ogs muligheter for at Windows will crashe.\n\nTrykk ",
+  "Cancel": "Avbryt",
+  "Insert/Modify Link": "Rediger lenke",
+  "New window (_blank)": "Eget vindu (_blank)",
+  "None (use implicit)": "Ingen (bruk standardinnstilling)",
+  "Other": "Annen",
+  "Same frame (_self)": "Samme ramme (_self)",
+  "Target:": "Ml:",
+  "Title (tooltip):": "Tittel (tooltip):",
+  "Top frame (_top)": "Toppramme (_top)",
+  "URL:": "Adresse:",
+  "You must enter the URL where this link points to": "Du m skrive inn en adresse som denne lenken skal peke til",
+  "Clear Inline Font Specifications": "Fjerne inline font spesifikasjoner",
+  "Would you like to clear font typefaces?": "nsker du  fjerne skrifttyper",
+  "Would you like to clear font sizes?": "nsker du  fjerne skrift strrelser",
+  "Would you like to clear font colours?": "nsker du  fjerne farger p skriften",
+  "Print document": "Skriv ut dokumentet",
+  "Split Block": "Seperasjonsblokk",
+  "Toggle Borders": "Skru av/p hjelpelinjer p tabeller",
+  "Select all": "Merk alt",
+  // Loading messages
+  "Loading in progress. Please wait !": "WYSIWYG laster, vennligst vent!",
+  "Constructing main object": "Vennligst vent",
+  "Create Toolbar": "Lag verktylinje",
+  "Register panel right": "Registrer hyrepanel",
+  "Register panel left": "Registrer venstrepanel",
+  "Register panel top": "Registrer toppanel",
+  "Register panel bottom": "Registrer bunnpanel"
+
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/nl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/nl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,64 @@
+// I18N constants
+
+// LANG: "nl", ENCODING: UTF-8
+// Author: Michel Weegeerink (info@mmc-shop.nl), http://mmc-shop.nl
+
+// FOR TRANSLATORS:
+//
+//   1. PLEASE PUT YOUR CONTACT INFO IN THE ABOVE LINE
+//      (at least a valid email address)
+//
+//   2. PLEASE TRY TO USE UTF-8 FOR ENCODING;
+//      (if this is not possible, please include a comment
+//       that states what encoding is necessary.)
+
+{
+  "Bold": "Vet",
+  "Italic": "Cursief",
+  "Underline": "Onderstrepen",
+  "Strikethrough": "Doorhalen",
+  "Subscript": "Subscript",
+  "Superscript": "Superscript",
+  "Justify Left": "Links uitlijnen",
+  "Justify Center": "Centreren",
+  "Justify Right": "Rechts uitlijnen",
+  "Justify Full": "Uitvullen",
+  "Ordered List": "Nummering",
+  "Bulleted List": "Opsommingstekens",
+  "Decrease Indent": "Inspringing verkleinen",
+  "Increase Indent": "Inspringing vergroten",
+  "Font Color": "Tekstkleur",
+  "Background Color": "Achtergrondkleur",
+  "Horizontal Rule": "Horizontale lijn",
+  "Insert Web Link": "Hyperlink invoegen/aanpassen",
+  "Insert/Modify Image": "Afbeelding invoegen/aanpassen",
+  "Insert Table": "Tabel invoegen",
+  "Toggle HTML Source": "HTML broncode",
+  "Enlarge Editor": "Vergroot Editor",
+  "About this editor": "Over deze editor",
+  "Help using editor": "Xinha help",
+  "Current style": "Huidige stijl",
+  "Undoes your last action": "Ongedaan maken",
+  "Redoes your last action": "Herhalen",
+  "Cut selection": "Knippen",
+  "Copy selection": "Kopi?ren",
+  "Paste from clipboard": "Plakken",
+  "Direction left to right": "Tekstrichting links naar rechts",
+  "Direction right to left": "Tekstrichting rechts naar links",
+  "OK": "OK",
+  "Cancel": "Annuleren",
+  "Path": "Pad",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "Je bent in TEKST-mode. Gebruik de [<>] knop om terug te keren naar WYSIWYG-mode.",
+  "The full screen mode is known to cause problems with Internet Explorer, due to browser bugs that we weren": "Fullscreen-mode veroorzaakt problemen met Internet Explorer door bugs in de webbrowser die we niet kunnen omzeilen. Hierdoor kunnen de volgende effecten optreden: verknoeide teksten, een verlies aan editor-functionaliteit en/of willekeurig vastlopen van de webbrowser. Als u Windows 95 of 98 gebruikt, is het zeer waarschijnlijk dat u een algemene beschermingsfout (",
+  "Cancel": "Annuleren",
+  "Insert/Modify Link": "Hyperlink invoegen/aanpassen",
+  "New window (_blank)": "Nieuw venster (_blank)",
+  "None (use implicit)": "Geen",
+  "Other": "Ander",
+  "Same frame (_self)": "Zelfde frame (_self)",
+  "Target:": "Doel:",
+  "Title (tooltip):": "Titel (tooltip):",
+  "Top frame (_top)": "Bovenste frame (_top)",
+  "URL:": "URL:",
+  "You must enter the URL where this link points to": "Geef de URL in waar de link naar verwijst"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/pl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/pl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,125 @@
+// I18N constants
+// LANG: "pl", ENCODING: UTF-8
+// translated: Krzysztof Kotowicz, http://www.eskot.krakow.pl/portfolio/, koto@webworkers.pl
+{
+  "Bold": "Pogrubienie",
+  "Italic": "Pochylenie",
+  "Underline": "Podkrelenie",
+  "Strikethrough": "Przekrelenie",
+  "Subscript": "Indeks dolny",
+  "Superscript": "Indeks grny",
+  "Justify Left": "Wyrwnaj do lewej",
+  "Justify Center": "Wyrodkuj",
+  "Justify Right": "Wyrwnaj do prawej",
+  "Justify Full": "Wyjustuj",
+  "Ordered List": "Numerowanie",
+  "Bulleted List": "Wypunktowanie",
+  "Decrease Indent": "Zmniejsz wcicie",
+  "Increase Indent": "Zwiksz wcicie",
+  "Font Color": "Kolor czcionki",
+  "Background Color": "Kolor ta",
+  "Horizontal Rule": "Linia pozioma",
+  "Insert Web Link": "Wstaw adres sieci Web",
+  "Insert/Modify Image": "Wstaw obraz",
+  "Insert Table": "Wstaw tabel",
+  "Toggle HTML Source": "Edycja WYSIWYG/w rdle strony",
+  "Enlarge Editor": "Peny ekran",
+  "About this editor": "Informacje o tym edytorze",
+  "Help using editor": "Pomoc",
+  "Current style": "Obecny styl",
+  "Undoes your last action": "Cofa ostatnio wykonane polecenie",
+  "Redoes your last action": "Ponawia ostatnio wykonane polecenie",
+  "Cut selection": "Wycina zaznaczenie do schowka",
+  "Copy selection": "Kopiuje zaznaczenie do schowka",
+  "Paste from clipboard": "Wkleja zawarto schowka",
+  "Direction left to right": "Kierunek tekstu lewo-prawo",
+  "Direction right to left": "Kierunek tekstu prawo-lewo",
+  "Remove formatting": "Usu formatowanie",
+  "Select all": "Zaznacz wszystko",
+  "Print document": "Drukuj dokument",
+  "Clear MSOffice tags": "Wyczy tagi MSOffice",
+  "Clear Inline Font Specifications": "Wycisz bezporednie przypisania czcionek",
+  "Split Block": "Podziel blok",
+  "Toggle Borders": "Wcz / wycz ramki",
+
+  "&mdash; format &mdash;": "&mdash; Format &mdash;",
+  "Heading 1": "Nagwek 1",
+  "Heading 2": "Nagwek 2",
+  "Heading 3": "Nagwek 3",
+  "Heading 4": "Nagwek 4",
+  "Heading 5": "Nagwek 5",
+  "Heading 6": "Nagwek 6",
+  "Normal": "Normalny",
+  "Address": "Adres",
+  "Formatted": "Preformatowany",
+
+  //dialogs
+  "OK": "OK",
+  "Cancel": "Anuluj",
+  "Path": "cieka",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "Jeste w TRYBIE TEKSTOWYM. Uyj przycisku [<>], aby przeczy si na tryb WYSIWYG.",
+  "The Paste button does not work in Mozilla based web browsers (technical security reasons). Press CTRL-V on your keyboard to paste directly.": "Przycisk Wklej nie dziaa w przegldarkach Mozilla z uwagi na ustawienia bezpieczestwa. Nacinij CRTL-V, aby wklei zawarto schowka.",
+
+  "Alignment:": "Wyrwnanie:",
+  "Not set": "Nie ustawione",
+  "Left": "Do lewej",
+  "Right": "Do prawej",
+  "Texttop": "Gra tekstu",
+  "Absmiddle": "Abs. rodek",
+  "Baseline": "Linia bazowa",
+  "Absbottom": "Abs. d",
+  "Bottom": "D",
+  "Middle": "rodek",
+  "Top": "Gra",
+
+  "Layout": "Layout",
+  "Spacing": "Spacjowanie",
+  "Horizontal:": "Poziome:",
+  "Horizontal padding": "Wcicie poziome",
+  "Vertical:": "Pionowe:",
+  "Vertical padding": "Wcicie pionowe",
+  "Border thickness:": "Grubo obramowania:",
+  "Leave empty for no border": "Bez ramek - zostaw puste",
+
+  //Insert Link
+  "Insert/Modify Link": "Wstaw/edytuj odnonik",
+  "None (use implicit)": "Brak",
+  "New window (_blank)": "Nowe okno (_blank)",
+  "Same frame (_self)": "Ta sama ramka (_self)",
+  "Top frame (_top)": "Gwna ramka (_top)",
+  "Other": "Inne",
+  "Target:": "Okno docelowe:",
+  "Title (tooltip):": "Tytu (tooltip):",
+  "URL:": "URL:",
+  "You must enter the URL where this link points to": "Musisz poda URL, na jaki bdzie wskazywa odnonik",
+
+  // Insert Table
+  "Insert Table": "Wstaw tabel",
+  "Rows:": "Wierszy:",
+  "Number of rows": "Liczba wierszy",
+  "Cols:": "Kolumn:",
+  "Number of columns": "Liczba kolumn",
+  "Width:": "Szeroko:",
+  "Width of the table": "Szeroko tabeli",
+  "Percent": "Procent",
+  "Pixels": "Pikseli",
+  "Em": "Em",
+  "Width unit": "Jednostka",
+  "Fixed width columns": "Kolumny o staej szerokoci",
+  "Positioning of this table": "Pozycjonowanie tabeli",
+  "Cell spacing:": "Odstp komrek:",
+  "Space between adjacent cells": "Przestrze pomidzy komrkami",
+  "Cell padding:": "Wcicie komrek:",
+  "Space between content and border in cell": "Przestrze midzy krawdzi a zawartoci komrki",
+
+  // Insert Image
+  "Insert Image": "Wstaw obrazek",
+  "Image URL:": "URL obrazka:",
+  "Enter the image URL here": "Podaj URL obrazka",
+  "Preview": "Podgld",
+  "Preview the image in a new window": "Podgld obrazka w nowym oknie",
+  "Alternate text:": "Tekst alternatywny:",
+  "For browsers that don't support images": "Dla przegldarek, ktre nie obsuguj obrazkw",
+  "Positioning of this image": "Pozycjonowanie obrazka",
+  "Image Preview:": "Podgld obrazka:"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,184 @@
+// I18N constants
+//
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+//
+// Initial basic work by Alex Piaz <webmaster@globalmap.com>
+//
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+//
+// Last revision: 06 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+//
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt)
+{
+  "About": "Sobre",
+  "About Xinha": "Sobre o Xinha",
+  "Absbottom": "Inferior absoluto",
+  "Absmiddle": "Meio absoluto",
+  "Alignment:": "Alinhamento",
+  "Alternate text:": "Texto alternativo",
+  "Baseline": "Linha base",
+  "Bold": "Negrito",
+  "Border thickness:": "Espessura da borda",
+  "Bottom": "Boto",
+  "CTRL-0 (zero)": "CTRL-0 (zero)",
+  "CTRL-1 .. CTRL-6": "CTRL-1 .. CTRL-6",
+  "CTRL-A": "CTRL-A",
+  "CTRL-B": "CTRL-B",
+  "CTRL-C": "CTRL-C",
+  "CTRL-E": "CTRL-E",
+  "CTRL-I": "CTRL-I",
+  "CTRL-J": "CTRL-J",
+  "CTRL-L": "CTRL-L",
+  "CTRL-N": "CTRL-N",
+  "CTRL-R": "CTRL-R",
+  "CTRL-S": "CTRL-S",
+  "CTRL-U": "CTRL-U",
+  "CTRL-V": "CTRL-V",
+  "CTRL-X": "CTRL-X",
+  "CTRL-Y": "CTRL-Y",
+  "CTRL-Z": "CTRL-Z",
+  "Cancel": "Cancelar",
+  "Cell padding:": "Espaamento interno da clula:",
+  "Cell spacing:": "Espaamento da clula:",
+  "Clean content pasted from Word": "Limpar contedo copiado do Word",
+  "Close": "Fechar",
+  "Collapse borders:": "Bordas fechadas:",
+  "Cols:": "Colunas:",
+  "Constructing object": "Construindo objeto",
+  "Copy selection": "Copiar seleo",
+  "Create Statusbar": "Criar barra de informao (statusbar)",
+  "Create Toolbar": "Criar Barra de Ferramentas",
+  "Current style": "Estilo Atual",
+  "Cut selection": "Recortar seleo",
+  "Developer": "Desenvolvedor",
+  "ENTER": "ENTRAR",
+  "Editor Help": "Ajuda do Editor",
+  "Em": "Em",
+  "Enter the image URL here": "Entre aqui com a URL da imagem",
+  "Finishing": "Terminando",
+  "Fixed width columns": "Colunas com largura fixa",
+  "For browsers that don't support images": "Para navegadores que no suportam imagens",
+  "Generate Xinha framework": "Gerar rea de Trabalho do Xinha",
+  "Headings": "Ttulos",
+  "Horizontal padding": "Espaamento interno horizontal",
+  "Horizontal:": "Horizontal:",
+  "Image Preview:": "Visualizao da Imagem:",
+  "Image URL:": "URL da imagem:",
+  "Init editor size": "Iniciar tamanho do editor",
+  "Insert Image": "Inserir Imagem",
+  "Insert Table": "Inserir Tabela",
+  "Insert/Modify Link": "Inserir/Modificar Link",
+  "Italic": "Itlico",
+  "Justify Center": "Justificar Centralizado",
+  "Justify Full": "Justificar Completamente",
+  "Justify Left": "Justificar  Esquerda",
+  "Justify Right": "Justificar  Direita",
+  "Keyboard shortcuts": "Atalhos de Teclado",
+  "Layout": "Esquema",
+  "Leave empty for no border": "Deixe em branco para no ter bordas",
+  "Left": "Esquerda",
+  "License": "Licena",
+  "Loading in progress. Please wait!": "Carregamento em processo. Por favor, aguarde!",
+  "Middle": "Meio",
+  "Name": "Nome",
+  "New window (_blank)": "Nova janela (_blank)",
+  "None (use implicit)": "Nenhum (uso implicito)",
+  "Not set": "No definido",
+  "Number of columns": "Nmero de colunas",
+  "Number of rows": "Nmero de linhas",
+  "OK": "OK",
+  "Paste from clipboard": "Colar da rea de Transferncia",
+  "Path": "Caminho",
+  "Percent": "Porcentagem",
+  "Pixels": "Pixels",
+  "Plugins": "Plugins",
+  "Positioning of this image": "Posicionamento desta imagem",
+  "Positioning of this table": "Posicionamento desta tabela",
+  "Preview": "Visualizao",
+  "Preview the image in a new window": "Visualizar a imagem em uma nova janela",
+  "Redoes your last action": "Refazer sua ltima ao",
+  "Right": "Direita",
+  "Rows:": "Linhas:",
+  "SHIFT-ENTER": "SHIFT-ENTER",
+  "Same frame (_self)": "Mesmo frame (_self)",
+  "Select Color": "Selecionar cr",
+  "Select all": "Selecionar tudo",
+  "Set format to paragraph": "Definir formato para o pargrafo",
+  "Space between adjacent cells": "Espao entre clulas adjacentes",
+  "Space between content and border in cell": "Espao entre contedo e borda na clula",
+  "Spacing": "Espaamento",
+  "Sponsored by": "Patrocinado por",
+  "Strikethrough": "Tachado",
+  "Target:": "Destino:",
+  "Texttop": "Texto no topo",
+  "Thanks": "Agradecimentos",
+  "The Paste button does not work in Mozilla based web browsers (technical security reasons). Press CTRL-V on your keyboard to paste directly.": "O boto Colar no funciona em navegadores baseado no Mozilla (por razes tcnicas de segurana). Pressione CTRL-V no seu teclado para colar diretamente.",
+  "The editor provides the following key combinations:": "Este editor fornece a seguinte combinao de teclas:",
+  "Title (tooltip):": "Ttulo (tooltip)",
+  "Top": "Topo",
+  "Top frame (_top)": "Frame no topo (_top)",
+  "URL:": "URL:",
+  "Underline": "Sublinhado",
+  "Undoes your last action": "Desfazer sua ltima ao",
+  "Version": "Verso",
+  "Vertical padding": "Espaamento interno vertical",
+  "Vertical:": "Vertical:",
+  "Width of the table": "Larguran da tabela",
+  "Width unit": "Unidade de largura",
+  "Width:": "Largura:",
+  "Would you like to clear font colours?": "Deseja limpar as cores de fonte",
+  "Would you like to clear font sizes?": "Deseja limpar os tamanhos de fonte",
+  "Would you like to clear font typefaces?": "Deseja limpar os tipos de fonte",
+  "Xinha Help": "Ajuda do Xinha",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "Voc est no MODO TEXTO.  Use o boto [<>] para mudar para o modo de Visualizao (WYSIWYG)",
+  "Your Document is not well formed. Check JavaScript console for details.": "Seu Documento no est formatado corretamente. Verifique o console do JavaScript para maiores detalhes.",
+  "insert linebreak": "inserir quebra de linha",
+  "new paragraph": "novo pargrafo",
+  
+  // not find with lc_parse_strings.php
+  "Subscript": "Subescrito",
+  "Superscript": "Sobrescrito",
+  "Direction left to right": "Da esquerda para direita",
+  "Direction right to left": "Da direita para esquerda",
+  "Remove formatting": "Remover formatao",
+  "Select all": "Selecionar tudo",
+  "Print document": "Imprimir documento",
+  "Clear MSOffice tags": "Limpar tags do MS Office",
+  "Clear Inline Font Specifications": "Limpar especificaes de fontes inline",
+  "Split Block": "Dividir Bloco",
+  "Toggle Borders": "Mudar Bordas",
+  "Save as": "Salvar como",
+  "Insert/Overwrite": "Inserir/Sobrescrever",
+  "&mdash; format &mdash;": "&mdash; formato &mdash;",
+  "Heading 1": "Ttulo 1",
+  "Heading 2": "Ttulo 2",
+  "Heading 3": "Ttulo 3",
+  "Heading 4": "Ttulo 4",
+  "Heading 5": "Ttulo 5",
+  "Heading 6": "Ttulo 6",
+  "Normal": "Normal",
+  "Address": "Endereo",
+  "Formatted": "Formatado",
+  "&mdash; font &mdash;": "&mdash; fonte &mdash;",
+  "&mdash; size &mdash;": "&mdash; tamanho &mdash;",
+  "Ordered List": "Lista Numerada",
+  "Bulleted List": "Lista Marcadores",
+  "Decrease Indent": "Diminuir Indentao",
+  "Increase Indent": "Aumentar Indentao",
+  "Font Color": "Cor da Fonte",
+  "Background Color": "Cor do Fundo",
+  "Horizontal Rule": "Linha Horizontal",
+  "Insert Web Link": "Inserir Link",
+  "Insert/Modify Image": "Inserir/Modificar Imagem",
+  "Insert Table": "Inserir Tabela",
+  "Toggle HTML Source": "Ver Cdigo-Fonte",
+  "Enlarge Editor": "Expandir Editor",
+  "About this editor": "Sobre este editor",
+  "Help using editor": "Ajuda - Usando o editor"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/ro.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/ro.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,63 @@
+// I18N constants
+
+// LANG: "ro", ENCODING: UTF-8
+// Author: Mihai Bazon, http://dynarch.com/mishoo
+
+// FOR TRANSLATORS:
+//
+//   1. PLEASE PUT YOUR CONTACT INFO IN THE ABOVE LINE
+//      (at least a valid email address)
+//
+//   2. PLEASE TRY TO USE UTF-8 FOR ENCODING;
+//      (if this is not possible, please include a comment
+//       that states what encoding is necessary.)
+
+{
+  "Bold": "ngroat",
+  "Italic": "Italic",
+  "Underline": "Subliniat",
+  "Strikethrough": "Tiat",
+  "Subscript": "Indice jos",
+  "Superscript": "Indice sus",
+  "Justify Left": "Aliniere la stnga",
+  "Justify Center": "Aliniere pe centru",
+  "Justify Right": "Aliniere la dreapta",
+  "Justify Full": "Aliniere n ambele pri",
+  "Ordered List": "List ordonat",
+  "Bulleted List": "List marcat",
+  "Decrease Indent": "Micoreaz alineatul",
+  "Increase Indent": "Mrete alineatul",
+  "Font Color": "Culoarea textului",
+  "Background Color": "Culoare de fundal",
+  "Horizontal Rule": "Linie orizontal",
+  "Insert Web Link": "Insereaz/modific link",
+  "Insert/Modify Image": "Insereaz/modific imagine",
+  "Insert Table": "Insereaz un tabel",
+  "Toggle HTML Source": "Sursa HTML / WYSIWYG",
+  "Enlarge Editor": "Maximizeaz editorul",
+  "About this editor": "Despre editor",
+  "Help using editor": "Documentaie (devel)",
+  "Current style": "Stilul curent",
+  "Undoes your last action": "Anuleaz ultima aciune",
+  "Redoes your last action": "Reface ultima aciune anulat",
+  "Cut selection": "Taie n clipboard",
+  "Copy selection": "Copie n clipboard",
+  "Paste from clipboard": "Aduce din clipboard",
+  "Direction left to right": "Direcia de scriere: stnga - dreapta",
+  "Direction right to left": "Direcia de scriere: dreapta - stnga",
+  "OK": "OK",
+  "Cancel": "Anuleaz",
+  "Path": "Calea",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "Eti n modul TEXT.  Apas butonul [<>] pentru a te ntoarce n modul WYSIWYG.",
+  "Cancel": "Renun",
+  "Insert/Modify Link": "Insereaz/modifc link",
+  "New window (_blank)": "Fereastr nou (_blank)",
+  "None (use implicit)": "Nimic (folosete ce-i implicit)",
+  "Other": "Alt target",
+  "Same frame (_self)": "Aceeai fereastr (_self)",
+  "Target:": "inta:",
+  "Title (tooltip):": "Titlul (tooltip):",
+  "Top frame (_top)": "Fereastra principal (_top)",
+  "URL:": "URL:",
+  "You must enter the URL where this link points to": "Trebuie s introducei un URL"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/ru.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/ru.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,185 @@
+// I18N constants
+
+// LANG: "ru", ENCODING: UTF-8
+// Author: Yulya Shtyryakova, <yulya@vdcom.ru>
+
+// Some additions by: Alexey Kirpichnikov, <alexkir@kiwistudio.ru>
+// I took French version as a source of English phrases because French version was the most comprehensive
+// (fr.js was the largest file, actually) %)
+
+// FOR TRANSLATORS:
+//
+//   1. PLEASE PUT YOUR CONTACT INFO IN THE ABOVE LINE
+//      (at least a valid email address)
+//
+//   2. PLEASE TRY TO USE UTF-8 FOR ENCODING;
+//      (if this is not possible, please include a comment
+//       that states what encoding is necessary.)
+
+{
+  "Bold": "",
+  "Italic": "",
+  "Underline": "",
+  "Strikethrough": "",
+  "Subscript": " ",
+  "Superscript": " ",
+  "Justify Left": "  ",
+  "Justify Center": " ",
+  "Justify Right": "  ",
+  "Justify Full": " ",
+  "Ordered List": " ",
+  "Bulleted List": " ",
+  "Decrease Indent": " ",
+  "Increase Indent": " ",
+  "Font Color": " ",
+  "Background Color": " ",
+  "Horizontal Rule": " ",
+  "Insert Web Link": " ",
+  "Insert/Modify Image": " ",
+  "Insert Table": " ",
+  "Toggle HTML Source": " Html-",
+  "Enlarge Editor": " ",
+  "About this editor": " ",
+  "Help using editor": "",
+  "Current style": " ",
+  "Undoes your last action": "",
+  "Redoes your last action": "",
+  "Cut selection": "",
+  "Copy selection": "",
+  "Paste from clipboard": "",
+  "Direction left to right": "  ",
+  "Direction right to left": "  ",
+  "Remove formatting": " ",
+  "Select all": " ",
+  "Print document": "",
+  "Clear MSOffice tags": "  MSOffice",
+  "Clear Inline Font Specifications": "   ",
+  "Would you like to clear font typefaces?": "  ?",
+  "Would you like to clear font sizes?": "   ?",
+  "Would you like to clear font colours?": "   ?",
+  "Split Block": " ",
+  "Toggle Borders": "/  ",
+  "Save as": " ",
+  "Insert/Overwrite": "/",
+  "&mdash; format &mdash;": "&mdash;  &mdash;",
+  "Heading 1": " 1",
+  "Heading 2": " 2",
+  "Heading 3": " 3",
+  "Heading 4": " 4",
+  "Heading 5": " 5",
+  "Heading 6": " 6",
+  "Normal": " ",
+  "Address": "",
+  "Formatted": " ",
+
+  "&mdash; font &mdash;": "&mdash;  &mdash;",
+  "&mdash; size &mdash;": "&mdash;  &mdash;",
+
+
+// 
+
+  "OK": "OK",
+  "Cancel": "",
+  "Path": "",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "    Html-.   [<>],     .",
+
+"The Paste button does not work in Mozilla based web browsers (technical security reasons). Press CTRL-V on your keyboard to paste directly.": "        Mozilla (  ,   ).  Ctrl-V  ,  .",
+
+  "Your Document is not well formed. Check JavaScript console for details.": "   .   JavaScript,   .",
+
+  "Alignment:": "",
+  "Not set": " ",
+  "Left": "  ",
+  "Right": "  ",
+  "Texttop": "   ",
+  "Absmiddle": "  ",
+  "Baseline": "   ",
+  "Absbottom": "  ",
+  "Bottom": "  ",
+  "Middle": "",
+  "Top": "  ",
+
+  "Layout": "",
+  "Spacing": "",
+  "Horizontal:": " ",
+  "Horizontal padding": " ",
+  "Vertical:": " ",
+  "Vertical padding": " ",
+  "Border thickness:": " ",
+  "Leave empty for no border": " ,   ",
+
+  //Insert Link
+  "Insert/Modify Link": "/ ",
+  "None (use implicit)": " ",
+  "New window (_blank)": "  (_blank)",
+  "Same frame (_self)": "   (_self)",
+  "Top frame (_top)": "  (_top)",
+  "Other": "",
+  "Target:": "  :",
+  "Title (tooltip):": " ",
+  "URL:": "URL:",
+  "You must enter the URL where this link points to": "   URL,     ",
+  "You need to select some text before creating a link": "   ,     ",
+
+  // Insert Table
+  "Insert Table": " ",
+  "Rows:": "",
+  "Number of rows": " ",
+  "Cols:": "",
+  "Number of columns": " ",
+  "Width:": "",
+  "Width of the table": " ",
+  "Percent": "",
+  "Pixels": "",
+  "Em": "em",
+  "Width unit": " ",
+  "Fixed width columns": "  ",
+  "Positioning of this table": " ",
+  "Cell spacing:": "  ",
+  "Space between adjacent cells": "   ",
+  "Cell padding:": "  ",
+  "Space between content and border in cell": "     ",
+  "You must enter a number of rows": "    ",
+  "You must enter a number of columns": "    ",
+
+  // Insert Image
+  "Insert Image": " ",
+  "Image URL:": "URL ",
+  "Enter the image URL here": "  ",
+  "Preview": " ",
+  "Preview the image in a new window": "    ",
+  "Alternate text:": " ",
+  "For browsers that don't support images": " ,    ",
+  "Positioning of this image": " ",
+  "Image Preview:": " ",
+  "You must enter the URL": "   URL",
+
+  // Editor Help
+  "Xinha Help": "",
+  "Editor Help": "",
+  "Keyboard shortcuts": " ",
+  "The editor provides the following key combinations:": "    :",
+  "ENTER": "ENTER",
+  "new paragraph": " ",
+  "SHIFT-ENTER": "SHIFT+ENTER",
+  "insert linebreak": " ",
+  "Set format to paragraph": " ",
+  "Clean content pasted from Word": " ,   Word",
+  "Headings": "",
+  "Close": "",
+
+  // Loading messages
+  "Loading in progress. Please wait !": "... , .",
+  "Constructing main object": "  ",
+  "Constructing object": " ",
+  "Register panel right": "  ",
+  "Register panel left": "  ",
+  "Register panel top": "  ",
+  "Register panel bottom": "  ",
+  "Create Toolbar": "  ",
+  "Create StatusBar": "  ",
+  "Generate Xinha object": "  Xinha",
+  "Init editor size": "  ",
+  "Init IFrame": " iframe",
+  "Register plugin $plugin": " $plugin"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/sh.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/sh.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,140 @@
+// I18N constants
+
+// LANG: "sh", ENCODING: UTF-8 | ISO-8859-2
+// Author: Ljuba Rankovi, http://www.rankovic.net/ljubar
+
+// FOR TRANSLATORS:
+//
+//   1. PLEASE PUT YOUR CONTACT INFO IN THE ABOVE LINE
+//      (at least a valid email address)
+//
+//   2. PLEASE TRY TO USE UTF-8 FOR ENCODING;
+//      (if this is not possible, please include a comment
+//       that states what encoding is necessary.)
+
+{
+		"Bold": "Masno",
+		"Italic": "Kurziv",
+		"Underline": "Podvueno",
+		"Strikethrough": "Precrtano",
+		"Subscript": "Indeks-tekst",
+		"Superscript": "Eksponent-tekst",
+		"Justify Left":"Ravnanje ulevo",
+		"Justify Center": "Ravnanje po simetrali",
+		"Justify Right": "Ravnanje udesno",
+		"Justify Full": "Puno ravnanje",
+		"Ordered List": "Lista sa rednim brojevima",
+		"Bulleted List": "Lista sa simbolima",
+		"Decrease Indent": "smanji uvlaenje",
+		"Increase Indent": "Poveaj uvlaenje",
+		"Font Color": "Boja slova",
+		"Background Color": "Boja pozadine",
+		"Horizontal Rule": "Horizontalna linija",
+		"Insert Web Link": "Dodaj web link",
+		"Insert/Modify Image": "Dodaj/promeni sliku",
+		"Insert Table": "Ubaci tabelu",
+		"Toggle HTML Source": "Prebaci na HTML kod",
+		"Enlarge Editor": "Poveaj editor",
+		"About this editor": "O ovom editoru",
+		"Help using editor": "Pomo pri korienju editora",
+		"Current style": "Vaei stil",
+		"Undoes your last action": "Ponitava poslednju radnju",
+		"Redoes your last action": "Vraa poslednju radnju",
+		"Cut selection": "Iseci izabrano",
+		"Copy selection": "Kopiraj izabrano",
+		"Paste from clipboard": "Zalepi iz klipborda",
+		"Direction left to right": "Pravac s leva na desno",
+		"Direction right to left": "Pravac s desna na levo",
+        "Remove formatting": "Ukoni formatiranje",
+        "Select all": "Izaberi sve",
+        "Print document": "tampaj dokument",
+        "Clear MSOffice tags": "Obrii MSOffice tagove",
+        "Clear Inline Font Specifications": "Obrii dodeljene osobine fonta",
+        "Split Block": "Podeli blok",
+        "Toggle Borders": "Izmeni okvire",
+
+        "&mdash; format &mdash;": "&mdash; Format &mdash;",
+        "Heading 1": "Zaglavlje 1",
+        "Heading 2": "Zaglavlje 2",
+        "Heading 3": "Zaglavlje 3",
+        "Heading 4": "Zaglavlje 4",
+        "Heading 5": "Zaglavlje 5",
+        "Heading 6": "Zaglavlje 6",
+        "Normal": "Obian",
+        "Address": "Adresa",
+        "Formatted": "Formatiran",
+        
+        // dialogs
+		"OK": "OK",
+		"Cancel": "Poniti",
+		"Path": "Putanja",
+		"You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "Nalazite se u TEXT reimu.  Koristite [<>] dugme za povratak na WYSIWYG.",
+
+		"The Paste button does not work in Mozilla based web browsers (technical security reasons). Press CTRL-V on your keyboard to paste directly.": "",
+
+        "Alignment:": "Ravnanje",
+        "Not set": "Nije postavljeno",
+        "Left": "Levo",
+        "Right": "Desno",
+        "Texttop": "Vrh teksta",
+        "Absmiddle": "Apsolutna sredina",
+        "Baseline": "Donja linija",
+        "Absbottom": "Apsolutno dno",
+        "Bottom": "Dno",
+        "Middle": "Sredina",
+        "Top": "Vrh",
+
+        "Layout": "Prelom",
+        "Spacing": "Razmak",
+        "Horizontal:": "Po horizontali",
+        "Horizontal padding": "Horizontalno odstojanje",
+        "Vertical:": "Po vertikali",
+        "Vertical padding": "Vertikalno odstojanje",
+        "Border thickness:": "Debljina okvira",
+        "Leave empty for no border": "Ostavi prazno kad nema okvira",
+		
+        // Insert Link
+		"Insert/Modify Link": "Dodaj/promeni Link",
+		"None (use implicit)": "koristi podrazumevano",
+		"New window (_blank)": "Novom prozoru (_blank)",
+		"Same frame (_self)": "Isti frejm (_self)",
+		"Top frame (_top)": "Glavni frejm (_top)",
+		"Other": "Drugo",
+		"Target:": "Otvori u:",
+		"Title (tooltip):": "Naziv (tooltip):",
+		"URL:": "URL:",
+		"You must enter the URL where this link points to": "Morate uneti URL na koji vodi ovaj link",
+		
+        // Insert Table
+        "Insert Table": "Ubaci tabelu",
+        "Rows:": "Redovi",
+        "Number of rows": "Broj redova",
+        "Cols:": "Kolone",
+        "Number of columns": "Broj kolona",
+        "Width:": "irina",
+        "Width of the table": "irina tabele",
+        "Percent": "Procenat",
+        "Pixels": "Pikseli",
+        "Em": "Em",
+        "Width unit": "Jedinica irine",
+        "Fixed width columns": "Fiksirana irina kolona",
+        "Positioning of this table": "Postavljanje ove tabele",
+        "Cell spacing:": "Rastojanje elija",
+        "Space between adjacent cells": "Rastojanje naspramnih elija",
+        "Cell padding:": "Unutranja odstojanja u eliji",
+        "Space between content and border in cell": "Rastojanje izmeu sadraja i okvira elije",
+
+        // Insert Image
+        "Insert Image": "Ubaci sliku",
+        "Image URL:": "URL slike",
+        "Enter the image URL here": "Unesite URL slike ovde",
+        "Preview": "Pregled",
+        "Preview the image in a new window": "Pregledaj sliku u novom prozoru",
+        "Alternate text:": "Alternativni tekst",
+        "For browsers that don't support images": "Za pretraivae koji ne podravaju slike",
+        "Positioning of this image": "Postavljanje ove slike",
+        "Image Preview:": "Pregled slike",
+        
+        // Select Color popup
+		"Select Color": "Izaberite boju"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/si.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/si.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,50 @@
+// I18N constants
+
+// LANG: "si", ENCODING: UTF-8
+// Author: Tomaz Kregar, x_tomo_x@email.si
+
+// FOR TRANSLATORS:
+//
+//   1. PLEASE PUT YOUR CONTACT INFO IN THE ABOVE LINE
+//      (at least a valid email address)
+//
+//   2. PLEASE TRY TO USE UTF-8 FOR ENCODING;
+//      (if this is not possible, please include a comment
+//       that states what encoding is necessary.)
+
+{
+  "Bold": "Krepko",
+  "Italic": "Leee",
+  "Underline": "Podrtano",
+  "Strikethrough": "Prertano",
+  "Subscript": "Podpisano",
+  "Superscript": "Nadpisano",
+  "Justify Left": "Poravnaj levo",
+  "Justify Center": "Na sredino",
+  "Justify Right": "Poravnaj desno",
+  "Justify Full": "Porazdeli vsebino",
+  "Ordered List": "Otevilevanje",
+  "Bulleted List": "Oznaevanje",
+  "Decrease Indent": "Zmanjaj zamik",
+  "Increase Indent": "Poveaj zamik",
+  "Font Color": "Barva pisave",
+  "Background Color": "Barva ozadja",
+  "Horizontal Rule": "Vodoravna rta",
+  "Insert Web Link": "Vstavi hiperpovezavo",
+  "Insert/Modify Image": "Vstavi sliko",
+  "Insert Table": "Vstavi tabelo",
+  "Toggle HTML Source": "Preklopi na HTML kodo",
+  "Enlarge Editor": "Poveaj urejevalnik",
+  "About this editor": "Vizitka za urejevalnik",
+  "Help using editor": "Pomo za urejevalnik",
+  "Current style": "Trenutni slog",
+  "Undoes your last action": "Razveljavi zadnjo akcijo",
+  "Redoes your last action": "Uveljavi zadnjo akcijo",
+  "Cut selection": "Izrei",
+  "Copy selection": "Kopiraj",
+  "Paste from clipboard": "Prilepi",
+  "OK": "V redu",
+  "Cancel": "Preklii",
+  "Path": "Pot",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "Si v tekstovnem nainu.  Uporabi [<>] gumb za prklop nazaj na WYSIWYG."
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/sr.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/sr.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,140 @@
+// I18N constants
+
+// LANG: "sh", ENCODING: UTF-8 | ISO-8859-5
+// Author: Ljuba Rankovi, http://www.rankovic.net/ljubar
+
+// FOR TRANSLATORS:
+//
+//   1. PLEASE PUT YOUR CONTACT INFO IN THE ABOVE LINE
+//      (at least a valid email address)
+//
+//   2. PLEASE TRY TO USE UTF-8 FOR ENCODING;
+//      (if this is not possible, please include a comment
+//       that states what encoding is necessary.)
+
+{
+		"Bold": "",
+		"Italic": "",
+		"Underline": "",
+		"Strikethrough": "",
+		"Subscript": "-",
+		"Superscript": "-",
+		"Justify Left": " ",
+		"Justify Center": "  ",
+		"Justify Right": " ",
+		"Justify Full": " ",
+		"Ordered List": "   ",
+		"Bulleted List": "  ",
+		"Decrease Indent": " ",
+		"Increase Indent": " ",
+		"Font Color": " ",
+		"Background Color": " ",
+		"Horizontal Rule": " ",
+		"Insert Web Link": "  ",
+		"Insert/Modify Image": "/ ",
+		"Insert Table": " ",
+		"Toggle HTML Source": "    ",
+		"Enlarge Editor": " ",
+		"About this editor": "  ",
+		"Help using editor": "   ",
+		"Current style": " ",
+		"Undoes your last action": "  ",
+		"Redoes your last action": "  ",
+		"Cut selection": " ",
+		"Copy selection": " ",
+		"Paste from clipboard": "  ",
+		"Direction left to right": "    ",
+		"Direction right to left": "    ",
+        "Remove formatting": " ",
+        "Select all": " ",
+        "Print document": " ",
+        "Clear MSOffice tags": " MSOffice ",
+        "Clear Inline Font Specifications": "   ",
+        "Split Block": " ",
+        "Toggle Borders": "  ",
+
+        "&mdash; format &mdash;": "&mdash; Format &mdash;",
+        "Heading 1": " 1",
+        "Heading 2": " 2",
+        "Heading 3": " 3",
+        "Heading 4": " 4",
+        "Heading 5": " 5",
+        "Heading 6": " 6",
+        "Normal": "",
+        "Address": "",
+        "Formatted": "",		
+		
+        // dialogs
+		"OK": "OK",
+		"Cancel": "",
+		"Path": "",
+		"You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.":    "    .   [<>]      (WYSIWYG).",
+
+		"The Paste button does not work in Mozilla based web browsers (technical security reasons). Press CTRL-V on your keyboard to paste directly.": " ''      Mozilla (  ).  CTRL-V     .",
+		
+        "Alignment:": "",
+        "Not set": " ",
+        "Left": "",
+        "Right": "",
+        "Texttop": " ",
+        "Absmiddle": " ",
+        "Baseline": " ",
+        "Absbottom": " ",
+        "Bottom": "",
+        "Middle": "",
+        "Top": "",
+
+        "Layout": "",
+        "Spacing": "",
+        "Horizontal:": " ",
+        "Horizontal padding": " ",
+        "Vertical:": " ",
+        "Vertical padding": " ",
+        "Border thickness:": " ",
+        "Leave empty for no border": "    ",
+
+        // Insert Link
+		"Insert/Modify Link": "/ ",
+		"None (use implicit)": " ",
+		"New window (_blank)": "  (_blank)",
+		"Same frame (_self)": "  (_self)",
+		"Top frame (_top)": "  (_top)",
+		"Other": "",
+		"Target:": " :",
+		"Title (tooltip):": " (tooltip):",
+		"URL:": ":",
+		"You must enter the URL where this link points to": "       ",
+
+        // Insert Table
+        "Insert Table": " ",
+        "Rows:": "",
+        "Number of rows": " ",
+        "Cols:": "",
+        "Number of columns": " ",
+        "Width:": "",
+        "Width of the table": " ",
+        "Percent": "",
+        "Pixels": "",
+        "Em": "",
+        "Width unit": " ",
+        "Fixed width columns": "  ",
+        "Positioning of this table": "  ",
+        "Cell spacing:": "  ",
+        "Space between adjacent cells": "   ",
+        "Cell padding:": "    ",
+        "Space between content and border in cell": "       ",
+
+        // Insert Image
+        "Insert Image": " ",
+        "Image URL:": " ",
+        "Enter the image URL here": "   ",
+        "Preview": "",
+        "Preview the image in a new window": "    ",
+        "Alternate text:": " ",
+        "For browsers that don't support images": "     ",
+        "Positioning of this image": "  ",
+        "Image Preview:": " ",
+
+        // Select Color popup
+		"Select Color": " "
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/sv.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/sv.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,116 @@
+// I18N constants
+// LANG: "sv", ENCODING: UTF-8
+
+// Swedish version for htmlArea v3.0
+// Initital translation by pat <pat@engvall.nu>
+// Synced with additional contants in rev. 477 (Mar 2006) by Thomas Loo <tloo@saltstorm.net>
+
+{
+  "Bold": "Fet",
+  "Italic": "Kursiv",
+  "Underline": "Understruken",
+  "Strikethrough": "Genomstruken",
+  "Subscript": "Nedsnkt",
+  "Superscript": "Upphjd",
+  "Justify Left": "Vnsterjustera",
+  "Justify Center": "Centrera",
+  "Justify Right": "Hgerjustera",
+  "Justify Full": "Marginaljustera",
+  "Ordered List": "Numrerad lista",
+  "Bulleted List": "Punktlista",
+  "Decrease Indent": "Minska indrag",
+  "Increase Indent": "ka indrag",
+  "Font Color": "Textfrg",
+  "Background Color": "Bakgrundsfrg",
+  "Horizontal Rule": "Vgrt linje",
+  "Insert Web Link": "Infoga lnk",
+  "Insert/Modify Image": "Infoga bild",
+  "Toggle HTML Source": "Visa kllkod",
+  "Enlarge Editor": "Visa i eget fnster",
+  "About this editor": "Om denna editor",
+  "Help using editor": "Hjlp",
+  "Current style": "Nuvarande stil",
+
+  "Undoes your last action": "ngra kommando",
+  "Redoes your last action": "Upprepa kommando",
+  "Select all": "Markera allt",
+  "Print document": "Skriv ut",
+  "Clear MSOffice tags": "Stda bort MS Office taggar",
+  "Clear Inline Font Specifications": "Rensa inbddad typsnittsinformation",
+  "Remove formatting": "Rensa formattering",
+  "Toggle Borders": "Objektramar",
+  "Split Block": "Dela block",
+  "Direction left to right": "Vnster till hger",
+  "Direction right to left": "Hger till vnster",
+
+  "Insert/Overwrite": "Infoga/Skriv ver",
+  "OK": "OK",
+  "Cancel": "Avbryt",
+  "Path": "Objekt",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "Du befinner dig i texlge. Klicka p ikonen [<>] ovan fr att vxla tillbaka till WYSIWIG lge",
+  "The full screen mode is known to cause problems with Internet Explorer, due to browser bugs that we weren": "Visning i fullskrmslga fungerar dligt i din weblsare. Mjliga problem resulterar i en ryckig editor, saknade editorfunktioner och/eller att weblsaren kraschar. Om du anvnder Windows 95/98 finns ocks mjligheten att Windows kraschar.\n\nTryck ",
+  "The Paste button does not work in Mozilla based web browsers (technical security reasons). Press CTRL-V on your keyboard to paste directly.": "Denna knapp fungerar ej i Mozillabaserad weblsare, anvnd istllet snabbtangenterna CTRL-V p tangentbordet fr att klistra in.",
+
+  "Insert/Modify Link": "Redigera lnk",
+  "New window (_blank)": "Nytt fnster (_blank)",
+  "None (use implicit)": "Ingen (anvnd standardinstlling)",
+  "Other": "Annan",
+  "Same frame (_self)": "Samma ram (_self)",
+  "Target:": "Ml:",
+  "Title (tooltip):": "Titel (tooltip):",
+  "Top frame (_top)": "Toppram (_top)",
+  "URL:": "Skvg:",
+  "You must enter the URL where this link points to": "Du msta ange en adress till vilken lnken skall peka p",
+  "Would you like to clear font typefaces?": "Radera alla typsnittsinformation ?",
+  "Would you like to clear font sizes?": "Radera alla fontstorlekar ?",
+  "Would you like to clear font colours?": "Ta bort all textfrger ?",
+
+  "You need to select some text before creating a link": "Du msta markera ett objekt att applicera lnken p!",
+
+  // Insert Table
+  "Insert Table": "Infoga tabell",
+  "Rows:": "Rader:",
+  "Number of rows": "Antal rader",
+  "Cols:": "Kolumner:",
+  "Number of columns": "Antal kolumner",
+  "Width:": "Bredd:",
+  "Width of the table": "Tabellbredd",
+  "Percent": "Procent",
+  "Pixels": "Pixlar",
+  "Em": "",
+  "Width unit": "Breddenheter",
+  "Fixed width columns": "Fixerad bredd",
+  "Alignment:": "Marginaljustering",
+  "Positioning of this table": "Tabellposition",
+  "Border thickness:": "Ramtjocklek",
+  "Leave empty for no border": "Lmna fltet tomt fr att undvika ramar",
+  "Spacing": "Cellegenskaper",
+  "Cell spacing:": "Cellmarginaler:",
+  "Space between adjacent cells": "Utrymme mellan celler",
+  "Cell padding:": "Cellindrag:",
+  "Space between content and border in cell": "Utrymme mellan ram och cellinnehll",
+  "You must enter a number of rows": "Ange ental rader",
+  "You must enter a number of columns": "Ange antal kolumner",
+
+  // Editor Help
+  "Keyboard shortcuts": "Snabbtangenter",
+  "The editor provides the following key combinations:": "Editorn nyttjar fljande kombinationer:",
+  "new paragraph": "Ny paragraf ",
+  "insert linebreak": "Infoga radbrytning ",
+  "Set format to paragraph": "Aktivera paragraflge",
+  "Clean content pasted from Word": "Rensa innehll inklistrat frn MS Word",
+  "Headings": "Skapa standardrubrik",
+  "Cut selection": "Klipp ut markering",
+  "Copy selection": "Kopiera  markering",
+  "Paste from clipboard": "Klistra in",
+  "Close": "Stng",
+
+  // Loading messages
+  "Loading in progress. Please wait !": "Editorn laddas. Vnta...",
+  "Constructing main object": "Skapar huvudobjekt",
+  "Create Toolbar": "Skapar verktygspanel",
+  "Register panel right": "Registerar panel hger",
+  "Register panel left": "Registerar panel vnster",
+  "Register panel top": "Registerar toppanel",
+  "Register panel bottom": "Registerar fotpanel"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/th.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/th.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,50 @@
+// I18N constants
+
+// LANG: "th", ENCODING: UTF-8
+// Author: Suchin Prasongbundit, <suchin@joolsoft.com>
+
+// FOR TRANSLATORS:
+//
+//   1. PLEASE PUT YOUR CONTACT INFO IN THE ABOVE LINE
+//      (at least a valid email address)
+//
+//   2. PLEASE TRY TO USE UTF-8 FOR ENCODING;
+//      (if this is not possible, please include a comment
+//       that states what encoding is necessary.)
+
+{
+  "Bold": "",
+  "Italic": "",
+  "Underline": "",
+  "Strikethrough": "",
+  "Subscript": "",
+  "Superscript": "",
+  "Justify Left": "",
+  "Justify Center": "",
+  "Justify Right": "",
+  "Justify Full": "",
+  "Ordered List": "",
+  "Bulleted List": "",
+  "Decrease Indent": "",
+  "Increase Indent": "",
+  "Font Color": "",
+  "Background Color": "",
+  "Horizontal Rule": "",
+  "Insert Web Link": "",
+  "Insert/Modify Image": "/",
+  "Insert Table": "",
+  "Toggle HTML Source": " HTML",
+  "Enlarge Editor": "",
+  "About this editor": "",
+  "Help using editor": "",
+  "Current style": "",
+  "Undoes your last action": "",
+  "Redoes your last action": "",
+  "Cut selection": "",
+  "Copy selection": "",
+  "Paste from clipboard": "",
+  "OK": "",
+  "Cancel": "",
+  "Path": "",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "  [<>] "
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/lang/vn.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/lang/vn.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,56 @@
+// I18N constants : Vietnamese
+// LANG: "en", ENCODING: UTF-8
+// Author: Nguyn nh Nam, <hncryptologist@yahoo.com>
+// Modified 21/07/2004 by Phm Mai Qun <pmquan@4vn.org>
+
+{
+  "Bold": "m",
+  "Italic": "Nghing",
+  "Underline": "Gch Chn",
+  "Strikethrough": "Gch Xa",
+  "Subscript": "Vit Xung Di",
+  "Superscript": "Vit Ln Trn",
+  "Justify Left": "Cn Tri",
+  "Justify Center": "Cn Gia",
+  "Justify Right": "Cn Phi",
+  "Justify Full": "Cn u",
+  "Ordered List": "Danh Sch C Th T (1, 2, 3)",
+  "Bulleted List": "Danh Sch Phi Th T (Chm u dng)",
+  "Decrease Indent": "Li Ra Ngoi",
+  "Increase Indent": "Tht Vo Trong",
+  "Font Color": "Mu Ch",
+  "Background Color": "Mu Nn",
+  "Horizontal Rule": "Dng K Ngang",
+  "Insert Web Link": "To Lin Kt",
+  "Insert/Modify Image": "Chn nh",
+  "Insert Table": "Chn Bng",
+  "Toggle HTML Source": "Ch  M HTML",
+  "Enlarge Editor": "Phng To  Son Tho",
+  "About this editor": "T Gii Thiu",
+  "Help using editor": "Gip ",
+  "Current style": "nh Dng Hin Thi",
+  "Undoes your last action": "Hy thao tc trc",
+  "Redoes your last action": "Ly li thao tc va b",
+  "Cut selection": "Ct",
+  "Copy selection": "Sao chp",
+  "Paste from clipboard": "Dn",
+  "Direction left to right": "Vit t tri sang phi",
+  "Direction right to left": "Vit t phi sang tri",
+  "OK": "ng ",
+  "Cancel": "Hy",
+  "The full screen mode is known to cause problems with Internet Explorer, due to browser bugs that we weren": "Ch  phng to  son tho c th gy li vi Internet Explorer v mt s li ca trnh duyt ny, v th ch  ny c th s khng chy. Hin th khng ng, ln xn, khng c y  chc nng, v cng c th lm trnh duyt ca bn b tt ngang. Nu bn ang s dng Windows 9x bn c th b bo li ",
+  "Path": "ng Dn",
+  "You are in TEXT MODE.  Use the [<>] button to switch back to WYSIWYG.": "Bn ang  ch  text.  S dng nt [<>]  chuyn li ch  WYSIWIG.",
+  "Cancel": "Hy",
+  "Insert/Modify Link": "Thm/Chnh sa ng dn",
+  "New window (_blank)": "Ca s mi (_blank)",
+  "None (use implicit)": "Khng (s dng implicit)",
+  "OK": "ng ",
+  "Other": "Khc",
+  "Same frame (_self)": "Trn cng khung (_self)",
+  "Target:": "Ni hin th:",
+  "Title (tooltip):": "Tiu  (ca hng dn):",
+  "Top frame (_top)": "Khung trn cng (_top)",
+  "URL:": "URL:",
+  "You must enter the URL where this link points to": "Bn phi in a ch (URL) m ng dn s lin kt ti"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/license.txt
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/license.txt	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,30 @@
+htmlArea License (based on BSD license)
+Copyright (c) 2002-2004, interactivetools.com, inc.
+Copyright (c) 2003-2004 dynarch.com
+All rights reserved.
+
+Redistribution and use in source and binary forms, with or without
+modification, are permitted provided that the following conditions are met:
+
+1) Redistributions of source code must retain the above copyright notice,
+   this list of conditions and the following disclaimer.
+
+2) Redistributions in binary form must reproduce the above copyright notice,
+   this list of conditions and the following disclaimer in the documentation
+   and/or other materials provided with the distribution.
+
+3) Neither the name of interactivetools.com, inc. nor the names of its
+   contributors may be used to endorse or promote products derived from this
+   software without specific prior written permission.
+
+THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
+LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
+INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+POSSIBILITY OF SUCH DAMAGE.
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/ColorPicker/ColorPicker.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/ColorPicker/ColorPicker.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,624 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/modules/ColorPicker/ColorPicker.js */
+ColorPicker._pluginInfo={name:"colorPicker",version:"$LastChangedRevision:998 $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1"),developer:"James Sleeman",developer_url:"http://www.gogo.co.nz/",c_owner:"Gogo Internet Services",license:"htmlArea",sponsor:"Gogo Internet Services",sponsor_url:"http://www.gogo.co.nz/"};
+function ColorPicker(){
+}
+try{
+if(window.opener&&window.opener.Xinha){
+var openerColorPicker=window.opener.Xinha.colorPicker;
+Xinha._addEvent(window,"unload",function(){
+Xinha.colorPicker=openerColorPicker;
+});
+}
+}
+catch(e){
+}
+Xinha.colorPicker=function(_1){
+if(Xinha.colorPicker.savedColors.length===0){
+Xinha.colorPicker.loadColors();
+}
+this.is_ie_6=(Xinha.is_ie&&Xinha.ie_version<7);
+var _2=this;
+var _3=false;
+var _4=false;
+var _5=0;
+var _6=0;
+this.callback=_1.callback?_1.callback:function(_7){
+alert("You picked "+_7);
+};
+this.websafe=_1.websafe?_1.websafe:false;
+this.savecolors=_1.savecolors?_1.savecolors:20;
+this.cellsize=parseInt(_1.cellsize?_1.cellsize:"10px",10);
+this.side=_1.granularity?_1.granularity:18;
+var _8=this.side+1;
+var _9=this.side-1;
+this.value=1;
+this.saved_cells=null;
+this.table=document.createElement("table");
+this.table.className="dialog";
+this.table.cellSpacing=this.table.cellPadding=0;
+this.table.onmouseup=function(){
+_3=false;
+_4=false;
+};
+this.tbody=document.createElement("tbody");
+this.table.appendChild(this.tbody);
+this.table.style.border="1px solid WindowFrame";
+this.table.style.zIndex="1050";
+var tr=document.createElement("tr");
+var td=document.createElement("td");
+td.colSpan=this.side;
+td.className="title";
+td.style.fontFamily="small-caption,caption,sans-serif";
+td.style.fontSize="x-small";
+td.unselectable="on";
+td.style.MozUserSelect="none";
+td.style.cursor="default";
+td.appendChild(document.createTextNode(Xinha._lc("Click a color...")));
+td.style.borderBottom="1px solid WindowFrame";
+tr.appendChild(td);
+td=null;
+var td=document.createElement("td");
+td.className="title";
+td.colSpan=2;
+td.style.fontFamily="Tahoma,Verdana,sans-serif";
+td.style.borderBottom="1px solid WindowFrame";
+td.style.paddingRight="0";
+tr.appendChild(td);
+var _c=document.createElement("div");
+_c.title=Xinha._lc("Close");
+_c.className="buttonColor";
+_c.style.height="11px";
+_c.style.width="11px";
+_c.style.cursor="pointer";
+_c.onclick=function(){
+_2.close();
+};
+_c.appendChild(document.createTextNode("\xd7"));
+_c.align="center";
+_c.style.verticalAlign="top";
+_c.style.position="relative";
+_c.style.cssFloat="right";
+_c.style.styleFloat="right";
+_c.style.padding="0";
+_c.style.margin="2px";
+_c.style.backgroundColor="transparent";
+_c.style.fontSize="11px";
+if(!Xinha.is_ie){
+_c.style.lineHeight="9px";
+}
+_c.style.letterSpacing="0";
+td.appendChild(_c);
+this.tbody.appendChild(tr);
+_c=tr=td=null;
+this.constrain_cb=document.createElement("input");
+this.constrain_cb.type="checkbox";
+this.chosenColor=document.createElement("input");
+this.chosenColor.type="text";
+this.chosenColor.maxLength=7;
+this.chosenColor.style.width="50px";
+this.chosenColor.style.fontSize="11px";
+this.chosenColor.onchange=function(){
+if(/#[0-9a-f]{6,6}/i.test(this.value)){
+_2.backSample.style.backgroundColor=this.value;
+_2.foreSample.style.color=this.value;
+}
+};
+this.backSample=document.createElement("div");
+this.backSample.appendChild(document.createTextNode("\xa0"));
+this.backSample.style.fontWeight="bold";
+this.backSample.style.fontFamily="small-caption,caption,sans-serif";
+this.backSample.fontSize="x-small";
+this.foreSample=document.createElement("div");
+this.foreSample.appendChild(document.createTextNode(Xinha._lc("Sample")));
+this.foreSample.style.fontWeight="bold";
+this.foreSample.style.fontFamily="small-caption,caption,sans-serif";
+this.foreSample.fontSize="x-small";
+function toHex(_d){
+var h=_d.toString(16);
+if(h.length<2){
+h="0"+h;
+}
+return h;
+}
+function tupleToColor(_f){
+return "#"+toHex(_f.red)+toHex(_f.green)+toHex(_f.blue);
+}
+function nearestPowerOf(num,_11){
+return Math.round(Math.round(num/_11)*_11);
+}
+function doubleHexDec(dec){
+return parseInt(dec.toString(16)+dec.toString(16),16);
+}
+function rgbToWebsafe(_13){
+_13.red=doubleHexDec(nearestPowerOf(parseInt(toHex(_13.red).charAt(0),16),3));
+_13.blue=doubleHexDec(nearestPowerOf(parseInt(toHex(_13.blue).charAt(0),16),3));
+_13.green=doubleHexDec(nearestPowerOf(parseInt(toHex(_13.green).charAt(0),16),3));
+return _13;
+}
+function hsvToRGB(h,s,v){
+var _17;
+if(s===0){
+_17={red:v,green:v,blue:v};
+}else{
+h/=60;
+var i=Math.floor(h);
+var f=h-i;
+var p=v*(1-s);
+var q=v*(1-s*f);
+var t=v*(1-s*(1-f));
+switch(i){
+case 0:
+_17={red:v,green:t,blue:p};
+break;
+case 1:
+_17={red:q,green:v,blue:p};
+break;
+case 2:
+_17={red:p,green:v,blue:t};
+break;
+case 3:
+_17={red:p,green:q,blue:v};
+break;
+case 4:
+_17={red:t,green:p,blue:v};
+break;
+default:
+_17={red:v,green:p,blue:q};
+break;
+}
+}
+_17.red=Math.ceil(_17.red*255);
+_17.green=Math.ceil(_17.green*255);
+_17.blue=Math.ceil(_17.blue*255);
+return _17;
+}
+var _1d=this;
+function closeOnBodyClick(ev){
+ev=ev?ev:window.event;
+el=ev.target?ev.target:ev.srcElement;
+do{
+if(el==_1d.table){
+return;
+}
+}while(el=el.parentNode);
+_1d.close();
+}
+this.open=function(_1f,_20,_21){
+this.table.style.display="";
+this.pick_color();
+if(_21&&/#[0-9a-f]{6,6}/i.test(_21)){
+this.chosenColor.value=_21;
+this.backSample.style.backgroundColor=_21;
+this.foreSample.style.color=_21;
+}
+Xinha._addEvent(document.body,"mousedown",closeOnBodyClick);
+this.table.style.position="absolute";
+var e=_20;
+var top=0;
+var _24=0;
+do{
+if(e.style.position=="fixed"){
+this.table.style.position="fixed";
+}
+top+=e.offsetTop;
+_24+=e.offsetLeft;
+e=e.offsetParent;
+}while(e);
+var x,y;
+if(/top/.test(_1f)||(top+this.table.offsetHeight>document.body.offsetHeight)){
+if(top-this.table.offsetHeight>0){
+this.table.style.top=(top-this.table.offsetHeight)+"px";
+}else{
+this.table.style.top=0;
+}
+}else{
+this.table.style.top=(top+_20.offsetHeight)+"px";
+}
+if(/left/.test(_1f)||(_24+this.table.offsetWidth>document.body.offsetWidth)){
+if(_24-(this.table.offsetWidth-_20.offsetWidth)>0){
+this.table.style.left=(_24-(this.table.offsetWidth-_20.offsetWidth))+"px";
+}else{
+this.table.style.left=0;
+}
+}else{
+this.table.style.left=_24+"px";
+}
+if(this.is_ie_6){
+this.iframe.style.top=this.table.style.top;
+this.iframe.style.left=this.table.style.left;
+}
+};
+function pickCell(_26){
+_2.chosenColor.value=_26.colorCode;
+_2.backSample.style.backgroundColor=_26.colorCode;
+_2.foreSample.style.color=_26.colorCode;
+if((_26.hue>=195&&_26.saturation>0.5)||(_26.hue===0&&_26.saturation===0&&_26.value<0.5)||(_26.hue!==0&&_2.value<0.75)){
+_26.style.borderColor="#fff";
+}else{
+_26.style.borderColor="#000";
+}
+_5=_26.thisrow;
+_6=_26.thiscol;
+}
+function pickValue(_27){
+if(_2.value<0.5){
+_27.style.borderColor="#fff";
+}else{
+_27.style.borderColor="#000";
+}
+_9=_27.thisrow;
+_8=_27.thiscol;
+_2.chosenColor.value=_2.saved_cells[_5][_6].colorCode;
+_2.backSample.style.backgroundColor=_2.saved_cells[_5][_6].colorCode;
+_2.foreSample.style.color=_2.saved_cells[_5][_6].colorCode;
+}
+function unpickCell(row,col){
+_2.saved_cells[row][col].style.borderColor=_2.saved_cells[row][col].colorCode;
+}
+this.pick_color=function(){
+var _2a,cols;
+var _2b=this;
+var _2c=359/(this.side);
+var _2d=1/(this.side-1);
+var _2e=1/(this.side-1);
+var _2f=this.constrain_cb.checked;
+if(this.saved_cells===null){
+this.saved_cells=[];
+for(var row=0;row<this.side;row++){
+var tr=document.createElement("tr");
+this.saved_cells[row]=[];
+for(var col=0;col<this.side;col++){
+var td=document.createElement("td");
+if(_2f){
+td.colorCode=tupleToColor(rgbToWebsafe(hsvToRGB(_2c*row,_2d*col,this.value)));
+}else{
+td.colorCode=tupleToColor(hsvToRGB(_2c*row,_2d*col,this.value));
+}
+this.saved_cells[row][col]=td;
+td.style.height=this.cellsize+"px";
+td.style.width=this.cellsize-2+"px";
+td.style.borderWidth="1px";
+td.style.borderStyle="solid";
+td.style.borderColor=td.colorCode;
+td.style.backgroundColor=td.colorCode;
+if(row==_5&&col==_6){
+td.style.borderColor="#000";
+this.chosenColor.value=td.colorCode;
+this.backSample.style.backgroundColor=td.colorCode;
+this.foreSample.style.color=td.colorCode;
+}
+td.hue=_2c*row;
+td.saturation=_2d*col;
+td.thisrow=row;
+td.thiscol=col;
+td.onmousedown=function(){
+_3=true;
+_2b.saved_cells[_5][_6].style.borderColor=_2b.saved_cells[_5][_6].colorCode;
+pickCell(this);
+};
+td.onmouseover=function(){
+if(_3){
+pickCell(this);
+}
+};
+td.onmouseout=function(){
+if(_3){
+this.style.borderColor=this.colorCode;
+}
+};
+td.ondblclick=function(){
+Xinha.colorPicker.remember(this.colorCode,_2b.savecolors);
+_2b.callback(this.colorCode);
+_2b.close();
+};
+td.appendChild(document.createTextNode(" "));
+td.style.cursor="pointer";
+tr.appendChild(td);
+td=null;
+}
+var td=document.createElement("td");
+td.appendChild(document.createTextNode(" "));
+td.style.width=this.cellsize+"px";
+tr.appendChild(td);
+td=null;
+var td=document.createElement("td");
+this.saved_cells[row][col+1]=td;
+td.appendChild(document.createTextNode(" "));
+td.style.width=this.cellsize-2+"px";
+td.style.height=this.cellsize+"px";
+td.constrainedColorCode=tupleToColor(rgbToWebsafe(hsvToRGB(0,0,_2e*row)));
+td.style.backgroundColor=td.colorCode=tupleToColor(hsvToRGB(0,0,_2e*row));
+td.style.borderWidth="1px";
+td.style.borderStyle="solid";
+td.style.borderColor=td.colorCode;
+if(row==_9){
+td.style.borderColor="black";
+}
+td.hue=_2c*row;
+td.saturation=_2d*col;
+td.hsv_value=_2e*row;
+td.thisrow=row;
+td.thiscol=col+1;
+td.onmousedown=function(){
+_4=true;
+_2b.saved_cells[_9][_8].style.borderColor=_2b.saved_cells[_9][_8].colorCode;
+_2b.value=this.hsv_value;
+_2b.pick_color();
+pickValue(this);
+};
+td.onmouseover=function(){
+if(_4){
+_2b.value=this.hsv_value;
+_2b.pick_color();
+pickValue(this);
+}
+};
+td.onmouseout=function(){
+if(_4){
+this.style.borderColor=this.colorCode;
+}
+};
+td.style.cursor="pointer";
+tr.appendChild(td);
+td=null;
+this.tbody.appendChild(tr);
+tr=null;
+}
+var tr=document.createElement("tr");
+this.saved_cells[row]=[];
+for(var col=0;col<this.side;col++){
+var td=document.createElement("td");
+if(_2f){
+td.colorCode=tupleToColor(rgbToWebsafe(hsvToRGB(0,0,_2e*(this.side-col-1))));
+}else{
+td.colorCode=tupleToColor(hsvToRGB(0,0,_2e*(this.side-col-1)));
+}
+this.saved_cells[row][col]=td;
+td.style.height=this.cellsize+"px";
+td.style.width=this.cellsize-2+"px";
+td.style.borderWidth="1px";
+td.style.borderStyle="solid";
+td.style.borderColor=td.colorCode;
+td.style.backgroundColor=td.colorCode;
+td.hue=0;
+td.saturation=0;
+td.value=_2e*(this.side-col-1);
+td.thisrow=row;
+td.thiscol=col;
+td.onmousedown=function(){
+_3=true;
+_2b.saved_cells[_5][_6].style.borderColor=_2b.saved_cells[_5][_6].colorCode;
+pickCell(this);
+};
+td.onmouseover=function(){
+if(_3){
+pickCell(this);
+}
+};
+td.onmouseout=function(){
+if(_3){
+this.style.borderColor=this.colorCode;
+}
+};
+td.ondblclick=function(){
+Xinha.colorPicker.remember(this.colorCode,_2b.savecolors);
+_2b.callback(this.colorCode);
+_2b.close();
+};
+td.appendChild(document.createTextNode(" "));
+td.style.cursor="pointer";
+tr.appendChild(td);
+td=null;
+}
+this.tbody.appendChild(tr);
+tr=null;
+var tr=document.createElement("tr");
+var td=document.createElement("td");
+tr.appendChild(td);
+td.colSpan=this.side+2;
+td.style.padding="3px";
+if(this.websafe){
+var div=document.createElement("div");
+var _35=document.createElement("label");
+_35.appendChild(document.createTextNode(Xinha._lc("Web Safe: ")));
+this.constrain_cb.onclick=function(){
+_2b.pick_color();
+};
+_35.appendChild(this.constrain_cb);
+_35.style.fontFamily="small-caption,caption,sans-serif";
+_35.style.fontSize="x-small";
+div.appendChild(_35);
+td.appendChild(div);
+div=null;
+}
+var div=document.createElement("div");
+var _35=document.createElement("label");
+_35.style.fontFamily="small-caption,caption,sans-serif";
+_35.style.fontSize="x-small";
+_35.appendChild(document.createTextNode(Xinha._lc("Color: ")));
+_35.appendChild(this.chosenColor);
+div.appendChild(_35);
+var but=document.createElement("span");
+but.className="buttonColor ";
+but.style.fontSize="13px";
+but.style.width="24px";
+but.style.marginLeft="2px";
+but.style.padding="0px 4px";
+but.style.cursor="pointer";
+but.onclick=function(){
+Xinha.colorPicker.remember(_2b.chosenColor.value,_2b.savecolors);
+_2b.callback(_2b.chosenColor.value);
+_2b.close();
+};
+but.appendChild(document.createTextNode(Xinha._lc("OK")));
+but.align="center";
+div.appendChild(but);
+td.appendChild(div);
+var _37=document.createElement("table");
+_37.style.width="100%";
+var _38=document.createElement("tbody");
+_37.appendChild(_38);
+var _39=document.createElement("tr");
+_38.appendChild(_39);
+var _3a=document.createElement("td");
+_39.appendChild(_3a);
+_3a.appendChild(this.backSample);
+_3a.style.width="50%";
+var _3b=document.createElement("td");
+_39.appendChild(_3b);
+_3b.appendChild(this.foreSample);
+_3b.style.width="50%";
+td.appendChild(_37);
+var _3c=document.createElement("div");
+_3c.style.clear="both";
+function createSavedColors(_3d){
+var _3e=Xinha.is_ie;
+var div=document.createElement("div");
+div.style.width=_2b.cellsize+"px";
+div.style.height=_2b.cellsize+"px";
+div.style.margin="1px";
+div.style.border="1px solid black";
+div.style.cursor="pointer";
+div.style.backgroundColor=_3d;
+div.style[_3e?"styleFloat":"cssFloat"]="left";
+div.ondblclick=function(){
+_2b.callback(_3d);
+_2b.close();
+};
+div.onclick=function(){
+_2b.chosenColor.value=_3d;
+_2b.backSample.style.backgroundColor=_3d;
+_2b.foreSample.style.color=_3d;
+};
+_3c.appendChild(div);
+}
+for(var _40=0;_40<Xinha.colorPicker.savedColors.length;_40++){
+createSavedColors(Xinha.colorPicker.savedColors[_40]);
+}
+td.appendChild(_3c);
+this.tbody.appendChild(tr);
+document.body.appendChild(this.table);
+if(this.is_ie_6){
+if(!this.iframe){
+this.iframe=document.createElement("iframe");
+this.iframe.frameBorder=0;
+this.iframe.src="javascript:;";
+this.iframe.style.position="absolute";
+this.iframe.style.width=this.table.offsetWidth;
+this.iframe.style.height=this.table.offsetHeight;
+document.body.insertBefore(this.iframe,this.table);
+}
+this.iframe.style.display="";
+}
+}else{
+for(var row=0;row<this.side;row++){
+for(var col=0;col<this.side;col++){
+if(_2f){
+this.saved_cells[row][col].colorCode=tupleToColor(rgbToWebsafe(hsvToRGB(_2c*row,_2d*col,this.value)));
+}else{
+this.saved_cells[row][col].colorCode=tupleToColor(hsvToRGB(_2c*row,_2d*col,this.value));
+}
+this.saved_cells[row][col].style.backgroundColor=this.saved_cells[row][col].colorCode;
+this.saved_cells[row][col].style.borderColor=this.saved_cells[row][col].colorCode;
+}
+}
+var _41=this.saved_cells[_5][_6];
+this.chosenColor.value=_41.colorCode;
+this.backSample.style.backgroundColor=_41.colorCode;
+this.foreSample.style.color=_41.colorCode;
+if((_41.hue>=195&&_41.saturation>0.5)||(_41.hue===0&&_41.saturation===0&&_41.value<0.5)||(_41.hue!==0&&_2b.value<0.75)){
+_41.style.borderColor="#fff";
+}else{
+_41.style.borderColor="#000";
+}
+}
+};
+this.close=function(){
+Xinha._removeEvent(document.body,"mousedown",closeOnBodyClick);
+this.table.style.display="none";
+if(this.is_ie_6){
+if(this.iframe){
+this.iframe.style.display="none";
+}
+}
+};
+};
+Xinha.colorPicker.savedColors=[];
+Xinha.colorPicker.remember=function(_42,_43){
+for(var i=Xinha.colorPicker.savedColors.length;i--;){
+if(Xinha.colorPicker.savedColors[i]==_42){
+return false;
+}
+}
+Xinha.colorPicker.savedColors.splice(0,0,_42);
+Xinha.colorPicker.savedColors=Xinha.colorPicker.savedColors.slice(0,_43);
+var _45=new Date();
+_45.setMonth(_45.getMonth()+1);
+document.cookie="XinhaColorPicker="+escape(Xinha.colorPicker.savedColors.join("-"))+";expires="+_45.toGMTString();
+return true;
+};
+Xinha.colorPicker.loadColors=function(){
+var _46=document.cookie.indexOf("XinhaColorPicker");
+if(_46!=-1){
+var _47=(document.cookie.indexOf("=",_46)+1);
+var end=document.cookie.indexOf(";",_46);
+if(end==-1){
+end=document.cookie.length;
+}
+Xinha.colorPicker.savedColors=unescape(document.cookie.substring(_47,end)).split("-");
+}
+};
+Xinha.colorPicker.InputBinding=function(_49,_4a){
+var doc=_49.ownerDocument;
+var _4c=doc.createElement("span");
+_4c.className="buttonColor";
+var _4d=this.chooser=doc.createElement("span");
+_4d.className="chooser";
+if(_49.value){
+_4d.style.backgroundColor=_49.value;
+}
+_4d.onmouseover=function(){
+_4d.className="chooser buttonColor-hilite";
+};
+_4d.onmouseout=function(){
+_4d.className="chooser";
+};
+_4d.appendChild(doc.createTextNode("\xa0"));
+_4c.appendChild(_4d);
+var _4e=doc.createElement("span");
+_4e.className="nocolor";
+_4e.onmouseover=function(){
+_4e.className="nocolor buttonColor-hilite";
+_4e.style.color="#f00";
+};
+_4e.onmouseout=function(){
+_4e.className="nocolor";
+_4e.style.color="#000";
+};
+_4e.onclick=function(){
+_49.value="";
+_4d.style.backgroundColor="";
+};
+_4e.appendChild(doc.createTextNode("\xd7"));
+_4c.appendChild(_4e);
+_49.parentNode.insertBefore(_4c,_49.nextSibling);
+Xinha._addEvent(_49,"change",function(){
+_4d.style.backgroundColor=this.value;
+});
+_4a=(_4a)?Xinha.cloneObject(_4a):{cellsize:"5px"};
+_4a.callback=(_4a.callback)?_4a.callback:function(_4f){
+_4d.style.backgroundColor=_4f;
+_49.value=_4f;
+};
+_4d.onclick=function(){
+var _50=new Xinha.colorPicker(_4a);
+_50.open("",_4d,_49.value);
+};
+Xinha.freeLater(this,"chooser");
+};
+Xinha.colorPicker.InputBinding.prototype.setColor=function(_51){
+this.chooser.style.backgroundColor=_51;
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/ColorPicker/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/ColorPicker/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,22 @@
+// I18N constants
+//
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+//
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+//
+// Last revision: 06 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+//
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "Click a color...": "Selecione uma cr...",
+  "Close": "Fechar",
+  "Color: ": "Cr:",
+  "Sample": "Exemplo",
+  "Web Safe: ": "Web Segura:"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/CreateLink/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/CreateLink/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,18 @@
+// I18N constants
+//
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+//
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+//
+// Last revision: 06 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+//
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "You need to select some text before creating a link": "Voc precisa selecionar um texto antes de criar um link"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/CreateLink/link.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/CreateLink/link.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,136 @@
+<html>
+
+<head>
+  <title>Insert/Modify Link</title>
+  <script type="text/javascript" src="../../popups/popup.js"></script>
+  <link rel="stylesheet" type="text/css" href="../../popups/popup.css" />
+
+  <script type="text/javascript">
+    window.resizeTo(400, 200);
+
+Xinha = window.opener.Xinha;
+
+function i18n(str) {
+  return (Xinha._lc(str, 'Xinha'));
+}
+
+function onTargetChanged() {
+  var f = document.getElementById("f_other_target");
+  if (this.value == "_other") {
+    f.style.visibility = "visible";
+    f.select();
+    f.focus();
+  } else f.style.visibility = "hidden";
+}
+
+function Init() {
+  __dlg_translate('Xinha');
+  __dlg_init();
+
+  // Make sure the translated string appears in the drop down. (for gecko)
+  document.getElementById("f_target").selectedIndex = 1;
+  document.getElementById("f_target").selectedIndex = 0;
+
+  var param = window.dialogArguments;
+  var target_select = document.getElementById("f_target");
+  var use_target = true;
+  if (param) {
+    if ( typeof param["f_usetarget"] != "undefined" ) {
+      use_target = param["f_usetarget"];
+    }
+    if ( typeof param["f_href"] != "undefined" ) {
+      document.getElementById("f_href").value = param["f_href"];
+      document.getElementById("f_title").value = param["f_title"];
+      comboSelectValue(target_select, param["f_target"]);
+      if (target_select.value != param.f_target) {
+        var opt = document.createElement("option");
+        opt.value = param.f_target;
+        opt.innerHTML = opt.value;
+        target_select.appendChild(opt);
+        opt.selected = true;
+      }
+    }
+  }
+  if (! use_target) {
+    document.getElementById("f_target_label").style.visibility = "hidden";
+    document.getElementById("f_target").style.visibility = "hidden";
+    document.getElementById("f_other_target").style.visibility = "hidden";
+  }
+  var opt = document.createElement("option");
+  opt.value = "_other";
+  opt.innerHTML = i18n("Other");
+  target_select.appendChild(opt);
+  target_select.onchange = onTargetChanged;
+  document.getElementById("f_href").focus();
+  document.getElementById("f_href").select();
+}
+
+function onOK() {
+  var required = {
+    // f_href shouldn't be required or otherwise removing the link by entering an empty
+    // url isn't possible anymore.
+    // "f_href": i18n("You must enter the URL where this link points to")
+  };
+  for (var i in required) {
+    var el = document.getElementById(i);
+    if (!el.value) {
+      alert(required[i]);
+      el.focus();
+      return false;
+    }
+  }
+  // pass data back to the calling window
+  var fields = ["f_href", "f_title", "f_target" ];
+  var param = new Object();
+  for (var i in fields) {
+    var id = fields[i];
+    var el = document.getElementById(id);
+    param[id] = el.value;
+  }
+  if (param.f_target == "_other")
+    param.f_target = document.getElementById("f_other_target").value;
+  __dlg_close(param);
+  return false;
+}
+
+function onCancel() {
+  __dlg_close(null);
+  return false;
+}
+
+</script>
+
+</head>
+
+<body class="dialog" onload="Init()">
+<div class="title">Insert/Modify Link</div>
+<form>
+<table border="0" style="width: 100%;">
+  <tr>
+    <td class="label">URL:</td>
+    <td><input type="text" id="f_href" style="width: 100%" /></td>
+  </tr>
+  <tr>
+    <td class="label">Title (tooltip):</td>
+    <td><input type="text" id="f_title" style="width: 100%" /></td>
+  </tr>
+  <tr>
+    <td class="label"><span id="f_target_label">Target:</span></td>
+    <td><select id="f_target">
+      <option value="">None (use implicit)</option>
+      <option value="_blank">New window (_blank)</option>
+      <option value="_self">Same frame (_self)</option>
+      <option value="_top">Top frame (_top)</option>
+    </select>
+    <input type="text" name="f_other_target" id="f_other_target" size="10" style="visibility: hidden" />
+    </td>
+  </tr>
+</table>
+
+<div id="buttons">
+  <button type="submit" name="ok" onclick="return onOK();">OK</button>
+  <button type="button" name="cancel" onclick="return onCancel();">Cancel</button>
+</div>
+</form>
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/CreateLink/link.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/CreateLink/link.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,87 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/modules/CreateLink/link.js */
+CreateLink._pluginInfo={name:"CreateLink",origin:"Xinha Core",version:"$LastChangedRevision:990 $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1"),developer:"The Xinha Core Developer Team",developer_url:"$HeadURL:http://svn.xinha.webfactional.com/trunk/modules/CreateLink/link.js $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1"),sponsor:"",sponsor_url:"",license:"htmlArea"};
+function CreateLink(_1){
+}
+Xinha.prototype._createLink=function(_2){
+var _3=this;
+var _4=null;
+if(typeof _2=="undefined"){
+_2=this.getParentElement();
+if(_2){
+while(_2&&!/^a$/i.test(_2.tagName)){
+_2=_2.parentNode;
+}
+}
+}
+if(!_2){
+var _5=_3.getSelection();
+var _6=_3.createRange(_5);
+var _7=0;
+if(Xinha.is_ie){
+if(_5.type=="Control"){
+_7=_6.length;
+}else{
+_7=_6.compareEndPoints("StartToEnd",_6);
+}
+}else{
+_7=_6.compareBoundaryPoints(_6.START_TO_END,_6);
+}
+if(_7===0){
+alert(Xinha._lc("You need to select some text before creating a link"));
+return;
+}
+_4={f_href:"",f_title:"",f_target:"",f_usetarget:_3.config.makeLinkShowsTarget};
+}else{
+_4={f_href:Xinha.is_ie?_3.stripBaseURL(_2.href):_2.getAttribute("href"),f_title:_2.title,f_target:_2.target,f_usetarget:_3.config.makeLinkShowsTarget};
+}
+Dialog(_3.config.URIs.link,function(_8){
+if(!_8){
+return false;
+}
+var a=_2;
+if(!a){
+try{
+var _a=Xinha.uniq("http://www.example.com/Link");
+_3._doc.execCommand("createlink",false,_a);
+var _b=_3._doc.getElementsByTagName("a");
+for(var i=0;i<_b.length;i++){
+var _d=_b[i];
+if(_d.href==_a){
+if(!a){
+a=_d;
+}
+_d.href=_8.f_href;
+if(_8.f_target){
+_d.target=_8.f_target;
+}
+if(_8.f_title){
+_d.title=_8.f_title;
+}
+}
+}
+}
+catch(ex){
+}
+}else{
+var _e=_8.f_href.trim();
+_3.selectNodeContents(a);
+if(_e===""){
+_3._doc.execCommand("unlink",false,null);
+_3.updateToolbar();
+return false;
+}else{
+a.href=_e;
+}
+}
+if(!(a&&a.tagName.toLowerCase()=="a")){
+return false;
+}
+a.target=_8.f_target.trim();
+a.title=_8.f_title.trim();
+_3.selectNodeContents(a);
+_3.updateToolbar();
+},_4);
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/Dialogs/dialog.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/Dialogs/dialog.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,75 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/modules/Dialogs/dialog.js */
+function Dialog(_1,_2,_3){
+if(typeof _3=="undefined"){
+_3=window;
+}
+if(typeof window.showModalDialog=="function"&&!Xinha.is_webkit){
+Dialog._return=function(_4){
+if(typeof _2=="function"){
+_2(_4);
+}
+};
+var r=window.showModalDialog(_1,_3,"dialogheight=300;dialogwidth=400;resizable=yes");
+}else{
+Dialog._geckoOpenModal(_1,_2,_3);
+}
+}
+Dialog._parentEvent=function(ev){
+setTimeout(function(){
+if(Dialog._modal&&!Dialog._modal.closed){
+Dialog._modal.focus();
+}
+},50);
+try{
+if(Dialog._modal&&!Dialog._modal.closed){
+Xinha._stopEvent(ev);
+}
+}
+catch(e){
+}
+};
+Dialog._return=null;
+Dialog._modal=null;
+Dialog._arguments=null;
+Dialog._selection=null;
+Dialog._geckoOpenModal=function(_7,_8,_9){
+var _a=window.open(_7,"hadialog","toolbar=no,menubar=no,personalbar=no,width=10,height=10,"+"scrollbars=no,resizable=yes,modal=yes,dependable=yes");
+Dialog._modal=_a;
+Dialog._arguments=_9;
+function capwin(w){
+Xinha._addEvent(w,"click",Dialog._parentEvent);
+Xinha._addEvent(w,"mousedown",Dialog._parentEvent);
+Xinha._addEvent(w,"focus",Dialog._parentEvent);
+}
+function relwin(w){
+Xinha._removeEvent(w,"click",Dialog._parentEvent);
+Xinha._removeEvent(w,"mousedown",Dialog._parentEvent);
+Xinha._removeEvent(w,"focus",Dialog._parentEvent);
+}
+capwin(window);
+for(var i=0;i<window.frames.length;i++){
+try{
+capwin(window.frames[i]);
+}
+catch(e){
+}
+}
+Dialog._return=function(_e){
+if(_e&&_8){
+_8(_e);
+}
+relwin(window);
+for(var i=0;i<window.frames.length;i++){
+try{
+relwin(window.frames[i]);
+}
+catch(e){
+}
+}
+Dialog._modal=null;
+};
+Dialog._modal.focus();
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/Dialogs/inline-dialog.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/Dialogs/inline-dialog.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,207 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/modules/Dialogs/inline-dialog.js */
+Xinha.Dialog=function(_1,_2,_3){
+this.id={};
+this.r_id={};
+this.editor=_1;
+this.document=document;
+this.rootElem=document.createElement("div");
+this.rootElem.className="dialog";
+this.rootElem.style.position="absolute";
+this.rootElem.style.display="none";
+this.editor._framework.ed_cell.insertBefore(this.rootElem,this.editor._framework.ed_cell.firstChild);
+this.rootElem.style.width=this.width=this.editor._framework.ed_cell.offsetWidth+"px";
+this.rootElem.style.height=this.height=this.editor._framework.ed_cell.offsetHeight+"px";
+var _4=this;
+if(typeof _3=="function"){
+this._lc=_3;
+}else{
+if(_3){
+this._lc=function(_5){
+return Xinha._lc(_5,_3);
+};
+}else{
+this._lc=function(_6){
+return _6;
+};
+}
+}
+_2=_2.replace(/\[([a-z0-9_]+)\]/ig,function(_7,id){
+if(typeof _4.id[id]=="undefined"){
+_4.id[id]=Xinha.uniq("Dialog");
+_4.r_id[_4.id[id]]=id;
+}
+return _4.id[id];
+}).replace(/<l10n>(.*?)<\/l10n>/ig,function(_9,_a){
+return _4._lc(_a);
+}).replace(/="_\((.*?)\)"/g,function(_b,_c){
+return "=\""+_4._lc(_c)+"\"";
+});
+this.rootElem.innerHTML=_2;
+this.editor.notifyOn("resize",function(e,_e){
+_4.rootElem.style.width=_4.width=_4.editor._framework.ed_cell.offsetWidth+"px";
+_4.rootElem.style.height=_4.height=_4.editor._framework.ed_cell.offsetHeight+"px";
+_4.onresize();
+});
+};
+Xinha.Dialog.prototype.onresize=function(){
+return true;
+};
+Xinha.Dialog.prototype.show=function(_f){
+if(Xinha.is_ie){
+this._lastRange=this.editor._createRange(this.editor._getSelection());
+}
+if(typeof _f!="undefined"){
+this.setValues(_f);
+}
+this._restoreTo=[this.editor._textArea.style.display,this.editor._iframe.style.visibility,this.editor.hidePanels()];
+this.editor._textArea.style.display="none";
+this.editor._iframe.style.visibility="hidden";
+this.rootElem.style.display="";
+};
+Xinha.Dialog.prototype.hide=function(){
+this.rootElem.style.display="none";
+this.editor._textArea.style.display=this._restoreTo[0];
+this.editor._iframe.style.visibility=this._restoreTo[1];
+this.editor.showPanels(this._restoreTo[2]);
+if(Xinha.is_ie){
+this._lastRange.select();
+}
+this.editor.updateToolbar();
+return this.getValues();
+};
+Xinha.Dialog.prototype.toggle=function(){
+if(this.rootElem.style.display=="none"){
+this.show();
+}else{
+this.hide();
+}
+};
+Xinha.Dialog.prototype.setValues=function(_10){
+for(var i in _10){
+var _12=this.getElementsByName(i);
+if(!_12){
+continue;
+}
+for(var x=0;x<_12.length;x++){
+var e=_12[x];
+switch(e.tagName.toLowerCase()){
+case "select":
+for(var j=0;j<e.options.length;j++){
+if(typeof _10[i]=="object"){
+for(var k=0;k<_10[i].length;k++){
+if(_10[i][k]==e.options[j].value){
+e.options[j].selected=true;
+}
+}
+}else{
+if(_10[i]==e.options[j].value){
+e.options[j].selected=true;
+}
+}
+}
+break;
+case "textarea":
+case "input":
+switch(e.getAttribute("type")){
+case "radio":
+if(e.value==_10[i]){
+e.checked=true;
+}
+break;
+case "checkbox":
+if(typeof _10[i]=="object"){
+for(var j in _10[i]){
+if(_10[i][j]==e.value){
+e.checked=true;
+}
+}
+}else{
+if(_10[i]==e.value){
+e.checked=true;
+}
+}
+break;
+default:
+e.value=_10[i];
+}
+break;
+default:
+break;
+}
+}
+}
+};
+Xinha.Dialog.prototype.getValues=function(){
+var _17=[];
+var _18=Xinha.collectionToArray(this.rootElem.getElementsByTagName("input")).append(Xinha.collectionToArray(this.rootElem.getElementsByTagName("textarea"))).append(Xinha.collectionToArray(this.rootElem.getElementsByTagName("select")));
+for(var x=0;x<_18.length;x++){
+var i=_18[x];
+if(!(i.name&&this.r_id[i.name])){
+continue;
+}
+if(typeof _17[this.r_id[i.name]]=="undefined"){
+_17[this.r_id[i.name]]=null;
+}
+var v=_17[this.r_id[i.name]];
+switch(i.tagName.toLowerCase()){
+case "select":
+if(i.multiple){
+if(!v.push){
+if(v!=null){
+v=[v];
+}else{
+v=new Array();
+}
+}
+for(var j=0;j<i.options.length;j++){
+if(i.options[j].selected){
+v.push(i.options[j].value);
+}
+}
+}else{
+if(i.selectedIndex>=0){
+v=i.options[i.selectedIndex];
+}
+}
+break;
+case "textarea":
+case "input":
+default:
+switch(i.type.toLowerCase()){
+case "radio":
+if(i.checked){
+v=i.value;
+break;
+}
+case "checkbox":
+if(v==null){
+if(this.getElementsByName(this.r_id[i.name]).length>1){
+v=new Array();
+}
+}
+if(i.checked){
+if(v!=null&&typeof v=="object"&&v.push){
+v.push(i.value);
+}else{
+v=i.value;
+}
+}
+break;
+default:
+v=i.value;
+break;
+}
+}
+_17[this.r_id[i.name]]=v;
+}
+return _17;
+};
+Xinha.Dialog.prototype.getElementById=function(id){
+return this.document.getElementById(this.id[id]?this.id[id]:id);
+};
+Xinha.Dialog.prototype.getElementsByName=function(_1e){
+return this.document.getElementsByName(this.id[_1e]?this.id[_1e]:_1e);
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/Dialogs/panel-dialog.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/Dialogs/panel-dialog.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,51 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/modules/Dialogs/panel-dialog.js */
+Xinha.PanelDialog=function(_1,_2,_3,_4){
+this.id={};
+this.r_id={};
+this.editor=_1;
+this.document=document;
+this.rootElem=_1.addPanel(_2);
+var _5=this;
+if(typeof _4=="function"){
+this._lc=_4;
+}else{
+if(_4){
+this._lc=function(_6){
+return Xinha._lc(_6,_4);
+};
+}else{
+this._lc=function(_7){
+return _7;
+};
+}
+}
+_3=_3.replace(/\[([a-z0-9_]+)\]/ig,function(_8,id){
+if(typeof _5.id[id]=="undefined"){
+_5.id[id]=Xinha.uniq("Dialog");
+_5.r_id[_5.id[id]]=id;
+}
+return _5.id[id];
+}).replace(/<l10n>(.*?)<\/l10n>/ig,function(_a,_b){
+return _5._lc(_b);
+}).replace(/="_\((.*?)\)"/g,function(_c,_d){
+return "=\""+_5._lc(_d)+"\"";
+});
+this.rootElem.innerHTML=_3;
+};
+Xinha.PanelDialog.prototype.show=function(_e){
+this.setValues(_e);
+this.editor.showPanel(this.rootElem);
+};
+Xinha.PanelDialog.prototype.hide=function(){
+this.editor.hidePanel(this.rootElem);
+return this.getValues();
+};
+Xinha.PanelDialog.prototype.onresize=Xinha.Dialog.prototype.onresize;
+Xinha.PanelDialog.prototype.toggle=Xinha.Dialog.prototype.toggle;
+Xinha.PanelDialog.prototype.setValues=Xinha.Dialog.prototype.setValues;
+Xinha.PanelDialog.prototype.getValues=Xinha.Dialog.prototype.getValues;
+Xinha.PanelDialog.prototype.getElementById=Xinha.Dialog.prototype.getElementById;
+Xinha.PanelDialog.prototype.getElementsByName=Xinha.Dialog.prototype.getElementsByName;
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/Dialogs/popupwin.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/Dialogs/popupwin.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,123 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/modules/Dialogs/popupwin.js */
+function PopupWin(_1,_2,_3,_4){
+this.editor=_1;
+this.handler=_3;
+var _5=window.open("","__ha_dialog","toolbar=no,menubar=no,personalbar=no,width=600,height=600,left=20,top=40,scrollbars=no,resizable=yes");
+this.window=_5;
+var _6=_5.document;
+this.doc=_6;
+var _7=this;
+var _8=document.baseURI||document.URL;
+if(_8&&_8.match(/(.*)\/([^\/]+)/)){
+_8=RegExp.$1+"/";
+}
+if(typeof _editor_url!="undefined"&&!(/^\//.test(_editor_url))&&!(/http:\/\//.test(_editor_url))){
+_8+=_editor_url;
+}else{
+_8=_editor_url;
+}
+if(!(/\/$/.test(_8))){
+_8+="/";
+}
+this.baseURL=_8;
+_6.open();
+var _9="<html><head><title>"+_2+"</title>\n";
+_9+="<style type=\"text/css\">@import url("+_editor_url+"Xinha.css);</style>\n";
+if(_editor_skin!=""){
+_9+="<style type=\"text/css\">@import url("+_editor_url+"skins/"+_editor_skin+"/skin.css);</style>\n";
+}
+_9+="</head>\n";
+_9+="<body class=\"dialog popupwin\" id=\"--HA-body\"></body></html>";
+_6.write(_9);
+_6.close();
+function init2(){
+var _a=_6.body;
+if(!_a){
+setTimeout(init2,25);
+return false;
+}
+_5.title=_2;
+_6.documentElement.style.padding="0px";
+_6.documentElement.style.margin="0px";
+var _b=_6.createElement("div");
+_b.className="content";
+_7.content=_b;
+_a.appendChild(_b);
+_7.element=_a;
+_4(_7);
+_5.focus();
+}
+init2();
+}
+PopupWin.prototype.callHandler=function(){
+var _c=["input","textarea","select"];
+var _d={};
+for(var ti=_c.length;--ti>=0;){
+var _f=_c[ti];
+var els=this.content.getElementsByTagName(_f);
+for(var j=0;j<els.length;++j){
+var el=els[j];
+var val=el.value;
+if(el.tagName.toLowerCase()=="input"){
+if(el.type=="checkbox"){
+val=el.checked;
+}
+}
+_d[el.name]=val;
+}
+}
+this.handler(this,_d);
+return false;
+};
+PopupWin.prototype.close=function(){
+this.window.close();
+};
+PopupWin.prototype.addButtons=function(){
+var _14=this;
+var div=this.doc.createElement("div");
+this.content.appendChild(div);
+div.id="buttons";
+div.className="buttons";
+for(var i=0;i<arguments.length;++i){
+var btn=arguments[i];
+var _18=this.doc.createElement("button");
+div.appendChild(_18);
+_18.innerHTML=Xinha._lc(btn,"Xinha");
+switch(btn.toLowerCase()){
+case "ok":
+Xinha.addDom0Event(_18,"click",function(){
+_14.callHandler();
+_14.close();
+return false;
+});
+break;
+case "cancel":
+Xinha.addDom0Event(_18,"click",function(){
+_14.close();
+return false;
+});
+break;
+}
+}
+};
+PopupWin.prototype.showAtElement=function(){
+var _19=this;
+setTimeout(function(){
+var w=_19.content.offsetWidth+4;
+var h=_19.content.offsetHeight+4;
+var el=_19.content;
+var s=el.style;
+s.position="absolute";
+s.left=parseInt((w-el.offsetWidth)/2,10)+"px";
+s.top=parseInt((h-el.offsetHeight)/2,10)+"px";
+if(Xinha.is_gecko){
+_19.window.innerWidth=w;
+_19.window.innerHeight=h;
+}else{
+_19.window.resizeTo(w+8,h+70);
+}
+},25);
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/FullScreen/full-screen.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/FullScreen/full-screen.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,139 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/modules/FullScreen/full-screen.js */
+function FullScreen(_1,_2){
+this.editor=_1;
+_1._superclean_on=false;
+cfg=_1.config;
+cfg.registerButton("fullscreen",this._lc("Maximize/Minimize Editor"),[_editor_url+cfg.imgURL+"ed_buttons_main.gif",8,0],true,function(e,_4,_5){
+e._fullScreen();
+});
+cfg.addToolbarElement("fullscreen","popupeditor",0);
+}
+FullScreen._pluginInfo={name:"FullScreen",version:"1.0",developer:"James Sleeman",developer_url:"http://www.gogo.co.nz/",c_owner:"Gogo Internet Services",license:"htmlArea",sponsor:"Gogo Internet Services",sponsor_url:"http://www.gogo.co.nz/"};
+FullScreen.prototype._lc=function(_6){
+return Xinha._lc(_6,{url:_editor_url+"modules/FullScreen/lang/",context:"FullScreen"});
+};
+Xinha.prototype._fullScreen=function(){
+var e=this;
+function sizeItUp(){
+if(!e._isFullScreen||e._sizing){
+return false;
+}
+e._sizing=true;
+var _8=Xinha.viewportSize();
+var h=_8.y-e.config.fullScreenMargins[0]-e.config.fullScreenMargins[2];
+var w=_8.x-e.config.fullScreenMargins[1]-e.config.fullScreenMargins[3];
+e.sizeEditor(w+"px",h+"px",true,true);
+e._sizing=false;
+if(e._toolbarObjects.fullscreen){
+e._toolbarObjects.fullscreen.swapImage([_editor_url+cfg.imgURL+"ed_buttons_main.gif",9,0]);
+}
+}
+function sizeItDown(){
+if(e._isFullScreen||e._sizing){
+return false;
+}
+e._sizing=true;
+e.initSize();
+e._sizing=false;
+if(e._toolbarObjects.fullscreen){
+e._toolbarObjects.fullscreen.swapImage([_editor_url+cfg.imgURL+"ed_buttons_main.gif",8,0]);
+}
+}
+function resetScroll(){
+if(e._isFullScreen){
+window.scroll(0,0);
+window.setTimeout(resetScroll,150);
+}
+}
+if(typeof this._isFullScreen=="undefined"){
+this._isFullScreen=false;
+if(e.target!=e._iframe){
+Xinha._addEvent(window,"resize",sizeItUp);
+}
+}
+if(Xinha.is_gecko){
+this.deactivateEditor();
+}
+if(this._isFullScreen){
+this._htmlArea.style.position="";
+if(!Xinha.is_ie){
+this._htmlArea.style.border="";
+}
+try{
+if(Xinha.is_ie&&document.compatMode=="CSS1Compat"){
+var _b=document.getElementsByTagName("html");
+}else{
+var _b=document.getElementsByTagName("body");
+}
+_b[0].style.overflow="";
+}
+catch(e){
+}
+this._isFullScreen=false;
+sizeItDown();
+var _c=this._htmlArea;
+while((_c=_c.parentNode)&&_c.style){
+_c.style.position=_c._xinha_fullScreenOldPosition;
+_c._xinha_fullScreenOldPosition=null;
+}
+if(Xinha.ie_version<7){
+var _d=document.getElementsByTagName("select");
+for(var i=0;i<_d.length;++i){
+_d[i].style.visibility="visible";
+}
+}
+window.scroll(this._unScroll.x,this._unScroll.y);
+}else{
+this._unScroll={x:(window.pageXOffset)?(window.pageXOffset):(document.documentElement)?document.documentElement.scrollLeft:document.body.scrollLeft,y:(window.pageYOffset)?(window.pageYOffset):(document.documentElement)?document.documentElement.scrollTop:document.body.scrollTop};
+var _c=this._htmlArea;
+while((_c=_c.parentNode)&&_c.style){
+_c._xinha_fullScreenOldPosition=_c.style.position;
+_c.style.position="static";
+}
+if(Xinha.ie_version<7){
+var _d=document.getElementsByTagName("select");
+var s,currentEditor;
+for(var i=0;i<_d.length;++i){
+s=_d[i];
+currentEditor=false;
+while(s=s.parentNode){
+if(s==this._htmlArea){
+currentEditor=true;
+break;
+}
+}
+if(!currentEditor&&_d[i].style.visibility!="hidden"){
+_d[i].style.visibility="hidden";
+}
+}
+}
+window.scroll(0,0);
+this._htmlArea.style.position="absolute";
+this._htmlArea.style.zIndex=999;
+this._htmlArea.style.left=e.config.fullScreenMargins[3]+"px";
+this._htmlArea.style.top=e.config.fullScreenMargins[0]+"px";
+if(!Xinha.is_ie&&!Xinha.is_webkit){
+this._htmlArea.style.border="none";
+}
+this._isFullScreen=true;
+resetScroll();
+try{
+if(Xinha.is_ie&&document.compatMode=="CSS1Compat"){
+var _b=document.getElementsByTagName("html");
+}else{
+var _b=document.getElementsByTagName("body");
+}
+_b[0].style.overflow="hidden";
+}
+catch(e){
+}
+sizeItUp();
+}
+if(Xinha.is_gecko){
+this.activateEditor();
+}
+this.focusEditor();
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/FullScreen/lang/de.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/FullScreen/lang/de.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,6 @@
+// I18N constants
+// LANG: "de", ENCODING: UTF-8
+// translated: Raimund Meyer xinha@ray-of-light.org
+{
+  "Maximize/Minimize Editor": "Editor maximieren/verkleinern"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/FullScreen/lang/fr.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/FullScreen/lang/fr.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,5 @@
+// I18N constants
+// LANG: "fr", ENCODING: UTF-8
+{
+  "Maximize/Minimize Editor": "Agrandir/Rduire l'diteur"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/FullScreen/lang/ja.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/FullScreen/lang/ja.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,5 @@
+// I18N constants
+// LANG: "ja", ENCODING: UTF-8
+{
+  "Maximize/Minimize Editor": "/"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/FullScreen/lang/nb.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/FullScreen/lang/nb.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,6 @@
+// I18N constants
+// LANG: "nb", ENCODING: UTF-8
+// translated: Kim Steinhaug, http://www.steinhaug.com/, kim@steinhaug.com
+{
+  "Maximize/Minimize Editor": "Maksimer/Minimer WYSIWYG vindu"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/FullScreen/lang/pl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/FullScreen/lang/pl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,6 @@
+// I18N constants
+// LANG: "pl", ENCODING: UTF-8
+// translated: Krzysztof Kotowicz, koto1sa@o2.pl, http://www.eskot.krakow.pl/portfolio
+{
+  "Maximize/Minimize Editor": "Maksymalizuj/minimalizuj edytor"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/FullScreen/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/FullScreen/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,18 @@
+// I18N constants
+//
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+//
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+//
+// Last revision: 06 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+//
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "Maximize/Minimize Editor": "Maximizar/Minimizar Editor"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/FullScreen/lang/ru.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/FullScreen/lang/ru.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,6 @@
+// I18N constants
+// LANG: "ru", ENCODING: UTF-8
+// Author: Andrei Blagorazumov, a@fnr.ru
+{
+  "Maximize/Minimize Editor": "/ "
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/FullScreen/lang/sv.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/FullScreen/lang/sv.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,6 @@
+// I18N constants
+// LANG: "sv" (Swedish), ENCODING: UTF-8
+// translated: Erik Daln, <dalen@jpl.se>
+{
+  "Maximize/Minimize Editor": "Maximera/Minimera WYSIWYG fnster"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/Gecko/Gecko.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/Gecko/Gecko.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,461 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/modules/Gecko/Gecko.js */
+Gecko._pluginInfo={name:"Gecko",origin:"Xinha Core",version:"$LastChangedRevision:998 $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1"),developer:"The Xinha Core Developer Team",developer_url:"$HeadURL:http://svn.xinha.webfactional.com/trunk/modules/Gecko/Gecko.js $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1"),sponsor:"",sponsor_url:"",license:"htmlArea"};
+function Gecko(_1){
+this.editor=_1;
+_1.Gecko=this;
+}
+Gecko.prototype.onKeyPress=function(ev){
+var _3=this.editor;
+var s=_3.getSelection();
+if(_3.isShortCut(ev)){
+switch(_3.getKey(ev).toLowerCase()){
+case "z":
+if(_3._unLink&&_3._unlinkOnUndo){
+Xinha._stopEvent(ev);
+_3._unLink();
+_3.updateToolbar();
+return true;
+}
+break;
+case "a":
+sel=_3.getSelection();
+sel.removeAllRanges();
+range=_3.createRange();
+range.selectNodeContents(_3._doc.body);
+sel.addRange(range);
+Xinha._stopEvent(ev);
+return true;
+break;
+case "v":
+if(!_3.config.htmlareaPaste){
+return true;
+}
+break;
+}
+}
+switch(_3.getKey(ev)){
+case " ":
+var _5=function(_6,_7){
+var _8=_6.nextSibling;
+if(typeof _7=="string"){
+_7=_3._doc.createElement(_7);
+}
+var a=_6.parentNode.insertBefore(_7,_8);
+Xinha.removeFromParent(_6);
+a.appendChild(_6);
+_8.data=" "+_8.data;
+s.collapse(_8,1);
+_3._unLink=function(){
+var t=a.firstChild;
+a.removeChild(t);
+a.parentNode.insertBefore(t,a);
+Xinha.removeFromParent(a);
+_3._unLink=null;
+_3._unlinkOnUndo=false;
+};
+_3._unlinkOnUndo=true;
+return a;
+};
+if(_3.config.convertUrlsToLinks&&s&&s.isCollapsed&&s.anchorNode.nodeType==3&&s.anchorNode.data.length>3&&s.anchorNode.data.indexOf(".")>=0){
+var _b=s.anchorNode.data.substring(0,s.anchorOffset).search(/\S{4,}$/);
+if(_b==-1){
+break;
+}
+if(_3._getFirstAncestor(s,"a")){
+break;
+}
+var _c=s.anchorNode.data.substring(0,s.anchorOffset).replace(/^.*?(\S*)$/,"$1");
+var _d=_c.match(Xinha.RE_email);
+if(_d){
+var _e=s.anchorNode;
+var _f=_e.splitText(s.anchorOffset);
+var _10=_e.splitText(_b);
+_5(_10,"a").href="mailto:"+_d[0];
+break;
+}
+RE_date=/([0-9]+\.)+/;
+RE_ip=/(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)/;
+var _11=_c.match(Xinha.RE_url);
+if(_11){
+if(RE_date.test(_c)){
+break;
+}
+var _12=s.anchorNode;
+var _13=_12.splitText(s.anchorOffset);
+var _14=_12.splitText(_b);
+_5(_14,"a").href=(_11[1]?_11[1]:"http://")+_11[2];
+break;
+}
+}
+break;
+}
+switch(ev.keyCode){
+case 27:
+if(_3._unLink){
+_3._unLink();
+Xinha._stopEvent(ev);
+}
+break;
+break;
+case 8:
+case 46:
+if(!ev.shiftKey&&this.handleBackspace()){
+Xinha._stopEvent(ev);
+}
+default:
+_3._unlinkOnUndo=false;
+if(s.anchorNode&&s.anchorNode.nodeType==3){
+var a=_3._getFirstAncestor(s,"a");
+if(!a){
+break;
+}
+if(!a._updateAnchTimeout){
+if(s.anchorNode.data.match(Xinha.RE_email)&&a.href.match("mailto:"+s.anchorNode.data.trim())){
+var _16=s.anchorNode;
+var _17=function(){
+a.href="mailto:"+_16.data.trim();
+a._updateAnchTimeout=setTimeout(_17,250);
+};
+a._updateAnchTimeout=setTimeout(_17,1000);
+break;
+}
+var m=s.anchorNode.data.match(Xinha.RE_url);
+if(m&&a.href.match(new RegExp("http(s)?://"+Xinha.escapeStringForRegExp(s.anchorNode.data.trim())))){
+var _19=s.anchorNode;
+var _1a=function(){
+m=_19.data.match(Xinha.RE_url);
+if(m){
+a.href=(m[1]?m[1]:"http://")+m[2];
+}
+a._updateAnchTimeout=setTimeout(_1a,250);
+};
+a._updateAnchTimeout=setTimeout(_1a,1000);
+}
+}
+}
+break;
+}
+return false;
+};
+Gecko.prototype.handleBackspace=function(){
+var _1b=this.editor;
+setTimeout(function(){
+var sel=_1b.getSelection();
+var _1d=_1b.createRange(sel);
+var SC=_1d.startContainer;
+var SO=_1d.startOffset;
+var EC=_1d.endContainer;
+var EO=_1d.endOffset;
+var _22=SC.nextSibling;
+if(SC.nodeType==3){
+SC=SC.parentNode;
+}
+if(!(/\S/.test(SC.tagName))){
+var p=document.createElement("p");
+while(SC.firstChild){
+p.appendChild(SC.firstChild);
+}
+SC.parentNode.insertBefore(p,SC);
+Xinha.removeFromParent(SC);
+var r=_1d.cloneRange();
+r.setStartBefore(_22);
+r.setEndAfter(_22);
+r.extractContents();
+sel.removeAllRanges();
+sel.addRange(r);
+}
+},10);
+};
+Gecko.prototype.inwardHtml=function(_25){
+_25=_25.replace(/<(\/?)strong(\s|>|\/)/ig,"<$1b$2");
+_25=_25.replace(/<(\/?)em(\s|>|\/)/ig,"<$1i$2");
+_25=_25.replace(/<(\/?)del(\s|>|\/)/ig,"<$1strike$2");
+return _25;
+};
+Gecko.prototype.outwardHtml=function(_26){
+_26=_26.replace(/<script[\s]*src[\s]*=[\s]*['"]chrome:\/\/.*?["']>[\s]*<\/script>/ig,"");
+return _26;
+};
+Gecko.prototype.onExecCommand=function(_27,UI,_29){
+try{
+this.editor._doc.execCommand("useCSS",false,true);
+this.editor._doc.execCommand("styleWithCSS",false,false);
+}
+catch(ex){
+}
+switch(_27){
+case "paste":
+alert(Xinha._lc("The Paste button does not work in Mozilla based web browsers (technical security reasons). Press CTRL-V on your keyboard to paste directly."));
+return true;
+break;
+case "removeformat":
+var _2a=this.editor;
+var sel=_2a.getSelection();
+var _2c=_2a.saveSelection(sel);
+var _2d=_2a.createRange(sel);
+var els=_2a._doc.body.getElementsByTagName("*");
+var _2f=(_2d.startContainer.nodeType==1)?_2d.startContainer:_2d.startContainer.parentNode;
+var i,el;
+if(sel.isCollapsed){
+_2d.selectNodeContents(_2a._doc.body);
+}
+for(i=0;i<els.length;i++){
+el=els[i];
+if(_2d.isPointInRange(el,0)||(els[i]==_2f&&_2d.startOffset==0)){
+el.removeAttribute("style");
+}
+}
+this.editor._doc.execCommand(_27,UI,_29);
+_2a.restoreSelection(_2c);
+return true;
+break;
+}
+return false;
+};
+Gecko.prototype.onMouseDown=function(ev){
+if(ev.target.tagName.toLowerCase()=="hr"){
+var sel=this.editor.getSelection();
+var _33=this.editor.createRange(sel);
+_33.selectNode(ev.target);
+}
+};
+Xinha.prototype.insertNodeAtSelection=function(_34){
+if(_34.ownerDocument!=this._doc){
+try{
+_34=this._doc.adoptNode(_34);
+}
+catch(e){
+}
+}
+var sel=this.getSelection();
+var _36=this.createRange(sel);
+sel.removeAllRanges();
+_36.deleteContents();
+var _37=_36.startContainer;
+var pos=_36.startOffset;
+var _39=_34;
+switch(_37.nodeType){
+case 3:
+if(_34.nodeType==3){
+_37.insertData(pos,_34.data);
+_36=this.createRange();
+_36.setEnd(_37,pos+_34.length);
+_36.setStart(_37,pos+_34.length);
+sel.addRange(_36);
+}else{
+_37=_37.splitText(pos);
+if(_34.nodeType==11){
+_39=_39.firstChild;
+}
+_37.parentNode.insertBefore(_34,_37);
+this.selectNodeContents(_39);
+this.updateToolbar();
+}
+break;
+case 1:
+if(_34.nodeType==11){
+_39=_39.firstChild;
+}
+_37.insertBefore(_34,_37.childNodes[pos]);
+this.selectNodeContents(_39);
+this.updateToolbar();
+break;
+}
+};
+Xinha.prototype.getParentElement=function(sel){
+if(typeof sel=="undefined"){
+sel=this.getSelection();
+}
+var _3b=this.createRange(sel);
+try{
+var p=_3b.commonAncestorContainer;
+if(!_3b.collapsed&&_3b.startContainer==_3b.endContainer&&_3b.startOffset-_3b.endOffset<=1&&_3b.startContainer.hasChildNodes()){
+p=_3b.startContainer.childNodes[_3b.startOffset];
+}
+while(p.nodeType==3){
+p=p.parentNode;
+}
+return p;
+}
+catch(ex){
+return null;
+}
+};
+Xinha.prototype.activeElement=function(sel){
+if((sel===null)||this.selectionEmpty(sel)){
+return null;
+}
+if(!sel.isCollapsed){
+if(sel.anchorNode.childNodes.length>sel.anchorOffset&&sel.anchorNode.childNodes[sel.anchorOffset].nodeType==1){
+return sel.anchorNode.childNodes[sel.anchorOffset];
+}else{
+if(sel.anchorNode.nodeType==1){
+return sel.anchorNode;
+}else{
+return null;
+}
+}
+}
+return null;
+};
+Xinha.prototype.selectionEmpty=function(sel){
+if(!sel){
+return true;
+}
+if(typeof sel.isCollapsed!="undefined"){
+return sel.isCollapsed;
+}
+return true;
+};
+Xinha.prototype.saveSelection=function(){
+return this.createRange(this.getSelection()).cloneRange();
+};
+Xinha.prototype.restoreSelection=function(_3f){
+var sel=this.getSelection();
+sel.removeAllRanges();
+sel.addRange(_3f);
+};
+Xinha.prototype.selectNodeContents=function(_41,pos){
+this.focusEditor();
+this.forceRedraw();
+var _43;
+var _44=typeof pos=="undefined"?true:false;
+var sel=this.getSelection();
+_43=this._doc.createRange();
+if(!_41){
+sel.removeAllRanges();
+return;
+}
+if(_44&&_41.tagName&&_41.tagName.toLowerCase().match(/table|img|input|textarea|select/)){
+_43.selectNode(_41);
+}else{
+_43.selectNodeContents(_41);
+}
+sel.removeAllRanges();
+sel.addRange(_43);
+};
+Xinha.prototype.insertHTML=function(_46){
+var sel=this.getSelection();
+var _48=this.createRange(sel);
+this.focusEditor();
+var _49=this._doc.createDocumentFragment();
+var div=this._doc.createElement("div");
+div.innerHTML=_46;
+while(div.firstChild){
+_49.appendChild(div.firstChild);
+}
+var _4b=this.insertNodeAtSelection(_49);
+};
+Xinha.prototype.getSelectedHTML=function(){
+var sel=this.getSelection();
+if(sel.isCollapsed){
+return "";
+}
+var _4d=this.createRange(sel);
+return Xinha.getHTML(_4d.cloneContents(),false,this);
+};
+Xinha.prototype.getSelection=function(){
+return this._iframe.contentWindow.getSelection();
+};
+Xinha.prototype.createRange=function(sel){
+this.activateEditor();
+if(typeof sel!="undefined"){
+try{
+return sel.getRangeAt(0);
+}
+catch(ex){
+return this._doc.createRange();
+}
+}else{
+return this._doc.createRange();
+}
+};
+Xinha.prototype.isKeyEvent=function(_4f){
+return _4f.type=="keypress";
+};
+Xinha.prototype.getKey=function(_50){
+return String.fromCharCode(_50.charCode);
+};
+Xinha.getOuterHTML=function(_51){
+return (new XMLSerializer()).serializeToString(_51);
+};
+Xinha.prototype.cc=String.fromCharCode(8286);
+Xinha.prototype.setCC=function(_52){
+var cc=this.cc;
+try{
+if(_52=="textarea"){
+var ta=this._textArea;
+var _55=ta.selectionStart;
+var _56=ta.value.substring(0,_55);
+var _57=ta.value.substring(_55,ta.value.length);
+if(_57.match(/^[^<]*>/)){
+var _58=_57.indexOf(">")+1;
+ta.value=_56+_57.substring(0,_58)+cc+_57.substring(_58,_57.length);
+}else{
+ta.value=_56+cc+_57;
+}
+ta.value=ta.value.replace(new RegExp("(&[^"+cc+"]*?)("+cc+")([^"+cc+"]*?;)"),"$1$3$2");
+ta.value=ta.value.replace(new RegExp("(<script[^>]*>[^"+cc+"]*?)("+cc+")([^"+cc+"]*?</script>)"),"$1$3$2");
+ta.value=ta.value.replace(new RegExp("^([^"+cc+"]*)("+cc+")([^"+cc+"]*<body[^>]*>)(.*?)"),"$1$3$2$4");
+}else{
+var sel=this.getSelection();
+sel.getRangeAt(0).insertNode(this._doc.createTextNode(cc));
+}
+}
+catch(e){
+}
+};
+Xinha.prototype.findCC=function(_5a){
+if(_5a=="textarea"){
+var ta=this._textArea;
+var pos=ta.value.indexOf(this.cc);
+if(pos==-1){
+return;
+}
+var end=pos+this.cc.length;
+var _5e=ta.value.substring(0,pos);
+var _5f=ta.value.substring(end,ta.value.length);
+ta.value=_5e;
+ta.scrollTop=ta.scrollHeight;
+var _60=ta.scrollTop;
+ta.value+=_5f;
+ta.setSelectionRange(pos,pos);
+ta.focus();
+ta.scrollTop=_60;
+}else{
+try{
+var doc=this._doc;
+doc.body.innerHTML=doc.body.innerHTML.replace(new RegExp(this.cc),"<span id=\"XinhaEditingPostion\"></span>");
+var _62=doc.getElementById("XinhaEditingPostion");
+this.selectNodeContents(_62);
+_62.scrollIntoView(true);
+_62.parentNode.removeChild(_62);
+this._iframe.contentWindow.focus();
+}
+catch(e){
+}
+}
+};
+Xinha.prototype._standardToggleBorders=Xinha.prototype._toggleBorders;
+Xinha.prototype._toggleBorders=function(){
+var _63=this._standardToggleBorders();
+var _64=this._doc.getElementsByTagName("TABLE");
+for(var i=0;i<_64.length;i++){
+_64[i].style.display="none";
+_64[i].style.display="table";
+}
+return _63;
+};
+Xinha.getDoctype=function(doc){
+var d="";
+if(doc.doctype){
+d+="<!DOCTYPE "+doc.doctype.name+" PUBLIC ";
+d+=doc.doctype.publicId?"\""+doc.doctype.publicId+"\"":"";
+d+=doc.doctype.systemId?" \""+doc.doctype.systemId+"\"":"";
+d+=">";
+}
+return d;
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/Gecko/paraHandlerBest.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/Gecko/paraHandlerBest.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,296 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/modules/Gecko/paraHandlerBest.js */
+EnterParagraphs._pluginInfo={name:"EnterParagraphs",version:"1.0",developer:"Adam Wright",developer_url:"http://www.hipikat.org/",sponsor:"The University of Western Australia",sponsor_url:"http://www.uwa.edu.au/",license:"htmlArea"};
+EnterParagraphs.prototype._whiteSpace=/^\s*$/;
+EnterParagraphs.prototype._pExclusions=/^(address|blockquote|body|dd|div|dl|dt|fieldset|form|h1|h2|h3|h4|h5|h6|hr|li|noscript|ol|p|pre|table|ul)$/i;
+EnterParagraphs.prototype._pContainers=/^(body|del|div|fieldset|form|ins|map|noscript|object|td|th)$/i;
+EnterParagraphs.prototype._pBreak=/^(address|pre|blockquote)$/i;
+EnterParagraphs.prototype._permEmpty=/^(area|base|basefont|br|col|frame|hr|img|input|isindex|link|meta|param)$/i;
+EnterParagraphs.prototype._elemSolid=/^(applet|br|button|hr|img|input|table)$/i;
+EnterParagraphs.prototype._pifySibling=/^(address|blockquote|del|div|dl|fieldset|form|h1|h2|h3|h4|h5|h6|hr|ins|map|noscript|object|ol|p|pre|table|ul|)$/i;
+EnterParagraphs.prototype._pifyForced=/^(ul|ol|dl|table)$/i;
+EnterParagraphs.prototype._pifyParent=/^(dd|dt|li|td|th|tr)$/i;
+function EnterParagraphs(_1){
+this.editor=_1;
+if(Xinha.is_gecko){
+this.onKeyPress=this.__onKeyPress;
+}
+}
+EnterParagraphs.prototype.name="EnterParagraphs";
+EnterParagraphs.prototype.insertAdjacentElement=function(_2,_3,el){
+if(_3=="BeforeBegin"){
+_2.parentNode.insertBefore(el,_2);
+}else{
+if(_3=="AfterEnd"){
+_2.nextSibling?_2.parentNode.insertBefore(el,_2.nextSibling):_2.parentNode.appendChild(el);
+}else{
+if(_3=="AfterBegin"&&_2.firstChild){
+_2.insertBefore(el,_2.firstChild);
+}else{
+if(_3=="BeforeEnd"||_3=="AfterBegin"){
+_2.appendChild(el);
+}
+}
+}
+}
+};
+EnterParagraphs.prototype.forEachNodeUnder=function(_5,_6,_7,_8){
+var _9,end;
+if(_5.nodeType==11&&_5.firstChild){
+_9=_5.firstChild;
+end=_5.lastChild;
+}else{
+_9=end=_5;
+}
+while(end.lastChild){
+end=end.lastChild;
+}
+return this.forEachNode(_9,end,_6,_7,_8);
+};
+EnterParagraphs.prototype.forEachNode=function(_a,_b,_c,_d,_e){
+var _f=function(_10,_11){
+return (_11=="ltr"?_10.nextSibling:_10.previousSibling);
+};
+var _12=function(_13,_14){
+return (_14=="ltr"?_13.firstChild:_13.lastChild);
+};
+var _15,lookup,fnReturnVal;
+var _16=_e;
+var _17=false;
+while(_15!=_d=="ltr"?_b:_a){
+if(!_15){
+_15=_d=="ltr"?_a:_b;
+}else{
+if(_12(_15,_d)){
+_15=_12(_15,_d);
+}else{
+if(_f(_15,_d)){
+_15=_f(_15,_d);
+}else{
+lookup=_15;
+while(!_f(lookup,_d)&&lookup!=(_d=="ltr"?_b:_a)){
+lookup=lookup.parentNode;
+}
+_15=(_f(lookup,_d)?_f(lookup,_d):lookup);
+}
+}
+}
+_17=(_15==(_d=="ltr"?_b:_a));
+switch(_c){
+case "cullids":
+fnReturnVal=this._fenCullIds(_15,_16);
+break;
+case "find_fill":
+fnReturnVal=this._fenEmptySet(_15,_16,_c,_17);
+break;
+case "find_cursorpoint":
+fnReturnVal=this._fenEmptySet(_15,_16,_c,_17);
+break;
+}
+if(fnReturnVal[0]){
+return fnReturnVal[1];
+}
+if(_17){
+break;
+}
+if(fnReturnVal[1]){
+_16=fnReturnVal[1];
+}
+}
+return false;
+};
+EnterParagraphs.prototype._fenEmptySet=function(_18,_19,_1a,_1b){
+if(!_19&&!_18.firstChild){
+_19=_18;
+}
+if((_18.nodeType==1&&this._elemSolid.test(_18.nodeName))||(_18.nodeType==3&&!this._whiteSpace.test(_18.nodeValue))||(_18.nodeType!=1&&_18.nodeType!=3)){
+switch(_1a){
+case "find_fill":
+return new Array(true,false);
+break;
+case "find_cursorpoint":
+return new Array(true,_18);
+break;
+}
+}
+if(_1b){
+return new Array(true,_19);
+}
+return new Array(false,_19);
+};
+EnterParagraphs.prototype._fenCullIds=function(_1c,_1d,_1e){
+if(_1d.id){
+_1e[_1d.id]?_1d.id="":_1e[_1d.id]=true;
+}
+return new Array(false,_1e);
+};
+EnterParagraphs.prototype.processSide=function(rng,_20){
+var _21=function(_22,_23){
+return (_23=="left"?_22.previousSibling:_22.nextSibling);
+};
+var _24=_20=="left"?rng.startContainer:rng.endContainer;
+var _25=_20=="left"?rng.startOffset:rng.endOffset;
+var _26,start=_24;
+while(start.nodeType==1&&!this._permEmpty.test(start.nodeName)){
+start=(_25?start.lastChild:start.firstChild);
+}
+while(_26=_26?(_21(_26,_20)?_21(_26,_20):_26.parentNode):start){
+if(_21(_26,_20)){
+if(this._pExclusions.test(_21(_26,_20).nodeName)){
+return this.processRng(rng,_20,_26,_21(_26,_20),(_20=="left"?"AfterEnd":"BeforeBegin"),true,false);
+}
+}else{
+if(this._pContainers.test(_26.parentNode.nodeName)){
+return this.processRng(rng,_20,_26,_26.parentNode,(_20=="left"?"AfterBegin":"BeforeEnd"),true,false);
+}else{
+if(this._pExclusions.test(_26.parentNode.nodeName)){
+if(this._pBreak.test(_26.parentNode.nodeName)){
+return this.processRng(rng,_20,_26,_26.parentNode,(_20=="left"?"AfterBegin":"BeforeEnd"),false,(_20=="left"?true:false));
+}else{
+return this.processRng(rng,_20,(_26=_26.parentNode),(_21(_26,_20)?_21(_26,_20):_26.parentNode),(_21(_26,_20)?(_20=="left"?"AfterEnd":"BeforeBegin"):(_20=="left"?"AfterBegin":"BeforeEnd")),false,false);
+}
+}
+}
+}
+}
+};
+EnterParagraphs.prototype.processRng=function(rng,_28,_29,_2a,_2b,_2c,_2d){
+var _2e=_28=="left"?rng.startContainer:rng.endContainer;
+var _2f=_28=="left"?rng.startOffset:rng.endOffset;
+var _30=this.editor;
+var _31=_30._doc.createRange();
+_31.selectNode(_29);
+if(_28=="left"){
+_31.setEnd(_2e,_2f);
+rng.setStart(_31.startContainer,_31.startOffset);
+}else{
+if(_28=="right"){
+_31.setStart(_2e,_2f);
+rng.setEnd(_31.endContainer,_31.endOffset);
+}
+}
+var cnt=_31.cloneContents();
+this.forEachNodeUnder(cnt,"cullids","ltr",this.takenIds,false,false);
+var _33,pifyOffset,fill;
+_33=_28=="left"?(_31.endContainer.nodeType==3?true:false):(_31.startContainer.nodeType==3?false:true);
+pifyOffset=_33?_31.startOffset:_31.endOffset;
+_33=_33?_31.startContainer:_31.endContainer;
+if(this._pifyParent.test(_33.nodeName)&&_33.parentNode.childNodes.item(0)==_33){
+while(!this._pifySibling.test(_33.nodeName)){
+_33=_33.parentNode;
+}
+}
+if(cnt.nodeType==11&&!cnt.firstChild){
+if(_33.nodeName!="BODY"||(_33.nodeName=="BODY"&&pifyOffset!=0)){
+cnt.appendChild(_30._doc.createElement(_33.nodeName));
+}
+}
+fill=this.forEachNodeUnder(cnt,"find_fill","ltr",false);
+if(fill&&this._pifySibling.test(_33.nodeName)&&((pifyOffset==0)||(pifyOffset==1&&this._pifyForced.test(_33.nodeName)))){
+_29=_30._doc.createElement("p");
+_29.innerHTML="&nbsp;";
+if((_28=="left")&&_33.previousSibling){
+return new Array(_33.previousSibling,"AfterEnd",_29);
+}else{
+if((_28=="right")&&_33.nextSibling){
+return new Array(_33.nextSibling,"BeforeBegin",_29);
+}else{
+return new Array(_33.parentNode,(_28=="left"?"AfterBegin":"BeforeEnd"),_29);
+}
+}
+}
+if(fill){
+if(fill.nodeType==3){
+fill=_30._doc.createDocumentFragment();
+}
+if((fill.nodeType==1&&!this._elemSolid.test())||fill.nodeType==11){
+var _34=_30._doc.createElement("p");
+_34.innerHTML="&nbsp;";
+fill.appendChild(_34);
+}else{
+var _34=_30._doc.createElement("p");
+_34.innerHTML="&nbsp;";
+fill.parentNode.insertBefore(parentNode,fill);
+}
+}
+if(fill){
+_29=fill;
+}else{
+_29=(_2c||(cnt.nodeType==11&&!cnt.firstChild))?_30._doc.createElement("p"):_30._doc.createDocumentFragment();
+_29.appendChild(cnt);
+}
+if(_2d){
+_29.appendChild(_30._doc.createElement("br"));
+}
+return new Array(_2a,_2b,_29);
+};
+EnterParagraphs.prototype.isNormalListItem=function(rng){
+var _36,listNode;
+_36=rng.startContainer;
+if((typeof _36.nodeName!="undefined")&&(_36.nodeName.toLowerCase()=="li")){
+listNode=_36;
+}else{
+if((typeof _36.parentNode!="undefined")&&(typeof _36.parentNode.nodeName!="undefined")&&(_36.parentNode.nodeName.toLowerCase()=="li")){
+listNode=_36.parentNode;
+}else{
+return false;
+}
+}
+if(!listNode.previousSibling){
+if(rng.startOffset==0){
+return false;
+}
+}
+return true;
+};
+EnterParagraphs.prototype.__onKeyPress=function(ev){
+if(ev.keyCode==13&&!ev.shiftKey&&this.editor._iframe.contentWindow.getSelection){
+return this.handleEnter(ev);
+}
+};
+EnterParagraphs.prototype.handleEnter=function(ev){
+var _39;
+var sel=this.editor.getSelection();
+var rng=this.editor.createRange(sel);
+if(this.isNormalListItem(rng)){
+return true;
+}
+this.takenIds=new Object();
+var _3c=this.processSide(rng,"left");
+var _3d=this.processSide(rng,"right");
+_39=_3d[2];
+sel.removeAllRanges();
+rng.deleteContents();
+var _3e=this.forEachNodeUnder(_39,"find_cursorpoint","ltr",false,true);
+if(!_3e){
+alert("INTERNAL ERROR - could not find place to put cursor after ENTER");
+}
+if(_3c){
+this.insertAdjacentElement(_3c[0],_3c[1],_3c[2]);
+}
+if(_3d&&_3d.nodeType!=1){
+this.insertAdjacentElement(_3d[0],_3d[1],_3d[2]);
+}
+if((_3e)&&(this._permEmpty.test(_3e.nodeName))){
+var _3f=0;
+while(_3e.parentNode.childNodes.item(_3f)!=_3e){
+_3f++;
+}
+sel.collapse(_3e.parentNode,_3f);
+}else{
+try{
+sel.collapse(_3e,0);
+if(_3e.nodeType==3){
+_3e=_3e.parentNode;
+}
+this.editor.scrollToElement(_3e);
+}
+catch(e){
+}
+}
+this.editor.updateToolbar();
+Xinha._stopEvent(ev);
+return true;
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/GetHtml/DOMwalk.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/GetHtml/DOMwalk.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,187 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/modules/GetHtml/DOMwalk.js */
+function GetHtmlImplementation(_1){
+this.editor=_1;
+}
+GetHtmlImplementation._pluginInfo={name:"GetHtmlImplementation DOMwalk",origin:"Xinha Core",version:"$LastChangedRevision:961 $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1"),developer:"The Xinha Core Developer Team",developer_url:"$HeadURL:http://svn.xinha.webfactional.com/trunk/modules/GetHtml/DOMwalk.js $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1"),sponsor:"",sponsor_url:"",license:"htmlArea"};
+Xinha.getHTML=function(_2,_3,_4){
+return Xinha.getHTMLWrapper(_2,_3,_4);
+};
+Xinha.emptyAttributes=" checked disabled ismap readonly nowrap compact declare selected defer multiple noresize noshade ";
+Xinha.getHTMLWrapper=function(_5,_6,_7,_8){
+var _9="";
+if(!_8){
+_8="";
+}
+switch(_5.nodeType){
+case 10:
+case 6:
+case 12:
+break;
+case 2:
+break;
+case 4:
+_9+=(Xinha.is_ie?("\n"+_8):"")+"<![CDATA["+_5.data+"]]>";
+break;
+case 5:
+_9+="&"+_5.nodeValue+";";
+break;
+case 7:
+_9+=(Xinha.is_ie?("\n"+_8):"")+"<"+"?"+_5.target+" "+_5.data+" ?>";
+break;
+case 1:
+case 11:
+case 9:
+var _a;
+var i;
+var _c=(_5.nodeType==1)?_5.tagName.toLowerCase():"";
+if((_c=="script"||_c=="noscript")&&_7.config.stripScripts){
+break;
+}
+if(_6){
+_6=!(_7.config.htmlRemoveTags&&_7.config.htmlRemoveTags.test(_c));
+}
+if(Xinha.is_ie&&_c=="head"){
+if(_6){
+_9+=(Xinha.is_ie?("\n"+_8):"")+"<head>";
+}
+var _d=RegExp.multiline;
+RegExp.multiline=true;
+var _e=_5.innerHTML.replace(Xinha.RE_tagName,function(_f,p1,p2){
+return p1+p2.toLowerCase();
+}).replace(/\s*=\s*(([^'"][^>\s]*)([>\s])|"([^"]+)"|'([^']+)')/g,"=\"$2$4$5\"$3").replace(/<(link|meta)((\s*\S*="[^"]*")*)>/g,"<$1$2 />");
+RegExp.multiline=_d;
+_9+=_e+"\n";
+if(_6){
+_9+=(Xinha.is_ie?("\n"+_8):"")+"</head>";
+}
+break;
+}else{
+if(_6){
+_a=(!(_5.hasChildNodes()||Xinha.needsClosingTag(_5)));
+_9+=((Xinha.isBlockElement(_5))?("\n"+_8):"")+"<"+_5.tagName.toLowerCase();
+var _12=_5.attributes;
+for(i=0;i<_12.length;++i){
+var a=_12.item(i);
+if(typeof a.nodeValue=="object"){
+continue;
+}
+if(_5.tagName.toLowerCase()=="input"&&_5.type.toLowerCase()=="checkbox"&&a.nodeName.toLowerCase()=="value"&&a.nodeValue.toLowerCase()=="on"){
+continue;
+}
+if(!a.specified&&!(_5.tagName.toLowerCase().match(/input|option/)&&a.nodeName=="value")&&!(_5.tagName.toLowerCase().match(/area/)&&a.nodeName.match(/shape|coords/i))){
+continue;
+}
+var _14=a.nodeName.toLowerCase();
+if(/_moz_editor_bogus_node/.test(_14)||(_14=="class"&&a.nodeValue=="webkit-block-placeholder")){
+_9="";
+break;
+}
+if(/(_moz)|(contenteditable)|(_msh)/.test(_14)){
+continue;
+}
+var _15;
+if(Xinha.emptyAttributes.indexOf(" "+_14+" ")!=-1){
+_15=_14;
+}else{
+if(_14!="style"){
+if(typeof _5[a.nodeName]!="undefined"&&_14!="href"&&_14!="src"&&!(/^on/.test(_14))){
+_15=_5[a.nodeName];
+}else{
+_15=a.nodeValue;
+if(_14=="class"){
+_15=_15.replace(/Apple-style-span/,"");
+if(!_15){
+continue;
+}
+}
+if(Xinha.is_ie&&(_14=="href"||_14=="src")){
+_15=_7.stripBaseURL(_15);
+}
+if(_7.config.only7BitPrintablesInURLs&&(_14=="href"||_14=="src")){
+_15=_15.replace(/([^!-~]+)/g,function(_16){
+return escape(_16);
+});
+}
+}
+}else{
+if(!Xinha.is_ie){
+_15=_5.style.cssText.replace(/rgb\(.*?\)/ig,function(rgb){
+return Xinha._colorToRgb(rgb);
+});
+}
+}
+}
+if(/^(_moz)?$/.test(_15)){
+continue;
+}
+_9+=" "+_14+"=\""+Xinha.htmlEncode(_15)+"\"";
+}
+if(Xinha.is_ie&&_5.style.cssText){
+_9+=" style=\""+_5.style.cssText.toLowerCase()+"\"";
+}
+if(Xinha.is_ie&&_5.tagName.toLowerCase()=="option"&&_5.selected){
+_9+=" selected=\"selected\"";
+}
+if(_9!==""){
+if(_a&&_c=="p"){
+_9+=">&nbsp;</p>";
+}else{
+if(_a){
+_9+=" />";
+}else{
+_9+=">";
+}
+}
+}
+}
+}
+var _18=false;
+if(_c=="script"||_c=="noscript"){
+if(!_7.config.stripScripts){
+if(Xinha.is_ie){
+var _19="\n"+_5.innerHTML.replace(/^[\n\r]*/,"").replace(/\s+$/,"")+"\n"+_8;
+}else{
+var _19=(_5.hasChildNodes())?_5.firstChild.nodeValue:"";
+}
+_9+=_19+"</"+_c+">"+((Xinha.is_ie)?"\n":"");
+}
+}else{
+if(_c=="pre"){
+_9+=((Xinha.is_ie)?"\n":"")+_5.innerHTML.replace(/<br>/g,"\n")+"</"+_c+">";
+}else{
+for(i=_5.firstChild;i;i=i.nextSibling){
+if(!_18&&i.nodeType==1&&Xinha.isBlockElement(i)){
+_18=true;
+}
+_9+=Xinha.getHTMLWrapper(i,true,_7,_8+"  ");
+}
+if(_6&&!_a){
+_9+=(((Xinha.isBlockElement(_5)&&_18)||_c=="head"||_c=="html")?("\n"+_8):"")+"</"+_5.tagName.toLowerCase()+">";
+}
+}
+}
+break;
+case 3:
+if(/^script|noscript|style$/i.test(_5.parentNode.tagName)){
+_9=_5.data;
+}else{
+if(_5.data.trim()==""){
+if(_5.data){
+_9=" ";
+}else{
+_9="";
+}
+}else{
+_9=Xinha.htmlEncode(_5.data);
+}
+}
+break;
+case 8:
+_9="<!--"+_5.data+"-->";
+break;
+}
+return _9;
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/GetHtml/TransformInnerHTML.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/GetHtml/TransformInnerHTML.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,151 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/modules/GetHtml/TransformInnerHTML.js */
+function GetHtmlImplementation(_1){
+this.editor=_1;
+}
+GetHtmlImplementation._pluginInfo={name:"GetHtmlImplementation TransformInnerHTML",version:"1.0",developer:"Nelson Bright",developer_url:"http://www.brightworkweb.com/",sponsor:"",sponsor_url:"",license:"htmlArea"};
+Xinha.RegExpCache=[/<\s*\/?([^\s\/>]+)[\s*\/>]/gi,/(\s+)_moz[^=>]*=[^\s>]*/gi,/\s*=\s*(([^'"][^>\s]*)([>\s])|"([^"]+)"|'([^']+)')/g,/\/>/g,/<(br|hr|img|input|link|meta|param|embed|area)((\s*\S*="[^"]*")*)>/g,/(<\w+\s+(\w*="[^"]*"\s+)*)(checked|compact|declare|defer|disabled|ismap|multiple|no(href|resize|shade|wrap)|readonly|selected)([\s>])/gi,/(="[^']*)'([^'"]*")/,/&(?=(?!(#[0-9]{2,5};|[a-zA-Z0-9]{2,6};|#x[0-9a-fA-F]{2,4};))[^<]*>)/g,/<\s+/g,/\s+(\/)?>/g,/\s{2,}/g,/\s+([^=\s]+)((="[^"]+")|([\s>]))/g,/\s+contenteditable(=[^>\s\/]*)?/gi,/((href|src)=")([^\s]*)"/g,/<\/?(div|p|h[1-6]|table|tr|td|th|ul|ol|li|blockquote|object|br|hr|img|embed|param|pre|script|html|head|body|meta|link|title|area|input|form|textarea|select|option)[^>]*>/g,/<\/(div|p|h[1-6]|table|tr|ul|ol|blockquote|object|html|head|body|script|form|select)( [^>]*)?>/g,/<(div|p|h[1-6]|table|tr|ul|ol|blockquote|object|html|head|body|script|form|select)( [^>]*)?>/g,/<(td|th|li|option|br|hr|embed|param|pre|meta|link|title|area|input|textarea)[^>]*>/g,/(^|<\/(pre|script)>)(\s|[^\s])*?(<(pre|script)[^>]*>|$)/g,/(<pre[^>]*>)([\s\S])*?(<\/pre>)/g,/(^|<!--[\s\S]*?-->)([\s\S]*?)(?=<!--[\s\S]*?-->|$)/g,/\S*=""/g,/<!--[\s\S]*?-->|<\?[\s\S]*?\?>|<\/?\w[^>]*>/g,/(^|<\/script>)[\s\S]*?(<script[^>]*>|$)/g];
+if(typeof RegExp.prototype.compile=="function"){
+for(var i=0;i<Xinha.RegExpCache.length;i++){
+Xinha.RegExpCache[i]=new RegExp().compile(Xinha.RegExpCache[i]);
+}
+}
+Xinha.prototype.cleanHTML=function(_2){
+var c=Xinha.RegExpCache;
+_2=_2.replace(c[0],function(_4){
+return _4.toLowerCase();
+}).replace(c[1]," ").replace(c[12]," ").replace(c[2],"=\"$2$4$5\"$3").replace(c[21]," ").replace(c[11],function(_5,p1,p2){
+return " "+p1.toLowerCase()+p2;
+}).replace(c[3],">").replace(c[9],"$1>").replace(c[5],"$1$3=\"$3\"$5").replace(c[4],"<$1$2 />").replace(c[6],"$1$2").replace(c[7],"&amp;").replace(c[8],"<").replace(c[10]," ");
+if(Xinha.is_ie&&c[13].test(_2)){
+_2=_2.replace(c[13],"$1"+this.stripBaseURL(RegExp.$3)+"\"");
+}
+if(this.config.only7BitPrintablesInURLs){
+if(Xinha.is_ie){
+c[13].test(_2);
+}
+if(c[13].test(_2)){
+try{
+_2=_2.replace(c[13],"$1"+decodeURIComponent(RegExp.$3).replace(/([^!-~]+)/g,function(_8){
+return escape(_8);
+})+"\"");
+}
+catch(e){
+_2=_2.replace(c[13],"$1"+RegExp.$3.replace(/([^!-~]+)/g,function(_9){
+return escape(_9);
+})+"\"");
+}
+}
+}
+return _2;
+};
+Xinha.indent=function(s,_b){
+Xinha.__nindent=0;
+Xinha.__sindent="";
+Xinha.__sindentChar=(typeof _b=="undefined")?"  ":_b;
+var c=Xinha.RegExpCache;
+if(Xinha.is_gecko){
+s=s.replace(c[19],function(_d){
+return _d.replace(/<br \/>/g,"\n");
+});
+}
+s=s.replace(c[18],function(_e){
+_e=_e.replace(c[20],function(st,$1,$2){
+string=$2.replace(/[\n\r]/gi," ").replace(/\s+/gi," ").replace(c[14],function(str){
+if(str.match(c[16])){
+var s="\n"+Xinha.__sindent+str;
+Xinha.__sindent+=Xinha.__sindentChar;
+++Xinha.__nindent;
+return s;
+}else{
+if(str.match(c[15])){
+--Xinha.__nindent;
+Xinha.__sindent="";
+for(var i=Xinha.__nindent;i>0;--i){
+Xinha.__sindent+=Xinha.__sindentChar;
+}
+return "\n"+Xinha.__sindent+str;
+}else{
+if(str.match(c[17])){
+return "\n"+Xinha.__sindent+str;
+}
+}
+}
+return str;
+});
+return $1+string;
+});
+return _e;
+});
+s=s.replace(/^\s*/,"").replace(/ +\n/g,"\n").replace(/[\r\n]+(\s+)<\/script>/g,"\n$1</script>");
+return s;
+};
+Xinha.getHTML=function(_15,_16,_17){
+var _18="";
+var c=Xinha.RegExpCache;
+if(_15.nodeType==11){
+var div=document.createElement("div");
+var _1b=_15.insertBefore(div,_15.firstChild);
+for(j=_1b.nextSibling;j;j=j.nextSibling){
+_1b.appendChild(j.cloneNode(true));
+}
+_18+=_1b.innerHTML.replace(c[23],function(_1c){
+_1c=_1c.replace(c[22],function(tag){
+if(/^<[!\?]/.test(tag)){
+return tag;
+}else{
+return _17.cleanHTML(tag);
+}
+});
+return _1c;
+});
+}else{
+var _1e=(_15.nodeType==1)?_15.tagName.toLowerCase():"";
+if(_16){
+_18+="<"+_1e;
+var _1f=_15.attributes;
+for(i=0;i<_1f.length;++i){
+var a=_1f.item(i);
+if(!a.specified){
+continue;
+}
+var _21=a.nodeName.toLowerCase();
+var _22=a.nodeValue;
+_18+=" "+_21+"=\""+_22+"\"";
+}
+_18+=">";
+}
+if(_1e=="html"){
+innerhtml=_17._doc.documentElement.innerHTML;
+}else{
+innerhtml=_15.innerHTML;
+}
+_18+=innerhtml.replace(c[23],function(_23){
+_23=_23.replace(c[22],function(tag){
+if(/^<[!\?]/.test(tag)){
+return tag;
+}else{
+if(!(_17.config.htmlRemoveTags&&_17.config.htmlRemoveTags.test(tag.replace(/<([^\s>\/]+)/,"$1")))){
+return _17.cleanHTML(tag);
+}else{
+return "";
+}
+}
+});
+return _23;
+});
+if(Xinha.is_ie){
+_18=_18.replace(/<li( [^>]*)?>/g,"</li><li$1>").replace(/(<(ul|ol)[^>]*>)[\s\n]*<\/li>/g,"$1").replace(/<\/li>([\s\n]*<\/li>)+/g,"</li>");
+}
+if(Xinha.is_gecko){
+_18=_18.replace(/<br \/>\n$/,"");
+}
+if(_16){
+_18+="</"+_1e+">";
+}
+_18=Xinha.indent(_18);
+}
+return _18;
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/GetHtml/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/GetHtml/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,18 @@
+// I18N constants
+//
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+//
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+//
+// Last revision: 06 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+//
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "Your Document is not well formed. Check JavaScript console for details.": "Seu documento no est formatado corretamente. Verifique os detalhes no console do Javascript."
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/InsertImage/insert_image.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/InsertImage/insert_image.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,173 @@
+<!DOCTYPE html
+     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
+    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
+<head>
+  <title>Insert Image</title>
+
+<script type="text/javascript" src="../../popups/popup.js"></script>
+<link rel="stylesheet" type="text/css" href="../../popups/popup.css" />
+
+<script type="text/javascript">
+
+
+Xinha = window.opener.Xinha;
+function i18n(str) {
+  return (Xinha._lc(str, 'Xinha'));
+}
+
+function Init() {
+  __dlg_translate('Xinha');
+  __dlg_init(null,{width:410,height:400});
+  // Make sure the translated string appears in the drop down. (for gecko)
+  document.getElementById("f_align").selectedIndex = 1;
+  document.getElementById("f_align").selectedIndex = 5;
+  var param = window.dialogArguments;
+  if (param["f_base"]) {
+      document.getElementById("f_base").value = param["f_base"];
+  }
+  document.getElementById("f_url").value    = param["f_url"] ? param["f_url"] : "";
+  document.getElementById("f_alt").value    = param["f_alt"] ? param["f_alt"] : "";
+  document.getElementById("f_border").value = (typeof param["f_border"]!="undefined") ? param["f_border"] : "";
+  document.getElementById("f_align").value  = param["f_align"] ? param["f_align"] : "";
+  document.getElementById("f_vert").value   = (typeof param["f_vert"]!="undefined") ? param["f_vert"] : "";
+  document.getElementById("f_horiz").value  = (typeof param["f_horiz"]!="undefined") ? param["f_horiz"] : "";
+  if (param["f_url"]) {
+      window.ipreview.location.replace(Xinha._resolveRelativeUrl(param.f_base, param.f_url));
+  }
+  document.getElementById("f_url").focus();
+}
+
+function onOK() {
+  var required = {
+    "f_url": i18n("You must enter the URL")
+  };
+  for (var i in required) {
+    var el = document.getElementById(i);
+    if (!el.value) {
+      alert(required[i]);
+      el.focus();
+      return false;
+    }
+  }
+  // pass data back to the calling window
+  var fields = ["f_url", "f_alt", "f_align", "f_border",
+                "f_horiz", "f_vert"];
+  var param = new Object();
+  for (var i in fields) {
+    var id = fields[i];
+    var el = document.getElementById(id);
+    param[id] = el.value;
+  }
+  __dlg_close(param);
+  return false;
+}
+
+function onCancel() {
+  __dlg_close(null);
+  return false;
+}
+
+function onPreview() {
+  var f_url = document.getElementById("f_url");
+  var url = f_url.value;
+  var base = document.getElementById("f_base").value;
+  if (!url) {
+    alert(i18n("You must enter the URL"));
+    f_url.focus();
+    return false;
+  }
+  window.ipreview.location.replace(Xinha._resolveRelativeUrl(base, url));
+  return false;
+}
+</script>
+
+</head>
+
+<body class="dialog" onload="Init()">
+
+<div class="title">Insert Image</div>
+<!--- new stuff --->
+<form action="" method="get">
+<input type="hidden" name="base" id="f_base"/>
+<table border="0" width="100%" style="padding: 0px; margin: 0px">
+  <tbody>
+
+  <tr>
+    <td style="width: 7em; text-align: right">Image URL:</td>
+    <td><input type="text" name="url" id="f_url" style="width:75%"
+      title="Enter the image URL here" />
+      <button name="preview" onclick="return onPreview();"
+      title="Preview the image in a new window">Preview</button>
+    </td>
+  </tr>
+  <tr>
+    <td style="width: 7em; text-align: right">Alternate text:</td>
+    <td><input type="text" name="alt" id="f_alt" style="width:100%"
+      title="For browsers that don't support images" /></td>
+  </tr>
+
+  </tbody>
+</table>
+
+<fieldset style="float: left; margin-left: 5px;">
+<legend>Layout</legend>
+
+<div class="space"></div>
+
+<div class="fl">Alignment:</div>
+<select size="1" name="align" id="f_align"
+  title="Positioning of this image">
+  <option value=""                             >Not set</option>
+  <option value="left"                         >Left</option>
+  <option value="right"                        >Right</option>
+  <option value="texttop"                      >Texttop</option>
+  <option value="absmiddle"                    >Absmiddle</option>
+  <option value="baseline" selected="selected" >Baseline</option>
+  <option value="absbottom"                    >Absbottom</option>
+  <option value="bottom"                       >Bottom</option>
+  <option value="middle"                       >Middle</option>
+  <option value="top"                          >Top</option>
+</select>
+
+<br />
+
+<div class="fl">Border thickness:</div>
+<input type="text" name="border" id="f_border" size="5"
+title="Leave empty for no border" />
+
+<div class="space"></div>
+
+</fieldset>
+
+<fieldset>
+<legend>Spacing</legend>
+
+<div class="space"></div>
+
+<div class="fr">Horizontal:</div>
+<input type="text" name="horiz" id="f_horiz" size="5"
+title="Horizontal padding" />
+
+<br />
+
+<div class="fr">Vertical:</div>
+<input type="text" name="vert" id="f_vert" size="5"
+title="Vertical padding" />
+
+<div class="space"></div>
+
+</fieldset>
+<div class="space" style="clear:all"></div>
+<div>
+Image Preview:<br />
+    <iframe name="ipreview" id="ipreview" frameborder="0" style="border : 1px solid gray;" 
+	height="200" width="100%" src="../../popups/blank.html"></iframe>
+</div>
+<div id="buttons">
+<button type="submit" name="ok" onclick="return onOK();">OK</button>
+<button type="button" name="cancel" onclick="return onCancel();">Cancel</button>
+</div>
+</form>
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/InsertImage/insert_image.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/InsertImage/insert_image.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,119 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/modules/InsertImage/insert_image.js */
+InsertImage._pluginInfo={name:"InsertImage",origin:"Xinha Core",version:"$LastChangedRevision:992 $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1"),developer:"The Xinha Core Developer Team",developer_url:"$HeadURL:http://svn.xinha.webfactional.com/trunk/modules/InsertImage/insert_image.js $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1"),sponsor:"",sponsor_url:"",license:"htmlArea"};
+function InsertImage(_1){
+}
+Xinha.prototype._insertImage=function(_2){
+var _3=this;
+var _4;
+if(typeof _2=="undefined"){
+_2=this.getParentElement();
+if(_2&&_2.tagName.toLowerCase()!="img"){
+_2=null;
+}
+}
+var _5;
+if(typeof _3.config.baseHref!="undefined"&&_3.config.baseHref!==null){
+_5=_3.config.baseHref;
+}else{
+var _6=window.location.toString().split("/");
+_6.pop();
+_5=_6.join("/");
+}
+if(_2){
+function getSpecifiedAttribute(_7,_8){
+var a=_7.attributes;
+for(var i=0;i<a.length;i++){
+if(a[i].nodeName==_8&&a[i].specified){
+return a[i].value;
+}
+}
+return "";
+}
+_4={f_base:_5,f_url:this.stripBaseURL(_2.getAttribute("src",2)),f_alt:_2.alt,f_border:_2.border,f_align:_2.align,f_vert:getSpecifiedAttribute(_2,"vspace"),f_horiz:getSpecifiedAttribute(_2,"hspace"),f_width:_2.width,f_height:_2.height};
+}else{
+_4={f_base:_5,f_url:""};
+}
+Dialog(_3.config.URIs.insert_image,function(_b){
+if(!_b){
+return false;
+}
+var _c=_2;
+if(!_c){
+if(Xinha.is_ie){
+var _d=_3.getSelection();
+var _e=_3.createRange(_d);
+_3._doc.execCommand("insertimage",false,_b.f_url);
+_c=_e.parentElement();
+if(_c.tagName.toLowerCase()!="img"){
+_c=_c.previousSibling;
+}
+}else{
+_c=document.createElement("img");
+_c.src=_b.f_url;
+_3.insertNodeAtSelection(_c);
+if(!_c.tagName){
+_c=_e.startContainer.firstChild;
+}
+}
+}else{
+_c.src=_b.f_url;
+}
+for(var _f in _b){
+var _10=_b[_f];
+switch(_f){
+case "f_alt":
+if(_10){
+_c.alt=_10;
+}else{
+_c.removeAttribute("alt");
+}
+break;
+case "f_border":
+if(_10){
+_c.border=parseInt(_10||"0");
+}else{
+_c.removeAttribute("border");
+}
+break;
+case "f_align":
+if(_10){
+_c.align=_10;
+}else{
+_c.removeAttribute("align");
+}
+break;
+case "f_vert":
+if(_10!=""){
+_c.vspace=parseInt(_10||"0");
+}else{
+_c.removeAttribute("vspace");
+}
+break;
+case "f_horiz":
+if(_10!=""){
+_c.hspace=parseInt(_10||"0");
+}else{
+_c.removeAttribute("hspace");
+}
+break;
+case "f_width":
+if(_10){
+_c.width=parseInt(_10||"0");
+}else{
+_c.removeAttribute("width");
+}
+break;
+case "f_height":
+if(_10){
+_c.height=parseInt(_10||"0");
+}else{
+_c.removeAttribute("height");
+}
+break;
+}
+}
+},_4);
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/InsertTable/insert_table.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/InsertTable/insert_table.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,157 @@
+<html>
+
+<head>
+  <title>Insert Table</title>
+
+<script type="text/javascript" src="../../popups/popup.js"></script>
+<link rel="stylesheet" type="text/css" href="../../popups/popup.css" />
+
+<script type="text/javascript">
+
+window.resizeTo(425, 250);
+
+Xinha = window.opener.Xinha;
+function i18n(str) {
+  return (Xinha._lc(str, 'Xinha'));
+}
+
+function Init() {
+  Xinha = window.opener.Xinha; // load the Xinha plugin and lang file
+  __dlg_translate('Xinha');
+  __dlg_init(null, Xinha.is_ie ? null : {width:425,height:250});
+  // Make sure the translated string appears in the drop down. (for gecko)
+  document.getElementById("f_unit").selectedIndex = 1;
+  document.getElementById("f_unit").selectedIndex = 0;
+  document.getElementById("f_align").selectedIndex = 1;
+  document.getElementById("f_align").selectedIndex = 0;
+  document.getElementById("f_rows").focus();
+}
+
+function onOK() {
+  var required = {
+    "f_rows": i18n("You must enter a number of rows"),
+    "f_cols": i18n("You must enter a number of columns")
+  };
+  for (var i in required) {
+    var el = document.getElementById(i);
+    if (!el.value) {
+      alert(required[i]);
+      el.focus();
+      return false;
+    }
+  }
+  var fields = ["f_rows", "f_cols", "f_width", "f_unit", "f_fixed",
+                "f_align", "f_border", "f_spacing", "f_padding"];
+  var param = new Object();
+  for (var i in fields) {
+    var id = fields[i];
+    var el = document.getElementById(id);
+    param[id] = (el.type == "checkbox") ? el.checked : el.value;
+  }
+  __dlg_close(param);
+  return false;
+}
+
+function onCancel() {
+  __dlg_close(null);
+  return false;
+}
+
+</script>
+
+</head>
+
+<body class="dialog" onload="Init()">
+
+<div class="title">Insert Table</div>
+
+<form action="" method="get">
+<table border="0" style="padding: 0px; margin: 0px">
+  <tbody>
+
+  <tr>
+    <td style="width: 4em; text-align: right">Rows:</td>
+    <td><input type="text" name="rows" id="f_rows" size="5" title="Number of rows" value="2" /></td>
+    <td style="width: 4em; text-align: right">Width:</td>
+    <td><input type="text" name="width" id="f_width" size="5" title="Width of the table" value="100" /></td>
+    <td><select size="1" name="unit" id="f_unit" title="Width unit">
+      <option value="%" selected="selected"  >Percent</option>
+      <option value="px"              >Pixels</option>
+      <option value="em"              >Em</option>
+    </select></td>
+  </tr>
+  <tr>
+    <td style="width: 4em; text-align: right">Cols:</td>
+    <td><input type="text" name="cols" id="f_cols" size="5" title="Number of columns" value="4" /></td>
+    <td style="text-align: right"><input type="checkbox" checked="checked" name="fixed" id="f_fixed" /></td>
+    <td colspan="2"><label for="f_fixed"
+    >Fixed width columns</label></td>
+  </tr>
+  </tbody>
+</table>
+
+<p />
+
+<fieldset style="float: left; margin-left: 5px;">
+<legend>Layout</legend>
+
+<div class="space"></div>
+
+<div class="fl">Alignment:</div>
+<select size="1" name="align" id="f_align"
+  title="Positioning of this table">
+  <option value="" selected="selected"         >Not set</option>
+  <option value="left"                         >Left</option>
+  <option value="right"                        >Right</option>
+  <option value="texttop"                      >Texttop</option>
+  <option value="absmiddle"                    >Absmiddle</option>
+  <option value="baseline"                     >Baseline</option>
+  <option value="absbottom"                    >Absbottom</option>
+  <option value="bottom"                       >Bottom</option>
+  <option value="middle"                       >Middle</option>
+  <option value="top"                          >Top</option>
+</select>
+
+<p />
+
+<div class="fl">Border thickness:</div>
+<input type="text" name="border" id="f_border" size="5" value="1"
+title="Leave empty for no border" />
+<!--
+<p />
+
+<div class="fl">Collapse borders:</div>
+<input type="checkbox" name="collapse" id="f_collapse" />
+-->
+<div class="space"></div>
+
+</fieldset>
+
+<fieldset style="float:right; margin-right: 5px;">
+<legend>Spacing</legend>
+
+<div class="space"></div>
+
+<div class="fr">Cell spacing:</div>
+<input type="text" name="spacing" id="f_spacing" size="5" value="1"
+title="Space between adjacent cells" />
+
+<p />
+
+<div class="fr">Cell padding:</div>
+<input type="text" name="padding" id="f_padding" size="5" value="1"
+title="Space between content and border in cell" />
+
+<div class="space"></div>
+
+</fieldset>
+
+<div style="margin-top: 85px; border-top: 1px solid #999; padding: 2px; text-align: right;">
+<button type="button" name="ok" onclick="return onOK();">OK</button>
+<button type="button" name="cancel" onclick="return onCancel();">Cancel</button>
+</div>
+
+</form>
+
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/InsertTable/insert_table.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/InsertTable/insert_table.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,66 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/modules/InsertTable/insert_table.js */
+InsertTable._pluginInfo={name:"InsertTable",origin:"Xinha Core",version:"$LastChangedRevision: 688 $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1"),developer:"The Xinha Core Developer Team",developer_url:"$HeadURL: http://svn.xinha.python-hosting.com/trunk/modules/InsertTable/insert_table.js $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1"),sponsor:"",sponsor_url:"",license:"htmlArea"};
+function InsertTable(_1){
+}
+Xinha.prototype._insertTable=function(){
+var _2=this.getSelection();
+var _3=this.createRange(_2);
+var _4=this;
+Dialog(_4.config.URIs.insert_table,function(_5){
+if(!_5){
+return false;
+}
+var _6=_4._doc;
+var _7=_6.createElement("table");
+for(var _8 in _5){
+var _9=_5[_8];
+if(!_9){
+continue;
+}
+switch(_8){
+case "f_width":
+_7.style.width=_9+_5.f_unit;
+break;
+case "f_align":
+_7.align=_9;
+break;
+case "f_border":
+_7.border=parseInt(_9,10);
+break;
+case "f_spacing":
+_7.cellSpacing=parseInt(_9,10);
+break;
+case "f_padding":
+_7.cellPadding=parseInt(_9,10);
+break;
+}
+}
+var _a=0;
+if(_5.f_fixed){
+_a=Math.floor(100/parseInt(_5.f_cols,10));
+}
+var _b=_6.createElement("tbody");
+_7.appendChild(_b);
+for(var i=0;i<_5.f_rows;++i){
+var tr=_6.createElement("tr");
+_b.appendChild(tr);
+for(var j=0;j<_5.f_cols;++j){
+var td=_6.createElement("td");
+if(_a){
+td.style.width=_a+"%";
+}
+tr.appendChild(td);
+td.appendChild(_6.createTextNode("\xa0"));
+}
+}
+if(Xinha.is_ie){
+_3.pasteHTML(_7.outerHTML);
+}else{
+_4.insertNodeAtSelection(_7);
+}
+return true;
+},null);
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/InternetExplorer/InternetExplorer.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/InternetExplorer/InternetExplorer.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,337 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/modules/InternetExplorer/InternetExplorer.js */
+InternetExplorer._pluginInfo={name:"Internet Explorer",origin:"Xinha Core",version:"$LastChangedRevision:980 $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1"),developer:"The Xinha Core Developer Team",developer_url:"$HeadURL:http://svn.xinha.webfactional.com/trunk/modules/InternetExplorer/InternetExplorer.js $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1"),sponsor:"",sponsor_url:"",license:"htmlArea"};
+function InternetExplorer(_1){
+this.editor=_1;
+_1.InternetExplorer=this;
+}
+InternetExplorer.prototype.onKeyPress=function(ev){
+if(this.editor.isShortCut(ev)){
+switch(this.editor.getKey(ev).toLowerCase()){
+case "n":
+this.editor.execCommand("formatblock",false,"<p>");
+Xinha._stopEvent(ev);
+return true;
+break;
+case "1":
+case "2":
+case "3":
+case "4":
+case "5":
+case "6":
+this.editor.execCommand("formatblock",false,"<h"+this.editor.getKey(ev).toLowerCase()+">");
+Xinha._stopEvent(ev);
+return true;
+break;
+}
+}
+switch(ev.keyCode){
+case 8:
+case 46:
+if(this.handleBackspace()){
+Xinha._stopEvent(ev);
+return true;
+}
+break;
+}
+return false;
+};
+InternetExplorer.prototype.handleBackspace=function(){
+var _3=this.editor;
+var _4=_3.getSelection();
+if(_4.type=="Control"){
+var _5=_3.activeElement(_4);
+Xinha.removeFromParent(_5);
+return true;
+}
+var _6=_3.createRange(_4);
+var r2=_6.duplicate();
+r2.moveStart("character",-1);
+var a=r2.parentElement();
+if(a!=_6.parentElement()&&(/^a$/i.test(a.tagName))){
+r2.collapse(true);
+r2.moveEnd("character",1);
+r2.pasteHTML("");
+r2.select();
+return true;
+}
+};
+InternetExplorer.prototype.inwardHtml=function(_9){
+_9=_9.replace(/<(\/?)del(\s|>|\/)/ig,"<$1strike$2");
+_9=_9.replace(/(<script|<!--)/i,"&nbsp;$1");
+return _9;
+};
+InternetExplorer.prototype.outwardHtml=function(_a){
+_a=_a.replace(/&nbsp;(\s*)(<script|<!--)/i,"$1$2");
+return _a;
+};
+InternetExplorer.prototype.onExecCommand=function(_b,UI,_d){
+switch(_b){
+case "saveas":
+var _e=null;
+var _f=this.editor;
+var _10=document.createElement("iframe");
+_10.src="about:blank";
+_10.style.display="none";
+document.body.appendChild(_10);
+try{
+if(_10.contentDocument){
+_e=_10.contentDocument;
+}else{
+_e=_10.contentWindow.document;
+}
+}
+catch(ex){
+}
+_e.open("text/html","replace");
+var _11="";
+if(_f.config.browserQuirksMode===false){
+var _12="<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">";
+}else{
+if(_f.config.browserQuirksMode===true){
+var _12="";
+}else{
+var _12=Xinha.getDoctype(document);
+}
+}
+if(!_f.config.fullPage){
+_11+=_12+"\n";
+_11+="<html>\n";
+_11+="<head>\n";
+_11+="<meta http-equiv=\"Content-Type\" content=\"text/html; charset="+_f.config.charSet+"\">\n";
+if(typeof _f.config.baseHref!="undefined"&&_f.config.baseHref!==null){
+_11+="<base href=\""+_f.config.baseHref+"\"/>\n";
+}
+if(typeof _f.config.pageStyleSheets!=="undefined"){
+for(var i=0;i<_f.config.pageStyleSheets.length;i++){
+if(_f.config.pageStyleSheets[i].length>0){
+_11+="<link rel=\"stylesheet\" type=\"text/css\" href=\""+_f.config.pageStyleSheets[i]+"\">";
+}
+}
+}
+if(_f.config.pageStyle){
+_11+="<style type=\"text/css\">\n"+_f.config.pageStyle+"\n</style>";
+}
+_11+="</head>\n";
+_11+="<body>\n";
+_11+=_f.getEditorContent();
+_11+="</body>\n";
+_11+="</html>";
+}else{
+_11=_f.getEditorContent();
+if(_11.match(Xinha.RE_doctype)){
+_f.setDoctype(RegExp.$1);
+}
+}
+_e.write(_11);
+_e.close();
+_e.execCommand(_b,UI,_d);
+document.body.removeChild(_10);
+return true;
+break;
+case "removeformat":
+var _f=this.editor;
+var sel=_f.getSelection();
+var _15=_f.saveSelection(sel);
+var i,el,els;
+function clean(el){
+if(el.nodeType!=1){
+return;
+}
+el.removeAttribute("style");
+for(var j=0;j<el.childNodes.length;j++){
+clean(el.childNodes[j]);
+}
+if((el.tagName.toLowerCase()=="span"&&!el.attributes.length)||el.tagName.toLowerCase()=="font"){
+el.outerHTML=el.innerHTML;
+}
+}
+if(_f.selectionEmpty(sel)){
+els=_f._doc.body.childNodes;
+for(i=0;i<els.length;i++){
+el=els[i];
+if(el.nodeType!=1){
+continue;
+}
+if(el.tagName.toLowerCase()=="span"){
+newNode=_f.convertNode(el,"div");
+el.parentNode.replaceChild(newNode,el);
+el=newNode;
+}
+clean(el);
+}
+}
+_f._doc.execCommand(_b,UI,_d);
+_f.restoreSelection(_15);
+return true;
+break;
+}
+return false;
+};
+Xinha.prototype.insertNodeAtSelection=function(_18){
+this.insertHTML(_18.outerHTML);
+};
+Xinha.prototype.getParentElement=function(sel){
+if(typeof sel=="undefined"){
+sel=this.getSelection();
+}
+var _1a=this.createRange(sel);
+switch(sel.type){
+case "Text":
+var _1b=_1a.parentElement();
+while(true){
+var _1c=_1a.duplicate();
+_1c.moveToElementText(_1b);
+if(_1c.inRange(_1a)){
+break;
+}
+if((_1b.nodeType!=1)||(_1b.tagName.toLowerCase()=="body")){
+break;
+}
+_1b=_1b.parentElement;
+}
+return _1b;
+case "None":
+return _1a.parentElement();
+case "Control":
+return _1a.item(0);
+default:
+return this._doc.body;
+}
+};
+Xinha.prototype.activeElement=function(sel){
+if((sel===null)||this.selectionEmpty(sel)){
+return null;
+}
+if(sel.type.toLowerCase()=="control"){
+return sel.createRange().item(0);
+}else{
+var _1e=sel.createRange();
+var _1f=this.getParentElement(sel);
+if(_1f.innerHTML==_1e.htmlText){
+return _1f;
+}
+return null;
+}
+};
+Xinha.prototype.selectionEmpty=function(sel){
+if(!sel){
+return true;
+}
+return this.createRange(sel).htmlText==="";
+};
+Xinha.prototype.saveSelection=function(){
+return this.createRange(this.getSelection());
+};
+Xinha.prototype.restoreSelection=function(_21){
+try{
+_21.select();
+}
+catch(e){
+}
+};
+Xinha.prototype.selectNodeContents=function(_22,pos){
+this.focusEditor();
+this.forceRedraw();
+var _24;
+var _25=typeof pos=="undefined"?true:false;
+if(_25&&_22.tagName&&_22.tagName.toLowerCase().match(/table|img|input|select|textarea/)){
+_24=this._doc.body.createControlRange();
+_24.add(_22);
+}else{
+_24=this._doc.body.createTextRange();
+_24.moveToElementText(_22);
+}
+_24.select();
+};
+Xinha.prototype.insertHTML=function(_26){
+this.focusEditor();
+var sel=this.getSelection();
+var _28=this.createRange(sel);
+_28.pasteHTML(_26);
+};
+Xinha.prototype.getSelectedHTML=function(){
+var sel=this.getSelection();
+if(this.selectionEmpty(sel)){
+return "";
+}
+var _2a=this.createRange(sel);
+if(_2a.htmlText){
+return _2a.htmlText;
+}else{
+if(_2a.length>=1){
+return _2a.item(0).outerHTML;
+}
+}
+return "";
+};
+Xinha.prototype.getSelection=function(){
+return this._doc.selection;
+};
+Xinha.prototype.createRange=function(sel){
+if(!sel){
+sel=this.getSelection();
+}
+return sel.createRange();
+};
+Xinha.prototype.isKeyEvent=function(_2c){
+return _2c.type=="keydown";
+};
+Xinha.prototype.getKey=function(_2d){
+return String.fromCharCode(_2d.keyCode);
+};
+Xinha.getOuterHTML=function(_2e){
+return _2e.outerHTML;
+};
+Xinha.prototype.cc=String.fromCharCode(8201);
+Xinha.prototype.setCC=function(_2f){
+var cc=this.cc;
+if(_2f=="textarea"){
+var ta=this._textArea;
+var pos=document.selection.createRange();
+pos.collapse();
+pos.text=cc;
+var _33=ta.value.indexOf(cc);
+var _34=ta.value.substring(0,_33);
+var _35=ta.value.substring(_33+cc.length,ta.value.length);
+if(_35.match(/^[^<]*>/)){
+var _36=_35.indexOf(">")+1;
+ta.value=_34+_35.substring(0,_36)+cc+_35.substring(_36,_35.length);
+}else{
+ta.value=_34+cc+_35;
+}
+ta.value=ta.value.replace(new RegExp("(&[^"+cc+"]*?)("+cc+")([^"+cc+"]*?;)"),"$1$3$2");
+ta.value=ta.value.replace(new RegExp("(<script[^>]*>[^"+cc+"]*?)("+cc+")([^"+cc+"]*?</script>)"),"$1$3$2");
+ta.value=ta.value.replace(new RegExp("^([^"+cc+"]*)("+cc+")([^"+cc+"]*<body[^>]*>)(.*?)"),"$1$3$2$4");
+}else{
+var sel=this.getSelection();
+var r=sel.createRange();
+if(sel.type=="Control"){
+var _39=r.item(0);
+_39.outerHTML+=cc;
+}else{
+r.collapse();
+r.text=cc;
+}
+}
+};
+Xinha.prototype.findCC=function(_3a){
+var _3b=(_3a=="textarea")?this._textArea:this._doc.body;
+range=_3b.createTextRange();
+if(range.findText(escape(this.cc))){
+range.select();
+range.text="";
+}
+if(range.findText(this.cc)){
+range.select();
+range.text="";
+}
+if(_3a=="textarea"){
+this._textArea.focus();
+}
+};
+Xinha.getDoctype=function(doc){
+return (doc.compatMode=="CSS1Compat"&&Xinha.ie_version<8)?"<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">":"";
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/Opera/Opera.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/Opera/Opera.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,464 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/modules/Opera/Opera.js */
+Opera._pluginInfo={name:"Opera",origin:"Xinha Core",version:"$LastChangedRevision:970 $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1"),developer:"The Xinha Core Developer Team",developer_url:"$HeadURL:http://svn.xinha.webfactional.com/trunk/modules/Opera/Opera.js $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1"),sponsor:"Gogo Internet Services Limited",sponsor_url:"http://www.gogo.co.nz/",license:"htmlArea"};
+function Opera(_1){
+this.editor=_1;
+_1.Opera=this;
+}
+Opera.prototype.onKeyPress=function(ev){
+var _3=this.editor;
+var s=_3.getSelection();
+if(_3.isShortCut(ev)){
+switch(_3.getKey(ev).toLowerCase()){
+case "z":
+if(_3._unLink&&_3._unlinkOnUndo){
+Xinha._stopEvent(ev);
+_3._unLink();
+_3.updateToolbar();
+return true;
+}
+break;
+case "a":
+sel=_3.getSelection();
+sel.removeAllRanges();
+range=_3.createRange();
+range.selectNodeContents(_3._doc.body);
+sel.addRange(range);
+Xinha._stopEvent(ev);
+return true;
+break;
+case "v":
+if(!_3.config.htmlareaPaste){
+return true;
+}
+break;
+}
+}
+switch(_3.getKey(ev)){
+case " ":
+var _5=function(_6,_7){
+var _8=_6.nextSibling;
+if(typeof _7=="string"){
+_7=_3._doc.createElement(_7);
+}
+var a=_6.parentNode.insertBefore(_7,_8);
+Xinha.removeFromParent(_6);
+a.appendChild(_6);
+_8.data=" "+_8.data;
+s.collapse(_8,1);
+_3._unLink=function(){
+var t=a.firstChild;
+a.removeChild(t);
+a.parentNode.insertBefore(t,a);
+Xinha.removeFromParent(a);
+_3._unLink=null;
+_3._unlinkOnUndo=false;
+};
+_3._unlinkOnUndo=true;
+return a;
+};
+if(_3.config.convertUrlsToLinks&&s&&s.isCollapsed&&s.anchorNode.nodeType==3&&s.anchorNode.data.length>3&&s.anchorNode.data.indexOf(".")>=0){
+var _b=s.anchorNode.data.substring(0,s.anchorOffset).search(/\S{4,}$/);
+if(_b==-1){
+break;
+}
+if(_3._getFirstAncestor(s,"a")){
+break;
+}
+var _c=s.anchorNode.data.substring(0,s.anchorOffset).replace(/^.*?(\S*)$/,"$1");
+var _d=_c.match(Xinha.RE_email);
+if(_d){
+var _e=s.anchorNode;
+var _f=_e.splitText(s.anchorOffset);
+var _10=_e.splitText(_b);
+_5(_10,"a").href="mailto:"+_d[0];
+break;
+}
+RE_date=/([0-9]+\.)+/;
+RE_ip=/(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)/;
+var _11=_c.match(Xinha.RE_url);
+if(_11){
+if(RE_date.test(_c)){
+break;
+}
+var _12=s.anchorNode;
+var _13=_12.splitText(s.anchorOffset);
+var _14=_12.splitText(_b);
+_5(_14,"a").href=(_11[1]?_11[1]:"http://")+_11[2];
+break;
+}
+}
+break;
+}
+switch(ev.keyCode){
+case 27:
+if(_3._unLink){
+_3._unLink();
+Xinha._stopEvent(ev);
+}
+break;
+break;
+case 8:
+case 46:
+if(!ev.shiftKey&&this.handleBackspace()){
+Xinha._stopEvent(ev);
+}
+default:
+_3._unlinkOnUndo=false;
+if(s.anchorNode&&s.anchorNode.nodeType==3){
+var a=_3._getFirstAncestor(s,"a");
+if(!a){
+break;
+}
+if(!a._updateAnchTimeout){
+if(s.anchorNode.data.match(Xinha.RE_email)&&a.href.match("mailto:"+s.anchorNode.data.trim())){
+var _16=s.anchorNode;
+var _17=function(){
+a.href="mailto:"+_16.data.trim();
+a._updateAnchTimeout=setTimeout(_17,250);
+};
+a._updateAnchTimeout=setTimeout(_17,1000);
+break;
+}
+var m=s.anchorNode.data.match(Xinha.RE_url);
+if(m&&a.href.match(new RegExp("http(s)?://"+Xinha.escapeStringForRegExp(s.anchorNode.data.trim())))){
+var _19=s.anchorNode;
+var _1a=function(){
+m=_19.data.match(Xinha.RE_url);
+if(m){
+a.href=(m[1]?m[1]:"http://")+m[2];
+}
+a._updateAnchTimeout=setTimeout(_1a,250);
+};
+a._updateAnchTimeout=setTimeout(_1a,1000);
+}
+}
+}
+break;
+}
+return false;
+};
+Opera.prototype.handleBackspace=function(){
+var _1b=this.editor;
+setTimeout(function(){
+var sel=_1b.getSelection();
+var _1d=_1b.createRange(sel);
+var SC=_1d.startContainer;
+var SO=_1d.startOffset;
+var EC=_1d.endContainer;
+var EO=_1d.endOffset;
+var _22=SC.nextSibling;
+if(SC.nodeType==3){
+SC=SC.parentNode;
+}
+if(!(/\S/.test(SC.tagName))){
+var p=document.createElement("p");
+while(SC.firstChild){
+p.appendChild(SC.firstChild);
+}
+SC.parentNode.insertBefore(p,SC);
+Xinha.removeFromParent(SC);
+var r=_1d.cloneRange();
+r.setStartBefore(_22);
+r.setEndAfter(_22);
+r.extractContents();
+sel.removeAllRanges();
+sel.addRange(r);
+}
+},10);
+};
+Opera.prototype.inwardHtml=function(_25){
+_25=_25.replace(/<(\/?)del(\s|>|\/)/ig,"<$1strike$2");
+return _25;
+};
+Opera.prototype.outwardHtml=function(_26){
+return _26;
+};
+Opera.prototype.onExecCommand=function(_27,UI,_29){
+switch(_27){
+case "removeformat":
+var _2a=this.editor;
+var sel=_2a.getSelection();
+var _2c=_2a.saveSelection(sel);
+var _2d=_2a.createRange(sel);
+var els=_2a._doc.body.getElementsByTagName("*");
+var _2f=(_2d.startContainer.nodeType==1)?_2d.startContainer:_2d.startContainer.parentNode;
+var i,el;
+if(sel.isCollapsed){
+_2d.selectNodeContents(_2a._doc.body);
+}
+for(i=0;i<els.length;i++){
+el=els[i];
+if(_2d.isPointInRange(el,0)||(els[i]==_2f&&_2d.startOffset==0)){
+el.removeAttribute("style");
+}
+}
+this.editor._doc.execCommand(_27,UI,_29);
+_2a.restoreSelection(_2c);
+return true;
+break;
+}
+return false;
+};
+Opera.prototype.onMouseDown=function(ev){
+};
+Xinha.prototype.insertNodeAtSelection=function(_32){
+if(_32.ownerDocument!=this._doc){
+try{
+_32=this._doc.adoptNode(_32);
+}
+catch(e){
+}
+}
+this.focusEditor();
+var sel=this.getSelection();
+var _34=this.createRange(sel);
+_34.deleteContents();
+var _35=_34.startContainer;
+var pos=_34.startOffset;
+var _37=_32;
+sel.removeAllRanges();
+switch(_35.nodeType){
+case 3:
+if(_32.nodeType==3){
+_35.insertData(pos,_32.data);
+_34=this.createRange();
+_34.setEnd(_35,pos+_32.length);
+_34.setStart(_35,pos+_32.length);
+sel.addRange(_34);
+}else{
+_35=_35.splitText(pos);
+if(_32.nodeType==11){
+_37=_37.firstChild;
+}
+_35.parentNode.insertBefore(_32,_35);
+this.selectNodeContents(_37);
+this.updateToolbar();
+}
+break;
+case 1:
+if(_32.nodeType==11){
+_37=_37.firstChild;
+}
+_35.insertBefore(_32,_35.childNodes[pos]);
+this.selectNodeContents(_37);
+this.updateToolbar();
+break;
+}
+};
+Xinha.prototype.getParentElement=function(sel){
+if(typeof sel=="undefined"){
+sel=this.getSelection();
+}
+var _39=this.createRange(sel);
+try{
+var p=_39.commonAncestorContainer;
+if(!_39.collapsed&&_39.startContainer==_39.endContainer&&_39.startOffset-_39.endOffset<=1&&_39.startContainer.hasChildNodes()){
+p=_39.startContainer.childNodes[_39.startOffset];
+}
+while(p.nodeType==3){
+p=p.parentNode;
+}
+return p;
+}
+catch(ex){
+return null;
+}
+};
+Xinha.prototype.activeElement=function(sel){
+if((sel===null)||this.selectionEmpty(sel)){
+return null;
+}
+if(!sel.isCollapsed){
+if(sel.anchorNode.childNodes.length>sel.anchorOffset&&sel.anchorNode.childNodes[sel.anchorOffset].nodeType==1){
+return sel.anchorNode.childNodes[sel.anchorOffset];
+}else{
+if(sel.anchorNode.nodeType==1){
+return sel.anchorNode;
+}else{
+return null;
+}
+}
+}
+return null;
+};
+Xinha.prototype.selectionEmpty=function(sel){
+if(!sel){
+return true;
+}
+if(typeof sel.isCollapsed!="undefined"){
+return sel.isCollapsed;
+}
+return true;
+};
+Xinha.prototype.saveSelection=function(){
+return this.createRange(this.getSelection()).cloneRange();
+};
+Xinha.prototype.restoreSelection=function(_3d){
+var sel=this.getSelection();
+sel.removeAllRanges();
+sel.addRange(_3d);
+};
+Xinha.prototype.selectNodeContents=function(_3f,pos){
+this.focusEditor();
+this.forceRedraw();
+var _41;
+var _42=typeof pos=="undefined"?true:false;
+var sel=this.getSelection();
+_41=this._doc.createRange();
+if(_42&&_3f.tagName&&_3f.tagName.toLowerCase().match(/table|img|input|textarea|select/)){
+_41.selectNode(_3f);
+}else{
+_41.selectNodeContents(_3f);
+}
+sel.removeAllRanges();
+sel.addRange(_41);
+};
+Xinha.prototype.insertHTML=function(_44){
+var sel=this.getSelection();
+var _46=this.createRange(sel);
+this.focusEditor();
+var _47=this._doc.createDocumentFragment();
+var div=this._doc.createElement("div");
+div.innerHTML=_44;
+while(div.firstChild){
+_47.appendChild(div.firstChild);
+}
+var _49=this.insertNodeAtSelection(_47);
+};
+Xinha.prototype.getSelectedHTML=function(){
+var sel=this.getSelection();
+if(sel.isCollapsed){
+return "";
+}
+var _4b=this.createRange(sel);
+return Xinha.getHTML(_4b.cloneContents(),false,this);
+};
+Xinha.prototype.getSelection=function(){
+var sel=this._iframe.contentWindow.getSelection();
+if(sel&&sel.focusNode&&sel.focusNode.tagName&&sel.focusNode.tagName=="HTML"){
+var bod=this._doc.getElementsByTagName("body")[0];
+var rng=this.createRange();
+rng.selectNodeContents(bod);
+sel.removeAllRanges();
+sel.addRange(rng);
+sel.collapseToEnd();
+}
+return sel;
+};
+Xinha.prototype.createRange=function(sel){
+this.activateEditor();
+if(typeof sel!="undefined"){
+try{
+return sel.getRangeAt(0);
+}
+catch(ex){
+return this._doc.createRange();
+}
+}else{
+return this._doc.createRange();
+}
+};
+Xinha.prototype.isKeyEvent=function(_50){
+return _50.type=="keypress";
+};
+Xinha.prototype.getKey=function(_51){
+return String.fromCharCode(_51.charCode);
+};
+Xinha.getOuterHTML=function(_52){
+return (new XMLSerializer()).serializeToString(_52);
+};
+Xinha.prototype.setCC=function(_53){
+var cc=String.fromCharCode(8286);
+try{
+if(_53=="textarea"){
+var ta=this._textArea;
+var _56=ta.selectionStart;
+var _57=ta.value.substring(0,_56);
+var _58=ta.value.substring(_56,ta.value.length);
+if(_58.match(/^[^<]*>/)){
+var _59=_58.indexOf(">")+1;
+ta.value=_57+_58.substring(0,_59)+cc+_58.substring(_59,_58.length);
+}else{
+ta.value=_57+cc+_58;
+}
+ta.value=ta.value.replace(new RegExp("(&[^"+cc+"]*?)("+cc+")([^"+cc+"]*?;)"),"$1$3$2");
+ta.value=ta.value.replace(new RegExp("(<script[^>]*>[^"+cc+"]*?)("+cc+")([^"+cc+"]*?</script>)"),"$1$3$2");
+ta.value=ta.value.replace(new RegExp("^([^"+cc+"]*)("+cc+")([^"+cc+"]*<body[^>]*>)(.*?)"),"$1$3$2$4");
+ta.value=ta.value.replace(cc,"<span id=\"XinhaOperaCaretMarker\">MARK</span>");
+}else{
+var sel=this.getSelection();
+var _5b=this._doc.createElement("span");
+_5b.id="XinhaOperaCaretMarker";
+sel.getRangeAt(0).insertNode(_5b);
+}
+}
+catch(e){
+}
+};
+Xinha.prototype.findCC=function(_5c){
+if(_5c=="textarea"){
+var ta=this._textArea;
+var pos=ta.value.search(/(<span\s+id="XinhaOperaCaretMarker"\s*\/?>((\s|(MARK))*<\/span>)?)/);
+if(pos==-1){
+return;
+}
+var cc=RegExp.$1;
+var end=pos+cc.length;
+var _61=ta.value.substring(0,pos);
+var _62=ta.value.substring(end,ta.value.length);
+ta.value=_61;
+ta.scrollTop=ta.scrollHeight;
+var _63=ta.scrollTop;
+ta.value+=_62;
+ta.setSelectionRange(pos,pos);
+ta.focus();
+ta.scrollTop=_63;
+}else{
+var _64=this._doc.getElementById("XinhaOperaCaretMarker");
+if(_64){
+this.focusEditor();
+var rng=this.createRange();
+rng.selectNode(_64);
+var sel=this.getSelection();
+sel.addRange(rng);
+sel.collapseToStart();
+this.scrollToElement(_64);
+_64.parentNode.removeChild(_64);
+return;
+}
+}
+};
+Xinha.getDoctype=function(doc){
+var d="";
+if(doc.doctype){
+d+="<!DOCTYPE "+doc.doctype.name+" PUBLIC ";
+d+=doc.doctype.publicId?"\""+doc.doctype.publicId+"\"":"";
+d+=doc.doctype.systemId?" \""+doc.doctype.systemId+"\"":"";
+d+=">";
+}
+return d;
+};
+Xinha.prototype._standardInitIframe=Xinha.prototype.initIframe;
+Xinha.prototype.initIframe=function(){
+if(!this._iframeLoadDone){
+if(this._iframe.contentWindow&&this._iframe.contentWindow.xinhaReadyToRoll){
+this._iframeLoadDone=true;
+this._standardInitIframe();
+}else{
+var _69=this;
+setTimeout(function(){
+_69.initIframe();
+},5);
+}
+}
+};
+Xinha._addEventOperaOrig=Xinha._addEvent;
+Xinha._addEvent=function(el,_6b,_6c){
+if(el.tagName&&el.tagName.toLowerCase()=="select"&&_6b=="change"){
+return Xinha.addDom0Event(el,_6b,_6c);
+}
+return Xinha._addEventOperaOrig(el,_6b,_6c);
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/modules/WebKit/WebKit.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/modules/WebKit/WebKit.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,478 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/modules/WebKit/WebKit.js */
+WebKit._pluginInfo={name:"WebKit",origin:"Xinha Core",version:"$LastChangedRevision:998 $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1"),developer:"The Xinha Core Developer Team",developer_url:"$HeadURL:http://svn.xinha.webfactional.com/trunk/modules/WebKit/WebKit.js $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1"),sponsor:"",sponsor_url:"",license:"htmlArea"};
+function WebKit(_1){
+this.editor=_1;
+_1.WebKit=this;
+}
+WebKit.prototype.onKeyPress=function(ev){
+var _3=this.editor;
+var s=_3.getSelection();
+if(_3.isShortCut(ev)){
+switch(_3.getKey(ev).toLowerCase()){
+case "z":
+if(_3._unLink&&_3._unlinkOnUndo){
+Xinha._stopEvent(ev);
+_3._unLink();
+_3.updateToolbar();
+return true;
+}
+break;
+case "a":
+break;
+case "v":
+if(!_3.config.htmlareaPaste){
+return true;
+}
+break;
+}
+}
+switch(_3.getKey(ev)){
+case " ":
+var _5=function(_6,_7){
+var _8=_6.nextSibling;
+if(typeof _7=="string"){
+_7=_3._doc.createElement(_7);
+}
+var a=_6.parentNode.insertBefore(_7,_8);
+Xinha.removeFromParent(_6);
+a.appendChild(_6);
+_8.data=" "+_8.data;
+s.collapse(_8,1);
+_3._unLink=function(){
+var t=a.firstChild;
+a.removeChild(t);
+a.parentNode.insertBefore(t,a);
+Xinha.removeFromParent(a);
+_3._unLink=null;
+_3._unlinkOnUndo=false;
+};
+_3._unlinkOnUndo=true;
+return a;
+};
+if(_3.config.convertUrlsToLinks&&s&&s.isCollapsed&&s.anchorNode.nodeType==3&&s.anchorNode.data.length>3&&s.anchorNode.data.indexOf(".")>=0){
+var _b=s.anchorNode.data.substring(0,s.anchorOffset).search(/\S{4,}$/);
+if(_b==-1){
+break;
+}
+if(_3._getFirstAncestor(s,"a")){
+break;
+}
+var _c=s.anchorNode.data.substring(0,s.anchorOffset).replace(/^.*?(\S*)$/,"$1");
+var _d=_c.match(Xinha.RE_email);
+if(_d){
+var _e=s.anchorNode;
+var _f=_e.splitText(s.anchorOffset);
+var _10=_e.splitText(_b);
+_5(_10,"a").href="mailto:"+_d[0];
+break;
+}
+RE_date=/([0-9]+\.)+/;
+RE_ip=/(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)/;
+var _11=_c.match(Xinha.RE_url);
+if(_11){
+if(RE_date.test(_c)){
+break;
+}
+var _12=s.anchorNode;
+var _13=_12.splitText(s.anchorOffset);
+var _14=_12.splitText(_b);
+_5(_14,"a").href=(_11[1]?_11[1]:"http://")+_11[2];
+break;
+}
+}
+break;
+}
+switch(ev.keyCode){
+case 13:
+if(ev.shiftKey){
+}
+break;
+case 27:
+if(_3._unLink){
+_3._unLink();
+Xinha._stopEvent(ev);
+}
+break;
+case 8:
+case 46:
+if(!ev.shiftKey&&this.handleBackspace()){
+Xinha._stopEvent(ev);
+}
+break;
+default:
+_3._unlinkOnUndo=false;
+if(s.anchorNode&&s.anchorNode.nodeType==3){
+var a=_3._getFirstAncestor(s,"a");
+if(!a){
+break;
+}
+if(!a._updateAnchTimeout){
+if(s.anchorNode.data.match(Xinha.RE_email)&&a.href.match("mailto:"+s.anchorNode.data.trim())){
+var _16=s.anchorNode;
+var _17=function(){
+a.href="mailto:"+_16.data.trim();
+a._updateAnchTimeout=setTimeout(_17,250);
+};
+a._updateAnchTimeout=setTimeout(_17,1000);
+break;
+}
+var m=s.anchorNode.data.match(Xinha.RE_url);
+if(m&&a.href.match(new RegExp("http(s)?://"+Xinha.escapeStringForRegExp(s.anchorNode.data.trim())))){
+var _19=s.anchorNode;
+var _1a=function(){
+m=_19.data.match(Xinha.RE_url);
+if(m){
+a.href=(m[1]?m[1]:"http://")+m[2];
+}
+a._updateAnchTimeout=setTimeout(_1a,250);
+};
+a._updateAnchTimeout=setTimeout(_1a,1000);
+}
+}
+}
+break;
+}
+return false;
+};
+WebKit.prototype.handleBackspace=function(){
+var _1b=this.editor;
+setTimeout(function(){
+var sel=_1b.getSelection();
+var _1d=_1b.createRange(sel);
+var SC=_1d.startContainer;
+var SO=_1d.startOffset;
+var EC=_1d.endContainer;
+var EO=_1d.endOffset;
+var _22=SC.nextSibling;
+if(SC.nodeType==3){
+SC=SC.parentNode;
+}
+if(!(/\S/.test(SC.tagName))){
+var p=document.createElement("p");
+while(SC.firstChild){
+p.appendChild(SC.firstChild);
+}
+SC.parentNode.insertBefore(p,SC);
+Xinha.removeFromParent(SC);
+var r=_1d.cloneRange();
+r.setStartBefore(_22);
+r.setEndAfter(_22);
+r.extractContents();
+sel.removeAllRanges();
+sel.addRange(r);
+}
+},10);
+};
+WebKit.prototype.inwardHtml=function(_25){
+return _25;
+};
+WebKit.prototype.outwardHtml=function(_26){
+return _26;
+};
+WebKit.prototype.onExecCommand=function(_27,UI,_29){
+this.editor._doc.execCommand("styleWithCSS",false,false);
+switch(_27){
+case "paste":
+alert(Xinha._lc("The Paste button does not work in the Safari browser for security reasons. Press CTRL-V on your keyboard to paste directly."));
+return true;
+break;
+case "removeformat":
+var _2a=this.editor;
+var sel=_2a.getSelection();
+var _2c=_2a.saveSelection(sel);
+var _2d=_2a.createRange(sel);
+var els=_2a._doc.getElementsByTagName("*");
+els=Xinha.collectionToArray(els);
+var _2f=(_2d.startContainer.nodeType==1)?_2d.startContainer:_2d.startContainer.parentNode;
+var i,el,newNode,fragment,child,r2=_2a._doc.createRange();
+function clean(el){
+if(el.nodeType!=1){
+return;
+}
+el.removeAttribute("style");
+for(var j=0;j<el.childNodes.length;j++){
+clean(el.childNodes[j]);
+}
+if((el.tagName.toLowerCase()=="span"&&!el.attributes.length)||el.tagName.toLowerCase()=="font"){
+r2.selectNodeContents(el);
+fragment=r2.extractContents();
+while(fragment.firstChild){
+child=fragment.removeChild(fragment.firstChild);
+el.parentNode.insertBefore(child,el);
+}
+el.parentNode.removeChild(el);
+}
+}
+if(sel.isCollapsed){
+els=_2a._doc.body.childNodes;
+for(i=0;i<els.length;i++){
+el=els[i];
+if(el.nodeType!=1){
+continue;
+}
+if(el.tagName.toLowerCase()=="span"){
+newNode=_2a.convertNode(el,"div");
+el.parentNode.replaceChild(newNode,el);
+el=newNode;
+}
+clean(el);
+}
+}else{
+for(i=0;i<els.length;i++){
+el=els[i];
+if(_2d.isPointInRange(el,0)||(els[i]==_2f&&_2d.startOffset==0)){
+clean(el);
+}
+}
+}
+r2.detach();
+_2a.restoreSelection(_2c);
+return true;
+break;
+}
+return false;
+};
+WebKit.prototype.onMouseDown=function(ev){
+if(ev.target.tagName.toLowerCase()=="hr"||ev.target.tagName.toLowerCase()=="img"){
+this.editor.selectNodeContents(ev.target);
+}
+};
+Xinha.prototype.insertNodeAtSelection=function(_34){
+var sel=this.getSelection();
+var _36=this.createRange(sel);
+sel.removeAllRanges();
+_36.deleteContents();
+var _37=_36.startContainer;
+var pos=_36.startOffset;
+var _39=_34;
+switch(_37.nodeType){
+case 3:
+if(_34.nodeType==3){
+_37.insertData(pos,_34.data);
+_36=this.createRange();
+_36.setEnd(_37,pos+_34.length);
+_36.setStart(_37,pos+_34.length);
+sel.addRange(_36);
+}else{
+_37=_37.splitText(pos);
+if(_34.nodeType==11){
+_39=_39.firstChild;
+}
+_37.parentNode.insertBefore(_34,_37);
+this.selectNodeContents(_39);
+this.updateToolbar();
+}
+break;
+case 1:
+if(_34.nodeType==11){
+_39=_39.firstChild;
+}
+_37.insertBefore(_34,_37.childNodes[pos]);
+this.selectNodeContents(_39);
+this.updateToolbar();
+break;
+}
+};
+Xinha.prototype.getParentElement=function(sel){
+if(typeof sel=="undefined"){
+sel=this.getSelection();
+}
+var _3b=this.createRange(sel);
+try{
+var p=_3b.commonAncestorContainer;
+if(!_3b.collapsed&&_3b.startContainer==_3b.endContainer&&_3b.startOffset-_3b.endOffset<=1&&_3b.startContainer.hasChildNodes()){
+p=_3b.startContainer.childNodes[_3b.startOffset];
+}
+while(p.nodeType==3){
+p=p.parentNode;
+}
+return p;
+}
+catch(ex){
+return null;
+}
+};
+Xinha.prototype.activeElement=function(sel){
+if((sel===null)||this.selectionEmpty(sel)){
+return null;
+}
+if(!sel.isCollapsed){
+if(sel.anchorNode.childNodes.length>sel.anchorOffset&&sel.anchorNode.childNodes[sel.anchorOffset].nodeType==1){
+return sel.anchorNode.childNodes[sel.anchorOffset];
+}else{
+if(sel.anchorNode.nodeType==1){
+return sel.anchorNode;
+}else{
+return null;
+}
+}
+}
+return null;
+};
+Xinha.prototype.selectionEmpty=function(sel){
+if(!sel){
+return true;
+}
+if(typeof sel.isCollapsed!="undefined"){
+return sel.isCollapsed;
+}
+return true;
+};
+Xinha.prototype.saveSelection=function(){
+return this.createRange(this.getSelection()).cloneRange();
+};
+Xinha.prototype.restoreSelection=function(_3f){
+var sel=this.getSelection();
+sel.removeAllRanges();
+sel.addRange(_3f);
+};
+Xinha.prototype.selectNodeContents=function(_41,pos){
+this.focusEditor();
+this.forceRedraw();
+var _43;
+var _44=typeof pos=="undefined"?true:false;
+var sel=this.getSelection();
+_43=this._doc.createRange();
+if(_44&&_41.tagName&&_41.tagName.toLowerCase().match(/table|img|input|textarea|select/)){
+_43.selectNode(_41);
+}else{
+_43.selectNodeContents(_41);
+}
+sel.removeAllRanges();
+sel.addRange(_43);
+};
+Xinha.prototype.insertHTML=function(_46){
+var sel=this.getSelection();
+var _48=this.createRange(sel);
+this.focusEditor();
+var _49=this._doc.createDocumentFragment();
+var div=this._doc.createElement("div");
+div.innerHTML=_46;
+while(div.firstChild){
+_49.appendChild(div.firstChild);
+}
+var _4b=this.insertNodeAtSelection(_49);
+};
+Xinha.prototype.getSelectedHTML=function(){
+var sel=this.getSelection();
+if(sel.isCollapsed){
+return "";
+}
+var _4d=this.createRange(sel);
+if(_4d){
+return Xinha.getHTML(_4d.cloneContents(),false,this);
+}else{
+return "";
+}
+};
+Xinha.prototype.getSelection=function(){
+return this._iframe.contentWindow.getSelection();
+};
+Xinha.prototype.createRange=function(sel){
+this.activateEditor();
+if(typeof sel!="undefined"){
+try{
+return sel.getRangeAt(0);
+}
+catch(ex){
+return this._doc.createRange();
+}
+}else{
+return this._doc.createRange();
+}
+};
+Xinha.prototype.isKeyEvent=function(_4f){
+return _4f.type=="keypress";
+};
+Xinha.prototype.getKey=function(_50){
+var key=String.fromCharCode(parseInt(_50.keyIdentifier.replace(/^U\+/,""),16));
+if(_50.shiftKey){
+return key;
+}else{
+return key.toLowerCase();
+}
+};
+Xinha.getOuterHTML=function(_52){
+return (new XMLSerializer()).serializeToString(_52);
+};
+Xinha.prototype.cc=String.fromCharCode(8286);
+Xinha.prototype.setCC=function(_53){
+var cc=this.cc;
+try{
+if(_53=="textarea"){
+var ta=this._textArea;
+var _56=ta.selectionStart;
+var _57=ta.value.substring(0,_56);
+var _58=ta.value.substring(_56,ta.value.length);
+if(_58.match(/^[^<]*>/)){
+var _59=_58.indexOf(">")+1;
+ta.value=_57+_58.substring(0,_59)+cc+_58.substring(_59,_58.length);
+}else{
+ta.value=_57+cc+_58;
+}
+ta.value=ta.value.replace(new RegExp("(&[^"+cc+"]*?)("+cc+")([^"+cc+"]*?;)"),"$1$3$2");
+ta.value=ta.value.replace(new RegExp("(<script[^>]*>[^"+cc+"]*?)("+cc+")([^"+cc+"]*?</script>)"),"$1$3$2");
+ta.value=ta.value.replace(new RegExp("^([^"+cc+"]*)("+cc+")([^"+cc+"]*<body[^>]*>)(.*?)"),"$1$3$2$4");
+}else{
+var sel=this.getSelection();
+sel.getRangeAt(0).insertNode(this._doc.createTextNode(cc));
+}
+}
+catch(e){
+}
+};
+Xinha.prototype.findCC=function(_5b){
+if(_5b=="textarea"){
+var ta=this._textArea;
+var pos=ta.value.indexOf(this.cc);
+if(pos==-1){
+return;
+}
+var end=pos+this.cc.length;
+var _5f=ta.value.substring(0,pos);
+var _60=ta.value.substring(end,ta.value.length);
+ta.value=_5f;
+ta.scrollTop=ta.scrollHeight;
+var _61=ta.scrollTop;
+ta.value+=_60;
+ta.setSelectionRange(pos,pos);
+ta.focus();
+ta.scrollTop=_61;
+}else{
+var _62=this;
+try{
+var doc=this._doc;
+doc.body.innerHTML=doc.body.innerHTML.replace(new RegExp(this.cc),"<span id=\"XinhaEditingPostion\"></span>");
+var _64=doc.getElementById("XinhaEditingPostion");
+this.selectNodeContents(_64);
+this.scrollToElement(_64);
+_64.parentNode.removeChild(_64);
+this._iframe.contentWindow.focus();
+}
+catch(e){
+}
+}
+};
+Xinha.prototype._standardToggleBorders=Xinha.prototype._toggleBorders;
+Xinha.prototype._toggleBorders=function(){
+var _65=this._standardToggleBorders();
+var _66=this._doc.getElementsByTagName("TABLE");
+for(var i=0;i<_66.length;i++){
+_66[i].style.display="none";
+_66[i].style.display="table";
+}
+return _65;
+};
+Xinha.getDoctype=function(doc){
+var d="";
+if(doc.doctype){
+d+="<!DOCTYPE "+doc.doctype.name+" PUBLIC ";
+d+=doc.doctype.publicId?"\""+doc.doctype.publicId+"\"":"";
+d+=doc.doctype.systemId?" \""+doc.doctype.systemId+"\"":"";
+d+=">";
+}
+return d;
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Abbreviation/abbr/de.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Abbreviation/abbr/de.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,40 @@
+// I18N constants
+// LANG: "de", ENCODING: UTF-8
+// Author: Udo Schmal, <schmal@schaffrath-neuemedien.de>
+//
+// (c) Udo Schmal & Schaffrath NeueMedien 2004
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+
+{
+  "Abs.": "Absatz",
+  "bspw.": "Beispielsweise",
+  "bzw.": "beziehungsweise",
+  "c/o": "care of / bei, zu Hnden von",
+  "ca.": "circa",
+  "d.h.": "das heit",
+  "d.J.": "des Jahres",
+  "Dr.": "Doktor",
+  "e.V.": "Eingetragener Verein",
+  "eG.": "Eingetragene Genossenschaft",
+  "ehem.": "ehemals",
+  "einschl.": "einschlielich",
+  "etc.": "et cetera / und so weiter",
+  "evtl.": "eventuell",
+  "ff.": "(fort) folgende",
+  "gem.": "gem",
+  "inkl.": "inklusive",
+  "max.": "maximal / maximum",
+  "min.": "mindestens / minimum / minimal",
+  "o.g.": "oben genannt",
+  "rd.": "rund",
+  "S.": "Seite",
+  "u.a.": "unter anderem",
+  "u..": "und hnlich",
+  "usw.": "und so weiter",
+  "vgl.": "vergleiche",
+  "z.B.": "zum Beispiel",
+  "z.T.": "zum Teil",
+  "z.Z.": "zur Zeit",
+  "zzgl.": "zuzglich"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Abbreviation/abbr/en.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Abbreviation/abbr/en.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,16 @@
+// I18N constants
+// LANG: "en", ENCODING: UTF-8
+// Author: Udo Schmal, <schmal@schaffrath-neuemedien.de>
+//
+// (c) Udo Schmal & Schaffrath NeueMedien 2004
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+
+{
+  "ANSI": "American National Standards Institute",  
+  "ASA": "American Standards Association",
+  "ISO": "International Organisation for Standardization",
+  "mime": "Multipurpose Internet Mail Extensions",
+  "UTF": "Unicode Transformation Format",
+  "W3C": "World Wide Web Consortium"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Abbreviation/abbreviation.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Abbreviation/abbreviation.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,11 @@
+abbr, acronym, span.abbr {
+  width: 18px;
+  height: 18px;
+	background-image: url(img/ed_abbreviation.gif);	
+	background-repeat: no-repeat;
+	background-position: left top;
+	white-space : nowrap;	
+	cursor: help;
+	border-bottom: 1px dashed #000;
+	padding-left: 19px;
+}
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Abbreviation/abbreviation.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Abbreviation/abbreviation.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,65 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/Abbreviation/abbreviation.js */
+function Abbreviation(_1){
+this.editor=_1;
+var _2=_1.config;
+var _3=this;
+_2.registerButton({id:"abbreviation",tooltip:this._lc("Abbreviation"),image:_1.imgURL("ed_abbreviation.gif","Abbreviation"),textMode:false,action:function(_4){
+_3.buttonPress(_4);
+}});
+_2.addToolbarElement("abbreviation","inserthorizontalrule",1);
+}
+Abbreviation._pluginInfo={name:"Abbreviation",version:"1.0",developer:"Udo Schmal",developer_url:"",sponsor:"L.N.Schaffrath NeueMedien",sponsor_url:"http://www.schaffrath-neuemedien.de/",c_owner:"Udo Schmal & Schaffrath-NeueMedien",license:"htmlArea"};
+Abbreviation.prototype._lc=function(_5){
+return Xinha._lc(_5,"Abbreviation");
+};
+Abbreviation.prototype.onGenerate=function(){
+this.editor.addEditorStylesheet(Xinha.getPluginDir("Abbreviation")+"/abbreviation.css");
+};
+Abbreviation.prototype.buttonPress=function(_6,_7,_8){
+var _9=null;
+var _a=_6.getSelectedHTML();
+var _b=_6._getSelection();
+var _c=_6._createRange(_b);
+var _d=_6._activeElement(_b);
+if(!(_d!=null&&_d.tagName.toLowerCase()=="abbr")){
+_d=_6._getFirstAncestor(_b,"abbr");
+}
+if(_d!=null&&_d.tagName.toLowerCase()=="abbr"){
+_9={title:_d.title,text:_d.innerHTML};
+}else{
+_9={title:"",text:_a};
+}
+_6._popupDialog("plugin://Abbreviation/abbreviation",function(_e){
+if(_e){
+var _f=_e["title"];
+if(_f==""||_f==null){
+if(_d){
+var _10=_d.innerHTML;
+_d.parentNode.removeChild(_d);
+_6.insertHTML(_10);
+}
+return;
+}
+try{
+var doc=_6._doc;
+if(!_d){
+_d=doc.createElement("abbr");
+_d.title=_f;
+_d.innerHTML=_a;
+if(Xinha.is_ie){
+_c.pasteHTML(_d.outerHTML);
+}else{
+_6.insertNodeAtSelection(_d);
+}
+}else{
+_d.title=_f;
+}
+}
+catch(e){
+}
+}
+},_9);
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Abbreviation/img/ed_abbreviation.gif
Binary file Xinha_0.95/plugins/Abbreviation/img/ed_abbreviation.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Abbreviation/lang/de.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Abbreviation/lang/de.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,8 @@
+// I18N constants
+// LANG: "de", ENCODING: UTF-8
+// Author: Udo Schmal (gocher), http://www.schaffrath-neuemedien.de/, udo.schmal@t-online.de
+{
+  "Abbreviation": "Abkrzung",
+  "Expansion:": "Erklrung:",
+  "Delete": "Lschen"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Abbreviation/lang/fr.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Abbreviation/lang/fr.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,7 @@
+// I18N constants
+// LANG: "fr", ENCODING: UTF-8
+{
+  "Abbreviation": "Abrviation",
+  "Expansion:": "Explication",
+  "Delete": "Supprimer"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Abbreviation/lang/ja.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Abbreviation/lang/ja.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,7 @@
+// I18N constants
+// LANG: "ja", ENCODING: UTF-8
+{
+  "Abbreviation": "",
+  "Expansion:": ":",
+  "Delete": ""
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Abbreviation/lang/nb.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Abbreviation/lang/nb.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,8 @@
+// I18N constants
+// LANG: "nb", ENCODING: UTF-8
+// translated: Kim Steinhaug, http://www.steinhaug.com/, kim@steinhaug.com
+{
+  "Abbreviation": "Beskrive forkortelse",
+  "Expansion:": "Betydning:",
+  "Delete": "Fjerne"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Abbreviation/lang/nl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Abbreviation/lang/nl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,8 @@
+// I18N constants
+// LANG: "nl", ENCODING: UTF-8
+// Author: Maarten Molenschot, maarten@nrgmm.nl
+{
+  "Abbreviation": "Afkorting",
+  "Expansion:": "Uitbreiding:",
+  "Delete": "Verwijderen"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Abbreviation/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Abbreviation/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,22 @@
+// I18N constants
+
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+
+// Last revision: 05 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "Abbreviation": "Abreviao",
+  "Cancel": "Cancelar",
+  "Delete": "Apagar",
+  "Expansion:": "Expandir:",
+  "OK": "OK"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Abbreviation/popups/abbreviation.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Abbreviation/popups/abbreviation.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,92 @@
+<html>
+<head>
+  <title>Abbreviation</title>
+  <link rel="stylesheet" type="text/css" href="../../../popups/popup.css" />
+  <script type="text/javascript" src="../../../popups/popup.js"></script>
+
+<script type="text/javascript">
+var Abbreviation = window.opener.Abbreviation; // load the Abbreviation plugin and lang file ;-)
+
+function fillSelect(text) {
+  var abbr = window.location.href;
+  abbr = abbr.replace(/popups\/abbreviation.html/g, "abbr\/" + window.opener._editor_lang + ".js");
+  var abbrData = Xinha._geturlcontent(abbr);
+  if (abbrData) {
+    eval('abbrObj = ' + abbrData);
+    if (abbrObj != "") {
+      dest = document.getElementById("select");
+      for (var i in abbrObj) {
+        same = (i==text);
+        dest.options[dest.options.length] = new Option(i + "=" + abbrObj[i], abbrObj[i], false, same);
+        if (same)
+        document.getElementById("title").value = abbrObj[i];
+      }
+    }
+  }
+}
+
+function Init() {
+  __dlg_translate("Abbreviation");
+  __dlg_init(null,{width: 260, height: 160});
+  var param = window.dialogArguments;
+  var text = null;
+  if (param) {
+    text = param["text"];
+    document.getElementById("title").value = param["title"];
+  }
+  fillSelect(text);
+  document.getElementById("title").focus();
+};
+
+function onOK() {
+  var param = new Object();
+  param["title"] = document.getElementById("title").value;
+  __dlg_close(param);
+  return false;
+}
+
+
+function onDelete() {
+  // pass data back to the calling window
+  var param = new Object();
+  param["title"] = "";
+  __dlg_close(param);
+  return false;
+};
+
+function onCancel() {
+  __dlg_close(null);
+  return false;
+};
+</script>
+
+</head>
+<body class="dialog" onload="Init()">
+<div class="title">Abbreviation</div>
+<form name="form" action="">
+<table border="0" style="width: 100%;">
+  <tr>
+    <td class="lable">Expansion:</td>
+    <td>
+    <select id="select" name="select"
+            onChange="document.form.title.value=document.form.select.options[document.form.select.selectedIndex].value"
+            style="position:absolute; top:35px; left:100px; width:118px; clip:rect(0 120 22 100)">
+      <option value=""></option>
+
+    </select>
+    <input type="text" id="title" name="title"
+           onChange="document.form.select.selectedIndex=-1"
+           style="position:absolute; top:35px; left:100px; width:100px; border-right:0">
+    <!--<input type="text" id="title" name="title" value="" size="30">-->
+    </td>
+  </tr>
+</table>
+
+<div id="buttons">
+   <button type="submit" name="ok" onclick="return onOK();">OK</button>
+   <button type="button" name="delete" onclick="return onDelete();">Delete</button>
+   <button type="button" name="cancel" onclick="return onCancel();">Cancel</button>
+</div>
+</form>
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/BackgroundImage/background-image.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/BackgroundImage/background-image.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,31 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/BackgroundImage/background-image.js */
+function BackgroundImage(_1){
+this.editor=_1;
+var _2=_1.config;
+var _3=this;
+_2.registerButton({id:"bgImage",tooltip:this._lc("Set page background image"),image:_1.imgURL("ed_bgimage.gif","BackgroundImage"),textMode:false,action:function(_4){
+_3.buttonPress(_4);
+}});
+_2.addToolbarElement("bgImage","inserthorizontalrule",1);
+}
+BackgroundImage._pluginInfo={name:"BackgroundImage",version:"1.0",developer:"Udo Schmal",developer_url:"http://www.schaffrath-neuemedien.de/",c_owner:"Udo Schmal & Schaffrath NeueMedien",sponsor:"L.N.Schaffrath NeueMedien",sponsor_url:"http://www.schaffrath-neuemedien.de.de/",license:"htmlArea"};
+BackgroundImage.prototype._lc=function(_5){
+return Xinha._lc(_5,"BackgroundImage");
+};
+BackgroundImage.prototype.buttonPress=function(_6){
+_6._popupDialog("plugin://BackgroundImage/bgimage",function(_7){
+if(_7){
+if(Xinha.is_ie){
+_6.focusEditor();
+}
+if(_7=="*"){
+_6._doc.body.background="";
+}else{
+_6._doc.body.background=_7;
+}
+}
+},null);
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/BackgroundImage/backgrounds/blufur.jpg
Binary file Xinha_0.95/plugins/BackgroundImage/backgrounds/blufur.jpg has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/BackgroundImage/backgrounds/palecnvs.jpg
Binary file Xinha_0.95/plugins/BackgroundImage/backgrounds/palecnvs.jpg has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/BackgroundImage/backgrounds/ppplcnvs.jpg
Binary file Xinha_0.95/plugins/BackgroundImage/backgrounds/ppplcnvs.jpg has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/BackgroundImage/backgrounds/thumbnails/blufur.jpg
Binary file Xinha_0.95/plugins/BackgroundImage/backgrounds/thumbnails/blufur.jpg has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/BackgroundImage/backgrounds/thumbnails/palecnvs.jpg
Binary file Xinha_0.95/plugins/BackgroundImage/backgrounds/thumbnails/palecnvs.jpg has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/BackgroundImage/backgrounds/thumbnails/ppplcnvs.jpg
Binary file Xinha_0.95/plugins/BackgroundImage/backgrounds/thumbnails/ppplcnvs.jpg has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/BackgroundImage/backgrounds/thumbnails/ylwsand.jpg
Binary file Xinha_0.95/plugins/BackgroundImage/backgrounds/thumbnails/ylwsand.jpg has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/BackgroundImage/backgrounds/ylwsand.jpg
Binary file Xinha_0.95/plugins/BackgroundImage/backgrounds/ylwsand.jpg has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/BackgroundImage/img/ed_bgimage.gif
Binary file Xinha_0.95/plugins/BackgroundImage/img/ed_bgimage.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/BackgroundImage/lang/de.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/BackgroundImage/lang/de.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,9 @@
+// I18N constants
+// LANG: "de", ENCODING: UTF-8
+// Author: Udo Schmal (gocher), http://www.schaffrath-neuemedien.de/, udo.schmal@t-online.de
+{
+  "Set page background image": "Seiten-Hintergrundbild setzen",
+  "Set Page Background Image": "Seiten-Hintergrundbild setzen",
+  "Remove Current Background": "Aktuellen Hintergrund entfernen",
+  "Cancel": "Abbrechen"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/BackgroundImage/lang/fr.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/BackgroundImage/lang/fr.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,8 @@
+// I18N constants
+// LANG: "fr", ENCODING: UTF-8
+{
+  "Set page background image": "Dfinir l'image de fond",
+  "Set Page Background Image": "Dfinir l'Image de Fond",
+  "Remove Current Background": "Supprimer le fond actuel",
+  "Cancel": "Annuler"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/BackgroundImage/lang/ja.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/BackgroundImage/lang/ja.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,8 @@
+// I18N constants
+// LANG: "ja", ENCODING: UTF-8
+{
+  "Set page background image": "",
+  "Set Page Background Image": "",
+  "Remove Current Background": "",
+  "Cancel": ""
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/BackgroundImage/lang/nb.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/BackgroundImage/lang/nb.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,9 @@
+// I18N constants
+// LANG: "nb", ENCODING: UTF-8
+// translated: Kim Steinhaug, http://www.steinhaug.com/, kim@steinhaug.com
+{
+  "Set page background image": "Velg bakgrunnsbilde p siden",
+  "Set Page Background Image": "Velg bakgrunnsbilde p Siden",
+  "Remove Current Background": "Fjern gjeldende bakgrunn",
+  "Cancel": "Avbryt"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/BackgroundImage/lang/nl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/BackgroundImage/lang/nl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,9 @@
+// I18N constants
+// LANG: "nl", ENCODING: UTF-8
+// Author: Maarten Molenschot, maarten@nrgmm.nl
+{
+  "Set page background image": "Pagina achtergrond afbeelding instellen",
+  "Set Page Background Image": "Pagina Achtergrond Afbeelding Instellen",
+  "Remove Current Background": "Huidige Achtergrond Afbeelding Verwijderen",
+  "Cancel": "Annuleren"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/BackgroundImage/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/BackgroundImage/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,21 @@
+// I18N constants
+
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+
+// Last revision: 05 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "Cancel": "Cancelar",
+  "Remove Current Background": "Remover fundo atual",
+  "Set Page Background Image": "Definir Imagem de Fundo",
+  "Set page background image": "Definir imagem de fundo"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/BackgroundImage/popups/bgimage.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/BackgroundImage/popups/bgimage.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,49 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+<html>
+<head>
+<title>Set Page Background Image</title>
+<link rel="stylesheet" type="text/css" href="../../../popups/popup.css" />
+<script type="text/javascript" src="../../../popups/popup.js"></script>
+<script language='JavaScript' type='text/javascript'>
+window.resizeTo(350, 195);
+function Init() {
+	
+  __dlg_translate("BackgroundImage");
+  __dlg_init();
+}
+
+function onCancel() {
+  __dlg_close(null);
+  return false;
+}
+
+function insertbg(image) {
+	__dlg_close(window.opener.Xinha.getPluginDir('BackgroundImage') + "/backgrounds/" + image);
+	return false;
+}
+
+function onDelete() {
+  __dlg_close("*");
+  return false;
+}
+</script>
+</head>
+<body class="dialog" onload="Init()">
+<form action="" method="get">
+  <div class="title">Set Page Background Image</div>
+<table style="text-align: center;" border="0" cellspacing="0" cellpadding="6">
+<tr style="text-align: center; vertical-align: top;">
+<td><img onclick="insertbg('blufur.jpg')" border="1" src="../backgrounds/thumbnails/blufur.jpg" width="50" height="50"></td>
+<td><img onclick="insertbg('palecnvs.jpg')" border="1" src="../backgrounds/thumbnails/palecnvs.jpg" width="50" height="50"></td>
+<td><img onclick="insertbg('ppplcnvs.jpg')" border="1" src="../backgrounds/thumbnails/ppplcnvs.jpg" width="50" height="50"></td>
+<td><img onclick="insertbg('ylwsand.jpg')" border="1" src="../backgrounds/thumbnails/ylwsand.jpg" width="50" height="50"></td>
+</tr>
+</table>
+<div class="space"></div>
+<div id="buttons">
+<button type="button" name="delete" onclick="return onDelete()" style="width:auto">Remove Current Background</button>
+<button type="button" name="cancel" onclick="return onCancel();">Cancel</button>
+</div>
+</form>
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/CharCounter/char-counter.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/CharCounter/char-counter.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,109 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/CharCounter/char-counter.js */
+function CharCounter(_1){
+this.editor=_1;
+this._Chars=0;
+this._Words=0;
+this._HTML=0;
+this.onKeyPress=this.__onKeyPress;
+}
+Xinha.Config.prototype.CharCounter={"showChar":true,"showWord":true,"showHtml":true,"separator":" | ","maxHTML":-1};
+CharCounter._pluginInfo={name:"CharCounter",version:"1.31",developer:"Udo Schmal",developer_url:"http://www.schaffrath-neuemedien.de",sponsor:"L.N.Schaffrath NeueMedien",sponsor_url:"http://www.schaffrath-neuemedien.de",c_owner:"Udo Schmal & L.N.Schaffrath NeueMedien",license:"htmlArea"};
+CharCounter.prototype._lc=function(_2){
+return Xinha._lc(_2,"CharCounter");
+};
+CharCounter.prototype.onGenerateOnce=function(){
+var _3=this;
+if(this.charCount==null){
+var _4=document.createElement("span");
+_4.style.padding="2px 5px";
+if(Xinha.is_ie){
+_4.style.styleFloat="right";
+}else{
+_4.style.cssFloat="right";
+}
+var _5=document.createElement("div");
+_5.style.height=_5.style.width=_5.style.lineHeight=_5.style.fontSize="1px";
+_5.style.clear="both";
+if(Xinha.is_ie){
+this.editor._statusBarTree.style.styleFloat="left";
+}else{
+this.editor._statusBarTree.style.cssFloat="left";
+}
+this.editor._statusBar.appendChild(_4);
+this.editor._statusBar.appendChild(_5);
+this.charCount=_4;
+}
+};
+CharCounter.prototype.__onKeyPress=function(ev){
+if((ev.keyCode!=8)&&(ev.keyCode!=46)){
+if(this.editor.config.CharCounter.maxHTML!=-1){
+var _7=this.editor.getHTML();
+if(_7.length>=this.editor.config.CharCounter.maxHTML){
+Xinha._stopEvent(ev);
+return true;
+}
+}
+}
+};
+CharCounter.prototype._updateCharCount=function(){
+var _8=this.editor;
+var _9=_8.config;
+var _a=_8.getHTML();
+var _b=new Array();
+if(_9.CharCounter.showHtml){
+_b[_b.length]=this._lc("HTML")+": "+_a.length;
+}
+this._HTML=_a.length;
+if(_9.CharCounter.showWord||_9.CharCounter.showChar){
+_a=_a.replace(/<\/?\s*!--[^-->]*-->/gi,"");
+_a=_a.replace(/<(.+?)>/g,"");
+_a=_a.replace(/&nbsp;/gi," ");
+_a=_a.replace(/([\n\r\t])/g," ");
+_a=_a.replace(/(  +)/g," ");
+_a=_a.replace(/&(.*);/g," ");
+_a=_a.replace(/^\s*|\s*$/g,"");
+}
+if(_9.CharCounter.showWord){
+this._Words=0;
+for(var x=0;x<_a.length;x++){
+if(_a.charAt(x)==" "){
+this._Words++;
+}
+}
+if(this._Words>=1){
+this._Words++;
+}
+_b[_b.length]=this._lc("Words")+": "+this._Words;
+}
+if(_9.CharCounter.showChar){
+_b[_b.length]=this._lc("Chars")+": "+_a.length;
+this._Chars=_a.length;
+}
+this.charCount.innerHTML=_b.join(_9.CharCounter.separator);
+};
+CharCounter.prototype.onUpdateToolbar=function(){
+this.charCount.innerHTML=this._lc("... in progress");
+if(this._timeoutID){
+window.clearTimeout(this._timeoutID);
+}
+var e=this;
+this._timeoutID=window.setTimeout(function(){
+e._updateCharCount();
+},1000);
+};
+CharCounter.prototype.onMode=function(_e){
+switch(_e){
+case "textmode":
+this.charCount.style.display="none";
+break;
+case "wysiwyg":
+this.charCount.style.display="";
+break;
+default:
+alert("Mode <"+_e+"> not defined!");
+return false;
+}
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/CharCounter/lang/de.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/CharCounter/lang/de.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,8 @@
+// I18N constants
+// LANG: "de", ENCODING: UTF-8
+// Author: Udo Schmal (gocher), http://www.schaffrath-neuemedien.de/, udo.schmal@t-online.de
+{
+  "Chars": "Zeichen",
+  "Words": "Worte",
+  "... in progress": "... in Bearbeitung"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/CharCounter/lang/fr.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/CharCounter/lang/fr.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,6 @@
+// I18N constants
+// LANG: "fr", ENCODING: UTF-8
+{
+  "Chars": "Caractres",
+  "Words": "Mots"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/CharCounter/lang/ja.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/CharCounter/lang/ja.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,7 @@
+// I18N constants
+// LANG: "ja", ENCODING: UTF-8
+{
+  "Chars": "",
+  "Words": "",
+  "... in progress": "... "
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/CharCounter/lang/nb.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/CharCounter/lang/nb.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,6 @@
+// I18N constants
+// LANG: "nb", ENCODING: UTF-8
+// translated: Kim Steinhaug, http://www.steinhaug.com/, kim@steinhaug.com
+{
+  "Chars": "Tegn"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/CharCounter/lang/nl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/CharCounter/lang/nl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,8 @@
+// I18N constants
+// LANG: "nl", ENCODING: UTF-8
+// Author: Maarten Molenschot, maarten@nrgmm.nl
+{
+  "Chars": "Tekens",
+  "Words": "Woorden",
+  "... in progress": "... wordt verwerkt"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/CharCounter/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/CharCounter/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,21 @@
+// I18N constants
+
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+
+// Last revision: 05 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "... in progress": "... em processo",
+  "Chars": "Caracteres",
+  "HTML": "HTML",
+  "Words": "Palavras"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/CharacterMap/CharacterMap.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/CharacterMap/CharacterMap.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,41 @@
+.CharacterMap { }
+.CharacterMap a.entity {
+  font-size:12px;
+  width:18px;
+  display:block;
+  float:left;
+  padding:2px;
+  text-decoration:none;
+  color:#000;
+  text-align:center;
+  
+}
+.CharacterMap a.light {
+  background-color:#ffffff;
+}
+.CharacterMap a.dark {
+  background-color:#f7f8fd;
+}
+.CharacterMap a.entity:hover {
+  background-color:#ffd760;
+  color:#000;
+}
+.popup td.character {
+  font-family:Verdana,Arial,Helvetica,sans-serif;
+  font-size:14px;
+  font-weight:bold;
+  text-align:center;
+  background:#fff;
+  padding:4px;
+}
+.popup td.character-hilite {
+  background:#ffd760;
+}
+.popup form {
+  text-align:center;
+}
+.popup table {
+  cursor:pointer;
+  background-color:#ADAD9C;
+  border:1px inset;
+}
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/CharacterMap/character-map.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/CharacterMap/character-map.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,71 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/CharacterMap/character-map.js */
+Xinha.loadStyle("CharacterMap.css","CharacterMap");
+function CharacterMap(_1){
+this.editor=_1;
+var _2=_1.config;
+var _3=this;
+_2.registerButton({id:"insertcharacter",tooltip:Xinha._lc("Insert special character","CharacterMap"),image:_1.imgURL("ed_charmap.gif","CharacterMap"),textMode:false,action:function(_4){
+_3.buttonPress(_4);
+}});
+_2.addToolbarElement("insertcharacter","createlink",-1);
+if(_2.CharacterMap.mode=="panel"){
+_1._CharacterMap=_1.addPanel("right");
+Xinha._addClass(_1._CharacterMap,"CharacterMap");
+_1.notifyOn("modechange",function(e,_6){
+if(_6.mode=="text"){
+_1.hidePanel(_1._CharacterMap);
+}
+});
+var _7=["&Yuml;","&scaron;","&#064;","&quot;","&iexcl;","&cent;","&pound;","&curren;","&yen;","&brvbar;","&sect;","&uml;","&copy;","&ordf;","&laquo;","&not;","&macr;","&deg;","&plusmn;","&sup2;","&sup3;","&acute;","&micro;","&para;","&middot;","&cedil;","&sup1;","&ordm;","&raquo;","&frac14;","&frac12;","&frac34;","&iquest;","&times;","&Oslash;","&divide;","&oslash;","&fnof;","&circ;","&tilde;","&ndash;","&mdash;","&lsquo;","&rsquo;","&sbquo;","&ldquo;","&rdquo;","&bdquo;","&dagger;","&Dagger;","&bull;","&hellip;","&permil;","&lsaquo;","&rsaquo;","&euro;","&trade;","&Agrave;","&Aacute;","&Acirc;","&Atilde;","&Auml;","&Aring;","&AElig;","&Ccedil;","&Egrave;","&Eacute;","&Ecirc;","&Euml;","&Igrave;","&Iacute;","&Icirc;","&Iuml;","&ETH;","&Ntilde;","&Ograve;","&Oacute;","&Ocirc;","&Otilde;","&Ouml;","&reg;","&times;","&Ugrave;","&Uacute;","&Ucirc;","&Uuml;","&Yacute;","&THORN;","&szlig;","&agrave;","&aacute;","&acirc;","&atilde;","&auml;","&aring;","&aelig;","&ccedil;","&egrave;","&eacute;","&ecirc;","&euml;","&igrave;","&iacute;","&icirc;","&iuml;","&eth;","&ntilde;","&ograve;","&oacute;","&ocirc;","&otilde;","&ouml;","&divide;","&oslash;","&ugrave;","&uacute;","&ucirc;","&uuml;","&yacute;","&thorn;","&yuml;","&OElig;","&oelig;","&Scaron;"];
+for(var i=0;i<_7.length;i++){
+this.addEntity(_7[i],i);
+}
+_1.hidePanel(_1._CharacterMap);
+}
+}
+Xinha.Config.prototype.CharacterMap={"mode":"popup"};
+CharacterMap._pluginInfo={name:"CharacterMap",version:"2.0",developer:"Laurent Vilday",developer_url:"http://www.mokhet.com/",c_owner:"Xinha community",sponsor:"",sponsor_url:"",license:"Creative Commons Attribution-ShareAlike License"};
+CharacterMap._isActive=false;
+CharacterMap.prototype.buttonPress=function(_9){
+var _a=_9.config;
+if(_a.CharacterMap.mode=="panel"){
+if(this._isActive){
+this._isActive=false;
+_9.hidePanel(_9._CharacterMap);
+}else{
+this._isActive=true;
+_9.showPanel(_9._CharacterMap);
+}
+}else{
+_9._popupDialog("plugin://CharacterMap/select_character",function(_b){
+if(!_b){
+return false;
+}
+if(Xinha.is_ie){
+_9.focusEditor();
+}
+_9.insertHTML(_b);
+},null);
+}
+};
+CharacterMap.prototype.addEntity=function(_c,_d){
+var _e=this.editor;
+var _f=this;
+var a=document.createElement("a");
+Xinha._addClass(a,"entity");
+a.innerHTML=_c;
+a.href="javascript:void(0)";
+Xinha._addClass(a,(_d%2)?"light":"dark");
+a.onclick=function(){
+if(Xinha.is_ie){
+_e.focusEditor();
+}
+_e.insertHTML(_c);
+return false;
+};
+_e._CharacterMap.appendChild(a);
+a=null;
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/CharacterMap/img/ed_charmap.gif
Binary file Xinha_0.95/plugins/CharacterMap/img/ed_charmap.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/CharacterMap/lang/de.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/CharacterMap/lang/de.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,11 @@
+// I18N constants
+// LANG: "de", ENCODING: UTF-8
+// Sponsored by http://www.systemconcept.de
+// Author: Holger Hees, <hhees@systemconcept.de>
+// (c) systemconcept.de 2004
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "Insert special character": "Sonderzeichen einfgen",
+  "Cancel": "Abbrechen"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/CharacterMap/lang/fr.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/CharacterMap/lang/fr.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,6 @@
+// I18N constants
+// LANG: "fr", ENCODING: UTF-8
+{
+  "Insert special character": "Insrer un caractre spcial",
+  "Cancel": "Annuler"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/CharacterMap/lang/it.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/CharacterMap/lang/it.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,6 @@
+// I18N constants
+// LANG: "it", ENCODING: UTF-8
+{
+  "Insert special character": "Inserisca il carattere speciale",
+  "Cancel": "Annullamento"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/CharacterMap/lang/nb.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/CharacterMap/lang/nb.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,7 @@
+// I18N constants
+// LANG: "nb", ENCODING: UTF-8
+// translated: Kim Steinhaug, http://www.steinhaug.com/, kim@steinhaug.com
+{
+  "Insert special character": "Sett inn tegn",
+  "Cancel": "Avbryt"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/CharacterMap/lang/nl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/CharacterMap/lang/nl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,11 @@
+// I18N constants
+// LANG: "nl", ENCODING: UTF-8
+// Sponsored by http://www.systemconcept.de
+// Author: Holger Hees, <hhees@systemconcept.de>
+// (c) systemconcept.de 2004
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "Insert special character": "Speciaal character invoegen",
+  "Cancel": "Annuleer"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/CharacterMap/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/CharacterMap/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,19 @@
+// I18N constants
+
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+
+// Last revision: 05 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "Cancel": "Cancelar",
+  "Insert special character": "Inserir caracter especial"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/CharacterMap/lang/ru.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/CharacterMap/lang/ru.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,7 @@
+// I18N constants
+// LANG: "ru", ENCODING: UTF-8
+// Author: Andrei Blagorazumov, a@fnr.ru
+{
+  "Insert special character": "  ",
+  "Cancel": ""
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/CharacterMap/lang/sv.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/CharacterMap/lang/sv.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,7 @@
+// I18N constants
+// LANG: "sv" (Swedish), ENCODING: UTF-8
+// translated: Erik Daln <dalen@jpl.se>
+{
+  "Insert special character": "Infoga tecken",
+  "Cancel": "Avbryt"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/CharacterMap/popups/select_character.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/CharacterMap/popups/select_character.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,184 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
+<html>
+<head>
+<title>Insert special character</title>
+<link rel="stylesheet" type="text/css" href="../CharacterMap.css" />
+<script type="text/javascript" src="../../../popups/popup.js"></script>
+<link rel="stylesheet" type="text/css" href="../../../popups/popup.css" />
+<script type="text/javascript">
+  window.resizeTo(480, 300);
+// HTMLSource based on HTMLArea XTD 1.5 modified by Holger Hees
+// Original Author - Bernhard Pfeifer novocaine@gmx.net
+HTMLArea = window.opener.HTMLArea;
+function Init() // run on page load
+{
+  __dlg_translate('CharacterMap');
+  __dlg_init();
+
+  var character = ''; // set default input to empty
+  View( null, character );
+  document.getElementById("cancel").focus();
+}
+var oldView = null;
+function View( td, character ) // preview character
+{
+  if (oldView)
+    HTMLArea._removeClass(oldView, 'character-hilite');
+  if (td) {
+    oldView = td;
+    HTMLArea._addClass(oldView, 'character-hilite');
+  }
+}
+function Set( string ) // return character
+{
+  var character = string;
+  __dlg_close( character );
+}
+function onCancel() // cancel selection
+{
+  __dlg_close( null );
+  return false;
+}
+
+</script>
+</head>
+<body class="dialog popup" onload="Init();">
+<table border="0" cellspacing="1" cellpadding="0" width="100%">
+<tr>
+<td class="character" onmouseover="View(this,'&amp;Yuml;')" onclick="Set('&Yuml;')">&Yuml;</td>
+<td class="character" onmouseover="View(this,'&amp;scaron;')" onclick="Set('&scaron;')">&scaron;</td>
+<td class="character" onmouseover="View(this,'&amp;#064;')" onclick="Set('&#064;')">@</td>
+<td class="character" onmouseover="View(this,'&amp;quot;')" onclick="Set('&quot;')">&quot;</td>
+<td class="character" onmouseover="View(this,'&amp;iexcl;')" onclick="Set('&iexcl;')">&iexcl;</td>
+<td class="character" onmouseover="View(this,'&amp;cent;')" onclick="Set('&cent;')">&cent;</td>
+<td class="character" onmouseover="View(this,'&amp;pound;')" onclick="Set('&pound;')">&pound;</td>
+<td class="character" onmouseover="View(this,'&amp;curren;')" onclick="Set('&curren;')">&curren;</td>
+<td class="character" onmouseover="View(this,'&amp;yen;')" onclick="Set('&yen;')">&yen;</td>
+<td class="character" onmouseover="View(this,'&amp;brvbar;')" onclick="Set('&brvbar;')">&brvbar;</td>
+<td class="character" onmouseover="View(this,'&amp;sect;')" onclick="Set('&sect;')">&sect;</td>
+<td class="character" onmouseover="View(this,'&amp;uml;')" onclick="Set('&uml;')">&uml;</td>
+<td class="character" onmouseover="View(this,'&amp;copy;')" onclick="Set('&copy;')">&copy;</td>
+<td class="character" onmouseover="View(this,'&amp;ordf;')" onclick="Set('&ordf;')">&ordf;</td>
+<td class="character" onmouseover="View(this,'&amp;laquo;')" onclick="Set('&laquo;')">&laquo;</td>
+<td class="character" onmouseover="View(this,'&amp;not;')" onclick="Set('&not;')">&not;</td>
+</tr><tr>
+<td class="character" onmouseover="View(this,'&amp;macr;')" onclick="Set('&macr;')">&macr;</td>
+<td class="character" onmouseover="View(this,'&amp;deg;')" onclick="Set('&deg;')">&deg;</td>
+<td class="character" onmouseover="View(this,'&amp;plusmn;')" onclick="Set('&plusmn;')">&plusmn;</td>
+<td class="character" onmouseover="View(this,'&amp;sup2;')" onclick="Set('&sup2;')">&sup2;</td>
+<td class="character" onmouseover="View(this,'&amp;sup3;')" onclick="Set('&sup3;')">&sup3;</td>
+<td class="character" onmouseover="View(this,'&amp;acute;')" onclick="Set('&acute;')">&acute;</td>
+<td class="character" onmouseover="View(this,'&amp;micro;')" onclick="Set('&micro;')">&micro;</td>
+<td class="character" onmouseover="View(this,'&amp;para;')" onclick="Set('&para;')">&para;</td>
+<td class="character" onmouseover="View(this,'&amp;middot;')" onclick="Set('&middot;')">&middot;</td>
+<td class="character" onmouseover="View(this,'&amp;cedil;')" onclick="Set('&cedil;')">&cedil;</td>
+<td class="character" onmouseover="View(this,'&amp;sup1;')" onclick="Set('&sup1;')">&sup1;</td>
+<td class="character" onmouseover="View(this,'&amp;ordm;')" onclick="Set('&ordm;')">&ordm;</td>
+<td class="character" onmouseover="View(this,'&amp;raquo;')" onclick="Set('&raquo;')">&raquo;</td>
+<td class="character" onmouseover="View(this,'&amp;frac14;')" onclick="Set('&frac14;')">&frac14;</td>
+<td class="character" onmouseover="View(this,'&amp;frac12;')" onclick="Set('&frac12;')">&frac12;</td>
+<td class="character" onmouseover="View(this,'&amp;frac34;')" onclick="Set('&frac34;')">&frac34;</td>
+</tr><tr>
+<td class="character" onmouseover="View(this,'&amp;iquest;')" onclick="Set('&iquest;')">&iquest;</td>
+<td class="character" onmouseover="View(this,'&amp;times;')" onclick="Set('&times;')">&times;</td>
+<td class="character" onmouseover="View(this,'&amp;Oslash;')" onclick="Set('&Oslash;')">&Oslash;</td>
+<td class="character" onmouseover="View(this,'&amp;divide;')" onclick="Set('&divide;')">&divide;</td>
+<td class="character" onmouseover="View(this,'&amp;oslash;')" onclick="Set('&oslash;')">&oslash;</td>
+<td class="character" onmouseover="View(this,'&amp;fnof;')" onclick="Set('&fnof;')">&fnof;</td>
+<td class="character" onmouseover="View(this,'&amp;circ;')" onclick="Set('&circ;')">&circ;</td>
+<td class="character" onmouseover="View(this,'&amp;tilde;')" onclick="Set('&tilde;')">&tilde;</td>
+<td class="character" onmouseover="View(this,'&amp;ndash;')" onclick="Set('&ndash;')">&ndash;</td>
+<td class="character" onmouseover="View(this,'&amp;mdash;')" onclick="Set('&mdash;')">&mdash;</td>
+<td class="character" onmouseover="View(this,'&amp;lsquo;')" onclick="Set('&lsquo;')">&lsquo;</td>
+<td class="character" onmouseover="View(this,'&amp;rsquo;')" onclick="Set('&rsquo;')">&rsquo;</td>
+<td class="character" onmouseover="View(this,'&amp;sbquo;')" onclick="Set('&sbquo;')">&sbquo;</td>
+<td class="character" onmouseover="View(this,'&amp;ldquo;')" onclick="Set('&ldquo;')">&ldquo;</td>
+<td class="character" onmouseover="View(this,'&amp;rdquo;')" onclick="Set('&rdquo;')">&rdquo;</td>
+<td class="character" onmouseover="View(this,'&amp;bdquo;')" onclick="Set('&bdquo;')">&bdquo;</td>
+</tr><tr>
+<td class="character" onmouseover="View(this,'&amp;dagger;')" onclick="Set('&dagger;')">&dagger;</td>
+<td class="character" onmouseover="View(this,'&amp;Dagger;')" onclick="Set('&Dagger;')">&Dagger;</td>
+<td class="character" onmouseover="View(this,'&amp;bull;')" onclick="Set('&bull;')">&bull;</td>
+<td class="character" onmouseover="View(this,'&amp;hellip;')" onclick="Set('&hellip;')">&hellip;</td>
+<td class="character" onmouseover="View(this,'&amp;permil;')" onclick="Set('&permil;')">&permil;</td>
+<td class="character" onmouseover="View(this,'&amp;lsaquo;')" onclick="Set('&lsaquo;')">&lsaquo;</td>
+<td class="character" onmouseover="View(this,'&amp;rsaquo;')" onclick="Set('&rsaquo;')">&rsaquo;</td>
+<td class="character" onmouseover="View(this,'&amp;euro;')" onclick="Set('&euro;')">&euro;</td>
+<td class="character" onmouseover="View(this,'&amp;trade;')" onclick="Set('&trade;')">&trade;</td>
+<td class="character" onmouseover="View(this,'&amp;Agrave;')" onclick="Set('&Agrave;')">&Agrave;</td>
+<td class="character" onmouseover="View(this,'&amp;Aacute;')" onclick="Set('&Aacute;')">&Aacute;</td>
+<td class="character" onmouseover="View(this,'&amp;Acirc;')" onclick="Set('&Acirc;')">&Acirc;</td>
+<td class="character" onmouseover="View(this,'&amp;Atilde;')" onclick="Set('&Atilde;')">&Atilde;</td>
+<td class="character" onmouseover="View(this,'&amp;Auml;')" onclick="Set('&Auml;')">&Auml;</td>
+<td class="character" onmouseover="View(this,'&amp;Aring;')" onclick="Set('&Aring;')">&Aring;</td>
+<td class="character" onmouseover="View(this,'&amp;AElig;')" onclick="Set('&AElig;')">&AElig;</td>
+</tr><tr>
+<td class="character" onmouseover="View(this,'&amp;Ccedil;')" onclick="Set('&Ccedil;')">&Ccedil;</td>
+<td class="character" onmouseover="View(this,'&amp;Egrave;')" onclick="Set('&Egrave;')">&Egrave;</td>
+<td class="character" onmouseover="View(this,'&amp;Eacute;')" onclick="Set('&Eacute;')">&Eacute;</td>
+<td class="character" onmouseover="View(this,'&amp;Ecirc;')" onclick="Set('&Ecirc;')">&Ecirc;</td>
+<td class="character" onmouseover="View(this,'&amp;Euml;')" onclick="Set('&Euml;')">&Euml;</td>
+<td class="character" onmouseover="View(this,'&amp;Igrave;')" onclick="Set('&Igrave;')">&Igrave;</td>
+<td class="character" onmouseover="View(this,'&amp;Iacute;')" onclick="Set('&Iacute;')">&Iacute;</td>
+<td class="character" onmouseover="View(this,'&amp;Icirc;')" onclick="Set('&Icirc;')">&Icirc;</td>
+<td class="character" onmouseover="View(this,'&amp;Iuml;')" onclick="Set('&Iuml;')">&Iuml;</td>
+<td class="character" onmouseover="View(this,'&amp;ETH;')" onclick="Set('&ETH;')">&ETH;</td>
+<td class="character" onmouseover="View(this,'&amp;Ntilde;')" onclick="Set('&Ntilde;')">&Ntilde;</td>
+<td class="character" onmouseover="View(this,'&amp;Ograve;')" onclick="Set('&Ograve;')">&Ograve;</td>
+<td class="character" onmouseover="View(this,'&amp;Oacute;')" onclick="Set('&Oacute;')">&Oacute;</td>
+<td class="character" onmouseover="View(this,'&amp;Ocirc;')" onclick="Set('&Ocirc;')">&Ocirc;</td>
+<td class="character" onmouseover="View(this,'&amp;Otilde;')" onclick="Set('&Otilde;')">&Otilde;</td>
+<td class="character" onmouseover="View(this,'&amp;Ouml;')" onclick="Set('&Ouml;')">&Ouml;</td>
+</tr><tr>
+<td class="character" onmouseover="View(this,'&amp;reg;')" onclick="Set('&reg;')">&reg;</td>
+<td class="character" onmouseover="View(this,'&amp;times;')" onclick="Set('&times;')">&times;</td>
+<td class="character" onmouseover="View(this,'&amp;Ugrave;')" onclick="Set('&Ugrave;')">&Ugrave;</td>
+<td class="character" onmouseover="View(this,'&amp;Uacute;')" onclick="Set('&Uacute;')">&Uacute;</td>
+<td class="character" onmouseover="View(this,'&amp;Ucirc;')" onclick="Set('&Ucirc;')">&Ucirc;</td>
+<td class="character" onmouseover="View(this,'&amp;Uuml;')" onclick="Set('&Uuml;')">&Uuml;</td>
+<td class="character" onmouseover="View(this,'&amp;Yacute;')" onclick="Set('&Yacute;')">&Yacute;</td>
+<td class="character" onmouseover="View(this,'&amp;THORN;')" onclick="Set('&THORN;')">&THORN;</td>
+<td class="character" onmouseover="View(this,'&amp;szlig;')" onclick="Set('&szlig;')">&szlig;</td>
+<td class="character" onmouseover="View(this,'&amp;agrave;')" onclick="Set('&agrave;')">&agrave;</td>
+<td class="character" onmouseover="View(this,'&amp;aacute;')" onclick="Set('&aacute;')">&aacute;</td>
+<td class="character" onmouseover="View(this,'&amp;acirc;')" onclick="Set('&acirc;')">&acirc;</td>
+<td class="character" onmouseover="View(this,'&amp;atilde;')" onclick="Set('&atilde;')">&atilde;</td>
+<td class="character" onmouseover="View(this,'&amp;auml;')" onclick="Set('&auml;')">&auml;</td>
+<td class="character" onmouseover="View(this,'&amp;aring;')" onclick="Set('&aring;')">&aring;</td>
+<td class="character" onmouseover="View(this,'&amp;aelig;')" onclick="Set('&aelig;')">&aelig;</td>
+</tr><tr>
+<td class="character" onmouseover="View(this,'&amp;ccedil;')" onclick="Set('&ccedil;')">&ccedil;</td>
+<td class="character" onmouseover="View(this,'&amp;egrave;')" onclick="Set('&egrave;')">&egrave;</td>
+<td class="character" onmouseover="View(this,'&amp;eacute;')" onclick="Set('&eacute;')">&eacute;</td>
+<td class="character" onmouseover="View(this,'&amp;ecirc;')" onclick="Set('&ecirc;')">&ecirc;</td>
+<td class="character" onmouseover="View(this,'&amp;euml;')" onclick="Set('&euml;')">&euml;</td>
+<td class="character" onmouseover="View(this,'&amp;igrave;')" onclick="Set('&igrave;')">&igrave;</td>
+<td class="character" onmouseover="View(this,'&amp;iacute;')" onclick="Set('&iacute;')">&iacute;</td>
+<td class="character" onmouseover="View(this,'&amp;icirc;')" onclick="Set('&icirc;')">&icirc;</td>
+<td class="character" onmouseover="View(this,'&amp;iuml;')" onclick="Set('&iuml;')">&iuml;</td>
+<td class="character" onmouseover="View(this,'&amp;eth;')" onclick="Set('&eth;')">&eth;</td>
+<td class="character" onmouseover="View(this,'&amp;ntilde;')" onclick="Set('&ntilde;')">&ntilde;</td>
+<td class="character" onmouseover="View(this,'&amp;ograve;')" onclick="Set('&ograve;')">&ograve;</td>
+<td class="character" onmouseover="View(this,'&amp;oacute;')" onclick="Set('&oacute;')">&oacute;</td>
+<td class="character" onmouseover="View(this,'&amp;ocirc;')" onclick="Set('&ocirc;')">&ocirc;</td>
+<td class="character" onmouseover="View(this,'&amp;otilde;')" onclick="Set('&otilde;')">&otilde;</td>
+<td class="character" onmouseover="View(this,'&amp;ouml;')" onclick="Set('&ouml;')">&ouml;</td>
+</tr><tr>
+<td class="character" onmouseover="View(this,'&amp;divide;')" onclick="Set('&divide;')">&divide;</td>
+<td class="character" onmouseover="View(this,'&amp;oslash;')" onclick="Set('&oslash;')">&oslash;</td>
+<td class="character" onmouseover="View(this,'&amp;ugrave;')" onclick="Set('&ugrave;')">&ugrave;</td>
+<td class="character" onmouseover="View(this,'&amp;uacute;')" onclick="Set('&uacute;')">&uacute;</td>
+<td class="character" onmouseover="View(this,'&amp;ucirc;')" onclick="Set('&ucirc;')">&ucirc;</td>
+<td class="character" onmouseover="View(this,'&amp;uuml;')" onclick="Set('&uuml;')">&uuml;</td>
+<td class="character" onmouseover="View(this,'&amp;yacute;')" onclick="Set('&yacute;')">&yacute;</td>
+<td class="character" onmouseover="View(this,'&amp;thorn;')" onclick="Set('&thorn;')">&thorn;</td>
+<td class="character" onmouseover="View(this,'&amp;yuml;')" onclick="Set('&yuml;')">&yuml;</td>
+<td class="character" onmouseover="View(this,'&amp;OElig;')" onclick="Set('&OElig;')">&OElig;</td>
+<td class="character" onmouseover="View(this,'&amp;oelig;')" onclick="Set('&oelig;')">&oelig;</td>
+<td class="character" onmouseover="View(this,'&amp;Scaron;')" onclick="Set('&Scaron;')">&Scaron;</td>
+<td class="character" colspan="4">&nbsp;</td>
+</tr>
+</table><br>
+<form action="#"><button type="button" id="cancel" name="cancel" onclick="return onCancel();">Cancel</button></form>
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ClientsideSpellcheck/clientside-spellcheck.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ClientsideSpellcheck/clientside-spellcheck.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,36 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/ClientsideSpellcheck/clientside-spellcheck.js */
+function ClientsideSpellcheck(_1){
+this.editor=_1;
+var _2=_1.config;
+var bl=ClientsideSpellcheck.btnList;
+var _4=this;
+var id="clientsidespellcheck";
+_2.registerButton(id,this._lc("Spell Check using ieSpell"),_1.imgURL("clientside-spellcheck.gif","ClientsideSpellcheck"),false,function(_6,id){
+_4.buttonPress(_6,id);
+});
+if(Xinha.is_ie){
+_2.addToolbarElement("clientsidespellcheck","print",1);
+}
+}
+ClientsideSpellcheck._pluginInfo={name:"ClientsideSpellcheck",version:"1.0",developer:"Michael Harris",developer_url:"http://www.jonesinternational.edu",c_owner:"Red Egg Software",sponsor:"Jones International University",sponsor_url:"http://www.jonesinternational.edu",license:"htmlArea"};
+ClientsideSpellcheck.prototype._lc=function(_8){
+return Xinha._lc(_8,"ClientsideSpellcheck");
+};
+ClientsideSpellcheck.prototype.buttonPress=function(_9){
+try{
+var _a=new ActiveXObject("ieSpell.ieSpellExtension");
+_a.CheckAllLinkedDocuments(document);
+}
+catch(exception){
+if(exception.number==-2146827859){
+if(confirm(this.lc("ieSpell not detected.  Click Ok to go to download page."))){
+window.open("http://www.iespell.com/download.php","DownLoad");
+}
+}else{
+alert(this.lc("ieSpell can only be used in Internet Explorer"));
+}
+}
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ClientsideSpellcheck/img/clientside-spellcheck.gif
Binary file Xinha_0.95/plugins/ClientsideSpellcheck/img/clientside-spellcheck.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ClientsideSpellcheck/img/he-spell-check.gif
Binary file Xinha_0.95/plugins/ClientsideSpellcheck/img/he-spell-check.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ClientsideSpellcheck/lang/de.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ClientsideSpellcheck/lang/de.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,8 @@
+// I18N constants
+// LANG: "de", ENCODING: UTF-8
+// translated: Udo Schmal (gocher), http://www.schaffrath-neuemedien.de/, udo.schmal@t-online.de
+{
+  "Spell Check using ieSpell": "Englische Rechtschreibkontrolle mit ieSpell",
+  "ieSpell can only be used in Internet Explorer": "ieSpell kann nur mit dem Internet Explorer benutzt werden",
+  "ieSpell not detected.  Click Ok to go to download page.": "ieSpell wurde nicht gefunden. Drcken sie Ok um ieSpeck herunter zu laden."
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ClientsideSpellcheck/lang/ja.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ClientsideSpellcheck/lang/ja.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,7 @@
+// I18N constants
+// LANG: "ja", ENCODING: UTF-8
+{
+  "Spell Check using ieSpell": " ieSpell ",
+  "ieSpell can only be used in Internet Explorer": "ieSpell  Internet Explorer ",
+  "ieSpell not detected.  Click Ok to go to download page.": "ieSpell OK "
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ClientsideSpellcheck/lang/nb.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ClientsideSpellcheck/lang/nb.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,3 @@
+// Dummy file
+
+{};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ClientsideSpellcheck/lang/nl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ClientsideSpellcheck/lang/nl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,8 @@
+// I18N constants
+// LANG: "nl", ENCODING: UTF-8
+// Author: Maarten Molenschot, maarten@nrgmm.nl
+{
+  "Spell Check using ieSpell": "Engelse spellingscontrole met ieSpell",
+  "ieSpell can only be used in Internet Explorer": "ieSpell kan alleen worden gebruikt in Internet Explorer",
+  "ieSpell not detected.  Click Ok to go to download page.": "ieSpell werd niet gevonden. Klik op Ok om ieSpell te downloaden"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ClientsideSpellcheck/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ClientsideSpellcheck/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,18 @@
+// I18N constants
+
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+
+// Last revision: 05 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "Spell Check using ieSpell": "Verificao Ortogrfica utilizando ieSpell"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ContextMenu/context-menu.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ContextMenu/context-menu.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,390 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/ContextMenu/context-menu.js */
+Xinha.loadStyle("menu.css","ContextMenu");
+function ContextMenu(_1){
+this.editor=_1;
+}
+ContextMenu._pluginInfo={name:"ContextMenu",version:"1.0",developer:"Mihai Bazon",developer_url:"http://dynarch.com/mishoo/",c_owner:"dynarch.com",sponsor:"American Bible Society",sponsor_url:"http://www.americanbible.org",license:"htmlArea"};
+Xinha.Config.prototype.ContextMenu={disableMozillaSpellCheck:false};
+ContextMenu.prototype.onGenerate=function(){
+var _2=this;
+var _3=this.editordoc=this.editor._iframe.contentWindow.document;
+Xinha._addEvents(_3,["contextmenu"],function(_4){
+return _2.popupMenu(Xinha.is_ie?_2.editor._iframe.contentWindow.event:_4);
+});
+this.currentMenu=null;
+if(this.editor.config.ContextMenu.disableMozillaSpellCheck){
+this.editordoc.body.spellcheck=false;
+}
+};
+ContextMenu.prototype.getContextMenu=function(_5){
+var _6=this;
+var _7=this.editor;
+var _8=_7.config;
+var _9=[];
+var _a=this.editor.plugins.TableOperations;
+if(_a){
+_a=_a.instance;
+}
+var _b=_7.hasSelectedText();
+if(!Xinha.is_gecko){
+if(_b){
+_9.push([Xinha._lc("Cut","ContextMenu"),function(){
+_7.execCommand("cut");
+},null,_8.btnList["cut"][1]],[Xinha._lc("Copy","ContextMenu"),function(){
+_7.execCommand("copy");
+},null,_8.btnList["copy"][1]]);
+_9.push([Xinha._lc("Paste","ContextMenu"),function(){
+_7.execCommand("paste");
+},null,_8.btnList["paste"][1]]);
+}
+}
+var _c=_5;
+var _d=[];
+var _e=null;
+var _f=null;
+var tr=null;
+var td=null;
+var img=null;
+function tableOperation(_13){
+_a.buttonPress(_7,_13);
+}
+function insertPara(_14){
+var el=_c;
+var par=el.parentNode;
+var p=_7._doc.createElement("p");
+p.appendChild(_7._doc.createElement("br"));
+par.insertBefore(p,_14?el.nextSibling:el);
+var sel=_7._getSelection();
+var _19=_7._createRange(sel);
+if(!Xinha.is_ie){
+sel.removeAllRanges();
+_19.selectNodeContents(p);
+_19.collapse(true);
+sel.addRange(_19);
+}else{
+_19.moveToElementText(p);
+_19.collapse(true);
+_19.select();
+}
+}
+for(;_5;_5=_5.parentNode){
+var tag=_5.tagName;
+if(!tag){
+continue;
+}
+tag=tag.toLowerCase();
+switch(tag){
+case "img":
+img=_5;
+_d.push(null,[Xinha._lc("_Image Properties...","ContextMenu"),function(){
+_7._insertImage(img);
+},Xinha._lc("Show the image properties dialog","ContextMenu"),_8.btnList["insertimage"][1]]);
+break;
+case "a":
+_e=_5;
+_d.push(null,[Xinha._lc("_Modify Link...","ContextMenu"),function(){
+_7.config.btnList["createlink"][3](_7);
+},Xinha._lc("Current URL is","ContextMenu")+": "+_e.href,_8.btnList["createlink"][1]],[Xinha._lc("Chec_k Link...","ContextMenu"),function(){
+window.open(_e.href);
+},Xinha._lc("Opens this link in a new window","ContextMenu")],[Xinha._lc("_Remove Link...","ContextMenu"),function(){
+if(confirm(Xinha._lc("Please confirm that you want to unlink this element.","ContextMenu")+"\n"+Xinha._lc("Link points to:","ContextMenu")+" "+_e.href)){
+while(_e.firstChild){
+_e.parentNode.insertBefore(_e.firstChild,_e);
+}
+_e.parentNode.removeChild(_e);
+}
+},Xinha._lc("Unlink the current element","ContextMenu")]);
+break;
+case "td":
+td=_5;
+if(!_a){
+break;
+}
+_d.push(null,[Xinha._lc("C_ell Properties...","ContextMenu"),function(){
+tableOperation("TO-cell-prop");
+},Xinha._lc("Show the Table Cell Properties dialog","ContextMenu"),_8.btnList["TO-cell-prop"][1]],[Xinha._lc("Insert Cell After","ContextMenu"),function(){
+tableOperation("TO-cell-insert-after");
+},Xinha._lc("Insert Cell After","ContextMenu"),_8.btnList["TO-cell-insert-after"][1]],[Xinha._lc("Insert Cell Before","ContextMenu"),function(){
+tableOperation("TO-cell-insert-before");
+},Xinha._lc("Insert Cell After","ContextMenu"),_8.btnList["TO-cell-insert-before"][1]],[Xinha._lc("Delete Cell","ContextMenu"),function(){
+tableOperation("TO-cell-delete");
+},Xinha._lc("Delete Cell","ContextMenu"),_8.btnList["TO-cell-delete"][1]],[Xinha._lc("Merge Cells","ContextMenu"),function(){
+tableOperation("TO-cell-merge");
+},Xinha._lc("Merge Cells","ContextMenu"),_8.btnList["TO-cell-merge"][1]]);
+break;
+case "tr":
+tr=_5;
+if(!_a){
+break;
+}
+_d.push(null,[Xinha._lc("Ro_w Properties...","ContextMenu"),function(){
+tableOperation("TO-row-prop");
+},Xinha._lc("Show the Table Row Properties dialog","ContextMenu"),_8.btnList["TO-row-prop"][1]],[Xinha._lc("I_nsert Row Before","ContextMenu"),function(){
+tableOperation("TO-row-insert-above");
+},Xinha._lc("Insert a new row before the current one","ContextMenu"),_8.btnList["TO-row-insert-above"][1]],[Xinha._lc("In_sert Row After","ContextMenu"),function(){
+tableOperation("TO-row-insert-under");
+},Xinha._lc("Insert a new row after the current one","ContextMenu"),_8.btnList["TO-row-insert-under"][1]],[Xinha._lc("_Delete Row","ContextMenu"),function(){
+tableOperation("TO-row-delete");
+},Xinha._lc("Delete the current row","ContextMenu"),_8.btnList["TO-row-delete"][1]]);
+break;
+case "table":
+_f=_5;
+if(!_a){
+break;
+}
+_d.push(null,[Xinha._lc("_Table Properties...","ContextMenu"),function(){
+tableOperation("TO-table-prop");
+},Xinha._lc("Show the Table Properties dialog","ContextMenu"),_8.btnList["TO-table-prop"][1]],[Xinha._lc("Insert _Column Before","ContextMenu"),function(){
+tableOperation("TO-col-insert-before");
+},Xinha._lc("Insert a new column before the current one","ContextMenu"),_8.btnList["TO-col-insert-before"][1]],[Xinha._lc("Insert C_olumn After","ContextMenu"),function(){
+tableOperation("TO-col-insert-after");
+},Xinha._lc("Insert a new column after the current one","ContextMenu"),_8.btnList["TO-col-insert-after"][1]],[Xinha._lc("De_lete Column","ContextMenu"),function(){
+tableOperation("TO-col-delete");
+},Xinha._lc("Delete the current column","ContextMenu"),_8.btnList["TO-col-delete"][1]]);
+break;
+case "body":
+_d.push(null,[Xinha._lc("Justify Left","ContextMenu"),function(){
+_7.execCommand("justifyleft");
+},null,_8.btnList["justifyleft"][1]],[Xinha._lc("Justify Center","ContextMenu"),function(){
+_7.execCommand("justifycenter");
+},null,_8.btnList["justifycenter"][1]],[Xinha._lc("Justify Right","ContextMenu"),function(){
+_7.execCommand("justifyright");
+},null,_8.btnList["justifyright"][1]],[Xinha._lc("Justify Full","ContextMenu"),function(){
+_7.execCommand("justifyfull");
+},null,_8.btnList["justifyfull"][1]]);
+break;
+}
+}
+if(_b&&!_e){
+_9.push(null,[Xinha._lc("Make lin_k...","ContextMenu"),function(){
+_7.config.btnList["createlink"][3](_7);
+},Xinha._lc("Create a link","ContextMenu"),_8.btnList["createlink"][1]]);
+}
+for(var i=0;i<_d.length;++i){
+_9.push(_d[i]);
+}
+if(!/html|body/i.test(_c.tagName)){
+_9.push(null,[Xinha._lc({string:"Remove the $elem Element...",replace:{elem:"&lt;"+_c.tagName+"&gt;"}},"ContextMenu"),function(){
+if(confirm(Xinha._lc("Please confirm that you want to remove this element:","ContextMenu")+" "+_c.tagName)){
+var el=_c;
+var p=el.parentNode;
+p.removeChild(el);
+if(Xinha.is_gecko){
+if(p.tagName.toLowerCase()=="td"&&!p.hasChildNodes()){
+p.appendChild(_7._doc.createElement("br"));
+}
+_7.forceRedraw();
+_7.focusEditor();
+_7.updateToolbar();
+if(_f){
+var _1e=_f.style.borderCollapse;
+_f.style.borderCollapse="collapse";
+_f.style.borderCollapse="separate";
+_f.style.borderCollapse=_1e;
+}
+}
+}
+},Xinha._lc("Remove this node from the document","ContextMenu")],[Xinha._lc("Insert paragraph before","ContextMenu"),function(){
+insertPara(false);
+},Xinha._lc("Insert a paragraph before the current node","ContextMenu")],[Xinha._lc("Insert paragraph after","ContextMenu"),function(){
+insertPara(true);
+},Xinha._lc("Insert a paragraph after the current node","ContextMenu")]);
+}
+if(!_9[0]){
+_9.shift();
+}
+return _9;
+};
+ContextMenu.prototype.popupMenu=function(ev){
+var _20=this;
+if(this.currentMenu){
+this.closeMenu();
+}
+function getPos(el){
+var r={x:el.offsetLeft,y:el.offsetTop};
+if(el.offsetParent){
+var tmp=getPos(el.offsetParent);
+r.x+=tmp.x;
+r.y+=tmp.y;
+}
+return r;
+}
+function documentClick(ev){
+ev||(ev=window.event);
+if(!_20.currentMenu){
+alert(Xinha._lc("How did you get here? (Please report!)","ContextMenu"));
+return false;
+}
+var el=Xinha.is_ie?ev.srcElement:ev.target;
+for(;el!=null&&el!=_20.currentMenu;el=el.parentNode){
+}
+if(el==null){
+_20.closeMenu();
+}
+}
+var _26=[];
+function keyPress(ev){
+ev||(ev=window.event);
+Xinha._stopEvent(ev);
+if(ev.keyCode==27){
+_20.closeMenu();
+return false;
+}
+var key=String.fromCharCode(Xinha.is_ie?ev.keyCode:ev.charCode).toLowerCase();
+for(var i=_26.length;--i>=0;){
+var k=_26[i];
+if(k[0].toLowerCase()==key){
+k[1].__msh.activate();
+}
+}
+}
+_20.closeMenu=function(){
+_20.currentMenu.parentNode.removeChild(_20.currentMenu);
+_20.currentMenu=null;
+Xinha._removeEvent(document,"mousedown",documentClick);
+Xinha._removeEvent(_20.editordoc,"mousedown",documentClick);
+if(_26.length>0){
+Xinha._removeEvent(_20.editordoc,"keypress",keyPress);
+}
+if(Xinha.is_ie){
+_20.iePopup.hide();
+}
+};
+var _2b=Xinha.is_ie?ev.srcElement:ev.target;
+var _2c=getPos(_20.editor._htmlArea);
+var x=ev.clientX+_2c.x;
+var y=ev.clientY+_2c.y;
+var div;
+var doc;
+if(!Xinha.is_ie){
+doc=document;
+}else{
+var _31=this.iePopup=window.createPopup();
+doc=_31.document;
+doc.open();
+doc.write("<html><head><style type='text/css'>@import url("+Xinha.getPluginDir("ContextMenu")+"/menu.css); html, body { padding: 0px; margin: 0px; overflow: hidden; border: 0px; }</style></head><body unselectable='yes'></body></html>");
+doc.close();
+}
+div=doc.createElement("div");
+if(Xinha.is_ie){
+div.unselectable="on";
+}
+div.oncontextmenu=function(){
+return false;
+};
+div.className="htmlarea-context-menu";
+if(!Xinha.is_ie){
+div.style.left=div.style.top="0px";
+}
+doc.body.appendChild(div);
+var _32=doc.createElement("table");
+div.appendChild(_32);
+_32.cellSpacing=0;
+_32.cellPadding=0;
+var _33=doc.createElement("tbody");
+_32.appendChild(_33);
+var _34=this.getContextMenu(_2b);
+for(var i=0;i<_34.length;++i){
+var _36=_34[i];
+var _37=doc.createElement("tr");
+_33.appendChild(_37);
+if(Xinha.is_ie){
+_37.unselectable="on";
+}else{
+_37.onmousedown=function(ev){
+Xinha._stopEvent(ev);
+return false;
+};
+}
+if(!_36){
+_37.className="separator";
+var td=doc.createElement("td");
+td.className="icon";
+var _3a=">";
+if(Xinha.is_ie){
+td.unselectable="on";
+_3a=" unselectable='on' style='height=1px'>&nbsp;";
+}
+td.innerHTML="<div"+_3a+"</div>";
+var td1=td.cloneNode(true);
+td1.className="label";
+_37.appendChild(td);
+_37.appendChild(td1);
+}else{
+var _3c=_36[0];
+_37.className="item";
+_37.__msh={item:_37,label:_3c,action:_36[1],tooltip:_36[2]||null,icon:_36[3]||null,activate:function(){
+_20.closeMenu();
+_20.editor.focusEditor();
+this.action();
+}};
+_3c=_3c.replace(/_([a-zA-Z0-9])/,"<u>$1</u>");
+if(_3c!=_36[0]){
+_26.push([RegExp.$1,_37]);
+}
+_3c=_3c.replace(/__/,"_");
+var td1=doc.createElement("td");
+if(Xinha.is_ie){
+td1.unselectable="on";
+}
+_37.appendChild(td1);
+td1.className="icon";
+if(_37.__msh.icon){
+var t=Xinha.makeBtnImg(_37.__msh.icon,doc);
+td1.appendChild(t);
+}
+var td2=doc.createElement("td");
+if(Xinha.is_ie){
+td2.unselectable="on";
+}
+_37.appendChild(td2);
+td2.className="label";
+td2.innerHTML=_3c;
+_37.onmouseover=function(){
+this.className+=" hover";
+_20.editor._statusBarTree.innerHTML=this.__msh.tooltip||"&nbsp;";
+};
+_37.onmouseout=function(){
+this.className="item";
+};
+_37.oncontextmenu=function(ev){
+this.__msh.activate();
+if(!Xinha.is_ie){
+Xinha._stopEvent(ev);
+}
+return false;
+};
+_37.onmouseup=function(ev){
+var _41=(new Date()).getTime();
+if(_41-_20.timeStamp>500){
+this.__msh.activate();
+}
+if(!Xinha.is_ie){
+Xinha._stopEvent(ev);
+}
+return false;
+};
+}
+}
+if(!Xinha.is_ie){
+div.style.left=x+"px";
+div.style.top=y+"px";
+}else{
+this.iePopup.show(ev.screenX,ev.screenY,300,50);
+var w=div.offsetWidth;
+var h=div.offsetHeight;
+this.iePopup.show(ev.screenX,ev.screenY,w,h);
+}
+this.currentMenu=div;
+this.timeStamp=(new Date()).getTime();
+Xinha._addEvent(document,"mousedown",documentClick);
+Xinha._addEvent(this.editordoc,"mousedown",documentClick);
+if(_26.length>0){
+Xinha._addEvent(this.editordoc,"keypress",keyPress);
+}
+Xinha._stopEvent(ev);
+return false;
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ContextMenu/lang/de.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ContextMenu/lang/de.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,50 @@
+// I18N constants
+// LANG: "de", ENCODING: UTF-8
+// translated: Raimund Meyer xinha@ray-of-light.org
+{
+  "Cut": "Ausschneiden",
+  "Copy": "Kopieren",
+  "Paste": "Einfgen",
+  "_Image Properties...": "Eigenschaften",
+  "Show the image properties dialog": "Fenster fr die Bildoptionen anzeigen",
+  "_Modify Link...": "Link ndern",
+  "Current URL is": "Aktuelle URL ist",
+  "Chec_k Link...": "Link testen",
+  "Opens this link in a new window": "Diesen Link in neuem Fenster ffnen",
+  "_Remove Link...": "Link entfernen",
+  "Please confirm that you want to unlink this element.": "Wollen sie diesen Link wirklich entfernen?",
+  "Link points to:": "Link zeigt auf:",
+  "Unlink the current element": "Link auf Element entfernen",
+  "C_ell Properties...": "Zellenoptionen",
+  "Show the Table Cell Properties dialog": "Zellenoptionen anzeigen",
+  "Ro_w Properties...": "Zeilenoptionen",
+  "Show the Table Row Properties dialog": "Zeilenoptionen anzeigen",
+  "I_nsert Row Before": "Zeile einfgen vor Position",
+  "Insert a new row before the current one": "Zeile einfgen vor der aktuellen Position",
+  "In_sert Row After": "Zeile eingen nach Position",
+  "Insert a new row after the current one": "Zeile einfgen nach der aktuellen Position",
+  "_Delete Row": "Zeile lschen",
+  "Delete the current row": "Zeile lschen",
+  "_Table Properties...": "Tabellenoptionen",
+  "Show the Table Properties dialog": "Tabellenoptionen anzeigen",
+  "Insert _Column Before": "Spalte einfgen vor Position",
+  "Insert a new column before the current one": "Spalte einfgen vor der aktuellen Position",
+  "Insert C_olumn After": "Spalte einfgen nach Position",
+  "Insert a new column after the current one": "Spalte einfgen nach der aktuellen Position",
+  "De_lete Column": "Spalte lschen",
+  "Delete the current column": "Spalte lschen",
+  "Justify Left": "Linksbndig",
+  "Justify Center": "Zentriert",
+  "Justify Right": "Rechtsbndig",
+  "Justify Full": "Blocksatz",
+  "Make lin_k...": "Link erstellen",
+  "Create a link": "Link erstellen",
+  "Remove the $elem Element...": "Element $elem entfernen...",
+  "Please confirm that you want to remove this element:": "Wollen sie dieses Element wirklich entfernen?",
+  "Remove this node from the document": "Dieses Element aus dem Dokument entfernen",
+  "Insert paragraph before": "Absatz einfgen vor Position",
+  "Insert a paragraph before the current node": "Absatz einfgen vor der aktuellen Position",
+  "Insert paragraph after": "Absatz einfgen hinter Position",
+  "Insert a paragraph after the current node": "Absatz einfgen hinter der aktuellen Position",
+  "How did you get here? (Please report!)": "Wie sind Sie denn hier hin gekommen? (Please report!)"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ContextMenu/lang/el.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ContextMenu/lang/el.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,47 @@
+// I18N constants
+// LANG: "el", ENCODING: UTF-8
+// Author: Dimitris Glezos, dimitris@glezos.com
+{
+  "Cut": "",
+  "Copy": "",
+  "Paste": "",
+  "_Image Properties...": " ...",
+  "_Modify Link...": " ...",
+  "Chec_k Link...": " ...",
+  "_Remove Link...": " ...",
+  "C_ell Properties...": " ...",
+  "Ro_w Properties...": " ...",
+  "I_nsert Row Before": "  ",
+  "In_sert Row After": "  ",
+  "_Delete Row": " ",
+  "_Table Properties...": " ...",
+  "Insert _Column Before": "  ",
+  "Insert C_olumn After": "  ",
+  "De_lete Column": " ",
+  "Justify Left": " ",
+  "Justify Center": " ",
+  "Justify Right": " ",
+  "Justify Full": " ",
+  "Make lin_k...": " ...",
+  "Remove the $elem Element...": " $elem ...",
+  "Please confirm that you want to remove this element:": "        ",
+  "Remove this node from the document": "      ",
+  "How did you get here? (Please report!)": "   ; (  !)",
+  "Show the image properties dialog": "     ",
+  "Modify URL": " URL",
+  "Current URL is": "  URL ",
+  "Opens this link in a new window": "       ",
+  "Please confirm that you want to unlink this element.": "           :",
+  "Link points to:": "   :",
+  "Unlink the current element": "     ",
+  "Show the Table Cell Properties dialog": "      ",
+  "Show the Table Row Properties dialog": "      ",
+  "Insert a new row before the current one": "      ",
+  "Insert a new row after the current one": "      ",
+  "Delete the current row": "  ",
+  "Show the Table Properties dialog": "     ",
+  "Insert a new column before the current one": "     ",
+  "Insert a new column after the current one": "     ",
+  "Delete the current column": "  ",
+  "Create a link": " "
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ContextMenu/lang/fr.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ContextMenu/lang/fr.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,50 @@
+// I18N constants
+// LANG: "fr", ENCODING: UTF-8
+{
+  "Cut": "Couper",
+  "Copy": "Copier",
+  "Paste": "Coller",
+  "_Image Properties...": "_Proprits de l'image...",
+  "_Modify Link...": "_Modifier le lien...",
+  "Chec_k Link...": "_Vrifier le lien...",
+  "_Remove Link...": "_Supprimer le lien...",
+  "C_ell Properties...": "P_roprits de la cellule...",
+  "Ro_w Properties...": "Pr_oprits de la range...",
+  "I_nsert Row Before": "Insrer une range a_vant",
+  "In_sert Row After": "Insr_er une range aprs",
+  "_Delete Row": "Suppr_imer une range",
+  "_Table Properties...": "Propri_ts de la table...",
+  "Insert _Column Before": "I_nsrer une colonne avant",
+  "Insert C_olumn After": "Insrer une colonne aprs",
+  "De_lete Column": "_Supprimer la colonne",
+  "Justify Left": "Aligner  gauche",
+  "Justify Center": "Aligner au centre",
+  "Justify Right": "Aligner  droite",
+  "Justify Full": "Justifier",
+  "Make lin_k...": "Convertir en lien...",
+  "Remove the $elem Element...": "Supprimer lment $elem...",
+  "Insert paragraph before": "Insrer un paragraphe avant",
+  "Insert paragraph after": "Insrer un paragraphe aprs",
+  "Please confirm that you want to remove this element:": "Confirmer la suppression de cet lment:",
+  "Remove this node from the document": "Supprimer ce noeud du document",
+  "How did you get here? (Please report!)": "Comment tes-vous arriv ici ? (Reportez le bug SVP !)",
+  "Show the image properties dialog": "Afficher le dialogue des proprits d'image",
+  "Modify URL": "Modifier l'URL",
+  "Current URL is": "L'URL courante est",
+  "Opens this link in a new window": "Ouvrir ce lien dans une nouvelle fentre",
+  "Please confirm that you want to unlink this element.": "Voulez-vous vraiment enlever le lien prsent sur cet lment.",
+  "Link points to:": "Le lien pointe sur:",
+  "Unlink the current element": "Enlever le lien sur cet lment",
+  "Show the Table Cell Properties dialog": "Afficher la boite de proprit des cellules",
+  "Show the Table Row Properties dialog": "Afficher la boite de proprit des ranges",
+  "Insert a new row before the current one": "Insrer une nouvelle range avant celle-ci",
+  "Insert a new row after the current one": "Insrer une nouvelle range aprs celle-ci",
+  "Delete the current row": "Supprimer la range courante",
+  "Show the Table Properties dialog": "Afficher la boite de proprit de tableau",
+  "Insert a new column before the current one": "Insrer une nouvelle range avant celle-ci",
+  "Insert a new column after the current one": "Insrer une nouvelle colonne aprs celle-ci",
+  "Delete the current column": "Supprimer cette colonne",
+  "Create a link": "Crer un lien",
+  "Insert a paragraph before the current node": "Insrer un paragraphe avant le noeud courant",
+  "Insert a paragraph after the current node": "Insrer un paragraphe aprs le noeud courant"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ContextMenu/lang/he.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ContextMenu/lang/he.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,47 @@
+// I18N constants
+// LANG: "he", ENCODING: UTF-8
+// Author: Liron Newman, http://www.eesh.net, <plastish at ultinet dot org>
+{
+  "Cut": "",
+  "Copy": "",
+  "Paste": "",
+  "_Image Properties...": "_ ...",
+  "_Modify Link...": "_ ...",
+  "Chec_k Link...": "_ ...",
+  "_Remove Link...": "_ ...",
+  "C_ell Properties...": " _...",
+  "Ro_w Properties...": " _...",
+  "I_nsert Row Before": "_  ",
+  "In_sert Row After": "_  ",
+  "_Delete Row": "_ ",
+  "_Table Properties...": " _...",
+  "Insert _Column Before": " _ ",
+  "Insert C_olumn After": " _ ",
+  "De_lete Column": "_ ",
+  "Justify Left": " ",
+  "Justify Center": " ",
+  "Justify Right": " ",
+  "Justify Full": "  ",
+  "Make lin_k...": " _...",
+  "Remove the $elem Element...": "   - $elem...",
+  "Please confirm that you want to remove this element:": "      :",
+  "Remove this node from the document": "  node  ",
+  "How did you get here? (Please report!)": "  ? ( !)",
+  "Show the image properties dialog": "   -   ",
+  "Modify URL": " URL",
+  "Current URL is": "URL  ",
+  "Opens this link in a new window": "    ",
+  "Please confirm that you want to unlink this element.": "       .",
+  "Link points to:": "  :",
+  "Unlink the current element": "   ",
+  "Show the Table Cell Properties dialog": "   -    ",
+  "Show the Table Row Properties dialog": "   -    ",
+  "Insert a new row before the current one": "    ",
+  "Insert a new row after the current one": "    ",
+  "Delete the current row": "   ",
+  "Show the Table Properties dialog": "   -   ",
+  "Insert a new column before the current one": "    ",
+  "Insert a new column after the current one": "    ",
+  "Delete the current column": "   ",
+  "Create a link": " "
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ContextMenu/lang/ja.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ContextMenu/lang/ja.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,53 @@
+// I18N constants
+// LANG: "ja", ENCODING: UTF-8
+{
+  "Cut": "",
+  "Copy": "",
+  "Paste": "",
+  "_Image Properties...": "(_I)...",
+  "Show the image properties dialog": "",
+  "_Modify Link...": "(_M)...",
+  "Current URL is": "URL",
+  "Chec_k Link...": "(_K)...",
+  "Opens this link in a new window": "",
+  "_Remove Link...": "(_R)",
+  "Please confirm that you want to unlink this element.": "",
+  "Link points to:": ":",
+  "Unlink the current element": "",
+  "C_ell Properties...": "(_E)...",
+  "Ro_w Properties...": "(_W)...",
+  "Show the Table Row Properties dialog": "",
+  "I_nsert Row Before": "(_N)",
+  "Insert a new row before the current one": "",
+  "In_sert Row After": "(_S)",
+  "Insert a new row after the current one": "",
+  "_Delete Row": "(_D)",
+  "Delete the current row": "",
+  "_Table Properties...": "(_T)...",
+  "Show the Table Properties dialog": "",
+  "Insert _Column Before": "(_C)",
+  "Insert a new column before the current one": "",
+  "Insert C_olumn After": "(_O)",
+  "Insert a new column after the current one": "",
+  "De_lete Column": "(_L)",
+  "Delete the current column": "",
+  "Justify Left": "",
+  "Justify Center": "",
+  "Justify Right": "",
+  "Justify Full": "",
+  "Make lin_k...": "(_K)...",
+  "Create a link": "",
+  "Remove the $elem Element...": "$elem  ...",
+  "Please confirm that you want to remove this element:": ":",
+  "Remove this node from the document": "",
+  "Insert paragraph before": "",
+  "Insert a paragraph before the current node": "",
+  "Insert paragraph after": "",
+  "Insert a paragraph after the current node": "",
+  "How did you get here? (Please report!)": "?(!)",
+  "Show the Table Cell Properties dialog": "",
+  "Insert Cell Before": "",
+  "Insert Cell After": "",
+  "Delete Cell": "",
+  "Merge Cells": ""
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ContextMenu/lang/nb.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ContextMenu/lang/nb.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,53 @@
+// I18N constants
+// LANG: "no", ENCODING: UTF-8
+// translated: Kim Steinhaug, http://www.steinhaug.com/, kim@steinhaug.com
+// Used key commands
+// C,D,e, ,I, ,k,k,l,M, ,n,o,R, ,s,T, ,w   : English
+//       H B j      R m    F       v       : Norwegian
+{
+  "Cut": "Klipp ut",
+  "Copy": "Kopier",
+  "Paste": "Lim inn",
+  "_Image Properties...": "_Bildeegenskaper...",
+  "Show the image properties dialog": "Vis bildeegenskaper",
+  "_Modify Link...": "_Rediger Link...",
+  "Current URL is": "Gjeldende URL er",
+  "Chec_k Link...": "Sje_kk Link...",
+  "Opens this link in a new window": "pner denne link i nytt vindu",
+  "_Remove Link...": "_Fjerne Link...",
+  "Please confirm that you want to unlink this element.": "Vennligst bekreft at du nsker  fjerne link p elementet",
+  "Link points to:": "Link peker til:",
+  "Unlink the current element": "Fjerne link p gjeldende element",
+  "C_ell Properties...": "C_elleegenskaper...",
+  "Show the Table Cell Properties dialog": "Vis egenskaper for celle",
+  "Ro_w Properties...": "Rad Egenskaper... (_w)",
+  "Show the Table Row Properties dialog": "Vis egenskaper for rad",
+  "I_nsert Row Before": "Sett I_nn rad fr",
+  "Insert a new row before the current one": "Sett inn ny rad fr gjeldende",
+  "In_sert Row After": "_Sett inn rad etter",
+  "Insert a new row after the current one": "Sett inn ny rad etter gjeldende",
+  "_Delete Row": "Slett rad (_d)",
+  "Delete the current row": "Slett gjeldende rad",
+  "_Table Properties...": "_Tabellegenskaper...",
+  "Show the Table Properties dialog": "Vis egenskaper for tabellen",
+  "Insert _Column Before": "Sett inn kolonne etter (_c)",
+  "Insert a new column before the current one": "Sett inn kolonne fr gjeldende",
+  "Insert C_olumn After": "Sett inn k_olonne etter",
+  "Insert a new column after the current one": "Sett inn kolonne etter gjeldende",
+  "De_lete Column": "S_lett kolonne",
+  "Delete the current column": "Slett gjeldende kolonne",
+  "Justify Left": "_Venstrejuster",
+  "Justify Center": "_Midtjuster",
+  "Justify Right": "_Hyrejuster",
+  "Justify Full": "Blokk_juster",
+  "Make lin_k...": "Lag len_ke...",
+  "Create a link": "Lag ny link",
+  "Remove the $elem Element...": "Fjerne $elem elementet...",
+  "Please confirm that you want to remove this element:": "Vennligst bekreft at du nsker  fjerne elementet:",
+  "Remove this node from the document": "Fjerne denne node fra dokumentet",
+  "Insert paragraph before": "Sett inn paragraf fr",
+  "Insert a paragraph before the current node": "Sett inn paragraf fr gjeldende node",
+  "Insert paragraph after": "Sett inn paragraf etter",
+  "Insert a paragraph after the current node": "Sett inn paragraf etter gjeldende node",
+  "How did you get here? (Please report!)": "Hva skjedde? (Vennligst beskriv)"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ContextMenu/lang/nl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ContextMenu/lang/nl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,47 @@
+// I18N constants
+// LANG: "nl", ENCODING: UTF-8
+// Author: Michel Weegeerink (info@mmc-shop.nl), http://mmc-shop.nl
+{
+  "Cut": "Knippen",
+  "Copy": "Kopiren",
+  "Paste": "Plakken",
+  "_Image Properties...": "Eigenschappen afbeelding...",
+  "_Modify Link...": "Hyperlin_k aanpassen...",
+  "Chec_k Link...": "Controleer hyperlin_k...",
+  "_Remove Link...": "Ve_rwijder hyperlink...",
+  "C_ell Properties...": "C_eleigenschappen...",
+  "Ro_w Properties...": "Rijeigenscha_ppen...",
+  "I_nsert Row Before": "Rij invoegen boven",
+  "In_sert Row After": "Rij invoegen onder",
+  "_Delete Row": "Rij _verwijderen",
+  "_Table Properties...": "_Tabeleigenschappen...",
+  "Insert _Column Before": "Kolom invoegen voor",
+  "Insert C_olumn After": "Kolom invoegen na",
+  "De_lete Column": "Kolom verwijderen",
+  "Justify Left": "Links uitlijnen",
+  "Justify Center": "Centreren",
+  "Justify Right": "Rechts uitlijnen",
+  "Justify Full": "Uitvullen",
+  "Make lin_k...": "Maak hyperlin_k...",
+  "Remove the $elem Element...": "Verwijder het $elem element...",
+  "Please confirm that you want to remove this element:": "Is het werkelijk de bedoeling dit element te verwijderen:",
+  "Remove this node from the document": "Verwijder dit punt van het document",
+  "How did you get here? (Please report!)": "Hoe kwam je hier? (A.U.B. doorgeven!)",
+  "Show the image properties dialog": "Laat het afbeeldingseigenschappen dialog zien",
+  "Modify URL": "Aanpassen URL",
+  "Current URL is": "Huidig URL is",
+  "Opens this link in a new window": "Opend deze hyperlink in een nieuw venster",
+  "Please confirm that you want to unlink this element.": "Is het werkelijk de bedoeling dit element te unlinken.",
+  "Link points to:": "Hyperlink verwijst naar:",
+  "Unlink the current element": "Unlink het huidige element",
+  "Show the Table Cell Properties dialog": "Laat de tabel celeigenschappen dialog zien",
+  "Show the Table Row Properties dialog": "Laat de tabel rijeigenschappen dialog zien",
+  "Insert a new row before the current one": "Voeg een nieuwe rij in boven de huidige",
+  "Insert a new row after the current one": "Voeg een nieuwe rij in onder de huidige",
+  "Delete the current row": "Verwijder de huidige rij",
+  "Show the Table Properties dialog": "Laat de tabel eigenschappen dialog zien",
+  "Insert a new column before the current one": "Voeg een nieuwe kolom in voor de huidige",
+  "Insert a new column after the current one": "Voeg een nieuwe kolom in na de huidige",
+  "Delete the current column": "Verwijder de huidige kolom",
+  "Create a link": "Maak een hyperlink"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ContextMenu/lang/pl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ContextMenu/lang/pl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,50 @@
+// I18N constants
+// LANG: "pl", ENCODING: UTF-8
+// translated: Krzysztof Kotowicz, http://www.eskot.krakow.pl/portfolio/, koto@webworkers.pl
+{
+  "Cut": "Wytnij",
+  "Copy": "Kopiuj",
+  "Paste": "Wklej",
+  "_Image Properties...": "Waciwoci obrazka",
+  "Show the image properties dialog": "Poka okienko waciwoci obrazka",  
+  "_Modify Link...": "Zmie odnonik",
+  "Current URL is": "Biecy URL odnonika",
+  "Chec_k Link...": "Sprawd odnonik",
+  "Opens this link in a new window": "Otwiera ten odnonik w nowym oknie",
+  "_Remove Link...": "Usu odnonik",
+  "Please confirm that you want to unlink this element.": "Na pewno chcesz usun odnonik?",
+  "Link points to:": "Odnonik wskazuje na:",
+  "Unlink the current element": "Usu odnonik z zaznaczonego elementu",
+  "C_ell Properties...": "Waciwoci komrki",
+  "Show the Table Cell Properties dialog": "Poka okno waciwoci komrki",
+  "Ro_w Properties...": "Waciwoci wiersza",
+  "Show the Table Row Properties dialog": "Poka okno waciwoci wiersza",
+  "I_nsert Row Before": "Wstaw wiersz przed",
+  "Insert a new row before the current one": "Wstaw nowy wiersz przed biecym",
+  "In_sert Row After": "Wstaw wiersz po",
+  "Insert a new row after the current one": "Wstaw nowy wiersz po biecym",
+  "_Delete Row": "Usu wiersz",
+  "Delete the current row": "Usu biecy wiersz",
+  "_Table Properties...": "Waciwoci tabeli",
+  "Show the Table Properties dialog": "Poka okienko waciwoci tabeli",
+  "Insert _Column Before": "Wstaw kolumn przed",
+  "Insert a new column before the current one": "Wstaw now kolumn przed biec",
+  "Insert C_olumn After": "Wstaw kolumn po",
+  "Insert a new column after the current one": "Wstaw now kolumn po biecej",
+  "De_lete Column": "Usu kolumn",
+  "Delete the current column": "Usuwa biec kolumn",
+  "Justify Left": "Wyrwnaj do lewej",
+  "Justify Center": "Wycentruj",
+  "Justify Right": "Wyrwnaj do prawej",
+  "Justify Full": "Wyjustuj",
+  "Make lin_k...": "Utwrz odnonik",
+  "Create a link": "Utwrz odnonik",
+  "Remove the $elem Element...": "Usu $elem...",
+  "Please confirm that you want to remove this element:": "Na pewno chcesz usun ten element?",
+  "Remove this node from the document": "Usu ten element z dokumentu",
+  "Insert paragraph before": "Wstaw akapit przed",
+  "Insert a paragraph before the current node": "Wstaw akapit przed biecym elementem",
+  "Insert paragraph after": "Wstaw akapit po",
+  "Insert a paragraph after the current node": "Wstaw akapit po biecym elemencie",
+  "How did you get here? (Please report!)": "Jak tu trafie (Prosz, podaj okolicznoci!)"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ContextMenu/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ContextMenu/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,65 @@
+// I18N constants
+
+// LANG: "pt_br", ENCODING: UTF-8
+// Brazilian Portuguese Translation
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// Site: www.mpg.com.br
+// Please dont remove this information - Por favor, no remova esta informao
+// If you modify this source, please insert a comment with your name and e-mail
+// Se modificar esta fonte, insira um comentrio com seu nome e e-mail
+
+// Last revision: September 2007
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "Cut": "Recortar",
+  "Copy": "Copiar",
+  "Paste": "Colar",
+  "_Image Properties...": "Propriedades da imagem...",
+  "Show the image properties dialog": "Mostrar a caixa de dilogo das Propriedades da imagem",
+  "_Modify Link...": "Modificar link",
+  "Current URL is": "A URL corrente ",
+  "Chec_k Link...": "Verificar Link...",
+  "Opens this link in a new window": "Abrir este link em uma nova janela",
+  "_Remove Link...": "Remover Link",
+  "Please confirm that you want to unlink this element.": "Por favor, confirme que deseja retirar o link do elemento.",
+  "Link points to:": "Link para:",
+  "Unlink the current element": "Remover link do elemento atual",
+  "C_ell Properties...": "Propriedades da clula",
+  "Show the Table Cell Properties dialog": "Mostrar caixa de dilogo de Propriedades da Clula",
+  "Ro_w Properties...": "Propriedades da Linha",
+  "Show the Table Row Properties dialog": "Mostrar caixa de dilogo de Propriedades da Linha",
+  "I_nsert Row Before": "Inserir linha antes deste ponto",
+  "Insert a new row before the current one": "Inserir uma nova linha antes desta",
+  "In_sert Row After": "Inserir linha depois deste ponto",
+  "Insert a new row after the current one": "Inserir uma linha aps esta",
+  "_Delete Row": "Apagar linha",
+  "Delete the current row": "Apagar a linha atual",
+  "_Table Properties...": "Propriedades da Tabela",
+  "Show the Table Properties dialog": "Mostrar caixa de dilogo de Propriedades da Tabela",
+  "Insert _Column Before": "Inserir coluna antes deste ponto",
+  "Insert a new column before the current one": "Inserir uma nova coluna antes desta",
+  "Insert C_olumn After": "Inserir coluna aps este ponto",
+  "Insert a new column after the current one": "Inserir uma nova coluna aps esta",
+  "De_lete Column": "Apagar Coluna",
+  "Delete the current column": "Apagar a coluna atual",
+  "Justify Left": "Justificar  esquerda",
+  "Justify Center": "Justificar centralizado",
+  "Justify Right": "Justificar  direita",
+  "Justify Full": "Justificao completa",
+  "Make lin_k...": "Criar link...",
+  "Create a link": "Criar um novo link",
+  "Remove the $elem Element...": "Remover o elemento $elem...",
+  "Please confirm that you want to remove this element:": "Por favor, confirme que deseja remover este elemento:",
+  "Remove this node from the document": "Remover este n do documento",
+  "Insert paragraph before": "Inserir um pargrafo antes",
+  "Insert a paragraph before the current node": "Inserir um pargrafo antes do n atual",
+  "Insert paragraph after": "Inserir um pargrafo aps",
+  "Insert a paragraph after the current node": "Inserir um pargrafo aps o n atual",
+  "How did you get here? (Please report!)": "Como voc comeou aqui? (Por favor, informe!)",
+  "Show the Table Cell Properties dialog": "Mostrar Propriedades da Tabelas",
+  "Insert Cell Before": "Inserir Clula Antes",
+  "Insert Cell After": "Inserir Clula Depois",
+  "Delete Cell": "Apagar Clula",
+  "Merge Cells": "Mesclar Clulas"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ContextMenu/lang/sv.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ContextMenu/lang/sv.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,54 @@
+// I18N constants
+// LANG: "sv", ENCODING: UTF-8
+// Swedish version for rev. 477 (Mar 2006) by Thomas Loo <tloo@saltstorm.net>
+
+// TODO: Proper keybindings
+// C,D,e, ,I, ,k,k,l,M, ,n,o,R, ,s,T, ,w   : English
+//       H B j      R m    F       v       : Swedish
+{
+  "Cut": "Klipp ut",
+  "Copy": "Kopiera",
+  "Paste": "Klistra in",
+  "_Image Properties...": "_Bildegenskaper...",
+  "Show the image properties dialog": "Visa bildegenskaper",
+  "_Modify Link...": "_Redigera Lnk...",
+  "Current URL is": "Aktuellt URL r",
+  "Chec_k Link...": "Kontrollera lnk...",
+  "Opens this link in a new window": "ppna lnk i nytt fnster",
+  "_Remove Link...": "_Ta bort lnk...",
+  "Please confirm that you want to unlink this element.": "Bekrfta borttagning av lnk",
+  "Link points to:": "Lnken pekar mot:",
+  "Unlink the current element": "Ta bort lnk kopplad till elementet",
+  "C_ell Properties...": "C_ellegenskaper...",
+  "Show the Table Cell Properties dialog": "Visa egenskaper for cellen",
+  "Ro_w Properties...": "Radegenskaper... (_w)",
+  "Show the Table Row Properties dialog": "Visa egenskaper fr rad",
+  "I_nsert Row Before": "I_nfoga rad fre",
+  "Insert a new row before the current one": "Infoga ny rad fre aktuell",
+  "In_sert Row After": "Infoga rad efter aktuell rad",
+  "Insert a new row after the current one": "Infoga ny rad efter aktuell",
+  "_Delete Row": "Radera rad (_d)",
+  "Delete the current row": "T bort aktuell rad",
+  "_Table Properties...": "_Tabellegenskaper...",
+  "Show the Table Properties dialog": "Visa tabellegenskaper",
+  "Insert _Column Before": "Infoga kolumn efter (_c)",
+  "Insert a new column before the current one": "Infoga kolumn fre aktuell",
+  "Insert C_olumn After": "Infoga k_olumn efter",
+  "Insert a new column after the current one": "Infoga kolumn efter aktuell",
+  "De_lete Column": "_Radera kolumn",
+  "Delete the current column": "Radera aktuell kolumn",
+  "Justify Left": "_Vnsterjustera",
+  "Justify Center": "_Centerjustera",
+  "Justify Right": "_Hgerjustera",
+  "Justify Full": "Block_justera",
+  "Make lin_k...": "Skapa ln_k...",
+  "Create a link": "SKapa ny lnk",
+  "Remove the $elem Element...": "Radera elementet $elem...",
+  "Please confirm that you want to remove this element:": "Bekrfta borttagning av element:",
+  "Remove this node from the document": "Radera nod frn dokumentet",
+  "Insert paragraph before": "Infoga paragraf fre",
+  "Insert a paragraph before the current node": "Infoga paragraf fre aktuell nod",
+  "Insert paragraph after": "Infoga paragraf efter",
+  "Insert a paragraph after the current node": "Infoga paragraf efter aktuell nod",
+  "How did you get here? (Please report!)": "Hur hamnade du hr? (Beskriv frloppet)"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ContextMenu/menu.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ContextMenu/menu.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,67 @@
+/* styles for the ContextMenu /HTMLArea */
+/* The ContextMenu plugin is (c) dynarch.com 2003. */
+/* Distributed under the same terms as HTMLArea itself */
+
+div.htmlarea-context-menu {
+  position: absolute;
+  border: 1px solid #aca899;
+  padding: 2px;
+  background-color: #fff;
+  color: #000;
+  cursor: default;
+  z-index: 1000;
+}
+
+div.htmlarea-context-menu table {
+  font: 11px tahoma,verdana,sans-serif;
+  border-collapse: collapse;
+}
+
+div.htmlarea-context-menu tr.item td.icon img {
+/* taken care of by xinha.makeBtnImg() */
+/* width: 18px; */
+/* height: 18px; */
+}
+
+div.htmlarea-context-menu tr.item td.icon {
+  padding: 0px 3px;
+  width: 18px;
+  height: 18px;
+  background-color: #cdf;
+}
+
+div.htmlarea-context-menu tr.item td.label {
+  padding: 1px 10px 1px 3px;
+}
+
+div.htmlarea-context-menu tr.separator td {
+  padding: 2px 0px;
+}
+
+div.htmlarea-context-menu tr.separator td div {
+  border-top: 1px solid #aca899;
+  overflow: hidden;
+  position: relative;
+}
+
+div.htmlarea-context-menu tr.separator td.icon {
+  background-color: #cdf;
+}
+
+div.htmlarea-context-menu tr.separator td.icon div {
+/*  margin-left: 3px; */
+  border-color: #fff;
+}
+
+div.htmlarea-context-menu tr.separator td.label div {
+  margin-right: 3px;
+}
+
+div.htmlarea-context-menu tr.item.hover {
+  background-color: #316ac5;
+  color: #fff;
+}
+
+div.htmlarea-context-menu tr.item.hover td.icon {
+  background-color: #619af5;
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/DefinitionList/definition-list.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/DefinitionList/definition-list.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,21 @@
+dl { border: 1px dotted #800000; }
+dt {
+  width: 18px;
+  height: 18px;
+  background-image: url(img/ed_dt.gif);
+  background-repeat: no-repeat;
+  background-position: left top;
+  padding-left: 19px;
+  display: block;
+  color: #800000;
+}
+dd {
+  width: 18px;
+  height: 18px;
+  background-image: url(img/ed_dd.gif);
+  background-repeat: no-repeat;
+  background-position: left top;
+  padding-left: 19px;
+  display: block;
+  color: #800000;
+}
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/DefinitionList/definition-list.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/DefinitionList/definition-list.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,74 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/DefinitionList/definition-list.js */
+function DefinitionList(_1){
+this.editor=_1;
+var _2=_1.config;
+var bl=DefinitionList.btnList;
+var _4=this;
+var _5=["linebreak"];
+for(var i=0;i<bl.length;++i){
+var _7=bl[i];
+if(!_7){
+_5.push("separator");
+}else{
+var id=_7[0];
+_2.registerButton(id,this._lc(_7[1]),_1.imgURL("ed_"+_7[0]+".gif","DefinitionList"),false,function(_9,id){
+_4.buttonPress(_9,id);
+});
+_5.push(id);
+}
+}
+_2.toolbar.push(_5);
+}
+DefinitionList._pluginInfo={name:"DefinitionList",version:"1.0",developer:"Udo Schmal",developer_url:"",c_owner:"Udo Schmal",license:"htmlArea"};
+DefinitionList.btnList=[["dl","definition list"],["dt","definition term"],["dd","definition description"]];
+DefinitionList.prototype._lc=function(_b){
+return Xinha._lc(_b,"DefinitionList");
+};
+DefinitionList.prototype.onGenerate=function(){
+this.editor.addEditorStylesheet(Xinha.getPluginDir("DefinitionList")+"/definition-list.css");
+};
+DefinitionList.prototype.buttonPress=function(_c,_d){
+if(_d=="dl"){
+var pe=_c.getParentElement();
+while(pe.parentNode.tagName.toLowerCase()!="body"){
+pe=pe.parentNode;
+}
+var dx=_c._doc.createElement(_d);
+dx.innerHTML="&nbsp;";
+if(pe.parentNode.lastChild==pe){
+pe.parentNode.appendChild(dx);
+}else{
+pe.parentNode.insertBefore(dx,pe.nextSibling);
+}
+}else{
+if((_d=="dt")||(_d=="dd")){
+var pe=_c.getParentElement();
+while(pe&&(pe.nodeType==1)&&(pe.tagName.toLowerCase()!="body")){
+if(pe.tagName.toLowerCase()=="dl"){
+var dx=_c._doc.createElement(_d);
+dx.innerHTML="&nbsp;";
+pe.appendChild(dx);
+break;
+}else{
+if((pe.tagName.toLowerCase()=="dt")||(pe.tagName.toLowerCase()=="dd")){
+var dx=_c._doc.createElement(_d);
+dx.innerHTML="&nbsp;";
+if(pe.parentNode.lastChild==pe){
+pe.parentNode.appendChild(dx);
+}else{
+pe.parentNode.insertBefore(dx,pe.nextSibling);
+}
+break;
+}
+}
+pe=pe.parentNode;
+}
+if(pe.tagName.toLowerCase()=="body"){
+alert("You can insert a definition term or description only in a definition list!");
+}
+}
+}
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/DefinitionList/img/ed_dd.gif
Binary file Xinha_0.95/plugins/DefinitionList/img/ed_dd.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/DefinitionList/img/ed_dl.gif
Binary file Xinha_0.95/plugins/DefinitionList/img/ed_dl.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/DefinitionList/img/ed_dt.gif
Binary file Xinha_0.95/plugins/DefinitionList/img/ed_dt.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/DefinitionList/lang/ja.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/DefinitionList/lang/ja.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,7 @@
+// I18N constants
+// LANG: "ja", ENCODING: UTF-8
+{
+  "definition list": "",
+  "definition term": "",
+  "definition description": ""
+}
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/DefinitionList/lang/nl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/DefinitionList/lang/nl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,8 @@
+// I18N constants
+// LANG: "nl", ENCODING: UTF-8
+// Author: Maarten Molenschot, maarten@nrgmm.nl
+{
+  "definition list": "definitie lijst",
+  "definition term": "definitie term",
+  "definition description": "definitie omschrijving
+}
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/DefinitionList/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/DefinitionList/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,20 @@
+// I18N constants
+
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+
+// Last revision: 05 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "definition list": "Lista de definio",
+  "definition term": "Termo de definio",
+  "definition description": "Descrio de definio"
+}
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/DoubleClick/double-click.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/DoubleClick/double-click.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,30 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/DoubleClick/double-click.js */
+DoubleClick._pluginInfo={name:"DoubleClick",version:"1.0",developer:"Marijn Kampf",developer_url:"http://www.marijn.org",c_owner:"Marijn Kampf",sponsor:"smiling-faces.com",sponsor_url:"http://www.smiling-faces.com",license:"htmlArea"};
+function DoubleClick(_1){
+this.editor=_1;
+this.editor.dblClickList={a:[function(e){
+e.config.btnList["createlink"][3](e);
+}],img:[function(e){
+e.execCommand("insertimage");
+}],td:[function(e){
+e.execCommand("inserttable");
+}]};
+}
+DoubleClick.prototype.onGenerate=function(){
+var _5=this;
+var _6=this.editordoc=this.editor._iframe.contentWindow.document;
+Xinha._addEvents(_6,["dblclick"],function(_7){
+return _5.onDoubleClick(Xinha.is_ie?_5.editor._iframe.contentWindow.event:_7);
+});
+this.currentClick=null;
+};
+DoubleClick.prototype.onDoubleClick=function(ev){
+var _9=Xinha.is_ie?ev.srcElement:ev.target;
+var _a=_9.tagName.toLowerCase();
+if(this.editor.dblClickList[_a]!=undefined){
+this.editor.dblClickList[_a][0](this.editor,_9);
+}
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/DynamicCSS/dynamiccss.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/DynamicCSS/dynamiccss.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,202 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/DynamicCSS/dynamiccss.js */
+function DynamicCSS(_1,_2){
+this.editor=_1;
+var _3=_1.config;
+var _4=this;
+var _5=null;
+var _6=null;
+var _7={id:"DynamicCSS-class",tooltip:this._lc("Choose stylesheet"),options:{"":""},action:function(_8){
+_4.onSelect(_8,this);
+},refresh:function(_9){
+_4.updateValue(_9,this);
+}};
+_3.registerDropdown(_7);
+_3.addToolbarElement(["T[CSS]","DynamicCSS-class","separator"],"formatblock",-1);
+}
+DynamicCSS.parseStyleSheet=function(_a){
+iframe=_a._iframe.contentWindow.document;
+cssArray=DynamicCSS.cssArray;
+if(!cssArray){
+cssArray=new Array();
+}
+for(i=0;i<iframe.styleSheets.length;i++){
+if(iframe.styleSheets[i].title=="XinhaInternalCSS"){
+continue;
+}
+if(Xinha.is_gecko){
+try{
+cssArray=DynamicCSS.applyCSSRule(iframe.styleSheets[i].cssRules,cssArray);
+}
+catch(e){
+}
+}else{
+try{
+if(iframe.styleSheets[i].rules){
+cssArray=DynamicCSS.applyCSSRule(iframe.styleSheets[i].rules,cssArray);
+}
+if(iframe.styleSheets[i].imports){
+for(j=0;j<iframe.styleSheets[i].imports.length;j++){
+cssArray=DynamicCSS.applyCSSRule(iframe.styleSheets[i].imports[j].rules,cssArray);
+}
+}
+}
+catch(e){
+}
+}
+}
+DynamicCSS.cssArray=cssArray;
+};
+DynamicCSS.applyCSSRule=function(_b,_c){
+for(rule in _b){
+if(typeof _b[rule]=="function"){
+continue;
+}
+if(_b[rule].selectorText){
+if(_b[rule].selectorText.search(/:+/)==-1){
+cssElements=_b[rule].selectorText.split(",");
+for(k=0;k<cssElements.length;k++){
+cssElement=cssElements[k].split(".");
+tagName=cssElement[0].toLowerCase().trim();
+className=cssElement[1];
+if(!tagName){
+tagName="all";
+}
+if(!_c[tagName]){
+_c[tagName]=new Array();
+}
+if(className){
+if(tagName=="all"){
+cssName=className;
+}else{
+cssName="<"+className+">";
+}
+}else{
+className="none";
+if(tagName=="all"){
+cssName=Xinha._lc("Default","DynamicCSS");
+}else{
+cssName="<"+Xinha._lc("Default","DynamicCSS")+">";
+}
+}
+_c[tagName][className]=cssName;
+DynamicCSS.cssLength++;
+}
+}
+}else{
+if(_b[rule].styleSheet){
+_c=DynamicCSS.applyCSSRule(_b[rule].styleSheet.cssRules,_c);
+}
+}
+}
+return _c;
+};
+DynamicCSS._pluginInfo={name:"DynamicCSS",version:"1.5.2",developer:"Holger Hees",developer_url:"http://www.systemconcept.de/",c_owner:"Holger Hees",sponsor:"System Concept GmbH",sponsor_url:"http://www.systemconcept.de/",license:"htmlArea"};
+DynamicCSS.prototype._lc=function(_d){
+return Xinha._lc(_d,"DynamicCSS");
+};
+DynamicCSS.prototype.onSelect=function(_e,_f){
+var _10=_e._toolbarObjects[_f.id];
+var _11=_10.element.selectedIndex;
+var _12=_10.element.value;
+var _13=_e.getParentElement();
+if(_12!="none"){
+_13.className=_12;
+DynamicCSS.lastClass=_12;
+}else{
+if(Xinha.is_gecko){
+_13.removeAttribute("class");
+}else{
+_13.removeAttribute("className");
+}
+}
+_e.updateToolbar();
+};
+DynamicCSS.prototype.reparseTimer=function(_14,obj,_16){
+if(DynamicCSS.parseCount<9){
+setTimeout(function(){
+DynamicCSS.cssLength=0;
+DynamicCSS.parseStyleSheet(_14);
+if(DynamicCSS.cssOldLength!=DynamicCSS.cssLength){
+DynamicCSS.cssOldLength=DynamicCSS.cssLength;
+DynamicCSS.lastClass=null;
+_16.updateValue(_14,obj);
+}
+_16.reparseTimer(_14,obj,_16);
+},DynamicCSS.parseCount*1000);
+DynamicCSS.parseCount=DynamicCSS.parseCount*2;
+}
+};
+DynamicCSS.prototype.updateValue=function(_17,obj){
+cssArray=DynamicCSS.cssArray;
+if(!cssArray){
+DynamicCSS.cssLength=0;
+DynamicCSS.parseStyleSheet(_17);
+cssArray=DynamicCSS.cssArray;
+DynamicCSS.cssOldLength=DynamicCSS.cssLength;
+DynamicCSS.parseCount=1;
+this.reparseTimer(_17,obj,this);
+}
+var _19=_17.getParentElement();
+var _1a=_19.tagName.toLowerCase();
+var _1b=_19.className;
+if(this.lastTag!=_1a||this.lastClass!=_1b){
+this.lastTag=_1a;
+this.lastClass=_1b;
+var _1c=_17._toolbarObjects[obj.id].element;
+while(_1c.length>0){
+_1c.options[_1c.length-1]=null;
+}
+_1c.options[0]=new Option(this._lc("Default"),"none");
+if(cssArray){
+if(_1a!="body"||_17.config.fullPage){
+if(cssArray[_1a]){
+for(cssClass in cssArray[_1a]){
+if(typeof cssArray[_1a][cssClass]!="string"){
+continue;
+}
+if(cssClass=="none"){
+_1c.options[0]=new Option(cssArray[_1a][cssClass],cssClass);
+}else{
+_1c.options[_1c.length]=new Option(cssArray[_1a][cssClass],cssClass);
+}
+}
+}
+if(cssArray["all"]){
+for(cssClass in cssArray["all"]){
+if(typeof cssArray["all"][cssClass]!="string"){
+continue;
+}
+_1c.options[_1c.length]=new Option(cssArray["all"][cssClass],cssClass);
+}
+}
+}else{
+if(cssArray[_1a]&&cssArray[_1a]["none"]){
+_1c.options[0]=new Option(cssArray[_1a]["none"],"none");
+}
+}
+}
+_1c.selectedIndex=0;
+if(typeof _1b!="undefined"&&/\S/.test(_1b)){
+var _1d=_1c.options;
+for(var i=_1d.length;--i>=0;){
+var _1f=_1d[i];
+if(_1b==_1f.value){
+_1c.selectedIndex=i;
+break;
+}
+}
+if(_1c.selectedIndex==0){
+_1c.options[_1c.length]=new Option(this._lc("Undefined"),_1b);
+_1c.selectedIndex=_1c.length-1;
+}
+}
+if(_1c.length>1){
+_1c.disabled=false;
+}else{
+_1c.disabled=true;
+}
+}
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/DynamicCSS/lang/de.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/DynamicCSS/lang/de.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,12 @@
+// I18N constants
+// LANG: "de", ENCODING: UTF-8
+// Sponsored by http://www.systemconcept.de
+// Author: Holger Hees, <hhees@systemconcept.de>
+// (c) systemconcept.de 2004
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "Default": "Standard",
+  "Undefined": "Nicht definiert",
+  "Choose stylesheet": "Whlen Sie einen StyleSheet aus"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/DynamicCSS/lang/fr.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/DynamicCSS/lang/fr.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,7 @@
+// I18N constants
+// LANG: "fr", ENCODING: UTF-8
+{
+  "Default": "Dfaut",
+  "Undefined": "Non dfini",
+  "Choose stylesheet": "Choisir feuille de style"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/DynamicCSS/lang/ja.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/DynamicCSS/lang/ja.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,7 @@
+// I18N constants
+// LANG: "ja", ENCODING: UTF-8
+{
+  "Default": "",
+  "Undefined": "",
+  "Choose stylesheet": ""
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/DynamicCSS/lang/nb.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/DynamicCSS/lang/nb.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,8 @@
+// I18N constants
+// LANG: "nb", ENCODING: UTF-8
+// translated: Kim Steinhaug, http://www.steinhaug.com/, kim@steinhaug.com
+{
+  "Default": "Standard",
+  "Undefined": "Udefinert",
+  "Choose stylesheet": "Velg stilsett"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/DynamicCSS/lang/nl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/DynamicCSS/lang/nl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,12 @@
+// I18N constants
+// LANG: "nl", ENCODING: UTF-8
+// Sponsored by http://www.systemconcept.de
+// Author: Holger Hees, <hhees@systemconcept.de>
+// (c) systemconcept.de 2004
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "Default": "Default",
+  "Undefined": "Ungedefinieerd",
+  "Choose stylesheet": "Kies stylesheet"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/DynamicCSS/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/DynamicCSS/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,21 @@
+// I18N constants
+
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+
+// Last revision: 05 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+
+{
+  "Choose stylesheet": "Escolher estilo",
+  "Default": "Padro",
+  "Undefined": "Indefinido"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/EditTag/edit-tag.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/EditTag/edit-tag.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,26 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/EditTag/edit-tag.js */
+function EditTag(_1){
+this.editor=_1;
+var _2=_1.config;
+var _3=this;
+_2.registerButton({id:"edittag",tooltip:this._lc("Edit HTML for selected text"),image:_1.imgURL("ed_edit_tag.gif","EditTag"),textMode:false,action:function(_4){
+_3.buttonPress(_4);
+}});
+_2.addToolbarElement("edittag","htmlmode",1);
+}
+EditTag._pluginInfo={name:"EditTag",version:"1.0",developer:"Pegoraro Marco",developer_url:"http://www.sin-italia.com/",c_owner:"Marco Pegoraro",sponsor:"Sin Italia",sponsor_url:"http://www.sin-italia.com/",license:"htmlArea"};
+EditTag.prototype._lc=function(_5){
+return Xinha._lc(_5,"EditTag");
+};
+EditTag.prototype.buttonPress=function(_6){
+outparam={content:_6.getSelectedHTML()};
+_6._popupDialog("plugin://EditTag/edit_tag",function(_7){
+if(!_7){
+return false;
+}
+_6.insertHTML(_7);
+},outparam);
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/EditTag/img/ed_edit_tag.gif
Binary file Xinha_0.95/plugins/EditTag/img/ed_edit_tag.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/EditTag/lang/de.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/EditTag/lang/de.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,7 @@
+// I18N constants
+// LANG: "de", ENCODING: UTF-8
+// translated: Udo Schmal (gocher), http://www.schaffrath-neuemedien.de/, udo.schmal@t-online.de
+{
+  "Edit HTML for selected text": "HTML im ausgewhlten Bereich bearbeiten",
+  "Tag Editor": "HTML tag Editor"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/EditTag/lang/fr.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/EditTag/lang/fr.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,6 @@
+// I18N constants
+// LANG: "fr", ENCODING: UTF-8
+{
+  "Edit HTML for selected text": "Editer le code HTML du texte slectionn",
+  "Tag Editor": "Editeur de tag HTML"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/EditTag/lang/ja.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/EditTag/lang/ja.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,6 @@
+// I18N constants
+// LANG: "ja", ENCODING: UTF-8
+{
+  "Edit HTML for selected text": "HTML",
+  "Tag Editor": ""
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/EditTag/lang/nb.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/EditTag/lang/nb.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,6 @@
+// I18N constants
+// LANG: "nb", ENCODING: UTF-8
+// translated: Kim Steinhaug, http://www.steinhaug.com/, kim@steinhaug.com
+{
+  "Edit HTML for selected text": "Rediger HTML for den valgte teksten"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/EditTag/lang/nl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/EditTag/lang/nl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,7 @@
+// I18N constants
+// LANG: "nl", ENCODING: UTF-8
+// Author: Maarten Molenschot, maarten@nrgmm.nl
+{
+  "Edit HTML for selected text": "HTML bewerken voor geselecteerde tekst",
+  "Tag Editor": "HTML tag Editor"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/EditTag/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/EditTag/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,22 @@
+// I18N constants
+
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+
+// Last revision: 05 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "Cancel": "Cancelar",
+  "Edit HTML for selected text": "Editar HTML para texto selecionado",
+  "Edit Tag By Peg": "Editar Tag por Peg",
+  "OK": "OK",
+  "Tag Editor": "Editor de Tag"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/EditTag/popups/edit_tag.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/EditTag/popups/edit_tag.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,38 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+<html>
+<head>
+  <title>Edit Tag By Peg</title>
+  <link rel="stylesheet" type="text/css" href="../../../popups/popup.css" />
+  <script type="text/javascript" src="../../../popups/popup.js"></script>
+<script language="javascript">
+  window.resizeTo(600, 450);
+function Init() {
+  __dlg_translate("EditTag");
+  __dlg_init();
+
+  var param = window.dialogArguments;
+  document.getElementById("TAG").value = param["content"];
+  document.getElementById("TAG").focus();
+}
+
+function onCancel() {
+  __dlg_close( null );
+  return false;
+}
+
+function onOK() {
+  var ret = document.getElementById("TAG").value;
+  __dlg_close( ret );
+}
+</script>
+</head>
+
+<body class="dialog" onLoad="Init();">
+<div class="title">Tag Editor</div>
+<textarea name="TAG" id="TAG" cols=22 rows=5 style="width: 100%; height: 315px; margin-top: 8px; margin-bottom: 4px; font-family: monospace; font-size: 11px;"></textarea>
+<div id="buttons">
+    <button type="submit" name="ok" onclick="return onOK();">OK</button>
+    <button type="button" name="cancel" onclick="return onCancel();">Cancel</button>
+</div>
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/ASCIIMathML.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Equation/ASCIIMathML.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,703 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/Equation/ASCIIMathML.js */
+var checkForMathML=true;
+var notifyIfNoMathML=true;
+var alertIfNoMathML=false;
+if(typeof mathcolor=="undefined"){
+var mathcolor="red";
+}
+if(typeof mathfontfamily=="undefined"){
+var mathfontfamily="serif";
+}
+var displaystyle=true;
+if(typeof showasciiformulaonhover=="undefined"){
+var showasciiformulaonhover=true;
+}
+var decimalsign=".";
+var AMdelimiter1="`",AMescape1="\\\\`";
+var AMdelimiter2="$",AMescape2="\\\\\\$",AMdelimiter2regexp="\\$";
+var doubleblankmathdelimiter=false;
+var isIE=document.createElementNS==null;
+if(document.getElementById==null){
+alert("This webpage requires a recent browser such as\nMozilla/Netscape 7+ or Internet Explorer 6+MathPlayer");
+}
+function AMcreateElementXHTML(t){
+if(isIE){
+return document.createElement(t);
+}else{
+return document.createElementNS("http://www.w3.org/1999/xhtml",t);
+}
+}
+function AMnoMathMLNote(){
+var nd=AMcreateElementXHTML("h3");
+nd.setAttribute("align","center");
+nd.appendChild(AMcreateElementXHTML("p"));
+nd.appendChild(document.createTextNode("To view the "));
+var an=AMcreateElementXHTML("a");
+an.appendChild(document.createTextNode("ASCIIMathML"));
+an.setAttribute("href","http://www.chapman.edu/~jipsen/asciimath.html");
+nd.appendChild(an);
+nd.appendChild(document.createTextNode(" notation use Internet Explorer 6+"));
+an=AMcreateElementXHTML("a");
+an.appendChild(document.createTextNode("MathPlayer"));
+an.setAttribute("href","http://www.dessci.com/en/products/mathplayer/download.htm");
+nd.appendChild(an);
+nd.appendChild(document.createTextNode(" or Netscape/Mozilla/Firefox"));
+nd.appendChild(AMcreateElementXHTML("p"));
+return nd;
+}
+function AMisMathMLavailable(){
+if(navigator.appName.slice(0,8)=="Netscape"){
+if(navigator.appVersion.slice(0,1)>="5"){
+return null;
+}else{
+return AMnoMathMLNote();
+}
+}else{
+if(navigator.appName.slice(0,9)=="Microsoft"){
+try{
+var _4=new ActiveXObject("MathPlayer.Factory.1");
+return null;
+}
+catch(e){
+return AMnoMathMLNote();
+}
+}else{
+return AMnoMathMLNote();
+}
+}
+}
+var AMcal=[61237,8492,61238,61239,8496,8497,61240,8459,8464,61241,61242,8466,8499,61243,61244,61245,61246,8475,61247,61248,61249,61250,61251,61252,61253,61254];
+var AMfrk=[61277,61278,8493,61279,61280,61281,61282,8460,8465,61283,61284,61285,61286,61287,61288,61289,61290,8476,61291,61292,61293,61294,61295,61296,61297,8488];
+var AMbbb=[61324,61325,8450,61326,61327,61328,61329,8461,61330,61331,61332,61333,61334,8469,61335,8473,8474,8477,61336,61337,61338,61339,61340,61341,61342,8484];
+var CONST=0,UNARY=1,BINARY=2,INFIX=3,LEFTBRACKET=4,RIGHTBRACKET=5,SPACE=6,UNDEROVER=7,DEFINITION=8,LEFTRIGHT=9,TEXT=10;
+var AMsqrt={input:"sqrt",tag:"msqrt",output:"sqrt",tex:null,ttype:UNARY},AMroot={input:"root",tag:"mroot",output:"root",tex:null,ttype:BINARY},AMfrac={input:"frac",tag:"mfrac",output:"/",tex:null,ttype:BINARY},AMdiv={input:"/",tag:"mfrac",output:"/",tex:null,ttype:INFIX},AMover={input:"stackrel",tag:"mover",output:"stackrel",tex:null,ttype:BINARY},AMsub={input:"_",tag:"msub",output:"_",tex:null,ttype:INFIX},AMsup={input:"^",tag:"msup",output:"^",tex:null,ttype:INFIX},AMtext={input:"text",tag:"mtext",output:"text",tex:null,ttype:TEXT},AMmbox={input:"mbox",tag:"mtext",output:"mbox",tex:null,ttype:TEXT},AMquote={input:"\"",tag:"mtext",output:"mbox",tex:null,ttype:TEXT};
+var AMsymbols=[{input:"alpha",tag:"mi",output:"\u03b1",tex:null,ttype:CONST},{input:"beta",tag:"mi",output:"\u03b2",tex:null,ttype:CONST},{input:"chi",tag:"mi",output:"\u03c7",tex:null,ttype:CONST},{input:"delta",tag:"mi",output:"\u03b4",tex:null,ttype:CONST},{input:"Delta",tag:"mo",output:"\u0394",tex:null,ttype:CONST},{input:"epsi",tag:"mi",output:"\u03b5",tex:"epsilon",ttype:CONST},{input:"varepsilon",tag:"mi",output:"\u025b",tex:null,ttype:CONST},{input:"eta",tag:"mi",output:"\u03b7",tex:null,ttype:CONST},{input:"gamma",tag:"mi",output:"\u03b3",tex:null,ttype:CONST},{input:"Gamma",tag:"mo",output:"\u0393",tex:null,ttype:CONST},{input:"iota",tag:"mi",output:"\u03b9",tex:null,ttype:CONST},{input:"kappa",tag:"mi",output:"\u03ba",tex:null,ttype:CONST},{input:"lambda",tag:"mi",output:"\u03bb",tex:null,ttype:CONST},{input:"Lambda",tag:"mo",output:"\u039b",tex:null,ttype:CONST},{input:"mu",tag:"mi",output:"\u03bc",tex:null,ttype:CONST},{input:"nu",tag:"mi",output:"\u03bd",tex:null,ttype:CONST},{input:"omega",tag:"mi",output:"\u03c9",tex:null,ttype:CONST},{input:"Omega",tag:"mo",output:"\u03a9",tex:null,ttype:CONST},{input:"phi",tag:"mi",output:"\u03c6",tex:null,ttype:CONST},{input:"varphi",tag:"mi",output:"\u03d5",tex:null,ttype:CONST},{input:"Phi",tag:"mo",output:"\u03a6",tex:null,ttype:CONST},{input:"pi",tag:"mi",output:"\u03c0",tex:null,ttype:CONST},{input:"Pi",tag:"mo",output:"\u03a0",tex:null,ttype:CONST},{input:"psi",tag:"mi",output:"\u03c8",tex:null,ttype:CONST},{input:"Psi",tag:"mi",output:"\u03a8",tex:null,ttype:CONST},{input:"rho",tag:"mi",output:"\u03c1",tex:null,ttype:CONST},{input:"sigma",tag:"mi",output:"\u03c3",tex:null,ttype:CONST},{input:"Sigma",tag:"mo",output:"\u03a3",tex:null,ttype:CONST},{input:"tau",tag:"mi",output:"\u03c4",tex:null,ttype:CONST},{input:"theta",tag:"mi",output:"\u03b8",tex:null,ttype:CONST},{input:"vartheta",tag:"mi",output:"\u03d1",tex:null,ttype:CONST},{input:"Theta",tag:"mo",output:"\u0398",tex:null,ttype:CONST},{input:"upsilon",tag:"mi",output:"\u03c5",tex:null,ttype:CONST},{input:"xi",tag:"mi",output:"\u03be",tex:null,ttype:CONST},{input:"Xi",tag:"mo",output:"\u039e",tex:null,ttype:CONST},{input:"zeta",tag:"mi",output:"\u03b6",tex:null,ttype:CONST},{input:"*",tag:"mo",output:"\u22c5",tex:"cdot",ttype:CONST},{input:"**",tag:"mo",output:"\u22c6",tex:"star",ttype:CONST},{input:"//",tag:"mo",output:"/",tex:null,ttype:CONST},{input:"\\\\",tag:"mo",output:"\\",tex:"backslash",ttype:CONST},{input:"setminus",tag:"mo",output:"\\",tex:null,ttype:CONST},{input:"xx",tag:"mo",output:"\xd7",tex:"times",ttype:CONST},{input:"-:",tag:"mo",output:"\xf7",tex:"divide",ttype:CONST},{input:"@",tag:"mo",output:"\u2218",tex:"circ",ttype:CONST},{input:"o+",tag:"mo",output:"\u2295",tex:"oplus",ttype:CONST},{input:"ox",tag:"mo",output:"\u2297",tex:"otimes",ttype:CONST},{input:"o.",tag:"mo",output:"\u2299",tex:"odot",ttype:CONST},{input:"sum",tag:"mo",output:"\u2211",tex:null,ttype:UNDEROVER},{input:"prod",tag:"mo",output:"\u220f",tex:null,ttype:UNDEROVER},{input:"^^",tag:"mo",output:"\u2227",tex:"wedge",ttype:CONST},{input:"^^^",tag:"mo",output:"\u22c0",tex:"bigwedge",ttype:UNDEROVER},{input:"vv",tag:"mo",output:"\u2228",tex:"vee",ttype:CONST},{input:"vvv",tag:"mo",output:"\u22c1",tex:"bigvee",ttype:UNDEROVER},{input:"nn",tag:"mo",output:"\u2229",tex:"cap",ttype:CONST},{input:"nnn",tag:"mo",output:"\u22c2",tex:"bigcap",ttype:UNDEROVER},{input:"uu",tag:"mo",output:"\u222a",tex:"cup",ttype:CONST},{input:"uuu",tag:"mo",output:"\u22c3",tex:"bigcup",ttype:UNDEROVER},{input:"!=",tag:"mo",output:"\u2260",tex:"ne",ttype:CONST},{input:":=",tag:"mo",output:":=",tex:null,ttype:CONST},{input:"lt",tag:"mo",output:"<",tex:null,ttype:CONST},{input:"<=",tag:"mo",output:"\u2264",tex:"le",ttype:CONST},{input:"lt=",tag:"mo",output:"\u2264",tex:"leq",ttype:CONST},{input:">=",tag:"mo",output:"\u2265",tex:"ge",ttype:CONST},{input:"geq",tag:"mo",output:"\u2265",tex:null,ttype:CONST},{input:"-<",tag:"mo",output:"\u227a",tex:"prec",ttype:CONST},{input:"-lt",tag:"mo",output:"\u227a",tex:null,ttype:CONST},{input:">-",tag:"mo",output:"\u227b",tex:"succ",ttype:CONST},{input:"-<=",tag:"mo",output:"\u2aaf",tex:"preceq",ttype:CONST},{input:">-=",tag:"mo",output:"\u2ab0",tex:"succeq",ttype:CONST},{input:"in",tag:"mo",output:"\u2208",tex:null,ttype:CONST},{input:"!in",tag:"mo",output:"\u2209",tex:"notin",ttype:CONST},{input:"sub",tag:"mo",output:"\u2282",tex:"subset",ttype:CONST},{input:"sup",tag:"mo",output:"\u2283",tex:"supset",ttype:CONST},{input:"sube",tag:"mo",output:"\u2286",tex:"subseteq",ttype:CONST},{input:"supe",tag:"mo",output:"\u2287",tex:"supseteq",ttype:CONST},{input:"-=",tag:"mo",output:"\u2261",tex:"equiv",ttype:CONST},{input:"~=",tag:"mo",output:"\u2245",tex:"cong",ttype:CONST},{input:"~~",tag:"mo",output:"\u2248",tex:"approx",ttype:CONST},{input:"prop",tag:"mo",output:"\u221d",tex:"propto",ttype:CONST},{input:"and",tag:"mtext",output:"and",tex:null,ttype:SPACE},{input:"or",tag:"mtext",output:"or",tex:null,ttype:SPACE},{input:"not",tag:"mo",output:"\xac",tex:"neg",ttype:CONST},{input:"=>",tag:"mo",output:"\u21d2",tex:"implies",ttype:CONST},{input:"if",tag:"mo",output:"if",tex:null,ttype:SPACE},{input:"<=>",tag:"mo",output:"\u21d4",tex:"iff",ttype:CONST},{input:"AA",tag:"mo",output:"\u2200",tex:"forall",ttype:CONST},{input:"EE",tag:"mo",output:"\u2203",tex:"exists",ttype:CONST},{input:"_|_",tag:"mo",output:"\u22a5",tex:"bot",ttype:CONST},{input:"TT",tag:"mo",output:"\u22a4",tex:"top",ttype:CONST},{input:"|--",tag:"mo",output:"\u22a2",tex:"vdash",ttype:CONST},{input:"|==",tag:"mo",output:"\u22a8",tex:"models",ttype:CONST},{input:"(",tag:"mo",output:"(",tex:null,ttype:LEFTBRACKET},{input:")",tag:"mo",output:")",tex:null,ttype:RIGHTBRACKET},{input:"[",tag:"mo",output:"[",tex:null,ttype:LEFTBRACKET},{input:"]",tag:"mo",output:"]",tex:null,ttype:RIGHTBRACKET},{input:"{",tag:"mo",output:"{",tex:null,ttype:LEFTBRACKET},{input:"}",tag:"mo",output:"}",tex:null,ttype:RIGHTBRACKET},{input:"|",tag:"mo",output:"|",tex:null,ttype:LEFTRIGHT},{input:"(:",tag:"mo",output:"\u2329",tex:"langle",ttype:LEFTBRACKET},{input:":)",tag:"mo",output:"\u232a",tex:"rangle",ttype:RIGHTBRACKET},{input:"<<",tag:"mo",output:"\u2329",tex:null,ttype:LEFTBRACKET},{input:">>",tag:"mo",output:"\u232a",tex:null,ttype:RIGHTBRACKET},{input:"{:",tag:"mo",output:"{:",tex:null,ttype:LEFTBRACKET,invisible:true},{input:":}",tag:"mo",output:":}",tex:null,ttype:RIGHTBRACKET,invisible:true},{input:"int",tag:"mo",output:"\u222b",tex:null,ttype:CONST},{input:"dx",tag:"mi",output:"{:d x:}",tex:null,ttype:DEFINITION},{input:"dy",tag:"mi",output:"{:d y:}",tex:null,ttype:DEFINITION},{input:"dz",tag:"mi",output:"{:d z:}",tex:null,ttype:DEFINITION},{input:"dt",tag:"mi",output:"{:d t:}",tex:null,ttype:DEFINITION},{input:"oint",tag:"mo",output:"\u222e",tex:null,ttype:CONST},{input:"del",tag:"mo",output:"\u2202",tex:"partial",ttype:CONST},{input:"grad",tag:"mo",output:"\u2207",tex:"nabla",ttype:CONST},{input:"+-",tag:"mo",output:"\xb1",tex:"pm",ttype:CONST},{input:"O/",tag:"mo",output:"\u2205",tex:"emptyset",ttype:CONST},{input:"oo",tag:"mo",output:"\u221e",tex:"infty",ttype:CONST},{input:"aleph",tag:"mo",output:"\u2135",tex:null,ttype:CONST},{input:"...",tag:"mo",output:"...",tex:"ldots",ttype:CONST},{input:":.",tag:"mo",output:"\u2234",tex:"therefore",ttype:CONST},{input:"/_",tag:"mo",output:"\u2220",tex:"angle",ttype:CONST},{input:"\\ ",tag:"mo",output:"\xa0",tex:null,ttype:CONST},{input:"quad",tag:"mo",output:"\xa0\xa0",tex:null,ttype:CONST},{input:"qquad",tag:"mo",output:"\xa0\xa0\xa0\xa0",tex:null,ttype:CONST},{input:"cdots",tag:"mo",output:"\u22ef",tex:null,ttype:CONST},{input:"vdots",tag:"mo",output:"\u22ee",tex:null,ttype:CONST},{input:"ddots",tag:"mo",output:"\u22f1",tex:null,ttype:CONST},{input:"diamond",tag:"mo",output:"\u22c4",tex:null,ttype:CONST},{input:"square",tag:"mo",output:"\u25a1",tex:null,ttype:CONST},{input:"|__",tag:"mo",output:"\u230a",tex:"lfloor",ttype:CONST},{input:"__|",tag:"mo",output:"\u230b",tex:"rfloor",ttype:CONST},{input:"|~",tag:"mo",output:"\u2308",tex:"lceiling",ttype:CONST},{input:"~|",tag:"mo",output:"\u2309",tex:"rceiling",ttype:CONST},{input:"CC",tag:"mo",output:"\u2102",tex:null,ttype:CONST},{input:"NN",tag:"mo",output:"\u2115",tex:null,ttype:CONST},{input:"QQ",tag:"mo",output:"\u211a",tex:null,ttype:CONST},{input:"RR",tag:"mo",output:"\u211d",tex:null,ttype:CONST},{input:"ZZ",tag:"mo",output:"\u2124",tex:null,ttype:CONST},{input:"f",tag:"mi",output:"f",tex:null,ttype:UNARY,func:true},{input:"g",tag:"mi",output:"g",tex:null,ttype:UNARY,func:true},{input:"lim",tag:"mo",output:"lim",tex:null,ttype:UNDEROVER},{input:"Lim",tag:"mo",output:"Lim",tex:null,ttype:UNDEROVER},{input:"sin",tag:"mo",output:"sin",tex:null,ttype:UNARY,func:true},{input:"cos",tag:"mo",output:"cos",tex:null,ttype:UNARY,func:true},{input:"tan",tag:"mo",output:"tan",tex:null,ttype:UNARY,func:true},{input:"sinh",tag:"mo",output:"sinh",tex:null,ttype:UNARY,func:true},{input:"cosh",tag:"mo",output:"cosh",tex:null,ttype:UNARY,func:true},{input:"tanh",tag:"mo",output:"tanh",tex:null,ttype:UNARY,func:true},{input:"cot",tag:"mo",output:"cot",tex:null,ttype:UNARY,func:true},{input:"sec",tag:"mo",output:"sec",tex:null,ttype:UNARY,func:true},{input:"csc",tag:"mo",output:"csc",tex:null,ttype:UNARY,func:true},{input:"log",tag:"mo",output:"log",tex:null,ttype:UNARY,func:true},{input:"ln",tag:"mo",output:"ln",tex:null,ttype:UNARY,func:true},{input:"det",tag:"mo",output:"det",tex:null,ttype:UNARY,func:true},{input:"dim",tag:"mo",output:"dim",tex:null,ttype:CONST},{input:"mod",tag:"mo",output:"mod",tex:null,ttype:CONST},{input:"gcd",tag:"mo",output:"gcd",tex:null,ttype:UNARY,func:true},{input:"lcm",tag:"mo",output:"lcm",tex:null,ttype:UNARY,func:true},{input:"lub",tag:"mo",output:"lub",tex:null,ttype:CONST},{input:"glb",tag:"mo",output:"glb",tex:null,ttype:CONST},{input:"min",tag:"mo",output:"min",tex:null,ttype:UNDEROVER},{input:"max",tag:"mo",output:"max",tex:null,ttype:UNDEROVER},{input:"uarr",tag:"mo",output:"\u2191",tex:"uparrow",ttype:CONST},{input:"darr",tag:"mo",output:"\u2193",tex:"downarrow",ttype:CONST},{input:"rarr",tag:"mo",output:"\u2192",tex:"rightarrow",ttype:CONST},{input:"->",tag:"mo",output:"\u2192",tex:"to",ttype:CONST},{input:"|->",tag:"mo",output:"\u21a6",tex:"mapsto",ttype:CONST},{input:"larr",tag:"mo",output:"\u2190",tex:"leftarrow",ttype:CONST},{input:"harr",tag:"mo",output:"\u2194",tex:"leftrightarrow",ttype:CONST},{input:"rArr",tag:"mo",output:"\u21d2",tex:"Rightarrow",ttype:CONST},{input:"lArr",tag:"mo",output:"\u21d0",tex:"Leftarrow",ttype:CONST},{input:"hArr",tag:"mo",output:"\u21d4",tex:"Leftrightarrow",ttype:CONST},AMsqrt,AMroot,AMfrac,AMdiv,AMover,AMsub,AMsup,{input:"hat",tag:"mover",output:"^",tex:null,ttype:UNARY,acc:true},{input:"bar",tag:"mover",output:"\xaf",tex:"overline",ttype:UNARY,acc:true},{input:"vec",tag:"mover",output:"\u2192",tex:null,ttype:UNARY,acc:true},{input:"dot",tag:"mover",output:".",tex:null,ttype:UNARY,acc:true},{input:"ddot",tag:"mover",output:"..",tex:null,ttype:UNARY,acc:true},{input:"ul",tag:"munder",output:"\u0332",tex:"underline",ttype:UNARY,acc:true},AMtext,AMmbox,AMquote,{input:"bb",tag:"mstyle",atname:"fontweight",atval:"bold",output:"bb",tex:null,ttype:UNARY},{input:"mathbf",tag:"mstyle",atname:"fontweight",atval:"bold",output:"mathbf",tex:null,ttype:UNARY},{input:"sf",tag:"mstyle",atname:"fontfamily",atval:"sans-serif",output:"sf",tex:null,ttype:UNARY},{input:"mathsf",tag:"mstyle",atname:"fontfamily",atval:"sans-serif",output:"mathsf",tex:null,ttype:UNARY},{input:"bbb",tag:"mstyle",atname:"mathvariant",atval:"double-struck",output:"bbb",tex:null,ttype:UNARY,codes:AMbbb},{input:"mathbb",tag:"mstyle",atname:"mathvariant",atval:"double-struck",output:"mathbb",tex:null,ttype:UNARY,codes:AMbbb},{input:"cc",tag:"mstyle",atname:"mathvariant",atval:"script",output:"cc",tex:null,ttype:UNARY,codes:AMcal},{input:"mathcal",tag:"mstyle",atname:"mathvariant",atval:"script",output:"mathcal",tex:null,ttype:UNARY,codes:AMcal},{input:"tt",tag:"mstyle",atname:"fontfamily",atval:"monospace",output:"tt",tex:null,ttype:UNARY},{input:"mathtt",tag:"mstyle",atname:"fontfamily",atval:"monospace",output:"mathtt",tex:null,ttype:UNARY},{input:"fr",tag:"mstyle",atname:"mathvariant",atval:"fraktur",output:"fr",tex:null,ttype:UNARY,codes:AMfrk},{input:"mathfrak",tag:"mstyle",atname:"mathvariant",atval:"fraktur",output:"mathfrak",tex:null,ttype:UNARY,codes:AMfrk}];
+function compareNames(s1,s2){
+if(s1.input>s2.input){
+return 1;
+}else{
+return -1;
+}
+}
+var AMnames=[];
+function AMinitSymbols(){
+var _7=[],i;
+for(i=0;i<AMsymbols.length;i++){
+if(AMsymbols[i].tex){
+_7[_7.length]={input:AMsymbols[i].tex,tag:AMsymbols[i].tag,output:AMsymbols[i].output,ttype:AMsymbols[i].ttype};
+}
+}
+AMsymbols=AMsymbols.concat(_7);
+AMsymbols.sort(compareNames);
+for(i=0;i<AMsymbols.length;i++){
+AMnames[i]=AMsymbols[i].input;
+}
+}
+var AMmathml="http://www.w3.org/1998/Math/MathML";
+function AMcreateElementMathML(t){
+if(isIE){
+return document.createElement("m:"+t);
+}else{
+return document.createElementNS(AMmathml,t);
+}
+}
+function AMcreateMmlNode(t,_a){
+if(isIE){
+var _b=document.createElement("m:"+t);
+}else{
+var _b=document.createElementNS(AMmathml,t);
+}
+_b.appendChild(_a);
+return _b;
+}
+function newcommand(_c,_d){
+AMsymbols=AMsymbols.concat([{input:_c,tag:"mo",output:_d,tex:null,ttype:DEFINITION}]);
+}
+function AMremoveCharsAndBlanks(_e,n){
+var st;
+if(_e.charAt(n)=="\\"&&_e.charAt(n+1)!="\\"&&_e.charAt(n+1)!=" "){
+st=_e.slice(n+1);
+}else{
+st=_e.slice(n);
+}
+for(var i=0;i<st.length&&st.charCodeAt(i)<=32;i=i+1){
+}
+return st.slice(i);
+}
+function AMposition(arr,str,n){
+if(n==0){
+var h,m;
+n=-1;
+h=arr.length;
+while(n+1<h){
+m=(n+h)>>1;
+if(arr[m]<str){
+n=m;
+}else{
+h=m;
+}
+}
+return h;
+}else{
+for(var i=n;i<arr.length&&arr[i]<str;i++){
+}
+}
+return i;
+}
+function AMgetSymbol(str){
+var k=0;
+var j=0;
+var mk;
+var st;
+var _1c;
+var _1d="";
+var _1e=true;
+for(var i=1;i<=str.length&&_1e;i++){
+st=str.slice(0,i);
+j=k;
+k=AMposition(AMnames,st,j);
+if(k<AMnames.length&&str.slice(0,AMnames[k].length)==AMnames[k]){
+_1d=AMnames[k];
+mk=k;
+i=_1d.length;
+}
+_1e=k<AMnames.length&&str.slice(0,AMnames[k].length)>=AMnames[k];
+}
+AMpreviousSymbol=AMcurrentSymbol;
+if(_1d!=""){
+AMcurrentSymbol=AMsymbols[mk].ttype;
+return AMsymbols[mk];
+}
+AMcurrentSymbol=CONST;
+k=1;
+st=str.slice(0,1);
+var _20=true;
+while("0"<=st&&st<="9"&&k<=str.length){
+st=str.slice(k,k+1);
+k++;
+}
+if(st==decimalsign){
+st=str.slice(k,k+1);
+if("0"<=st&&st<="9"){
+_20=false;
+k++;
+while("0"<=st&&st<="9"&&k<=str.length){
+st=str.slice(k,k+1);
+k++;
+}
+}
+}
+if((_20&&k>1)||k>2){
+st=str.slice(0,k-1);
+_1c="mn";
+}else{
+k=2;
+st=str.slice(0,1);
+_1c=(("A">st||st>"Z")&&("a">st||st>"z")?"mo":"mi");
+}
+if(st=="-"&&AMpreviousSymbol==INFIX){
+AMcurrentSymbol=INFIX;
+return {input:st,tag:_1c,output:st,ttype:UNARY,func:true};
+}
+return {input:st,tag:_1c,output:st,ttype:CONST};
+}
+function AMremoveBrackets(_21){
+var st;
+if(_21.nodeName=="mrow"){
+st=_21.firstChild.firstChild.nodeValue;
+if(st=="("||st=="["||st=="{"){
+_21.removeChild(_21.firstChild);
+}
+}
+if(_21.nodeName=="mrow"){
+st=_21.lastChild.firstChild.nodeValue;
+if(st==")"||st=="]"||st=="}"){
+_21.removeChild(_21.lastChild);
+}
+}
+}
+var AMnestingDepth,AMpreviousSymbol,AMcurrentSymbol;
+function AMparseSexpr(str){
+var _24,node,result,i,st,newFrag=document.createDocumentFragment();
+str=AMremoveCharsAndBlanks(str,0);
+_24=AMgetSymbol(str);
+if(_24==null||_24.ttype==RIGHTBRACKET&&AMnestingDepth>0){
+return [null,str];
+}
+if(_24.ttype==DEFINITION){
+str=_24.output+AMremoveCharsAndBlanks(str,_24.input.length);
+_24=AMgetSymbol(str);
+}
+switch(_24.ttype){
+case UNDEROVER:
+case CONST:
+str=AMremoveCharsAndBlanks(str,_24.input.length);
+return [AMcreateMmlNode(_24.tag,document.createTextNode(_24.output)),str];
+case LEFTBRACKET:
+AMnestingDepth++;
+str=AMremoveCharsAndBlanks(str,_24.input.length);
+result=AMparseExpr(str,true);
+AMnestingDepth--;
+if(typeof _24.invisible=="boolean"&&_24.invisible){
+node=AMcreateMmlNode("mrow",result[0]);
+}else{
+node=AMcreateMmlNode("mo",document.createTextNode(_24.output));
+node=AMcreateMmlNode("mrow",node);
+node.appendChild(result[0]);
+}
+return [node,result[1]];
+case TEXT:
+if(_24!=AMquote){
+str=AMremoveCharsAndBlanks(str,_24.input.length);
+}
+if(str.charAt(0)=="{"){
+i=str.indexOf("}");
+}else{
+if(str.charAt(0)=="("){
+i=str.indexOf(")");
+}else{
+if(str.charAt(0)=="["){
+i=str.indexOf("]");
+}else{
+if(_24==AMquote){
+i=str.slice(1).indexOf("\"")+1;
+}else{
+i=0;
+}
+}
+}
+}
+if(i==-1){
+i=str.length;
+}
+st=str.slice(1,i);
+if(st.charAt(0)==" "){
+node=AMcreateElementMathML("mspace");
+node.setAttribute("width","1ex");
+newFrag.appendChild(node);
+}
+newFrag.appendChild(AMcreateMmlNode(_24.tag,document.createTextNode(st)));
+if(st.charAt(st.length-1)==" "){
+node=AMcreateElementMathML("mspace");
+node.setAttribute("width","1ex");
+newFrag.appendChild(node);
+}
+str=AMremoveCharsAndBlanks(str,i+1);
+return [AMcreateMmlNode("mrow",newFrag),str];
+case UNARY:
+str=AMremoveCharsAndBlanks(str,_24.input.length);
+result=AMparseSexpr(str);
+if(result[0]==null){
+return [AMcreateMmlNode(_24.tag,document.createTextNode(_24.output)),str];
+}
+if(typeof _24.func=="boolean"&&_24.func){
+st=str.charAt(0);
+if(st=="^"||st=="_"||st=="/"||st=="|"||st==","){
+return [AMcreateMmlNode(_24.tag,document.createTextNode(_24.output)),str];
+}else{
+node=AMcreateMmlNode("mrow",AMcreateMmlNode(_24.tag,document.createTextNode(_24.output)));
+node.appendChild(result[0]);
+return [node,result[1]];
+}
+}
+AMremoveBrackets(result[0]);
+if(_24.input=="sqrt"){
+return [AMcreateMmlNode(_24.tag,result[0]),result[1]];
+}else{
+if(typeof _24.acc=="boolean"&&_24.acc){
+node=AMcreateMmlNode(_24.tag,result[0]);
+node.appendChild(AMcreateMmlNode("mo",document.createTextNode(_24.output)));
+return [node,result[1]];
+}else{
+if(!isIE&&typeof _24.codes!="undefined"){
+for(i=0;i<result[0].childNodes.length;i++){
+if(result[0].childNodes[i].nodeName=="mi"||result[0].nodeName=="mi"){
+st=(result[0].nodeName=="mi"?result[0].firstChild.nodeValue:result[0].childNodes[i].firstChild.nodeValue);
+var _25=[];
+for(var j=0;j<st.length;j++){
+if(st.charCodeAt(j)>64&&st.charCodeAt(j)<91){
+_25=_25+String.fromCharCode(_24.codes[st.charCodeAt(j)-65]);
+}else{
+_25=_25+st.charAt(j);
+}
+}
+if(result[0].nodeName=="mi"){
+result[0]=AMcreateElementMathML("mo").appendChild(document.createTextNode(_25));
+}else{
+result[0].replaceChild(AMcreateElementMathML("mo").appendChild(document.createTextNode(_25)),result[0].childNodes[i]);
+}
+}
+}
+}
+node=AMcreateMmlNode(_24.tag,result[0]);
+node.setAttribute(_24.atname,_24.atval);
+return [node,result[1]];
+}
+}
+case BINARY:
+str=AMremoveCharsAndBlanks(str,_24.input.length);
+result=AMparseSexpr(str);
+if(result[0]==null){
+return [AMcreateMmlNode("mo",document.createTextNode(_24.input)),str];
+}
+AMremoveBrackets(result[0]);
+var _27=AMparseSexpr(result[1]);
+if(_27[0]==null){
+return [AMcreateMmlNode("mo",document.createTextNode(_24.input)),str];
+}
+AMremoveBrackets(_27[0]);
+if(_24.input=="root"||_24.input=="stackrel"){
+newFrag.appendChild(_27[0]);
+}
+newFrag.appendChild(result[0]);
+if(_24.input=="frac"){
+newFrag.appendChild(_27[0]);
+}
+return [AMcreateMmlNode(_24.tag,newFrag),_27[1]];
+case INFIX:
+str=AMremoveCharsAndBlanks(str,_24.input.length);
+return [AMcreateMmlNode("mo",document.createTextNode(_24.output)),str];
+case SPACE:
+str=AMremoveCharsAndBlanks(str,_24.input.length);
+node=AMcreateElementMathML("mspace");
+node.setAttribute("width","1ex");
+newFrag.appendChild(node);
+newFrag.appendChild(AMcreateMmlNode(_24.tag,document.createTextNode(_24.output)));
+node=AMcreateElementMathML("mspace");
+node.setAttribute("width","1ex");
+newFrag.appendChild(node);
+return [AMcreateMmlNode("mrow",newFrag),str];
+case LEFTRIGHT:
+AMnestingDepth++;
+str=AMremoveCharsAndBlanks(str,_24.input.length);
+result=AMparseExpr(str,false);
+AMnestingDepth--;
+var st="";
+if(result[0].lastChild!=null){
+st=result[0].lastChild.firstChild.nodeValue;
+}
+if(st=="|"){
+node=AMcreateMmlNode("mo",document.createTextNode(_24.output));
+node=AMcreateMmlNode("mrow",node);
+node.appendChild(result[0]);
+return [node,result[1]];
+}else{
+node=AMcreateMmlNode("mo",document.createTextNode(_24.output));
+node=AMcreateMmlNode("mrow",node);
+return [node,str];
+}
+default:
+str=AMremoveCharsAndBlanks(str,_24.input.length);
+return [AMcreateMmlNode(_24.tag,document.createTextNode(_24.output)),str];
+}
+}
+function AMparseIexpr(str){
+var _2a,sym1,sym2,node,result,underover;
+str=AMremoveCharsAndBlanks(str,0);
+sym1=AMgetSymbol(str);
+result=AMparseSexpr(str);
+node=result[0];
+str=result[1];
+_2a=AMgetSymbol(str);
+if(_2a.ttype==INFIX&&_2a.input!="/"){
+str=AMremoveCharsAndBlanks(str,_2a.input.length);
+result=AMparseSexpr(str);
+if(result[0]==null){
+result[0]=AMcreateMmlNode("mo",document.createTextNode("\u25a1"));
+}else{
+AMremoveBrackets(result[0]);
+}
+str=result[1];
+if(_2a.input=="_"){
+sym2=AMgetSymbol(str);
+underover=(sym1.ttype==UNDEROVER);
+if(sym2.input=="^"){
+str=AMremoveCharsAndBlanks(str,sym2.input.length);
+var _2b=AMparseSexpr(str);
+AMremoveBrackets(_2b[0]);
+str=_2b[1];
+node=AMcreateMmlNode((underover?"munderover":"msubsup"),node);
+node.appendChild(result[0]);
+node.appendChild(_2b[0]);
+node=AMcreateMmlNode("mrow",node);
+}else{
+node=AMcreateMmlNode((underover?"munder":"msub"),node);
+node.appendChild(result[0]);
+}
+}else{
+node=AMcreateMmlNode(_2a.tag,node);
+node.appendChild(result[0]);
+}
+}
+return [node,str];
+}
+function AMparseExpr(str,_2d){
+var _2e,node,result,i,nodeList=[],newFrag=document.createDocumentFragment();
+do{
+str=AMremoveCharsAndBlanks(str,0);
+result=AMparseIexpr(str);
+node=result[0];
+str=result[1];
+_2e=AMgetSymbol(str);
+if(_2e.ttype==INFIX&&_2e.input=="/"){
+str=AMremoveCharsAndBlanks(str,_2e.input.length);
+result=AMparseIexpr(str);
+if(result[0]==null){
+result[0]=AMcreateMmlNode("mo",document.createTextNode("\u25a1"));
+}else{
+AMremoveBrackets(result[0]);
+}
+str=result[1];
+AMremoveBrackets(node);
+node=AMcreateMmlNode(_2e.tag,node);
+node.appendChild(result[0]);
+newFrag.appendChild(node);
+_2e=AMgetSymbol(str);
+}else{
+if(node!=undefined){
+newFrag.appendChild(node);
+}
+}
+}while((_2e.ttype!=RIGHTBRACKET&&(_2e.ttype!=LEFTRIGHT||_2d)||AMnestingDepth==0)&&_2e!=null&&_2e.output!="");
+if(_2e.ttype==RIGHTBRACKET||_2e.ttype==LEFTRIGHT){
+var len=newFrag.childNodes.length;
+if(len>0&&newFrag.childNodes[len-1].nodeName=="mrow"&&len>1&&newFrag.childNodes[len-2].nodeName=="mo"&&newFrag.childNodes[len-2].firstChild.nodeValue==","){
+var _30=newFrag.childNodes[len-1].lastChild.firstChild.nodeValue;
+if(_30==")"||_30=="]"){
+var _31=newFrag.childNodes[len-1].firstChild.firstChild.nodeValue;
+if(_31=="("&&_30==")"&&_2e.output!="}"||_31=="["&&_30=="]"){
+var pos=[];
+var _33=true;
+var m=newFrag.childNodes.length;
+for(i=0;_33&&i<m;i=i+2){
+pos[i]=[];
+node=newFrag.childNodes[i];
+if(_33){
+_33=node.nodeName=="mrow"&&(i==m-1||node.nextSibling.nodeName=="mo"&&node.nextSibling.firstChild.nodeValue==",")&&node.firstChild.firstChild.nodeValue==_31&&node.lastChild.firstChild.nodeValue==_30;
+}
+if(_33){
+for(var j=0;j<node.childNodes.length;j++){
+if(node.childNodes[j].firstChild.nodeValue==","){
+pos[i][pos[i].length]=j;
+}
+}
+}
+if(_33&&i>1){
+_33=pos[i].length==pos[i-2].length;
+}
+}
+if(_33){
+var row,frag,n,k,table=document.createDocumentFragment();
+for(i=0;i<m;i=i+2){
+row=document.createDocumentFragment();
+frag=document.createDocumentFragment();
+node=newFrag.firstChild;
+n=node.childNodes.length;
+k=0;
+node.removeChild(node.firstChild);
+for(j=1;j<n-1;j++){
+if(typeof pos[i][k]!="undefined"&&j==pos[i][k]){
+node.removeChild(node.firstChild);
+row.appendChild(AMcreateMmlNode("mtd",frag));
+k++;
+}else{
+frag.appendChild(node.firstChild);
+}
+}
+row.appendChild(AMcreateMmlNode("mtd",frag));
+if(newFrag.childNodes.length>2){
+newFrag.removeChild(newFrag.firstChild);
+newFrag.removeChild(newFrag.firstChild);
+}
+table.appendChild(AMcreateMmlNode("mtr",row));
+}
+node=AMcreateMmlNode("mtable",table);
+if(typeof _2e.invisible=="boolean"&&_2e.invisible){
+node.setAttribute("columnalign","left");
+}
+newFrag.replaceChild(node,newFrag.firstChild);
+}
+}
+}
+}
+str=AMremoveCharsAndBlanks(str,_2e.input.length);
+if(typeof _2e.invisible!="boolean"||!_2e.invisible){
+node=AMcreateMmlNode("mo",document.createTextNode(_2e.output));
+newFrag.appendChild(node);
+}
+}
+return [newFrag,str];
+}
+function AMparseMath(str){
+var _38,node=AMcreateElementMathML("mstyle");
+if(mathcolor!=""){
+node.setAttribute("mathcolor",mathcolor);
+}
+if(displaystyle){
+node.setAttribute("displaystyle","true");
+}
+if(mathfontfamily!=""){
+node.setAttribute("fontfamily",mathfontfamily);
+}
+AMnestingDepth=0;
+node.appendChild(AMparseExpr(str.replace(/^\s+/g,""),false)[0]);
+node=AMcreateMmlNode("math",node);
+if(showasciiformulaonhover){
+node.setAttribute("title",str.replace(/\s+/g," "));
+}
+if(mathfontfamily!=""&&(isIE||mathfontfamily!="serif")){
+var _39=AMcreateElementXHTML("font");
+_39.setAttribute("face",mathfontfamily);
+_39.appendChild(node);
+return _39;
+}
+return node;
+}
+function AMstrarr2docFrag(arr,_3b){
+var _3c=document.createDocumentFragment();
+var _3d=false;
+for(var i=0;i<arr.length;i++){
+if(_3d){
+_3c.appendChild(AMparseMath(arr[i]));
+}else{
+var _3f=(_3b?arr[i].split("\n\n"):[arr[i]]);
+_3c.appendChild(AMcreateElementXHTML("span").appendChild(document.createTextNode(_3f[0])));
+for(var j=1;j<_3f.length;j++){
+_3c.appendChild(AMcreateElementXHTML("p"));
+_3c.appendChild(AMcreateElementXHTML("span").appendChild(document.createTextNode(_3f[j])));
+}
+}
+_3d=!_3d;
+}
+return _3c;
+}
+function AMprocessNodeR(n,_42){
+var _43,str,arr,frg,i;
+if(n.childNodes.length==0){
+if((n.nodeType!=8||_42)&&n.parentNode.nodeName!="form"&&n.parentNode.nodeName!="FORM"&&n.parentNode.nodeName!="textarea"&&n.parentNode.nodeName!="TEXTAREA"&&n.parentNode.nodeName!="pre"&&n.parentNode.nodeName!="PRE"){
+str=n.nodeValue;
+if(!(str==null)){
+str=str.replace(/\r\n\r\n/g,"\n\n");
+if(doubleblankmathdelimiter){
+str=str.replace(/\x20\x20\./g," "+AMdelimiter1+".");
+str=str.replace(/\x20\x20,/g," "+AMdelimiter1+",");
+str=str.replace(/\x20\x20/g," "+AMdelimiter1+" ");
+}
+str=str.replace(/\x20+/g," ");
+str=str.replace(/\s*\r\n/g," ");
+_43=false;
+str=str.replace(new RegExp(AMescape2,"g"),function(st){
+_43=true;
+return "AMescape2";
+});
+str=str.replace(new RegExp(AMescape1,"g"),function(st){
+_43=true;
+return "AMescape1";
+});
+str=str.replace(new RegExp(AMdelimiter2regexp,"g"),AMdelimiter1);
+arr=str.split(AMdelimiter1);
+for(i=0;i<arr.length;i++){
+arr[i]=arr[i].replace(/AMescape2/g,AMdelimiter2).replace(/AMescape1/g,AMdelimiter1);
+}
+if(arr.length>1||_43){
+if(checkForMathML){
+checkForMathML=false;
+var nd=AMisMathMLavailable();
+AMnoMathML=nd!=null;
+if(AMnoMathML&&notifyIfNoMathML){
+if(alertIfNoMathML){
+alert("To view the ASCIIMathML notation use Internet Explorer 6 +\nMathPlayer (free from www.dessci.com)\n                or Firefox/Mozilla/Netscape");
+}else{
+AMbody.insertBefore(nd,AMbody.childNodes[0]);
+}
+}
+}
+if(!AMnoMathML){
+frg=AMstrarr2docFrag(arr,n.nodeType==8);
+var len=frg.childNodes.length;
+n.parentNode.replaceChild(frg,n);
+return len-1;
+}else{
+return 0;
+}
+}
+}
+}else{
+return 0;
+}
+}else{
+if(n.nodeName!="math"){
+for(i=0;i<n.childNodes.length;i++){
+i+=AMprocessNodeR(n.childNodes[i],_42);
+}
+}
+}
+return 0;
+}
+function AMprocessNode(n,_49,_4a){
+var _4b,st;
+if(_4a!=null){
+_4b=document.getElementsByTagName("span");
+for(var i=0;i<_4b.length;i++){
+if(_4b[i].className=="AM"){
+AMprocessNodeR(_4b[i],_49);
+}
+}
+}else{
+try{
+st=n.innerHTML;
+}
+catch(err){
+}
+if(st==null||st.indexOf(AMdelimiter1)!=-1||st.indexOf(AMdelimiter2)!=-1){
+AMprocessNodeR(n,_49);
+}
+}
+if(isIE){
+_4b=document.getElementsByTagName("math");
+for(var i=0;i<_4b.length;i++){
+_4b[i].update();
+}
+}
+}
+var AMbody;
+var AMnoMathML=false,AMtranslated=false;
+function translate(_4d){
+if(!AMtranslated){
+AMtranslated=true;
+AMinitSymbols();
+AMbody=document.getElementsByTagName("body")[0];
+AMprocessNode(AMbody,false,_4d);
+}
+}
+if(isIE){
+document.write("<object id=\"mathplayer\"  classid=\"clsid:32F66A20-7614-11D4-BD11-00104BD3F987\"></object>");
+document.write("<"+"?import namespace=\"m\" implementation=\"#mathplayer\"?>");
+}
+function generic(){
+translate();
+}
+if(typeof window.addEventListener!="undefined"){
+window.addEventListener("load",generic,false);
+}else{
+if(typeof document.addEventListener!="undefined"){
+document.addEventListener("load",generic,false);
+}else{
+if(typeof window.attachEvent!="undefined"){
+window.attachEvent("onload",generic);
+}else{
+if(typeof window.onload=="function"){
+var existing=onload;
+window.onload=function(){
+existing();
+generic();
+};
+}else{
+window.onload=generic;
+}
+}
+}
+}
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/equation.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Equation/equation.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,146 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/Equation/equation.js */
+function Equation(_1){
+this.editor=_1;
+var _2=_1.config;
+var _3=this;
+_2.registerButton({id:"equation",tooltip:this._lc("Formula Editor"),image:_1.imgURL("equation.gif","Equation"),textMode:false,action:function(_4,id){
+_3.buttonPress(_4,id);
+}});
+_2.addToolbarElement("equation","inserthorizontalrule",-1);
+mathcolor=_2.Equation.mathcolor;
+mathfontfamily=_2.Equation.mathfontfamily;
+this.enabled=!Xinha.is_ie;
+if(this.enabled){
+this.onBeforeSubmit=this.onBeforeUnload=function(){
+_3.unParse();
+};
+}
+if(typeof AMprocessNode!="function"){
+Xinha._loadback(Xinha.getPluginDir("Equation")+"/ASCIIMathML.js",function(){
+translate();
+});
+}
+}
+Xinha.Config.prototype.Equation={"mathcolor":"black","mathfontfamily":"serif"};
+Equation._pluginInfo={name:"ASCIIMathML Formula Editor",version:"2.3 (2008-01-26)",developer:"Raimund Meyer",developer_url:"http://xinha.raimundmeyer.de",c_owner:"",sponsor:"",sponsor_url:"",license:"GNU/LGPL"};
+Equation.prototype._lc=function(_6){
+return Xinha._lc(_6,"Equation");
+};
+Equation.prototype.onGenerate=function(){
+this.parse();
+};
+Equation.prototype.onKeyPress=function(ev){
+if(this.enabled){
+e=this.editor;
+var _8=e._getFirstAncestor(e.getSelection(),["span"]);
+if(_8&&_8.className=="AM"){
+if(ev.keyCode==8||ev.keyCode==46||ev.charCode){
+Xinha._stopEvent(ev);
+return true;
+}
+}
+}
+return false;
+};
+Equation.prototype.onBeforeMode=function(_9){
+if(this.enabled&&_9=="textmode"){
+this.unParse();
+}
+};
+Equation.prototype.onMode=function(_a){
+if(this.enabled&&_a=="wysiwyg"){
+this.parse();
+}
+};
+Equation.prototype.parse=function(){
+if(this.enabled){
+var _b=this.editor._doc;
+var _c=_b.getElementsByTagName("span");
+for(var i=0;i<_c.length;i++){
+var _e=_c[i];
+if(_e.className!="AM"){
+continue;
+}
+if(_e.innerHTML.indexOf(this.editor.cc)!=-1){
+_e.innerHTML=_e.innerHTML.replace(this.editor.cc,"");
+_e.parentNode.insertBefore(_b.createTextNode(this.editor.cc),_e);
+}
+_e.title=_e.innerHTML;
+var _f=_e.cloneNode(true);
+try{
+document.adoptNode(_f);
+}
+catch(e){
+}
+AMprocessNode(_f,false);
+try{
+_b.adoptNode(_f);
+}
+catch(e){
+}
+_e.parentNode.replaceChild(_f,_e);
+_f.parentNode.insertBefore(_b.createTextNode(String.fromCharCode(32)),_f);
+_f.parentNode.insertBefore(_b.createTextNode(String.fromCharCode(32)),_f.nextSibling);
+}
+}
+};
+Equation.prototype.unParse=function(){
+var doc=this.editor._doc;
+var _11=doc.getElementsByTagName("span");
+for(var i=0;i<_11.length;i++){
+var _13=_11[i];
+if(_13.className.indexOf("AM")==-1||_13.getElementsByTagName("math").length==0){
+continue;
+}
+var _14=_13.getAttribute("title");
+_13.innerHTML=_14;
+_13.setAttribute("title",null);
+}
+};
+Equation.prototype.buttonPress=function(){
+var _15=this;
+var _16=this.editor;
+var _17={};
+_17["editor"]=_16;
+var _18=_16._getFirstAncestor(_16.getSelection(),["span"]);
+if(_18){
+_17["editedNode"]=_18;
+}
+Dialog(Xinha.getPluginDir("Equation")+"/popups/dialog.html",function(_19){
+_15.insert(_19);
+},_17);
+};
+Equation.prototype.insert=function(_1a){
+if(typeof _1a["formula"]!="undefined"){
+var _1b=(_1a["formula"]!="")?_1a["formula"].replace(/^`?(.*)`?$/m,"`$1`"):"";
+if(_1a["editedNode"]&&(_1a["editedNode"].tagName.toLowerCase()=="span")){
+var _1c=_1a["editedNode"];
+if(_1b!=""){
+_1c.innerHTML=_1b;
+if(this.enabled){
+_1c.title=_1b;
+}
+}else{
+_1c.parentNode.removeChild(_1c);
+}
+}else{
+if(!_1a["editedNode"]&&_1b!=""){
+if(this.enabled){
+var _1c=document.createElement("span");
+_1c.className="AM";
+this.editor.insertNodeAtSelection(_1c);
+_1c.innerHTML=_1b;
+_1c.title=_1b;
+}else{
+this.editor.insertHTML("<span class=\"AM\">"+_1b+"</span>");
+}
+}
+}
+if(this.enabled){
+this.parse();
+}
+}
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/example.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Equation/example.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,45 @@
+<!DOCTYPE html
+     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
+    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
+
+<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
+<head>
+  <title>AsciiMathML Example</title>
+  <script type="text/javascript">
+    var mathcolor = "black"; 
+  </script>
+  <script type="text/javascript" src="ASCIIMathML.js"></script>
+<style type="text/css">
+  body { font-family: sans-serif }
+  pre {border: dotted grey thin; background-color:LightYellow; }
+  
+  </style>
+</head>
+
+<body >
+<h1>AsciiMathML Example</h1>
+<p>This shows how to set up your page to display MathML using AsciiMathML</p>
+<p>Add this to the head section of your document:</p>
+<pre>
+
+  &lt;!-- This block is optional configuration --&gt;
+  &lt;script type="text/javascript"&gt;
+    var mathcolor = "black"; // You may change the color of the formulae (default: red)
+    var showasciiformulaonhover = false; // helps students learn ASCIIMath, set to false if you like  (default:true)
+    var mathfontfamily = "Arial"; //and the font (default: serif, which is good I think)
+  &lt;/script&gt;
+  &lt;!-- THIS LOADS THE ACTUAL SCRIPT, PLEASE ADJUST THE URL --&lt;
+  &lt;script type="text/javascript" src="/xinha/plugins/Equation/ASCIIMathML.js"&gt;&lt;/script&gt;
+
+
+</pre>
+<p><span class="AM">`int_a^bf(x)dx`</span></p>
+<p><span class="AM">`[[a,b],[c,d]]`</span><br /></p>
+<p>
+ ASCIIMathML by <a href="http://www.chapman.edu/~jipsen" onclick="window.open(this.href,'_blank');return false;">Peter Jipsen</a>, 
+<a href="http://www.chapman.edu" onclick="window.open(this.href,'_blank');return false;">Chapman University</a><br />
+  For more information on AsciiMathML visit this page: <a href="http://www1.chapman.edu/~jipsen/mathml/asciimath.html" onclick="window.open(this.href,'_blank','');return false;">http://www1.chapman.edu/~jipsen/mathml/asciimath.html</a>
+
+</p>
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/img/abs_value.gif
Binary file Xinha_0.95/plugins/Equation/img/abs_value.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/img/diag_fraction.gif
Binary file Xinha_0.95/plugins/Equation/img/diag_fraction.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/img/divide.gif
Binary file Xinha_0.95/plugins/Equation/img/divide.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/img/dsp_greater_equal.gif
Binary file Xinha_0.95/plugins/Equation/img/dsp_greater_equal.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/img/dsp_less_equal.gif
Binary file Xinha_0.95/plugins/Equation/img/dsp_less_equal.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/img/dsp_notequal.gif
Binary file Xinha_0.95/plugins/Equation/img/dsp_notequal.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/img/equation.gif
Binary file Xinha_0.95/plugins/Equation/img/equation.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/img/equation.old.gif
Binary file Xinha_0.95/plugins/Equation/img/equation.old.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/img/greater_equal_than.gif
Binary file Xinha_0.95/plugins/Equation/img/greater_equal_than.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/img/hor_fraction.gif
Binary file Xinha_0.95/plugins/Equation/img/hor_fraction.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/img/less_equal_than.gif
Binary file Xinha_0.95/plugins/Equation/img/less_equal_than.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/img/mul.gif
Binary file Xinha_0.95/plugins/Equation/img/mul.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/img/notequal.gif
Binary file Xinha_0.95/plugins/Equation/img/notequal.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/img/parenthesis.gif
Binary file Xinha_0.95/plugins/Equation/img/parenthesis.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/img/root.gif
Binary file Xinha_0.95/plugins/Equation/img/root.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/img/square_root.gif
Binary file Xinha_0.95/plugins/Equation/img/square_root.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/lang/de.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Equation/lang/de.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,23 @@
+// I18N constants
+//
+//LANG: "base", ENCODING: UTF-8
+//Author: Translator-Name, <email@example.com>
+// FOR TRANSLATORS:
+//
+//   1. PLEASE PUT YOUR CONTACT INFO IN THE ABOVE LINE
+//      (at least a valid email address)
+//
+//   2. PLEASE TRY TO USE UTF-8 FOR ENCODING;
+//      (if this is not possible, please include a comment
+//       that states what encoding is necessary.)
+
+{
+  "AsciiMath Formula Input": "AsciiMath Formeleditor",
+  "Formula Editor": "Formeleditor",
+  "Input":"Eingabe",
+  "Preview":"Vorschau",
+  "Based on ASCIIMathML by ": "Basiert auf ASCIIMathML von ",
+  "For more information on AsciiMathML visit this page: ":"Fr weitere Informationen besuchen Sie bitte diese Seite: ",
+  'Attention Internet Explorer users: Please note that there is no WYSIWYG representation of the formula in the editor!<br />You might wish to use <a href="http://www.mozilla.com" onclick="window.open(this.href,\'_blank\');return false;">Mozilla Firefox</a> instead.' : 'Achtung Internet Explorer-Benutzer: Die Formel wird im Editor nicht als WYSIWYG dargestellt.<br />Benutzen Sie <a href="http://www.mozilla.com" target="_blank">Mozilla Firefox</a> als Alternative.',
+  "Show MathML" : "Zeige MathML"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/lang/ja.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Equation/lang/ja.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,11 @@
+// I18N constants
+// LANG: "ja", ENCODING: UTF-8
+{
+  "AsciiMath Formula Input": "AsciiMath ",
+  "Formula Editor": "",
+  "Input":"",
+  "Preview":"",
+  "Based on ASCIIMathML by ": "Based on ASCIIMathML by ",
+  "For more information on AsciiMathML visit this page: ":"AsciiMath: ",
+  "Attention: Editing the formula in the editor is not possible, please use this dialog!" : ": "
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/lang/nl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Equation/lang/nl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,13 @@
+// I18N constants
+// LANG: "nl", ENCODING: UTF-8
+// Author: Maarten Molenschot, maarten@nrgmm.nl
+
+{
+  "AsciiMath Formula Input": "AsciiMath Formule Invoeren",
+  "Formula Editor": "Formule Invoeren",
+  "Input":"Invoer",
+  "Preview":"Voorbeeld",
+  "Based on ASCIIMathML by ": "Gebasseerd op  ASCIIMathML van ",
+  "For more information on AsciiMathML visit this page: ":"Voor meer informatie over AsciiMathML ga je naar: ",
+  "Attention: Editing the formula in the editor is not possible, please use this dialog!" : "Let op! het bewerken van de formule in de editor is niet mogelijk, gebruik dit dialoog!"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Equation/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,36 @@
+// I18N constants
+
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+
+// Last revision: 05 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "&quot;text&quot;": "&quot;text&quot;",
+  "AsciiMath Formula Input": "Inserir Frmula AsciiMath",
+  "AsciiMathML Example": "Exemplo AsciiMathML",
+  "Based on ASCIIMathML by": "Baseado no ASCIIMathML por",
+  "Cancel": "Cancelar",
+  "Equation": "Equao",
+  "For more information on AsciiMathML visit this page:": "Para maiores informaes do AsciiMathML visite este site:",
+  "Formula Editor": "Editor de Frmula",
+  "Input": "Entrada",
+  "Insert": "Inserir",
+  "Preview": "Visualizar",
+  "Select operation": "Selecionar operao",
+  "`&quot;text&quot;`": "`&quot;texto&quot;`",
+
+  // new messages - see: http://xinha.webfactional.com/wiki/TranslationChanges
+  "Attention Internet Explorer users: Please note that there is no WYSIWYG representation of the formula in the editor! You might wish to use Mozilla Firefox instead.": "Ateno usurios do Internet Explorer: Observe que no  possvel representar frmulas no editor no modo de visualizao!  preferivelmente que voc utilize o Mozilla Firefox.",
+  "Show MathML": "Mostrar MathML", 
+  // removed old messages - see: http://xinha.webfactional.com/wiki/TranslationChanges
+  "Attention: Editing the formula in the editor is not possible, please use this dialog!": "Ateno: No  possvel editar a frmula no editor. Ppor favor, utilize este caixa de dilogo!"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/popups/dialog.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Equation/popups/dialog.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,358 @@
+<!DOCTYPE html
+     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
+    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
+
+<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
+<head>
+  <title>AsciiMath Formula Input</title>
+  <script type="text/javascript" src="../../../popups/popup.js"></script>
+  <script type="text/javascript" src="../ASCIIMathML.js"></script>
+  <link rel="stylesheet" type="text/css" href="../../../popups/popup.css" />
+
+  <style type="text/css">
+	/* <![CDATA[ */
+	#outputNode,#inputText,#mathml {
+		padding:5px;
+		background-color:white;
+		width:98%;
+		height:200px;
+		font-size:1.3em;
+		border: 1px solid darkgrey;
+		overflow:auto;
+	}
+	#clickInput {
+		width:100%;
+		border-collapse:collapse;
+		background-color: white;
+		text-align:center;
+	}
+	#clickInput td {
+		border: thin solid gray;
+		cursor:pointer;
+		font-size:1.1em;
+		
+	}
+	h3 {
+		font-size:1.6em;
+	}
+	/* ]]> */
+  </style>
+  <script type="text/javascript">
+ // <![CDATA[
+   window.resizeTo(500, 300);
+var showasciiformulaonhover = false;
+if (typeof Xinha == "undefined")
+	Xinha = window.opener.Xinha;
+
+function i18n(str) {
+  return (Xinha._lc(str, 'Equation'));
+}
+function set (string)
+{
+	var inputField = document.getElementById("inputText");
+	inputField.value += string;
+	preview();
+	inputField.focus();
+	return false;
+}
+function preview() {
+  if (document.getElementById("inputText") != '') {
+      var str = document.getElementById("inputText").value;
+      var outnode = document.getElementById("outputNode");
+      var newnode = AMcreateElementXHTML("div");
+      newnode.setAttribute("id","outputNode");
+      outnode.parentNode.replaceChild(newnode,outnode);
+      outnode = document.getElementById("outputNode");
+      var n = outnode.childNodes.length;
+      for (var i = 0; i < n; i++)
+        outnode.removeChild(outnode.firstChild);
+      outnode.appendChild(document.createComment("`"+str+"`"));
+      AMprocessNode(outnode,true);
+  }
+}
+function Init() {
+	__dlg_translate('Equation');
+	__dlg_init();
+	var param = window.dialogArguments;
+	var cfg = param["editor"].config;
+	
+	mathcolor = cfg.Equation.mathcolor;
+	mathfontfamily = cfg.Equation.mathfontfamily;
+	
+	translate();
+	var inputField = document.getElementById("inputText"); 
+	
+	if (param["editedNode"] && param["editedNode"].tagName.toLowerCase() == 'span')
+	{
+		var formula = param["editedNode"].getAttribute("title").replace(/^`*(.*?)`*$/m,"$1");
+		if (!formula) formula = param["editedNode"].innerHTML.replace(/^`*(.*?)`*$/m,"$1"); 
+		inputField.value = formula;
+		preview();
+	}
+	else inputField.value = '';
+	inputField.focus();
+}
+  
+function onOK() {
+ 	
+ var param = {
+ 	"editedNode":window.dialogArguments.editedNode,
+ 	"formula" : document.getElementById("inputText").value
+ };
+ 
+ __dlg_close(param);
+  return false;
+}
+
+function onCancel() {
+  __dlg_close(null);
+  return false;
+}
+
+function translate() {
+  if (!AMtranslated) { // run this only once
+    AMtranslated = true;
+    AMinitSymbols();
+    AMprocessNode(document.getElementById("clickInput"),true);
+    preview();
+  }
+}
+window.onload = Init;
+
+function AMnode2string(inNode,indent) {
+// thanks to James Frazer for contributing an initial version of this function
+   var i, str = "";
+   if(inNode.nodeType == 1) {
+       var name = inNode.nodeName.toLowerCase(); // (IE fix)
+       str = "\r" + indent + "<" + name;
+       for(i=0; i < inNode.attributes.length; i++)
+           if (inNode.attributes[i].nodeValue!="italic" &&
+               inNode.attributes[i].nodeValue!="" &&  //stop junk attributes
+               inNode.attributes[i].nodeValue!="inherit" && // (mostly IE)
+               inNode.attributes[i].nodeValue!=undefined &&
+               inNode.attributes[i].nodeName[0] != '-'
+               )
+               str += " "+inNode.attributes[i].nodeName+"="+
+                     "\""+inNode.attributes[i].nodeValue+"\"";
+       if (name == "math") 
+           str += " xmlns=\"http://www.w3.org/1998/Math/MathML\"";
+       str += ">";
+       for(i=0; i<inNode.childNodes.length; i++)
+           str += AMnode2string(inNode.childNodes[i], indent+"  ");
+       if (name != "mo" && name != "mi" && name != "mn") str += "\r"+indent;
+       str += "</" + name + ">";
+   }
+   else if(inNode.nodeType == 3) {
+       var st = inNode.nodeValue;
+       for (i=0; i<st.length; i++)
+           if (st.charCodeAt(i)<32 || st.charCodeAt(i)>126)
+               str += "&#"+st.charCodeAt(i)+";";
+           else if (st.charAt(i)=="<" && indent != "  ") str += "&lt;";
+           else if (st.charAt(i)==">" && indent != "  ") str += "&gt;";
+           else if (st.charAt(i)=="&" && indent != "  ") str += "&amp;";
+           else str += st.charAt(i);
+   }
+   return str;
+} 
+function showMathML()
+{
+	var math = document.getElementById("outputNode").getElementsByTagName("math")[0];
+	if (math)
+		math.parentNode.innerHTML = '<pre>'+Xinha.htmlEncode(AMnode2string(math,''))+'</pre>';
+}
+// ]]>
+</script>
+
+</head>
+
+<body class="dialog">
+<div class="title">AsciiMath Formula Input</div>
+<!--
+Table modified from CharacterMap for ASCIIMathML by Peter Jipsen
+HTMLSource based on HTMLArea XTD 1.5 (http://mosforge.net/projects/htmlarea3xtd/) modified by Holger Hees
+Original Author - Bernhard Pfeifer novocaine@gmx.net
+-->
+<table  id="clickInput">
+<tr>
+<td colspan="3" class="character" title="(x+1)/(x-1)" onclick="set('(x+1)/(x-1)')">`(x+1)/(x-1)`</td>
+<td colspan="2" class="character" title="x^(m+n)" onclick="set('x^(m+n)')">`x^(m+n)`</td>
+<td colspan="2" class="character" title="x_(mn)" onclick="set('x_(mn)')">`x_(mn)`</td>
+<td colspan="2" class="character" title="sqrt(x)" onclick="set('sqrt(x)')">`sqrt(x)`</td>
+<td colspan="3" class="character" title="root(n)(x)" onclick="set('root(n)(x)')">`root(n)(x)`</td>
+<td colspan="2" class="character" title="&quot;text&quot;" onclick="set('&quot;text&quot;')">`&quot;text&quot;`</td>
+<td colspan="2" class="character" style="cursor:default"></td>
+</tr><tr>
+<td colspan="2" class="character" title="dy/dx" onclick="set('dy/dx')">`dy/dx`</td>
+<td colspan="3" class="character" title="lim_(x-&gt;oo)" onclick="set('lim_(x-&gt;oo)')">`lim_(x-&gt;oo)`</td>
+<td colspan="3" class="character" title="sum_(n=1)^oo" onclick="set('sum_(n=1)^oo')">`sum_(n=1)^oo`</td>
+<td colspan="3" class="character" title="int_a^bf(x)dx" onclick="set('int_a^bf(x)dx')">`int_a^bf(x)dx`</td>
+<td colspan="3" class="character" title="[[a,b],[c,d]]" onclick="set('[[a,b],[c,d]]')">`[[a,b],[c,d]]`</td>
+<td colspan="2" class="character" title="((n),(k))" onclick="set('((n),(k))')">`((n),(k))`</td>
+</tr><tr>
+<td class="character" title="*" onclick="set('*')">`*`</td>
+<td class="character" title="**" onclick="set('**')">`**`</td>
+<td class="character" title="//" onclick="set('//')">`//`</td>
+<td class="character" title="\\" onclick="set('\\\\')">`\\`</td>
+<td class="character" title="xx" onclick="set('xx')">`xx`</td>
+<td class="character" title="-:" onclick="set('-:')">`-:`</td>
+<td class="character" title="@" onclick="set('@')">`@`</td>
+<td class="character" title="o+" onclick="set('o+')">`o+`</td>
+<td class="character" title="ox" onclick="set('ox')">`ox`</td>
+<td class="character" title="o." onclick="set('o.')">`o.`</td>
+<td class="character" title="sum" onclick="set('sum')">`sum`</td>
+<td class="character" title="prod" onclick="set('prod')">`prod`</td>
+<td class="character" title="^^" onclick="set('^^')">`^^`</td>
+<td class="character" title="^^^" onclick="set('^^^')"><span style="font-size:larger">`&and;`</span></td>
+<td class="character" title="vv" onclick="set('vv')">`vv`</td>
+<td class="character" title="vvv" onclick="set('vvv')"><span style="font-size:larger">`&or;`</span></td>
+</tr><tr>
+<td class="character" title="!=" onclick="set('!=')">`!=`</td>
+<td class="character" title="&lt;=" onclick="set('&lt;=')">`&lt;=`</td>
+<td class="character" title="&gt;=" onclick="set('&gt;=')">`&gt;=`</td>
+<td class="character" title="-&lt;" onclick="set('-&lt;')">`-&lt;`</td>
+<td class="character" title="&gt;-" onclick="set('&gt;-')">`&gt;-`</td>
+<td class="character" title="in" onclick="set('in')">`in`</td>
+<td class="character" title="!in" onclick="set('!in')">`!in`</td>
+<td class="character" title="sub" onclick="set('sub')">`sub`</td>
+<td class="character" title="sup" onclick="set('sup')">`sup`</td>
+<td class="character" title="sube" onclick="set('sube')">`sube`</td>
+<td class="character" title="supe" onclick="set('supe')">`supe`</td>
+<td class="character" title="O/" onclick="set('O/')">`O/`</td>
+<td class="character" title="nn" onclick="set('nn')">`nn`</td>
+<td class="character" title="nnn" onclick="set('nnn')"><span style="font-size:larger">`&cap;`</span></td>
+<td class="character" title="uu" onclick="set('uu')">`uu`</td>
+<td class="character" title="uuu" onclick="set('uuu')"><span style="font-size:larger">`&cup;`</span></td>
+</tr><tr>
+<td class="character" title="and" onclick="set('and')">`and`</td>
+<td class="character" title="or" onclick="set('or')">`or`</td>
+<td class="character" title="not" onclick="set('not')">`not`</td>
+<td class="character" title="=&gt;" onclick="set('==&gt;')">`=&gt;`</td>
+<td class="character" title="if" onclick="set('if')">`if`</td>
+<td class="character" title="&lt;=&gt;" onclick="set('&lt;=&gt;')">`&lt;=&gt;`</td>
+<td class="character" title="AA" onclick="set('AA')">`AA`</td>
+<td class="character" title="EE" onclick="set('EE')">`EE`</td>
+<td class="character" title="_|_" onclick="set('_|_')">`_|_`</td>
+<td class="character" title="TT" onclick="set('TT')">`TT`</td>
+<td class="character" title="|--" onclick="set('|--')">`|--`</td>
+<td class="character" title="|==" onclick="set('|==')">`|==`</td>
+<td class="character" title="-=" onclick="set('-=')">`-=`</td>
+<td class="character" title="~=" onclick="set('~=')">`~=`</td>
+<td class="character" title="~~" onclick="set('~~')">`~~`</td>
+<td class="character" title="prop" onclick="set('prop')">`prop`</td>
+</tr><tr>
+<td class="character" title="int" onclick="set('int')">`int`</td>
+<td class="character" title="oint" onclick="set('oint')">`oint`</td>
+<td class="character" title="del" onclick="set('del')">`del`</td>
+<td class="character" title="grad" onclick="set('grad')">`grad`</td>
+<td class="character" title="+-" onclick="set('+-')">`+-`</td>
+<td class="character" title="oo" onclick="set('oo')">`oo`</td>
+<td class="character" title="aleph" onclick="set('aleph')">`aleph`</td>
+<td class="character" title="quad" onclick="set('quad')">`quad`</td>
+<td class="character" title="diamond" onclick="set('diamond')">`diamond`</td>
+<td class="character" title="square" onclick="set('square')">`square`</td>
+<td class="character" title="|__" onclick="set('|__')">`|__`</td>
+<td class="character" title="__|" onclick="set('__|')">`__|`</td>
+<td class="character" title="|~" onclick="set('|~')">`|~`</td>
+<td class="character" title="~|" onclick="set('~|')">`~|`</td>
+<td class="character" title="&lt;x&gt;" onclick="set('&lt;x&gt;')">`&lt;x&gt;`</td>
+<td class="character" title="/_" onclick="set('/_')">`/_`</td>
+</tr><tr>
+<td class="character" title="uarr" onclick="set('uarr')">`uarr`</td>
+<td class="character" title="darr" onclick="set('darr')">`darr`</td>
+<td class="character" title="larr" onclick="set('larr')">`larr`</td>
+<td class="character" title="-&gt;" onclick="set('-&gt;')">`-&gt;`</td>
+<td class="character" title="|-&gt;" onclick="set('|-&gt;')">`|-&gt;`</td>
+<td class="character" title="harr" onclick="set('harr')">`harr`</td>
+<td class="character" title="lArr" onclick="set('lArr')">`lArr`</td>
+<td class="character" title="rArr" onclick="set('rArr')">`rArr`</td>
+<td class="character" title="hArr" onclick="set('hArr')">`hArr`</td>
+<td class="character" title="hata" onclick="set('hat')">`hata`</td>
+<td class="character" title="ula" onclick="set('ul')">`ula`</td>
+<td class="character" title="dota" onclick="set('dot')">`dota`</td>
+<td class="character" title="ddota" onclick="set('ddot')">`ddota`</td>
+<td class="character" title="veca" onclick="set('vec')">`veca`</td>
+<td class="character" title="bara" onclick="set('bar')">`bara`</td>
+<td class="character" title=":." onclick="set(':.')">`:.`</td>
+</tr><tr>
+<td class="character" title="NN" onclick="set('NN')">`NN`</td>
+<td class="character" title="ZZ" onclick="set('ZZ')">`ZZ`</td>
+<td class="character" title="QQ" onclick="set('QQ')">`QQ`</td>
+<td class="character" title="RR" onclick="set('RR')">`RR`</td>
+<td class="character" title="CC" onclick="set('CC')">`CC`</td>
+<td class="character" title="bba" onclick="set('bb')">`bba`</td>
+<td class="character" title="bbba" onclick="set('bbb')">`bbba`</td>
+<td class="character" title="cca" onclick="set('cc')">`cca`</td>
+<td class="character" title="fra" onclick="set('fr')">`fra`</td>
+<td class="character" title="sfa" onclick="set('sf')">`sfa`</td>
+<td class="character" title="tta" onclick="set('tt')">`tta`</td>
+<td colspan="4" class="character" title="stackrel(-&gt;)(+)" onclick="set('stackrel(-&gt;)(+)')">`stackrel(-&gt;)(+)`</td>
+<td class="character" title="upsilon" onclick="set('upsilon')">`upsilon`</td>
+</tr><tr>
+<td class="character" title="alpha" onclick="set('alpha')">`alpha`</td>
+<td class="character" title="beta" onclick="set('beta')">`beta`</td>
+<td class="character" title="gamma" onclick="set('gamma')">`gamma`</td>
+<td class="character" title="Gamma" onclick="set('Gamma')">`Gamma`</td>
+<td class="character" title="delta" onclick="set('delta')">`delta`</td>
+<td class="character" title="Delta" onclick="set('Delta')">`Delta`</td>
+<td class="character" title="epsi" onclick="set('epsi')">`epsi`</td>
+<td class="character" title="zeta" onclick="set('zeta')">`zeta`</td>
+<td class="character" title="eta" onclick="set('eta')">`eta`</td>
+<td class="character" title="theta" onclick="set('theta')">`theta`</td>
+<td class="character" title="Theta" onclick="set('Theta')">`Theta`</td>
+<td class="character" title="iota" onclick="set('iota')">`iota`</td>
+<td class="character" title="kappa" onclick="set('kappa')">`kappa`</td>
+<td class="character" title="lambda" onclick="set('lambda')">`lambda`</td>
+<td class="character" title="Lambda" onclick="set('Lambda')">`Lambda`</td>
+<td class="character" title="mu" onclick="set('mu')">`mu`</td>
+</tr><tr>
+<td class="character" title="nu" onclick="set('nu')">`nu`</td>
+<td class="character" title="pi" onclick="set('pi')">`pi`</td>
+<td class="character" title="Pi" onclick="set('Pi')">`Pi`</td>
+<td class="character" title="rho" onclick="set('rho')">`rho`</td>
+<td class="character" title="sigma" onclick="set('sigma')">`sigma`</td>
+<td class="character" title="Sigma" onclick="set('Sigma')">`Sigma`</td>
+<td class="character" title="tau" onclick="set('tau')">`tau`</td>
+<td class="character" title="xi" onclick="set('xi')">`xi`</td>
+<td class="character" title="Xi" onclick="set('Xi')">`Xi`</td>
+<td class="character" title="phi" onclick="set('phi')">`phi`</td>
+<td class="character" title="Phi" onclick="set('Phi')">`Phi`</td>
+<td class="character" title="chi" onclick="set('chi')">`chi`</td>
+<td class="character" title="psi" onclick="set('psi')">`psi`</td>
+<td class="character" title="Psi" onclick="set('Psi')">`Psi`</td>
+<td class="character" title="omega" onclick="set('omega')">`omega`</td>
+<td class="character" title="Omega" onclick="set('Omega')">`Omega`</td>
+</tr>
+</table>
+<form action="javascript:void(0);">
+<table style="width: 100%;border:none">
+  <tr>
+    <td style="width:50%">Input</td><td style="width:50%"><input type="button" onclick="showMathML()" style="float:right;font-size:10px" value="Show MathML" /><span>Preview</span></td>
+  </tr>
+  <tr>
+    <td>
+    <textarea id="inputText" onkeyup="preview()"></textarea>
+    </td>
+    <td>
+    <div id="outputNode"></div>
+    <textarea id="mathml" style="display:none"></textarea>
+    </td>
+  </tr>
+  <tr><td colspan="2">
+  <span>Based on ASCIIMathML by </span><a href="http://www.chapman.edu/~jipsen" onclick="window.open(this.href,'_blank','');return false;">Peter Jipsen</a>, 
+<a href="http://www.chapman.edu" onclick="window.open(this.href,'_blank','');return false;">Chapman University</a><br />
+  <span>For more information on AsciiMathML visit this page: </span><a href="http://www1.chapman.edu/~jipsen/mathml/asciimath.html" onclick="window.open(this.href,'_blank','');return false;">http://www1.chapman.edu/~jipsen/mathml/asciimath.html</a></td></tr>
+</table>
+
+<div id="buttons">
+<script type="text/javascript">
+// <![CDATA[
+if (Xinha.is_ie)
+ document.write('<span style="color:red;float:left">'+i18n('Attention Internet Explorer users: Please note that there is no WYSIWYG representation of the formula in the editor!<br />You might wish to use <a href="http://www.mozilla.com" onclick="window.open(this.href,\'_blank\');return false;">Mozilla Firefox</a> instead.')+'</span>');
+// ]]>
+</script>
+  <button type="submit" name="ok" onclick="return onOK();">OK</button>
+  <button type="button" name="cancel" onclick="return onCancel();">Cancel</button>
+</div>
+</form>
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Equation/readme.txt
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Equation/readme.txt	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,38 @@
+AsciiMathML Formula Editor for Xinha
+ _______________________
+ 
+Based on AsciiMathML by Peter Jipsen (http://www.chapman.edu/~jipsen).
+Plugin by Raimund Meyer (ray) xinha@raimundmeyer.de
+
+AsciiMathML is a JavaScript library for translating ASCII math notation to Presentation MathML.
+
+Usage
+ The formmulae are stored in their ASCII representation, so you have to include the 
+ ASCIIMathML library which can be found in the plugin folder in order to render the MathML output in your pages. 
+ 
+ Example (also see example.html):
+  var mathcolor = "black"; //  You may change the color of the formulae (default: red)
+  var mathfontfamily = "Arial"; //and the font (default: serif, which is good I think)
+  var showasciiformulaonhover = false; // if true helps students learn ASCIIMath (default:true)
+  <script type="text/javascript" src="/xinha/plugins/AsciiMath/ASCIIMathML.js"></script>
+
+ The recommended browser for using this plugin is Mozilla/Firefox. At the moment showing the MathML output
+ inside the editor is not supported in Internet Explorer.
+ 
+ 
+License information
+
+ This program is free software; you can redistribute it and/or modify
+ it under the terms of the GNU Lesser General Public License as published by
+ the Free Software Foundation; either version 2.1 of the License, or (at
+ your option) any later version.
+
+ This program is distributed in the hope that it will be useful, 
+ but WITHOUT ANY WARRANTY; without even the implied warranty of
+ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
+ Lesser General Public License (at http://www.gnu.org/licenses/lgpl.html) 
+ for more details.
+ 
+ NOTE: I have changed the license of AsciiMathML from GPL to LGPL according to a permission 
+ from the author (see http://xinha.gogo.co.nz/punbb/viewtopic.php?pid=4150#p4150)
+ Raimund Meyer 11-29-2006
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/Classes/ExtendedFileManager.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/Classes/ExtendedFileManager.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,825 @@
+<?php
+/**
+ * ExtendedFileManager, list images, directories, and thumbnails.
+ * Authors: Wei Zhuo, Afru, Krzysztof Kotowicz, Raimund Meyer
+ * Version: Updated on 08-01-2005 by Afru
+ * Version: Updated on 04-07-2006 by Krzysztof Kotowicz
+ * Version: Updated on 29-10-2006 by Raimund Meyer
+ * Package: ExtendedFileManager (EFM 1.1.3)
+ * http://www.afrusoft.com/htmlarea
+ */
+
+/**
+ * We use classes from ImageManager to avoid code duplication
+ */
+require_once '../ImageManager/Classes/Files.php';
+
+/**
+ * ExtendedFileManager Class.
+ * @author $Author:ray $
+ * @author $Author:ray $
+ * @version $Id:ExtendedFileManager.php 957 2008-02-01 22:44:49Z ray $
+ */
+class ExtendedFileManager 
+{
+	/**
+	 * Configuration array.
+	 */
+	var $config;
+
+	/**
+	 * Array of directory information.
+	 */
+	var $dirs;
+	
+    /**
+     * Manager mode - image | link
+     */
+	var $mode;
+
+	/**
+	 * Constructor. Create a new Image Manager instance.
+	 * @param array $config configuration array, see config.inc.php
+	 */
+	function ExtendedFileManager($config, $mode = null)
+	{
+		$this->config = $config;
+		
+		$this->mode = empty($mode) ? (empty($config['insert_mode']) ? 'image' : $config['insert_mode']): $mode;
+	}
+
+	/**
+	 * Get the base directory.
+	 * @return string base dir, see config.inc.php
+	 */
+	function getImagesDir()
+	{
+		if ($this->mode == 'link' && isset($this->config['files_dir']))
+			Return $this->config['files_dir'];
+		else Return $this->config['images_dir'];
+	}
+
+	/**
+	 * Get the base URL.
+	 * @return string base url, see config.inc.php
+	 */
+	function getImagesURL()
+	{
+		if ($this->mode == 'link' && isset($this->config['files_url']))
+				Return $this->config['files_url'];
+		else Return $this->config['images_url'];
+	}
+
+	function isValidBase()
+	{
+		return is_dir($this->getImagesDir());
+	}
+
+	/**
+	 * Get the tmp file prefix.
+     * @return string tmp file prefix.
+	 */
+	function getTmpPrefix() 
+	{
+		Return $this->config['tmp_prefix'];
+	}
+
+	/**
+	 * Get the sub directories in the base dir.
+	 * Each array element contain
+	 * the relative path (relative to the base dir) as key and the 
+	 * full path as value.
+	 * @return array of sub directries
+	 * <code>array('path name' => 'full directory path', ...)</code>
+	 */
+	function getDirs() 
+	{
+		if(is_null($this->dirs))
+		{
+			$dirs = $this->_dirs($this->getImagesDir(),'/');
+			ksort($dirs);
+			$this->dirs = $dirs;
+		}
+		return $this->dirs;
+	}
+
+	/**
+	 * Recursively travese the directories to get a list
+	 * of accessable directories.
+	 * @param string $base the full path to the current directory
+	 * @param string $path the relative path name
+	 * @return array of accessiable sub-directories
+	 * <code>array('path name' => 'full directory path', ...)</code>
+	 */
+	function _dirs($base, $path) 
+	{
+		$base = Files::fixPath($base);
+		$dirs = array();
+
+		if($this->isValidBase() == false)
+			return $dirs;
+
+		$d = @dir($base);
+		
+		while (false !== ($entry = $d->read())) 
+		{
+			//If it is a directory, and it doesn't start with
+			// a dot, and if is it not the thumbnail directory
+			if(is_dir($base.$entry) 
+				&& substr($entry,0,1) != '.'
+				&& $this->isThumbDir($entry) == false) 
+			{
+				$relative = Files::fixPath($path.$entry);
+				$fullpath = Files::fixPath($base.$entry);
+				$dirs[$relative] = $fullpath;
+				$dirs = array_merge($dirs, $this->_dirs($fullpath, $relative));
+			}
+		}
+		$d->close();
+
+		Return $dirs;
+	}
+
+	/**
+	 * Get all the files and directories of a relative path.
+	 * @param string $path relative path to be base path.
+	 * @return array of file and path information.
+	 * <code>array(0=>array('relative'=>'fullpath',...), 1=>array('filename'=>fileinfo array(),...)</code>
+	 * fileinfo array: <code>array('url'=>'full url', 
+	 *                       'relative'=>'relative to base', 
+	 *                        'fullpath'=>'full file path', 
+	 *                        'image'=>imageInfo array() false if not image,
+	 *                        'stat' => filestat)</code>
+	 */
+	function getFiles($path) 
+	{
+		$files = array();
+		$dirs = array();
+
+        $valid_extensions = $this->mode == 'image' ? $this->config['allowed_image_extensions'] : $this->config['allowed_link_extensions'];
+
+		if($this->isValidBase() == false)
+			return array($files,$dirs);
+
+		$path = Files::fixPath($path);
+		$base = Files::fixPath($this->getImagesDir());
+		$fullpath = Files::makePath($base,$path);
+
+
+		$d = @dir($fullpath);
+		
+		while (false !== ($entry = $d->read())) 
+		{
+			//not a dot file or directory
+			if(substr($entry,0,1) != '.')
+			{
+				if(is_dir($fullpath.$entry)
+					&& $this->isThumbDir($entry) == false)
+				{
+					$relative = Files::fixPath($path.$entry);
+					$full = Files::fixPath($fullpath.$entry);
+					$count = $this->countFiles($full);
+					$dirs[$relative] = array('fullpath'=>$full,'entry'=>$entry,'count'=>$count, 'stat'=>stat($fullpath.$entry));
+				}
+
+				else if(is_file($fullpath.$entry) && $this->isThumb($entry)==false && $this->isTmpFile($entry) == false) 
+				{
+					$afruext = strtolower(substr(strrchr($entry, "."), 1));
+
+                    if(in_array($afruext,$valid_extensions))
+					{
+
+						$file['url'] = Files::makePath($this->config['base_url'],$path).$entry;
+						$file['relative'] = $path.$entry;
+						$file['fullpath'] = $fullpath.$entry;
+						$img = $this->getImageInfo($fullpath.$entry);
+						if(!is_array($img)) $img[0]=$img[1]=0;
+						$file['image'] = $img;
+						$file['stat'] = stat($fullpath.$entry);
+						$file['ext'] = $afruext;
+						$files[$entry] = $file;
+					}
+
+				}
+			}
+		}
+		$d->close();
+		ksort($dirs);
+		ksort($files);
+		
+		Return array($dirs, $files);
+	}	
+
+	/**
+	 * Count the number of files and directories in a given folder
+	 * minus the thumbnail folders and thumbnails.
+	 */
+	function countFiles($path) 
+	{
+		$total = 0;
+
+		if(is_dir($path)) 
+		{
+			$d = @dir($path);
+
+			while (false !== ($entry = $d->read())) 
+			{
+				//echo $entry."<br>";
+				if(substr($entry,0,1) != '.'
+					&& $this->isThumbDir($entry) == false
+					&& $this->isTmpFile($entry) == false
+					&& $this->isThumb($entry) == false) 
+				{
+					$total++;
+				}
+			}
+			$d->close();
+		}
+		return $total;
+	}
+
+	/**
+	 * Get image size information.
+	 * @param string $file the image file
+	 * @return array of getImageSize information, 
+	 *  false if the file is not an image.
+	 */
+	function getImageInfo($file) 
+	{
+		Return @getImageSize($file);
+	}
+
+	/**
+	 * Check if the file contains the thumbnail prefix.
+	 * @param string $file filename to be checked
+	 * @return true if the file contains the thumbnail prefix, false otherwise.
+	 */
+	function isThumb($file) 
+	{
+		$len = strlen($this->config['thumbnail_prefix']);
+		if(substr($file,0,$len)==$this->config['thumbnail_prefix'])
+			Return true;
+		else
+			Return false;
+	}
+
+	/**
+	 * Check if the given directory is a thumbnail directory.
+	 * @param string $entry directory name
+	 * @return true if it is a thumbnail directory, false otherwise
+	 */
+	function isThumbDir($entry) 
+	{
+		if($this->config['thumbnail_dir'] == false
+			|| strlen(trim($this->config['thumbnail_dir'])) == 0)
+			Return false;		
+		else
+			Return ($entry == $this->config['thumbnail_dir']);
+	}
+
+	/**
+	 * Check if the given file is a tmp file.
+	 * @param string $file file name
+	 * @return boolean true if it is a tmp file, false otherwise
+	 */
+	function isTmpFile($file) 
+	{
+		$len = strlen($this->config['tmp_prefix']);
+		if(substr($file,0,$len)==$this->config['tmp_prefix'])
+			Return true;
+		else
+			Return false;	 	
+	}
+
+	/**
+	 * For a given image file, get the respective thumbnail filename
+	 * no file existence check is done.
+	 * @param string $fullpathfile the full path to the image file
+	 * @return string of the thumbnail file
+	 */
+	function getThumbName($fullpathfile) 
+	{
+		$path_parts = pathinfo($fullpathfile);
+		
+		$thumbnail = $this->config['thumbnail_prefix'].$path_parts['basename'];
+
+		if($this->config['safe_mode'] == true
+			|| strlen(trim($this->config['thumbnail_dir'])) == 0)
+		{
+			Return Files::makeFile($path_parts['dirname'],$thumbnail);
+		}
+		else
+		{
+			if(strlen(trim($this->config['thumbnail_dir'])) > 0)
+			{
+				$path = Files::makePath($path_parts['dirname'],$this->config['thumbnail_dir']);
+				if(!is_dir($path))
+					Files::createFolder($path);
+				Return Files::makeFile($path,$thumbnail);
+			}
+			else //should this ever happen?
+			{
+				//error_log('ExtendedFileManager: Error in creating thumbnail name');
+			}
+		}
+	}
+	
+	/**
+	 * Similar to getThumbName, but returns the URL, base on the
+	 * given base_url in config.inc.php
+	 * @param string $relative the relative image file name, 
+	 * relative to the base_dir path
+	 * @return string the url of the thumbnail
+	 */
+	function getThumbURL($relative) 
+	{
+		$path_parts = pathinfo($relative);
+		$thumbnail = $this->config['thumbnail_prefix'].$path_parts['basename'];
+		if($path_parts['dirname']=='\\') $path_parts['dirname']='/';
+
+		if($this->config['safe_mode'] == true
+			|| strlen(trim($this->config['thumbnail_dir'])) == 0)
+		{
+			Return Files::makeFile($this->getImagesURL(),$thumbnail);
+		}
+		else
+		{
+			if(strlen(trim($this->config['thumbnail_dir'])) > 0)
+			{
+				$path = Files::makePath($path_parts['dirname'],$this->config['thumbnail_dir']);
+				$url_path = Files::makePath($this->getImagesURL(), $path);
+				Return Files::makeFile($url_path,$thumbnail);
+			}
+			else //should this ever happen?
+			{
+				//error_log('ExtendedFileManager: Error in creating thumbnail url');
+			}
+
+		}
+	}
+
+   /**
+    * For a given image file, get the respective resized filename
+    * no file existence check is done.
+    * @param string $fullpathfile the full path to the image file
+    * @param integer $width the intended width
+    * @param integer $height the intended height
+    * @param boolean $mkDir whether to attempt to make the resized_dir if it doesn't exist
+    * @return string of the resized filename
+    */
+	function getResizedName($fullpathfile, $width, $height, $mkDir = TRUE)
+	{
+		$path_parts = pathinfo($fullpathfile);
+
+		$thumbnail = $this->config['resized_prefix']."_{$width}x{$height}_{$path_parts['basename']}";
+
+		if( strlen(trim($this->config['resized_dir'])) == 0 || $this->config['safe_mode'] == true )
+		{
+			Return Files::makeFile($path_parts['dirname'],$thumbnail);
+		}
+		else
+		{
+      $path = Files::makePath($path_parts['dirname'],$this->config['resized_dir']);
+      if($mkDir && !is_dir($path))
+        Files::createFolder($path);
+      Return Files::makeFile($path,$thumbnail);
+		}
+	}
+
+	/**
+	 * Check if the given path is part of the subdirectories
+	 * under the base_dir.
+	 * @param string $path the relative path to be checked
+	 * @return boolean true if the path exists, false otherwise
+	 */
+	function validRelativePath($path) 
+	{
+		$dirs = $this->getDirs();
+		if($path == '/')
+			Return true;
+		//check the path given in the url against the 
+		//list of paths in the system.
+		for($i = 0; $i < count($dirs); $i++)
+		{
+			$key = key($dirs);
+			//we found the path
+			if($key == $path)
+				Return true;
+		
+			next($dirs);
+		}		
+		Return false;
+	}
+
+	/**
+	 * Process uploaded files, assumes the file is in 
+	 * $_FILES['upload'] and $_POST['dir'] is set.
+	 * The dir must be relative to the base_dir and exists.
+	 * @return null
+	 */
+	function processUploads() 
+	{
+		if($this->isValidBase() == false)
+			return;
+
+		$relative = null;
+
+		if(isset($_POST['dir'])) 
+			$relative = rawurldecode($_POST['dir']);
+		else
+			return;
+
+		//check for the file, and must have valid relative path
+		if(isset($_FILES['upload']) && $this->validRelativePath($relative))
+		{
+			Return $this->_processFiles($relative, $_FILES['upload']);
+		}
+	}
+
+	/**
+	 * Process upload files. The file must be an 
+	 * uploaded file. Any duplicate
+	 * file will be renamed. See Files::copyFile for details
+	 * on renaming.
+	 * @param string $relative the relative path where the file
+	 * should be copied to.
+	 * @param array $file the uploaded file from $_FILES
+	 * @return boolean true if the file was processed successfully, 
+	 * false otherwise
+	 */
+	function _processFiles($relative, $file)
+	{
+		
+		if($file['error']!=0)
+		{
+			Return false;
+		}
+
+		if(!is_file($file['tmp_name']))
+		{
+			Return false;
+		}
+
+		if(!is_uploaded_file($file['tmp_name']))
+		{
+			Files::delFile($file['tmp_name']);
+			Return false;
+		}
+
+        $valid_extensions = $this->mode == 'image' ? $this->config['allowed_image_extensions'] : $this->config['allowed_link_extensions'];
+        $max_size = $this->mode == 'image' ? $this->config['max_filesize_kb_image'] : $this->config['max_filesize_kb_link'];
+		$afruext = strtolower(substr(strrchr($file['name'], "."), 1));
+
+		if(!in_array($afruext, $valid_extensions))
+		{
+			Files::delFile($file['tmp_name']);
+			Return 'Cannot upload $extension='.$afruext.'$ Files. Permission denied.';
+		}
+
+		if($file['size']>($max_size*1024))
+		{
+			Files::delFile($file['tmp_name']);
+			Return 'Unble to upload file. Maximum file size [$max_size='.$max_size.'$ KB] exceeded.';
+		}
+
+		if(!empty($this->config['max_foldersize_mb']) &&  (Files::dirSize($this->getImagesDir()))+$file['size']> ($this->config['max_foldersize_mb']*1048576))
+		{
+			Files::delFile($file['tmp_name']);
+			Return ("Cannot upload. Maximum folder size reached. Delete unwanted files and try again.");
+		}
+
+		//now copy the file
+		$path = Files::makePath($this->getImagesDir(),$relative);
+		$result = Files::copyFile($file['tmp_name'], $path, $file['name']);
+
+		//no copy error
+		if(!is_int($result))
+		{
+			Files::delFile($file['tmp_name']);
+			Return 'File "$file='.$file['name'].'$" successfully uploaded.';
+		}
+
+		//delete tmp files.
+		Files::delFile($file['tmp_name']);
+		Return false;
+
+	}
+
+
+	function getDiskInfo()
+	{
+        if (empty($this->config['max_foldersize_mb']))
+            return '';
+            
+		$tmpFreeSize=($this->config['max_foldersize_mb']*1048576)-Files::dirSize($this->getImagesDir());
+
+		if(!is_numeric($tmpFreeSize) || $tmpFreeSize<0)	$tmpFreeSize=0;
+        
+		Return 'Total Size : $max_foldersize_mb='.$this->config['max_foldersize_mb'].'$ MB, Free Space: $free_space='.Files::formatSize($tmpFreeSize).'$';
+	}
+
+
+
+	/**
+	 * Get the URL of the relative file.
+	 * basically appends the relative file to the 
+	 * base_url given in config.inc.php
+	 * @param string $relative a file the relative to the base_dir
+	 * @return string the URL of the relative file.
+	 */
+	function getFileURL($relative) 
+	{
+		Return Files::makeFile($this->getImagesURL(),$relative);
+	}
+
+	/**
+	 * Get the fullpath to a relative file.
+	 * @param string $relative the relative file.
+	 * @return string the full path, .ie. the base_dir + relative.
+	 */
+	function getFullPath($relative) 
+	{
+		Return Files::makeFile($this->getImagesDir(),$relative);;
+	}
+
+	/**
+	 * Get the default thumbnail.
+	 * @return string default thumbnail, empty string if 
+	 * the thumbnail doesn't exist.
+	 */
+	function getDefaultThumb() 
+	{
+		if(is_file($this->config['default_thumbnail']))
+			Return $this->config['default_thumbnail'];
+		else 
+			Return '';
+	}
+
+
+	/**
+	 * Checks image size. If the image size is less than default size
+	 * returns the original size else returns default size to display thumbnail
+	*/
+	function checkImageSize($relative)
+	{
+		$fullpath = Files::makeFile($this->getImagesDir(),$relative);
+
+		$afruext = strtolower(substr(strrchr($relative, "."), 1));
+		
+		if(!in_array($afruext,$this->config['thumbnail_extensions']))
+		{
+			$imgInfo=array(0,0);
+			Return $imgInfo;
+		}
+		else
+		{
+			$imgInfo = @getImageSize($fullpath);
+			//not an image
+			if(!is_array($imgInfo))
+			{
+				$imgInfo=array(0,0);
+				Return $imgInfo;
+			}
+			else
+			{
+				if($imgInfo[0] > $this->config['thumbnail_width'])
+				$imgInfo[0] = $this->config['thumbnail_width'];
+
+				if($imgInfo[1] > $this->config['thumbnail_height'])
+				$imgInfo[1] = $this->config['thumbnail_height'];
+
+				Return $imgInfo;
+			}
+		}
+
+	}
+
+
+	/**
+	 * Get the thumbnail url to be displayed. 
+	 * If the thumbnail exists, and it is up-to-date
+	 * the thumbnail url will be returns. If the 
+	 * file is not an image, a default image will be returned.
+	 * If it is an image file, and no thumbnail exists or 
+	 * the thumbnail is out-of-date (i.e. the thumbnail 
+	 * modified time is less than the original file)
+	 * then a thumbs.php?img=filename.jpg is returned.
+	 * The thumbs.php url will generate a new thumbnail
+	 * on the fly. If the image is less than the dimensions
+	 * of the thumbnails, the image will be display instead.
+	 * @param string $relative the relative image file.
+	 * @return string the url of the thumbnail, be it
+	 * actually thumbnail or a script to generate the
+	 * thumbnail on the fly.
+	 */
+	function getThumbnail($relative) 
+	{
+		global $IMConfig;
+		
+		$fullpath = Files::makeFile($this->getImagesDir(),$relative);
+
+		//not a file???
+		if(!is_file($fullpath))
+			Return $this->getDefaultThumb();
+
+		$afruext = strtolower(substr(strrchr($relative, "."), 1));
+		
+		if(!in_array($afruext,$this->config['thumbnail_extensions']))
+		{
+			if(is_file('icons/'.$afruext.'.gif')) 
+				Return('icons/'.$afruext.'.gif');
+			else
+				Return $this->getDefaultThumb();
+		}
+
+		$imgInfo = @getImageSize($fullpath);
+
+		//not an image
+		if(!is_array($imgInfo))
+			Return $this->getDefaultThumb();
+
+
+		//Returning original image as thumbnail without Image Library by Afru
+		if(!$this->config['img_library']) Return $this->getFileURL($relative);
+
+
+		//the original image is smaller than thumbnails,
+		//so just return the url to the original image.
+		if ($imgInfo[0] <= $this->config['thumbnail_width']
+		 && $imgInfo[1] <= $this->config['thumbnail_height'])
+			Return $this->getFileURL($relative);
+
+		$thumbnail = $this->getThumbName($fullpath);
+		
+		//check for thumbnails, if exists and
+		// it is up-to-date, return the thumbnail url
+		if(is_file($thumbnail))
+		{
+			if(filemtime($thumbnail) >= filemtime($fullpath))
+				Return $this->getThumbURL($relative);
+		}
+
+		//well, no thumbnail was found, so ask the thumbs.php
+		//to generate the thumbnail on the fly.
+		Return $IMConfig['backend_url'] . '__function=thumbs&img='.rawurlencode($relative)."&mode=$this->mode";
+	}
+
+	/**
+	 * Delete and specified files.
+	 * @return boolean true if delete, false otherwise
+	 */
+	function deleteFiles() 
+	{
+		if(isset($_GET['delf']))
+			return $this->_delFile(rawurldecode($_GET['delf']));
+        return false;
+	}
+
+	/**
+	 * Delete and specified directories.
+	 * @return boolean true if delete, false otherwise
+	 */
+	function deleteDirs() 
+	{
+		 if(isset($_GET['deld']))
+			return $this->_delDir(rawurldecode($_GET['deld']));		
+		 else
+			 Return false;
+	}
+
+	/**
+	 * Delete the relative file, and any thumbnails.
+	 * @param string $relative the relative file.
+	 * @return boolean true if deleted, false otherwise.
+	 */
+	function _delFile($relative) 
+	{
+		$fullpath = Files::makeFile($this->getImagesDir(),$relative);
+	
+		$afruext = strtolower(substr(strrchr($relative, "."), 1));
+
+        $valid_extensions = $this->mode == 'image' ? $this->config['allowed_image_extensions'] : $this->config['allowed_link_extensions'];
+
+		if(!in_array($afruext,$valid_extensions))
+		{
+			return false;
+		}
+
+		//check that the file is an image
+		if(is_array($this->getImageInfo($fullpath)))
+		{
+			$thumbnail = $this->getThumbName($fullpath);
+			Files::delFile($thumbnail);
+		}
+
+		Return Files::delFile($fullpath);
+	}
+
+	/**
+	 * Delete directories recursively.
+	 * @param string $relative the relative path to be deleted.
+	 * @return boolean true if deleted, false otherwise.
+	 */
+	function _delDir($relative) 
+	{
+		$fullpath = Files::makePath($this->getImagesDir(),$relative);
+	//	if($this->countFiles($fullpath) <= 0)
+			return Files::delFolder($fullpath,true); //delete recursively.
+		//else
+			//Return false;
+	}
+
+	/**
+	 * Create new directories.
+	 * If in safe_mode, nothing happens.
+	 * @return boolean true if created, false otherwise.
+	 */
+	function processNewDir() 
+	{
+		if($this->config['safe_mode'] == true)
+			Return false;
+
+		if(isset($_GET['newDir']) && isset($_GET['dir']))
+		{
+			$newDir = rawurldecode($_GET['newDir']);
+			$dir = rawurldecode($_GET['dir']);
+			$path = Files::makePath($this->getImagesDir(),$dir);
+			$fullpath = Files::makePath($path, Files::escape($newDir));
+			if(is_dir($fullpath))
+				Return false;
+
+			Return Files::createFolder($fullpath);
+		}
+	}
+
+	/**
+	 * Renames files if certain GET variables are set
+	 * @return bool
+	 */
+	function processRenames()
+	{
+		if(!empty($_GET['rename']) && !empty($_GET['renameTo']))
+		{
+			// new file name (without path and extension)
+			$newName = Files::escape(rawurldecode($_GET['renameTo']));
+			$newName = str_replace('.', '', $newName);
+
+			// path to file (from base images directory)
+			$oldName = rawurldecode($_GET['rename']);
+
+			// strip parent dir ("..") to avoid escaping from base directiory
+			$oldName = preg_replace('#\.\.#', '', $oldName);
+
+			if (is_dir($oldPath = Files::makeFile($this->getImagesDir(), $_GET['dir'].$oldName)))
+			{
+				$newPath = Files::makeFile($this->getImagesDir(), $_GET['dir'].$newName);
+				return Files::rename($oldPath,$newPath);
+			}
+			else 
+			{
+				// path to old file
+				$oldPath = Files::makeFile($this->getImagesDir(), $oldName);
+	
+				$ret = Files::renameFile($oldPath, $newName);
+				if ($ret === true) {
+					// delete old thumbnail
+					Files::delFile($this->getThumbname($oldPath));
+				}
+			}
+			return $ret;
+		}
+		
+		return null;
+	}
+
+	function processPaste()
+	{
+		switch ($_GET['paste'])
+		{
+			case 'copyFile':
+				$src = Files::makeFile($this->getImagesDir(), $_GET['srcdir'].$_GET['file']);
+				$file = $_GET['file'];
+				$dest = Files::makeFile($this->getImagesDir(), $_GET['dir']);
+				return Files::copyFile($src,$dest,$file);
+			break;
+			case 'copyDir':
+				$basePath = $this->getImagesDir();
+				$src = $_GET['srcdir'].$_GET['file'];
+				$dest = $_GET['dir'].$_GET['file'];
+				return Files::copyDir($basePath,$src,$dest);
+			break;
+			case 'moveFile':
+				$src = Files::makeFile($this->getImagesDir(), $_GET['srcdir'].$_GET['file']);
+				$dest = Files::makeFile($this->getImagesDir(), $_GET['dir'].$_GET['file']);
+				return Files::rename($src,$dest);
+			break;
+			case 'moveDir':
+				$src = Files::makeFile($this->getImagesDir(), $_GET['srcdir'].$_GET['file']);
+				$dest = Files::makeFile($this->getImagesDir(), $_GET['dir'].$_GET['file']);
+				return Files::rename($src,$dest);
+			break;
+		}
+	}
+}
+
+?>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/Readme.txt
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/Readme.txt	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,111 @@
+Package : Extended File Manager EFM 1.1.1
+
+Version 1.1 created from 1.0 beta by Krzysztof Kotowicz <koto@webworkers.pl>
+
+Overview :
+----------
+
+Extended File Manager is an advanced plugin for Xinha 
+
+It works in two different modes.
+1). Insert Image Mode and 
+2). Insert File Link Mode.
+
+In Insert Image Mode, it replaces the basic insert image functionality of Xinha with its advanced image manager.
+
+If Insert File Link Mode is enabled, a new icon will be added to the toolbar with advanced file linking capability.
+
+
+
+Complete Features :
+-------------------
+* Easy config.inc file that enables individual options for both modes.
+* Thumnail View 
+* List View 
+* Nice icons for both views 
+* Create Folders 
+* Vertical Scrolling 
+* Allowed extensions to view or upload.
+* File Uploads 
+* Max File upload limit 
+* Max Upload Folder size (Including all subfolders and files. A must see option.)
+* Dynamic display of available free space in the Upload Folder 
+* Dynamic Thumbnails using Image libraries or browser resize 
+* Image Editor (Actually done by Wei...a great addon) 
+* Can be used to insert images along with properties. 
+* Can be used to insert link to non-image files like pdf or zip.
+* You can specify image margin / padding / background and border colors
+* You may edit Alt/title tags for inserted images
+
+(Most of the features can be enabled/disabled as needed)
+
+Installation :
+--------------
+
+Installing involves extracting the archive to 'plugins' subdirectory of Xinha
+and selecting the plugin in appropriate xinha_plugins list.
+
+Plugin may be configured via xinha_config.ExtendedFileManager object.
+Look into ImageManager plugin documentation as this plugin uses almost identical
+settings. All available options can be found in the file config.inc.php.
+
+// only snippets of code from initializing file shown below
+
+
+  xinha_plugins = xinha_plugins ? xinha_plugins :
+  [
+   'ContextMenu',
+   'SuperClean',
+   'CharacterMap',
+   'GetHtml',
+   'ExtendedFileManager',
+   /*'ImageManager',*/  // replace image manager with EFM
+   'Linker'
+  ];
+
+...
+
+//If you don't want to add a button for linking files and use only the advanced ImageManager
+xinha_config.ExtendedFileManager.use_linker = false;
+// pass the configuration to plugin
+if (xinha_config.ExtendedFileManager) {
+   	    with (xinha_config.ExtendedFileManager)
+        {
+            <?php
+
+            // define backend configuration for the plugin
+            $IMConfig = array();
+            $IMConfig['images_dir'] = '<images dir>';
+            $IMConfig['images_url'] = '<images url>';
+            $IMConfig['files_dir'] = '<files dir>';
+            $IMConfig['files_url'] = '<files url>';
+            $IMConfig['thumbnail_prefix'] = 't_';
+            $IMConfig['thumbnail_dir'] = 't';
+            $IMConfig['resized_prefix'] = 'resized_';
+            $IMConfig['resized_dir'] = '';
+            $IMConfig['tmp_prefix'] = '_tmp';
+            $IMConfig['max_filesize_kb_image'] = 2000;
+            // maximum size for uploading files in 'insert image' mode (2000 kB here)
+
+            $IMConfig['max_filesize_kb_link'] = 5000;
+            // maximum size for uploading files in 'insert link' mode (5000 kB here)
+
+            // Maximum upload folder size in Megabytes.
+            // Use 0 to disable limit
+            $IMConfig['max_foldersize_mb'] = 0;
+            
+            $IMConfig['allowed_image_extensions'] = array("jpg","gif","png");
+            $IMConfig['allowed_link_extensions'] = array("jpg","gif","pdf","ip","txt",
+                                                         "psd","png","html","swf",
+                                                         "xml","xls");
+
+            require_once '/path/to/xinha/contrib/php-xinha.php';
+            xinha_pass_to_php_backend($IMConfig);
+            
+            ?>
+        }
+}
+
+=====
+afrusoft@gmail.com - author of EFM 1.0 beta
+koto@webworkers.pl - EFM 1.1 (most of the code taken from Xinha codebase)
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/assets/EditorContent.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/assets/EditorContent.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,662 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/ExtendedFileManager/assets/EditorContent.js */
+function MM_findObj(n,d){
+var p,i,x;
+if(!d){
+d=document;
+}
+if((p=n.indexOf("?"))>0&&parent.frames.length){
+d=parent.frames[n.substring(p+1)].document;
+n=n.substring(0,p);
+}
+if(!(x=d[n])&&d.all){
+x=d.all[n];
+}
+for(i=0;!x&&i<d.forms.length;i++){
+x=d.forms[i][n];
+}
+for(i=0;!x&&d.layers&&i<d.layers.length;i++){
+x=MM_findObj(n,d.layers[i].document);
+}
+if(!x&&d.getElementById){
+x=d.getElementById(n);
+}
+return x;
+}
+var pic_x,pic_y;
+function P7_Snap(){
+var x,y,ox,bx,oy,p,tx,a,b,k,d,da,e,el,args=P7_Snap.arguments;
+a=parseInt(a);
+for(k=0;k<(args.length-3);k+=4){
+if((g=MM_findObj(args[k]))!=null){
+el=eval(MM_findObj(args[k+1]));
+a=parseInt(args[k+2]);
+b=parseInt(args[k+3]);
+x=0;
+y=0;
+ox=0;
+oy=0;
+p="";
+tx=1;
+da="document.all['"+args[k]+"']";
+if(document.getElementById){
+d="document.getElementsByName('"+args[k]+"')[0]";
+if(!eval(d)){
+d="document.getElementById('"+args[k]+"')";
+if(!eval(d)){
+d=da;
+}
+}
+}else{
+if(document.all){
+d=da;
+}
+}
+if(document.all||document.getElementById){
+while(tx==1){
+p+=".offsetParent";
+if(eval(d+p)){
+x+=parseInt(eval(d+p+".offsetLeft"));
+y+=parseInt(eval(d+p+".offsetTop"));
+}else{
+tx=0;
+}
+}
+ox=parseInt(g.offsetLeft);
+oy=parseInt(g.offsetTop);
+var tw=x+ox+y+oy;
+if(tw==0||(navigator.appVersion.indexOf("MSIE 4")>-1&&navigator.appVersion.indexOf("Mac")>-1)){
+ox=0;
+oy=0;
+if(g.style.left){
+x=parseInt(g.style.left);
+y=parseInt(g.style.top);
+}else{
+var w1=parseInt(el.style.width);
+bx=(a<0)?-5-w1:-10;
+a=(Math.abs(a)<1000)?0:a;
+b=(Math.abs(b)<1000)?0:b;
+if(event==null){
+x=document.body.scrollLeft+bx;
+}else{
+x=document.body.scrollLeft+event.clientX+bx;
+}
+if(event==null){
+y=document.body.scrollTop;
+}else{
+y=document.body.scrollTop+event.clientY;
+}
+}
+}
+}else{
+if(document.layers){
+x=g.x;
+y=g.y;
+var q0=document.layers,dd="";
+for(var s=0;s<q0.length;s++){
+dd="document."+q0[s].name;
+if(eval(dd+".document."+args[k])){
+x+=eval(dd+".left");
+y+=eval(dd+".top");
+break;
+}
+}
+}
+}
+if(el){
+e=(document.layers)?el:el.style;
+var xx=parseInt(x+ox+a),yy=parseInt(y+oy+b);
+if(navigator.appName=="Netscape"&&parseInt(navigator.appVersion)>4){
+xx+="px";
+yy+="px";
+}
+if(navigator.appVersion.indexOf("MSIE 5")>-1&&navigator.appVersion.indexOf("Mac")>-1){
+xx+=parseInt(document.body.leftMargin);
+yy+=parseInt(document.body.topMargin);
+xx+="px";
+yy+="px";
+}
+e.left=xx;
+e.top=yy;
+}
+pic_x=parseInt(xx);
+pic_y=parseInt(yy);
+}
+}
+}
+var ie=document.all;
+var ns6=document.getElementById&&!document.all;
+var dragapproved=false;
+var z,x,y,status,ant,canvas,content,pic_width,pic_height,image,resizeHandle,oa_w,oa_h,oa_x,oa_y,mx2,my2;
+function init_resize(){
+P7_Snap("theImage","ant",0,0);
+if(canvas==null){
+canvas=MM_findObj("imgCanvas");
+}
+if(pic_width==null||pic_height==null){
+image=MM_findObj("theImage");
+pic_width=image.width;
+pic_height=image.height;
+}
+if(ant==null){
+ant=MM_findObj("ant");
+}
+ant.style.left=pic_x;
+ant.style.top=pic_y;
+ant.style.width=pic_width;
+ant.style.height=pic_height;
+ant.style.visibility="visible";
+drawBoundHandle();
+jg_doc.paint();
+}
+initEditor=function(){
+init_crop();
+init_resize();
+var _a=MM_findObj("markerImg",window.top.document);
+if(_a.src.indexOf("img/t_white.gif")>0){
+toggleMarker();
+}
+var _b=document.getElementById("theImage");
+_b._width=_b.width;
+_b._height=_b.height;
+};
+function init_crop(){
+P7_Snap("theImage","ant",0,0);
+}
+function setMode(_c){
+mode=_c;
+reset();
+}
+function reset(){
+if(ant==null){
+ant=MM_findObj("ant");
+}
+ant.style.visibility="hidden";
+ant.style.left=0;
+ant.style.top=0;
+ant.style.width=0;
+ant.style.height=0;
+mx2=null;
+my2=null;
+jg_doc.clear();
+if(mode!="measure"){
+showStatus();
+}
+if(mode=="scale"){
+init_resize();
+}
+P7_Snap("theImage","ant",0,0);
+}
+function toggleMarker(){
+if(ant==null){
+ant=MM_findObj("ant");
+}
+if(ant.className=="selection"){
+ant.className="selectionWhite";
+}else{
+ant.className="selection";
+}
+if(jg_doc.getColor()=="#000000"){
+jg_doc.setColor("#FFFFFF");
+}else{
+jg_doc.setColor("#000000");
+}
+drawBoundHandle;
+jg_doc.paint();
+}
+function move(e){
+if(dragapproved){
+var w=ns6?temp1+e.pageX-x:temp1+event.clientX+document.body.scrollLeft-x;
+var h=ns6?temp2+e.pageY-y:temp2+event.clientY+document.body.scrollTop-y;
+if(ant!=null){
+if(w>=0){
+ant.style.left=x;
+ant.style.width=w;
+}else{
+ant.style.left=x+w;
+ant.style.width=-1*w;
+}
+if(h>=0){
+ant.style.top=y;
+ant.style.height=h;
+}else{
+ant.style.top=y+h;
+ant.style.height=-1*h;
+}
+}
+showStatus();
+return false;
+}
+}
+function moveContent(e){
+if(dragapproved){
+var dx=ns6?oa_x+e.clientX-x:oa_x+event.clientX-x;
+var dy=ns6?oa_y+e.clientY-y:oa_y+event.clientY-y;
+ant.style.left=dx;
+ant.style.top=dy;
+showStatus();
+return false;
+}
+}
+function moveHandle(e){
+if(dragapproved){
+var w=ns6?e.clientX-x:event.clientX-x;
+var h=ns6?e.clientY-y:event.clientY-y;
+var _16=MM_findObj("constProp",window.top.document);
+var _17=document.theImage.height;
+var _18=document.theImage.width;
+rapp=_18/_17;
+rapp_inv=_17/_18;
+switch(resizeHandle){
+case "s-resize":
+if(oa_h+h>=0){
+ant.style.height=oa_h+h;
+if(_16.checked){
+ant.style.width=rapp*(oa_h+h);
+ant.style.left=oa_x-rapp*h/2;
+}
+}
+break;
+case "e-resize":
+if(oa_w+w>=0){
+ant.style.width=oa_w+w;
+if(_16.checked){
+ant.style.height=rapp_inv*(oa_w+w);
+ant.style.top=oa_y-rapp_inv*w/2;
+}
+}
+break;
+case "n-resize":
+if(oa_h-h>=0){
+ant.style.top=oa_y+h;
+ant.style.height=oa_h-h;
+if(_16.checked){
+ant.style.width=rapp*(oa_h-h);
+ant.style.left=oa_x+rapp*h/2;
+}
+}
+break;
+case "w-resize":
+if(oa_w-w>=0){
+ant.style.left=oa_x+w;
+ant.style.width=oa_w-w;
+if(_16.checked){
+ant.style.height=rapp_inv*(oa_w-w);
+ant.style.top=oa_y+rapp_inv*w/2;
+}
+}
+break;
+case "nw-resize":
+if(oa_h-h>=0&&oa_w-w>=0){
+ant.style.left=oa_x+w;
+ant.style.width=oa_w-w;
+ant.style.top=oa_y+h;
+if(_16.checked){
+ant.style.height=rapp_inv*(oa_w-w);
+}else{
+ant.style.height=oa_h-h;
+}
+}
+break;
+case "ne-resize":
+if(oa_h-h>=0&&oa_w+w>=0){
+ant.style.top=oa_y+h;
+ant.style.width=oa_w+w;
+if(_16.checked){
+ant.style.height=rapp_inv*(oa_w+w);
+}else{
+ant.style.height=oa_h-h;
+}
+}
+break;
+case "se-resize":
+if(oa_h+h>=0&&oa_w+w>=0){
+ant.style.width=oa_w+w;
+if(_16.checked){
+ant.style.height=rapp_inv*(oa_w+w);
+}else{
+ant.style.height=oa_h+h;
+}
+}
+break;
+case "sw-resize":
+if(oa_h+h>=0&&oa_w-w>=0){
+ant.style.left=oa_x+w;
+ant.style.width=oa_w-w;
+if(_16.checked){
+ant.style.height=rapp_inv*(oa_w-w);
+}else{
+ant.style.height=oa_h+h;
+}
+}
+}
+showStatus();
+return false;
+}
+}
+function drags(e){
+if(!ie&&!ns6){
+return;
+}
+var _1a=ns6?e.target:event.srcElement;
+var _1b=ns6?"HTML":"BODY";
+while(_1a.tagName!=_1b&&!(_1a.className=="crop"||_1a.className=="handleBox"||_1a.className=="selection"||_1a.className=="selectionWhite")){
+_1a=ns6?_1a.parentNode:_1a.parentElement;
+}
+if(_1a.className=="handleBox"){
+if(content!=null){
+if(content.width!=null&&content.height!=null){
+content.width=0;
+content.height=0;
+}
+}
+resizeHandle=_1a.id;
+x=ns6?e.clientX:event.clientX;
+y=ns6?e.clientY:event.clientY;
+oa_w=parseInt(ant.style.width);
+oa_h=parseInt(ant.style.height);
+oa_x=parseInt(ant.style.left);
+oa_y=parseInt(ant.style.top);
+dragapproved=true;
+document.onmousemove=moveHandle;
+return false;
+}else{
+if((_1a.className=="selection"||_1a.className=="selectionWhite")&&mode=="crop"){
+x=ns6?e.clientX:event.clientX;
+y=ns6?e.clientY:event.clientY;
+oa_x=parseInt(ant.style.left);
+oa_y=parseInt(ant.style.top);
+dragapproved=true;
+document.onmousemove=moveContent;
+return false;
+}else{
+if(_1a.className=="crop"&&mode=="crop"){
+if(content!=null){
+if(content.width!=null&&content.height!=null){
+content.width=0;
+content.height=0;
+}
+}
+if(status==null){
+status=MM_findObj("status");
+}
+if(ant==null){
+ant=MM_findObj("ant");
+}
+if(canvas==null){
+canvas=MM_findObj("imgCanvas");
+}
+if(content==null){
+content=MM_findObj("cropContent");
+}
+if(pic_width==null||pic_height==null){
+image=MM_findObj("theImage");
+pic_width=image.width;
+pic_height=image.height;
+}
+ant.style.visibility="visible";
+obj=_1a;
+dragapproved=true;
+z=_1a;
+temp1=parseInt(z.style.left+0);
+temp2=parseInt(z.style.top+0);
+x=ns6?e.pageX:event.clientX+document.body.scrollLeft;
+y=ns6?e.pageY:event.clientY+document.body.scrollTop;
+document.onmousemove=move;
+return false;
+}else{
+if(_1a.className=="crop"&&mode=="measure"){
+if(ant==null){
+ant=MM_findObj("ant");
+}
+if(canvas==null){
+canvas=MM_findObj("imgCanvas");
+}
+x=ns6?e.pageX:event.clientX+document.body.scrollLeft;
+y=ns6?e.pageY:event.clientY+document.body.scrollTop;
+dragapproved=true;
+document.onmousemove=measure;
+return false;
+}
+}
+}
+}
+}
+function measure(e){
+if(dragapproved){
+mx2=ns6?e.pageX:event.clientX+document.body.scrollLeft;
+my2=ns6?e.pageY:event.clientY+document.body.scrollTop;
+jg_doc.clear();
+jg_doc.setStroke(Stroke.DOTTED);
+jg_doc.drawLine(x,y,mx2,my2);
+jg_doc.paint();
+showStatus();
+return false;
+}
+}
+function setMarker(nx,ny,nw,nh){
+if(isNaN(nx)){
+nx=0;
+}
+if(isNaN(ny)){
+ny=0;
+}
+if(isNaN(nw)){
+nw=0;
+}
+if(isNaN(nh)){
+nh=0;
+}
+if(ant==null){
+ant=MM_findObj("ant");
+}
+if(canvas==null){
+canvas=MM_findObj("imgCanvas");
+}
+if(content==null){
+content=MM_findObj("cropContent");
+}
+if(pic_width==null||pic_height==null){
+image=MM_findObj("theImage");
+pic_width=image.width;
+pic_height=image.height;
+}
+ant.style.visibility="visible";
+nx=pic_x+nx;
+ny=pic_y+ny;
+if(nw>=0){
+ant.style.left=nx;
+ant.style.width=nw;
+}else{
+ant.style.left=nx+nw;
+ant.style.width=-1*nw;
+}
+if(nh>=0){
+ant.style.top=ny;
+ant.style.height=nh;
+}else{
+ant.style.top=ny+nh;
+ant.style.height=-1*nh;
+}
+}
+function max(x,y){
+if(y>x){
+return x;
+}else{
+return y;
+}
+}
+function drawBoundHandle(){
+if(ant==null||ant.style==null){
+return false;
+}
+var ah=parseInt(ant.style.height);
+var aw=parseInt(ant.style.width);
+var ax=parseInt(ant.style.left);
+var ay=parseInt(ant.style.top);
+jg_doc.drawHandle(ax-15,ay-15,30,30,"nw-resize");
+jg_doc.drawHandle(ax-15,ay+ah-15,30,30,"sw-resize");
+jg_doc.drawHandle(ax+aw-15,ay-15,30,30,"ne-resize");
+jg_doc.drawHandle(ax+aw-15,ay+ah-15,30,30,"se-resize");
+jg_doc.drawHandle(ax+max(15,aw/10),ay-8,aw-2*max(15,aw/10),8,"n-resize");
+jg_doc.drawHandle(ax+max(15,aw/10),ay+ah,aw-2*max(15,aw/10),8,"s-resize");
+jg_doc.drawHandle(ax-8,ay+max(15,ah/10),8,ah-2*max(15,ah/10),"w-resize");
+jg_doc.drawHandle(ax+aw,ay+max(15,ah/10),8,ah-2*max(15,ah/10),"e-resize");
+jg_doc.drawHandleBox(ax-4,ay-4,8,8,"nw-resize");
+jg_doc.drawHandleBox(ax-4,ay+ah-4,8,8,"sw-resize");
+jg_doc.drawHandleBox(ax+aw-4,ay-4,8,8,"ne-resize");
+jg_doc.drawHandleBox(ax+aw-4,ay+ah-4,8,8,"se-resize");
+jg_doc.drawHandleBox(ax+aw/2-4,ay-4,8,8,"n-resize");
+jg_doc.drawHandleBox(ax+aw/2-4,ay+ah-4,8,8,"s-resize");
+jg_doc.drawHandleBox(ax-4,ay+ah/2-4,8,8,"w-resize");
+jg_doc.drawHandleBox(ax+aw-4,ay+ah/2-4,8,8,"e-resize");
+}
+function showStatus(){
+if(ant==null||ant.style==null){
+return false;
+}
+var _27=100/parseInt(window.parent.document.getElementById("zoom").value,10);
+if(mode=="measure"){
+mx1=x-pic_x;
+my1=y-pic_y;
+mw=mx2-x;
+mh=my2-y;
+md=parseInt(Math.sqrt(mw*mw+mh*mh)*100)/100;
+ma=(Math.atan(-1*mh/mw)/Math.PI)*180;
+if(mw<0&&mh<0){
+ma=ma+180;
+}
+if(mw<0&&mh>0){
+ma=ma-180;
+}
+ma=parseInt(ma*100)/100;
+if(m_sx!=null&&!isNaN(mx1)){
+m_sx.value=mx1*_27+"px";
+}
+if(m_sy!=null&&!isNaN(my1)){
+m_sy.value=my1*_27+"px";
+}
+if(m_w!=null&&!isNaN(mw)){
+m_w.value=mw*_27+"px";
+}
+if(m_h!=null&&!isNaN(mh)){
+m_h.value=mh*_27+"px";
+}
+if(m_d!=null&&!isNaN(md)){
+m_d.value=md*_27+"px";
+}
+if(m_a!=null&&!isNaN(ma)){
+m_a.value=ma+"";
+}
+if(r_ra!=null&&!isNaN(ma)){
+r_ra.value=ma;
+}
+return false;
+}
+var ah=parseInt(ant.style.height);
+var aw=parseInt(ant.style.width);
+var ax=parseInt(ant.style.left);
+var ay=parseInt(ant.style.top);
+var cx=ax-pic_x<0?0:ax-pic_x;
+var cy=ay-pic_y<0?0:ay-pic_y;
+cx=cx>pic_width?pic_width:cx;
+cy=cy>pic_height?pic_height:cy;
+var cw=ax-pic_x>0?aw:aw-(pic_x-ax);
+var ch=ay-pic_y>0?ah:ah-(pic_y-ay);
+ch=ay+ah<pic_y+pic_height?ch:ch-(ay+ah-pic_y-pic_height);
+cw=ax+aw<pic_x+pic_width?cw:cw-(ax+aw-pic_x-pic_width);
+ch=ch<0?0:ch;
+cw=cw<0?0:cw;
+if(ant.style.visibility=="hidden"){
+cx="";
+cy="";
+cw="";
+ch="";
+}
+if(mode=="crop"){
+if(t_cx!=null){
+t_cx.value=cx*_27;
+}
+if(t_cy!=null){
+t_cy.value=cy*_27;
+}
+if(t_cw!=null){
+t_cw.value=cw*_27;
+}
+if(t_ch!=null){
+t_ch.value=ch*_27;
+}
+}else{
+if(mode=="scale"){
+var sw=aw,sh=ah;
+if(s_sw.value.indexOf("%")>0&&s_sh.value.indexOf("%")>0){
+sw=cw/pic_width;
+sh=ch/pic_height;
+}
+if(s_sw!=null){
+s_sw.value=sw*_27;
+}
+if(s_sh!=null){
+s_sh.value=sh*_27;
+}
+}
+}
+}
+function dragStopped(){
+dragapproved=false;
+if(ant==null||ant.style==null){
+return false;
+}
+if(mode=="measure"){
+jg_doc.drawLine(x-4,y,x+4,y);
+jg_doc.drawLine(x,y-4,x,y+4);
+jg_doc.drawLine(mx2-4,my2,mx2+4,my2);
+jg_doc.drawLine(mx2,my2-4,mx2,my2+4);
+jg_doc.paint();
+showStatus();
+return false;
+}
+var ah=parseInt(ant.style.height);
+var aw=parseInt(ant.style.width);
+var ax=parseInt(ant.style.left);
+var ay=parseInt(ant.style.top);
+jg_doc.clear();
+if(content!=null){
+if(content.width!=null&&content.height!=null){
+content.width=aw-1;
+content.height=ah-1;
+}
+}
+if(mode=="crop"){
+jg_doc.fillRectPattern(pic_x,pic_y,pic_width,ay-pic_y,pattern);
+var h1=ah;
+var y1=ay;
+if(ah+ay>=pic_height+pic_y){
+h1=pic_height+pic_y-ay;
+}else{
+if(ay<=pic_y){
+h1=ay+ah-pic_y;
+y1=pic_y;
+}
+}
+jg_doc.fillRectPattern(pic_x,y1,ax-pic_x,h1,pattern);
+jg_doc.fillRectPattern(ax+aw,y1,pic_x+pic_width-ax-aw,h1,pattern);
+jg_doc.fillRectPattern(pic_x,ay+ah,pic_width,pic_height+pic_y-ay-ah,pattern);
+}else{
+if(mode=="scale"){
+document.theImage.height=ah;
+document.theImage.width=aw;
+document.theImage.style.height=ah+" px";
+document.theImage.style.width=aw+" px";
+P7_Snap("theImage","ant",0,0);
+}
+}
+drawBoundHandle();
+jg_doc.paint();
+showStatus();
+return false;
+}
+document.onmousedown=drags;
+document.onmouseup=dragStopped;
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/assets/ImageEditor.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/assets/ImageEditor.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,76 @@
+.icons {
+    font: 11px Tahoma,Verdana,sans-serif;
+    color: #666699;
+    text-align: center;
+    text-decoration: none;
+    border: 1px solid #EEEEFF;
+    -Moz-Border-Radius: 6px 6px 6px 6px;
+}
+
+body, td, p {
+    font: 11px Tahoma,Verdana,sans-serif;
+}
+.iconsOver {
+    font: 11px Tahoma,Verdana,sans-serif;
+    color: #666699;
+    text-align: center;
+    text-decoration: none;
+    background-color: #F9F9FF;
+    border: 1px solid #666699;
+    -Moz-Border-Radius: 6px 6px 6px 6px;
+}
+.topBar {
+    font: 11px Tahoma,Verdana,sans-serif;
+    color: #666699;
+}
+.iconsSel {
+    font: 11px Tahoma,Verdana,sans-serif;
+    color: #666699;
+    text-align: center;
+    text-decoration: none;
+    border: 1px solid #666699;
+    -Moz-Border-Radius: 6px 6px 6px 6px;
+}
+.iconText {
+    font: 11px Tahoma,Verdana,sans-serif;
+    color: #666699;
+    text-decoration: none;
+    text-align: center;
+}
+.measureStats{
+    width: 50px;
+}
+
+#slidercasing {
+    /*border:1px solid #CCCCCC;
+    background-color:#FFFFFF;*/
+    width:100px;
+    height:5px;
+    position:relative;
+    z-index:4;
+    padding:10px;
+}
+
+
+#slidertrack {
+    position:relative;
+    border:1px solid #CCCCCC;
+    background-color:#FFFFCC;
+    z-index:5;
+    height:5px;
+}
+
+
+#sliderbar {
+    position:absolute;
+    z-index:6;
+    border:1px solid #CCCCCC;
+    background-color:#DDDDDD;
+    width:15px;     
+    padding:0px;
+    height:20px; 
+    cursor: pointer;
+    top:2px;
+}
+
+select, input, button { font: 11px Tahoma,Verdana,sans-serif; }
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/assets/dialog.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/assets/dialog.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,83 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/ExtendedFileManager/assets/dialog.js */
+function Dialog(_1,_2,_3){
+if(typeof _3=="undefined"){
+_3=window;
+}
+if(typeof window.showModalDialog=="function"){
+Dialog._return=_2;
+var r=window.showModalDialog(_1,_3,"dialogheight=10;dialogwidth=10;resizable=yes");
+}else{
+Dialog._geckoOpenModal(_1,_2,_3);
+}
+}
+Dialog._parentEvent=function(ev){
+setTimeout(function(){
+if(Dialog._modal&&!Dialog._modal.closed){
+Dialog._modal.focus();
+}
+},50);
+if(Dialog._modal&&!Dialog._modal.closed){
+Dialog._stopEvent(ev);
+}
+};
+Dialog._return=null;
+Dialog._modal=null;
+Dialog._arguments=null;
+Dialog._geckoOpenModal=function(_6,_7,_8){
+var _9="hadialog"+_6;
+var _a=/\W/g;
+_9=_9.replace(_a,"_");
+var _b=window.open(_6,_9,"toolbar=no,menubar=no,personalbar=no,width=10,height=10,"+"scrollbars=no,resizable=yes,modal=yes,dependable=yes");
+Dialog._modal=_b;
+Dialog._arguments=_8;
+function capwin(w){
+Dialog._addEvent(w,"click",Dialog._parentEvent);
+Dialog._addEvent(w,"mousedown",Dialog._parentEvent);
+Dialog._addEvent(w,"focus",Dialog._parentEvent);
+}
+function relwin(w){
+Dialog._removeEvent(w,"click",Dialog._parentEvent);
+Dialog._removeEvent(w,"mousedown",Dialog._parentEvent);
+Dialog._removeEvent(w,"focus",Dialog._parentEvent);
+}
+capwin(window);
+for(var i=0;i<window.frames.length;capwin(window.frames[i++])){
+}
+Dialog._return=function(_f){
+if(_f&&_7){
+_7(_f);
+}
+relwin(window);
+for(var i=0;i<window.frames.length;relwin(window.frames[i++])){
+}
+Dialog._modal=null;
+};
+};
+Dialog._addEvent=function(el,_12,_13){
+if(Dialog.is_ie){
+el.attachEvent("on"+_12,_13);
+}else{
+el.addEventListener(_12,_13,true);
+}
+};
+Dialog._removeEvent=function(el,_15,_16){
+if(Dialog.is_ie){
+el.detachEvent("on"+_15,_16);
+}else{
+el.removeEventListener(_15,_16,true);
+}
+};
+Dialog._stopEvent=function(ev){
+if(Dialog.is_ie){
+ev.cancelBubble=true;
+ev.returnValue=false;
+}else{
+ev.preventDefault();
+ev.stopPropagation();
+}
+};
+Dialog.agt=navigator.userAgent.toLowerCase();
+Dialog.is_ie=((Dialog.agt.indexOf("msie")!=-1)&&(Dialog.agt.indexOf("opera")==-1));
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/assets/dragTableCols.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/assets/dragTableCols.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,126 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/ExtendedFileManager/assets/dragTableCols.js */
+function dragTableCols(id){
+this.table=document.getElementById(id);
+var _2=this.table.rows[0].cells;
+this.ths=_2;
+var _3=this;
+var c;
+for(var j=0;j<this.table.rows.length;j++){
+for(var i=0;i<this.table.rows[j].cells.length;i++){
+c=this.table.rows[j].cells[i];
+c._i=i;
+dragTableCols.addEvent(c,"mousemove",function(e){
+_3.cellMouseMove(e);
+});
+dragTableCols.addEvent(c,"mouseover",function(e){
+e=e?e:window.event;
+var t=e.target||e.srcElement;
+t._pos=dragTableCols.getElementTopLeft(t);
+});
+}
+}
+function deactivate(){
+_3.drag=false;
+_3._col=null;
+document.body.style.cursor="";
+}
+dragTableCols.addEvent(document.body,"mousemove",function(e){
+_3.bodyMouseMove(e);
+});
+dragTableCols.addEvent(document.body,"mouseup",deactivate);
+}
+dragTableCols.prototype.cellMouseMove=function(e){
+e=e?e:window.event;
+var t=e.target||e.srcElement;
+if(typeof dragTableCols=="undefined"){
+return;
+}
+if(!t._pos){
+t._pos=dragTableCols.getElementTopLeft(t);
+return;
+}
+if(t.tagName.toLowerCase()!="td"&&t.tagName.toLowerCase()!="th"){
+return;
+}
+var _d=this;
+function activate(e){
+e=e?e:window.event;
+_d.drag=true;
+_d.startX=t._pos.left+t.offsetWidth;
+_d._col=t;
+var _f=t.offsetWidth;
+_d.startWidth=(t.width)?parseInt(t.width,10):t.offsetWidth;
+t.style.width=_d.startWidth+"px";
+_d.offset=t.offsetWidth-_f;
+t.style.width=_d.startWidth-_d.offset+"px";
+}
+if(t._pos.left+t.offsetWidth-dragTableCols.getPageX(e)<5&&t!=t.parentNode.cells[t.parentNode.cells.length-1]){
+t.style.cursor="e-resize";
+dragTableCols.addEvent(t,"mousedown",activate);
+}else{
+t.style.cursor="";
+dragTableCols.removeEvent(t,"mousedown",activate);
+}
+};
+dragTableCols.prototype.bodyMouseMove=function(e){
+if(!this.drag){
+return true;
+}
+e=e?e:window.event;
+var _11=dragTableCols.getPageX(e);
+var _12=_11-this.startX;
+document.body.style.cursor=(_12<0)?"e-resize":"w-resize";
+var _13=this.startWidth+_12-this.offset;
+this._col.style.width=((_13>10)?_13:10)+"px";
+return true;
+};
+dragTableCols.addEvent=function(obj,_15,fn){
+if(obj.addEventListener){
+obj.addEventListener(_15,fn,true);
+}else{
+if(obj.attachEvent){
+obj.attachEvent("on"+_15,fn);
+}else{
+return false;
+}
+}
+};
+dragTableCols.removeEvent=function(obj,_18,fn){
+if(obj.addEventListener){
+obj.removeEventListener(_18,fn,true);
+}else{
+if(obj.detachEvent){
+obj.detachEvent("on"+_18,fn);
+}else{
+return false;
+}
+}
+};
+dragTableCols.getElementTopLeft=function(_1a){
+var _1b=curtop=0;
+if(_1a.offsetParent){
+_1b=_1a.offsetLeft;
+curtop=_1a.offsetTop;
+while(_1a=_1a.offsetParent){
+_1b+=_1a.offsetLeft;
+curtop+=_1a.offsetTop;
+}
+}
+return {top:curtop,left:_1b};
+};
+dragTableCols.getPageX=function(e){
+if(e.pageX){
+return e.pageX;
+}else{
+if(document.documentElement&&document.documentElement.scrollTop){
+return document.documentElement.scrollLeft+e.clientX;
+}else{
+if(document.body){
+return document.body.scrollLeft+e.clientX;
+}
+}
+}
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/assets/editor.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/assets/editor.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,184 @@
+		body
+		{
+			margin: 0; padding: 0;
+			font: 11px Tahoma,Verdana,sans-serif;
+		}
+		select, input, button { font: 11px Tahoma,Verdana,sans-serif; }
+
+		#indicator
+		{
+			width: 20px;
+			height: 20px;
+			background-color: #eef;			
+			padding: 15px 20px;
+		}
+		* html #indicator
+		{
+			padding: 14px 22px;
+		}
+		#tools
+		{
+			background-color: #eef;
+			padding: 0;
+			border-left: 1px solid white;
+			border-bottom: 1px solid white;
+		}
+		#toolbar
+		{
+			background-color: #eef;
+			text-align: center;
+			padding: 5px;
+			border-top: 1px solid white;
+			border-right: 1px solid white;
+			vertical-align: top;
+			width:50px;
+		}
+		
+		#contents
+		{
+			position: relative;
+		}
+		
+		#editor
+		{
+			width: 100%;
+			height: 100%;
+		}
+
+		#toolbar a 
+		{
+			padding: 5px;
+			width: 40px;
+			display: block;
+			border: 1px solid #eef;
+			text-align: center;
+			text-decoration: none;
+			color: #669;
+			margin: 5px 0;
+		}
+		#toolbar a:hover
+		{
+			background-color: #F9F9FF;
+			border-color: #669;
+		}
+		
+		#toolbar a.iconActive
+		{
+			border-color: #669;
+		}
+
+		#toolbar a span
+		{
+			display: block;
+			text-decoration: none;
+			
+		}
+		#toolbar a img
+		{
+			border: 0 none;
+		}
+		
+		#tools .textInput
+		{
+			width: 3em;
+			vertical-align: 0px;
+
+		}
+		* html #tools .textInput
+		{
+			vertical-align: middle;
+		}
+		#tools .measureStats
+		{
+			width: 4.5em;
+			border: 0 none;
+			background-color: #eef;
+			vertical-align: 0px;
+		}
+		* html #tools .measureStats
+		{
+			vertical-align: middle;
+		}
+		#tools label
+		{
+			margin: 0 2px 0 5px;
+		}
+		#tools input
+		{
+			vertical-align: middle;
+		}
+		#tools .tool_inputs
+		{
+			padding-top: 10px;
+			float: left;			
+		}
+		#tools .div
+		{
+			vertical-align: middle;
+			margin: 0 5px;
+		}
+		#tools img
+		{
+			border: 0 none;
+		}
+		#tools a.buttons
+		{
+			margin-top: 10px;
+			border: 1px solid #eef;
+			display: block;
+			float: left;
+		}
+		#tools a.buttons:hover
+		{
+			background-color: #F9F9FF;
+			border-color: #669;
+		}
+		#slidercasing {
+    /*border:1px solid #CCCCCC;
+    background-color:#FFFFFF;*/
+    width:100px;
+    height:5px;
+    position:relative;
+    z-index:4;
+    padding:10px;
+	 top: 6px;
+	 margin: 0 -5px 0 -10px;
+
+	
+}
+
+
+#slidertrack {
+    position:relative;
+    border:1px solid #CCCCCC;
+    background-color:#FFFFCC;
+    z-index:5;
+    height:5px;
+}
+
+
+#sliderbar {
+    position:absolute;
+    z-index:6;
+    border:1px solid #CCCCCC;
+    background-color:#DDDDDD;
+    width:15px;     
+    padding:0px;
+    height:20px; 
+    cursor: pointer;
+    top:2px;
+}
+
+* html #slidercasing
+{
+	top:0;
+}
+
+
+#bottom
+{
+	position: relative;
+	top: 490px;
+}
+
+#save_filename {width: 100px;}
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/assets/editor.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/assets/editor.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,192 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/ExtendedFileManager/assets/editor.js */
+var current_action=null;
+var actions=["crop","scale","rotate","measure","save"];
+var orginal_width=null,orginal_height=null;
+function toggle(_1){
+if(current_action!=_1){
+for(var i in actions){
+if(actions[i]!=_1){
+var _3=document.getElementById("tools_"+actions[i]);
+_3.style.display="none";
+var _4=document.getElementById("icon_"+actions[i]);
+_4.className="";
+}
+}
+current_action=_1;
+var _3=document.getElementById("tools_"+_1);
+_3.style.display="block";
+var _4=document.getElementById("icon_"+_1);
+_4.className="iconActive";
+var _5=document.getElementById("indicator_image");
+_5.src="img/"+_1+".gif";
+editor.setMode(current_action);
+if(_1=="scale"){
+var _6=editor.window.document.getElementById("theImage");
+orginal_width=_6._width;
+orginal_height=_6._height;
+var w=document.getElementById("sw");
+w.value=orginal_width;
+var h=document.getElementById("sh");
+h.value=orginal_height;
+}
+if(_1=="save"){
+var _9=document.getElementById("save_format");
+var _a=document.getElementById("save_filename").value.match(/\.(gif|png|jpe?g)/i)[1].toLowerCase();
+switch(_a){
+case "png":
+_9.selectedIndex="3";
+break;
+case "gif":
+_9.selectedIndex="4";
+break;
+default:
+_9.selectedIndex="0";
+break;
+}
+_9.onchange();
+}
+}
+}
+function toggleMarker(){
+var _b=document.getElementById("markerImg");
+if(_b!=null&&_b.src!=null){
+if(_b.src.indexOf("t_black.gif")>=0){
+_b.src="img/t_white.gif";
+}else{
+_b.src="img/t_black.gif";
+}
+editor.toggleMarker();
+}
+}
+function toggleConstraints(){
+var _c=document.getElementById("scaleConstImg");
+var _d=document.getElementById("constProp");
+if(_c!=null&&_c.src!=null){
+if(_c.src.indexOf("unlocked2.gif")>=0){
+_c.src="img/islocked2.gif";
+_d.checked=true;
+checkConstrains("width");
+}else{
+_c.src="img/unlocked2.gif";
+_d.checked=false;
+}
+}
+}
+function checkConstrains(_e){
+var _f=document.getElementById("constProp");
+if(_f.checked){
+var w=document.getElementById("sw");
+var _11=w.value;
+var h=document.getElementById("sh");
+var _13=h.value;
+if(orginal_width>0&&orginal_height>0){
+if(_e=="width"&&_11>0){
+h.value=parseInt((_11/orginal_width)*orginal_height);
+}else{
+if(_e=="height"&&_13>0){
+w.value=parseInt((_13/orginal_height)*orginal_width);
+}
+}
+}
+}
+updateMarker("scale");
+}
+function updateMarker(_14){
+if(_14=="crop"){
+var _15=document.getElementById("cx");
+var _16=document.getElementById("cy");
+var _17=document.getElementById("cw");
+var _18=document.getElementById("ch");
+editor.setMarker(parseInt(_15.value),parseInt(_16.value),parseInt(_17.value),parseInt(_18.value));
+}else{
+if(_14=="scale"){
+var _19=document.getElementById("sw");
+var _1a=document.getElementById("sh");
+editor.setMarker(0,0,parseInt(_19.value),parseInt(_1a.value));
+}
+}
+}
+function rotateSubActionSelect(_1b){
+var _1c=_1b.options[_1b.selectedIndex].value;
+var _1d=document.getElementById("rotate_preset_select");
+var _1e=document.getElementById("flip");
+var _1f=document.getElementById("ra").parentNode;
+switch(_1c){
+case "rotate":
+_1d.style.display="";
+_1e.style.display="none";
+_1f.style.display="";
+break;
+case "flip":
+_1d.style.display="none";
+_1e.style.display="";
+_1f.style.display="none";
+break;
+}
+}
+function rotatePreset(_20){
+var _21=_20.options[_20.selectedIndex].value;
+if(_21.length>0&&parseInt(_21)!=0){
+var ra=document.getElementById("ra");
+ra.value=parseInt(_21);
+}
+}
+function updateFormat(_23){
+var _24=_23.options[_23.selectedIndex].value;
+var _25=_24.split(",");
+if(_25[0]!="jpeg"){
+document.getElementById("slider").style.display="none";
+}else{
+document.getElementById("slider").style.display="inline";
+}
+if(_25.length>1){
+updateSlider(parseInt(_25[1]));
+}
+}
+function zoom(){
+var _26=editor.window.document.getElementById("theImage");
+var _27=document.getElementById("zoom").value;
+_26.width=_26._width*parseInt(_27,10)/100;
+_26.height=_26._height*parseInt(_27,10)/100;
+editor.reset();
+editor.pic_width=null;
+editor.pic_height=null;
+}
+function addEvent(obj,_29,fn){
+if(obj.addEventListener){
+obj.addEventListener(_29,fn,true);
+return true;
+}else{
+if(obj.attachEvent){
+var r=obj.attachEvent("on"+_29,fn);
+return r;
+}else{
+return false;
+}
+}
+}
+var init=function(){
+if(window.opener){
+__xinha_dlg_init();
+__dlg_translate("ExtendedFileManager");
+}
+addEvent(window,"resize",winOnResize);
+try{
+window.moveTo(0,0);
+}
+catch(e){
+}
+window.resizeTo(window.screen.availWidth,window.screen.availHeight);
+winOnResize();
+};
+function winOnResize(){
+if(typeof editor.reset=="function"&&typeof editor.ant!="undefined"){
+editor.reset();
+}
+var win=Xinha.viewportSize(window);
+document.getElementById("contents").style.height=win.y-parseInt(document.getElementById("indicator").offsetHeight,10)-5+"px";
+}
+Xinha.addOnloadHandler(init,window);
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/assets/editorFrame.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/assets/editorFrame.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,17 @@
+body { margin: 0; padding: 0;  background-color: #eee; }
+table { width: 100%; }
+table td { text-align: center; }
+.crop{cursor:crosshair;}
+.selection { border: dotted 1px #000000; position:absolute; width: 0px; height: 1px; z-index:5; }
+.selectionWhite{ border: dotted 1px #FFFFFF; position:absolute; width: 0px; height: 1px; z-index:5; }
+.handleBox{ z-index:105; }
+.error { font-size:large; font-weight:bold; color:#c00; font-family: Helvetica, sans-serif; } 
+
+#n-resize  {cursor: n-resize  }
+#s-resize  {cursor: s-resize  }
+#w-resize  {cursor: w-resize  }
+#e-resize  {cursor: e-resize  }
+#nw-resize {cursor: nw-resize }
+#sw-resize {cursor: sw-resize }
+#ne-resize {cursor: ne-resize }
+#se-resize {cursor: se-resize }
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/assets/editorFrame.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/assets/editorFrame.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,91 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/ExtendedFileManager/assets/editorFrame.js */
+var topDoc=window.top.document;
+var t_cx=topDoc.getElementById("cx");
+var t_cy=topDoc.getElementById("cy");
+var t_cw=topDoc.getElementById("cw");
+var t_ch=topDoc.getElementById("ch");
+var m_sx=topDoc.getElementById("sx");
+var m_sy=topDoc.getElementById("sy");
+var m_w=topDoc.getElementById("mw");
+var m_h=topDoc.getElementById("mh");
+var m_a=topDoc.getElementById("ma");
+var m_d=topDoc.getElementById("md");
+var s_sw=topDoc.getElementById("sw");
+var s_sh=topDoc.getElementById("sh");
+var r_ra=topDoc.getElementById("ra");
+var pattern="img/2x2.gif";
+function doSubmit(_1){
+if(_1=="crop"){
+var _2=_backend_url+"__function=editorFrame&img="+currentImageFile+"&action=crop&params="+parseInt(t_cx.value)+","+parseInt(t_cy.value)+","+parseInt(t_cw.value)+","+parseInt(t_ch.value);
+location.href=_2;
+}else{
+if(_1=="scale"){
+var _2=_backend_url+"__function=editorFrame&img="+currentImageFile+"&action=scale&params="+parseInt(s_sw.value)+","+parseInt(s_sh.value);
+location.href=_2;
+}else{
+if(_1=="rotate"){
+var _3=topDoc.getElementById("rotate_sub_action");
+if(_3.value=="flip"){
+location.href=_backend_url+"__function=editorFrame&img="+currentImageFile+"&action=flip&params="+topDoc.getElementById("flip").value;
+}else{
+if(isNaN(parseFloat(r_ra.value))==false){
+location.href=_backend_url+"__function=editorFrame&img="+currentImageFile+"&action=rotate&params="+parseFloat(r_ra.value);
+}
+}
+}else{
+if(_1=="save"){
+var _4=topDoc.getElementById("save_filename");
+var _5=topDoc.getElementById("save_format");
+var _6=topDoc.getElementById("quality");
+var _7=_5.value.split(",");
+if(_4.value.length<=0){
+alert(i18n("Please enter a filename to save."));
+}else{
+var _8=encodeURI(_4.value);
+var _9=parseInt(_6.value);
+var _7=_5.value.split(",");
+var _2=_backend_url+"__function=editorFrame&img="+currentImageFile+"&action=save&params="+_7[0]+","+_9+"&file="+_8;
+location.href=_2;
+}
+}else{
+if(_1=="preview"){
+var _5=topDoc.getElementById("save_format");
+var _6=topDoc.getElementById("quality");
+var _9=parseInt(_6.value);
+var _7=_5.value.split(",");
+var _2=_backend_url+"__function=editorFrame&img="+currentImageFile+"&action=preview&params="+_7[0]+","+_9+"&file="+_8;
+location.href=_2;
+}
+}
+}
+}
+}
+}
+function addEvent(_a,_b,fn){
+if(_a.addEventListener){
+_a.addEventListener(_b,fn,true);
+return true;
+}else{
+if(_a.attachEvent){
+var r=_a.attachEvent("on"+_b,fn);
+return r;
+}else{
+return false;
+}
+}
+}
+var jg_doc;
+init=function(){
+jg_doc=new jsGraphics("imgCanvas");
+jg_doc.setColor("#000000");
+initEditor();
+if(window.parent.document.getElementById("zoom").value!="100"){
+window.parent.zoom();
+}
+reset();
+window.parent.document.getElementById("filesize").innerHTML=fileSize;
+};
+addEvent(window,"load",init);
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/assets/hover.htc
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/assets/hover.htc	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,34 @@
+<attach event="onmouseover" handler="hoverRollOver" />
+<attach event="onmouseout" handler="hoverRollOff" />
+<script type="text/javascript">
+//
+//	Simple behaviour for IE5+ to emulate :hover CSS pseudo-class.
+//  Experimental ver 0.1
+//
+//	This is an experimental version! Handle with care!
+//	Manual at: http://www.hszk.bme.hu/~hj130/css/list_menu/hover/
+//
+
+function hoverRollOver() {
+	
+	element.origClassName = element.className;	// backup origonal className
+	
+	var tempClassStr = element.className;		
+	
+	tempClassStr += "Hover";					// convert name+'Hover' the last class name	to emulate tag.class:hover
+	
+	tempClassStr = tempClassStr.replace(/\s/g,"Hover ");	//convert name+'Hover' the others to emulate tag.class:hover
+	
+	tempClassStr += " hover";				// add simple 'hover' class name to emulate tag:hover
+	
+	element.className = element.className + " " + tempClassStr; 
+	
+	//alert(element.className);
+	//window.status = element.className;		// only for TEST
+}
+function hoverRollOff() {
+	element.className = element.origClassName;
+}
+
+</script>
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/assets/imagelist.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/assets/imagelist.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,55 @@
+body { margin: 0; padding: 0;}
+.edit,.dir_holder .fileName, .thumb_holder .fileName    { font-size: 8pt; font-family: small-caption, sans-serif; padding-top: 3px;}
+.edit a { border: none; padding: 0; text-decoration:none; }
+.edit a:hover { background-color: ButtonHighlight; }
+.edit a img { border: none; vertical-align: bottom; }
+.noResult { font-size:large; font-weight:bold; color:#ccc; font-family: Helvetica, sans-serif;  text-align: center;  padding-top: 60px;   }
+.error { color:#c00; font-weight:bold; font-size: medium; font-family: Helvetica, sans-serif; text-align: center;  padding-top: 65px;}
+
+.dir_holder, .thumb_holder
+{
+  width:106px; height:132px;
+  float:left;
+  margin:6px 4px;
+  background-color:ButtonFace;
+  border: 1px outset;
+}
+
+.thumb_holder.active
+{
+  background:Highlight;
+  color:HighlightText;
+  border:1px dashed Highlight;
+}
+
+.dir_holder a.dir, .thumb_holder a.thumb
+{
+  height:85px;
+  display:block;
+  text-align:center;
+  padding:5px;
+  text-decoration:none;
+  overflow:hidden;
+}
+
+.thumb_holder a.thumb img
+{
+  border:1px solid black;
+}
+
+.dir_holder a.dir img
+{
+  border:none;
+}
+
+.listview { width:100%; }
+.listview td, .listview th { text-align:left; font-size:small; }
+.listview td.actions { text-align: right;width:111px }
+.listview td.actions img { border:0; }
+
+.listview thead th {background-color: ButtonFace; border: 1px solid threedface; border-color: ButtonHighlight ButtonShadow ButtonShadow ButtonHighlight; padding-top:2px; padding-bottom:2px; padding-left: 5px; padding-right: 5px; font-size: 9pt; font-family: "MS Sans Serif", "Bitstream Vera Sans", Geneva, Sans, sans-serif;font-weight:normal}
+.listview tbody td, .listview tbody th {overflow:hidden; padding-top:2px; padding-left: 3px; font-size: 9pt;  font-family: "MS Sans Serif", "Bitstream Vera Sans", Geneva, Sans, sans-serif;}
+.listview tbody a, listview tbody a:visited { font-weight: normal; text-decoration: none; color: #000; border:0px; padding:2px;}
+.listview tbody a:hover { background-color:#0B256B; color:#fff;}
+
+.listview tbody tr:hover {background-color: rgb(221,221,255)};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/assets/images.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/assets/images.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,245 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/ExtendedFileManager/assets/images.js */
+function i18n(_1){
+return Xinha._lc(_1,"ExtendedFileManager");
+}
+function changeDir(_2){
+showMessage("Loading");
+var _3=window.top.document.getElementById("manager_mode").value;
+var _4=window.top.document.getElementById("viewtype");
+var _5=_4.options[_4.selectedIndex].value;
+location.href=_backend_url+"__function=images&mode="+_3+"&dir="+_2+"&viewtype="+_5;
+document.cookie="EFMStartDir"+_3+"="+_2;
+}
+function newFolder(_6,_7){
+var _8=window.top.document.getElementById("manager_mode").value;
+var _9=window.top.document.getElementById("viewtype");
+var _a=_9.options[_9.selectedIndex].value;
+location.href=_backend_url+"__function=images&mode="+_8+"&dir="+_6+"&newDir="+_7+"&viewtype="+_a;
+}
+function renameFile(_b){
+var _c=_b.replace(/.*%2F/,"").replace(/\..*$/,"");
+var _d=function(_e){
+if(_e==""||_e==null||_e==_c){
+alert(i18n("Cancelled rename."));
+return false;
+}
+var _f=window.top.document.getElementById("manager_mode").value;
+var _10=window.top.document.getElementById("dirPath");
+var dir=_10.options[_10.selectedIndex].value;
+_10=window.top.document.getElementById("viewtype");
+var _12=_10.options[_10.selectedIndex].value;
+location.href=_backend_url+"__function=images&mode="+_f+"&dir="+dir+"&rename="+_b+"&renameTo="+_e+"&viewtype="+_12;
+};
+if(Xinha.ie_version>6){
+popupPrompt(i18n("Please enter new name for this file..."),_c,_d,i18n("Rename"));
+}else{
+var _13=prompt(i18n("Please enter new name for this file..."),_c);
+_d(_13);
+}
+}
+function renameDir(_14){
+function rename(_15){
+if(_15==""||_15==null||_15==_14){
+alert(i18n("Cancelled rename."));
+return false;
+}
+var _16=window.top.document.getElementById("manager_mode").value;
+var _17=window.top.document.getElementById("dirPath");
+var dir=_17.options[_17.selectedIndex].value;
+_17=window.top.document.getElementById("viewtype");
+var _19=_17.options[_17.selectedIndex].value;
+location.href=_backend_url+"__function=images&mode="+_16+"&dir="+dir+"&rename="+_14+"&renameTo="+_15+"&viewtype="+_19;
+}
+if(Xinha.ie_version>6){
+popupPrompt(i18n("Please enter new name for this folder..."),_14,rename,i18n("Rename"));
+}else{
+var _1a=prompt(i18n("Please enter new name for this folder..."),_14);
+rename(_1a);
+}
+}
+function copyFile(_1b,_1c){
+var _1d=window.top.document.getElementById("dirPath");
+var dir=_1d.options[_1d.selectedIndex].value;
+window.top.pasteButton({"dir":dir,"file":_1b,"action":_1c+"File"});
+}
+function copyDir(_1f,_20){
+var _21=window.top.document.getElementById("dirPath");
+var dir=_21.options[_21.selectedIndex].value;
+window.top.pasteButton({"dir":dir,"file":_1f,"action":_20+"Dir"});
+}
+function paste(_23){
+var _24=window.top.document.getElementById("manager_mode").value;
+var _25=window.top.document.getElementById("dirPath");
+var dir=_25.options[_25.selectedIndex].value;
+_25=window.top.document.getElementById("viewtype");
+var _27=_25.options[_25.selectedIndex].value;
+location.href=_backend_url+"__function=images&mode="+_24+"&dir="+dir+"&paste="+_23.action+"&srcdir="+_23.dir+"&file="+_23.file+"&viewtype="+_27;
+}
+function updateDir(_28){
+var _29=window.top.document.getElementById("manager_mode").value;
+document.cookie="EFMStartDir"+_29+"="+_28;
+var _2a=window.top.document.getElementById("dirPath");
+if(_2a){
+for(var i=0;i<_2a.length;i++){
+var _2c=_2a.options[i].text;
+if(_2c==_28){
+_2a.selectedIndex=i;
+showMessage("Loading");
+break;
+}
+}
+}
+}
+function emptyProperties(){
+toggleImageProperties(false);
+var _2d=window.top.document;
+_2d.getElementById("f_url").value="";
+_2d.getElementById("f_alt").value="";
+_2d.getElementById("f_title").value="";
+_2d.getElementById("f_width").value="";
+_2d.getElementById("f_margin").value="";
+_2d.getElementById("f_height").value="";
+_2d.getElementById("f_padding").value="";
+_2d.getElementById("f_border").value="";
+_2d.getElementById("f_borderColor").value="";
+_2d.getElementById("f_backgroundColor").value="";
+}
+function toggleImageProperties(val){
+var _2f=window.top.document;
+if(val==true){
+_2f.getElementById("f_width").value="";
+_2f.getElementById("f_margin").value="";
+_2f.getElementById("f_height").value="";
+_2f.getElementById("f_padding").value="";
+_2f.getElementById("f_border").value="";
+_2f.getElementById("f_borderColor").value="";
+_2f.getElementById("f_backgroundColor").value="";
+}
+_2f.getElementById("f_width").disabled=val;
+_2f.getElementById("f_margin").disabled=val;
+_2f.getElementById("f_height").disabled=val;
+_2f.getElementById("f_padding").disabled=val;
+_2f.getElementById("f_align").disabled=val;
+_2f.getElementById("f_border").disabled=val;
+_2f.getElementById("f_borderColor").value="";
+_2f.getElementById("f_backgroundColor").value="";
+_2f.getElementById("constrain_prop").disabled=val;
+}
+function selectImage(_30,alt,_32,_33){
+var _34=window.top.document;
+if(_34.getElementById("manager_mode").value=="image"){
+var obj=_34.getElementById("f_url");
+obj.value=_30;
+obj=_34.getElementById("f_alt");
+obj.value=alt;
+obj=_34.getElementById("f_title");
+obj.value=alt;
+if(_32==0&&_33==0){
+toggleImageProperties(true);
+}else{
+toggleImageProperties(false);
+var obj=_34.getElementById("f_width");
+obj.value=_32;
+var obj=_34.getElementById("f_height");
+obj.value=_33;
+var obj=_34.getElementById("orginal_width");
+obj.value=_32;
+var obj=_34.getElementById("orginal_height");
+obj.value=_33;
+update_selected();
+}
+}else{
+if(_34.getElementById("manager_mode").value=="link"){
+var obj=_34.getElementById("f_href");
+obj.value=_30;
+var obj=_34.getElementById("f_title");
+obj.value=alt;
+}
+}
+return false;
+}
+var _current_selected=null;
+function update_selected(){
+var _36=window.top.document;
+if(_current_selected){
+_current_selected.className=_current_selected.className.replace(/(^| )active( |$)/,"$1$2");
+_current_selected=null;
+}
+var _37=_36.getElementById("f_url").value;
+var _38=_36.getElementById("dirPath");
+var _39=_38.options[_38.selectedIndex].text;
+var dRe=new RegExp("^("+_39.replace(/([\/\^$*+?.()|{}[\]])/g,"\\$1")+")([^/]*)$");
+if(dRe.test(_37)){
+var _3b=document.getElementById("holder_"+asc2hex(RegExp.$2));
+if(_3b){
+_current_selected=_3b;
+_3b.className+=" active";
+}
+}
+showPreview(_37);
+}
+function asc2hex(str){
+var _3d="";
+for(var i=0;i<str.length;i++){
+var hex=(str.charCodeAt(i)).toString(16);
+if(hex.length==1){
+hex="0"+hex;
+}
+_3d+=hex;
+}
+return _3d;
+}
+function showMessage(_40){
+var _41=window.top.document;
+var _42=_41.getElementById("message");
+var _43=_41.getElementById("messages");
+if(_42&&_43){
+if(_42.firstChild){
+_42.removeChild(_42.firstChild);
+}
+_42.appendChild(_41.createTextNode(i18n(_40)));
+_43.style.display="block";
+}
+}
+function updateDiskMesg(_44){
+var _45=window.top.document;
+var _46=_45.getElementById("diskmesg");
+if(_46){
+if(_46.firstChild){
+_46.removeChild(_46.firstChild);
+}
+_46.appendChild(_45.createTextNode(_44));
+}
+}
+function addEvent(obj,_48,fn){
+if(obj.addEventListener){
+obj.addEventListener(_48,fn,true);
+return true;
+}else{
+if(obj.attachEvent){
+var r=obj.attachEvent("on"+_48,fn);
+return r;
+}else{
+return false;
+}
+}
+}
+function confirmDeleteFile(_4b){
+if(confirm(i18n("Delete file \"$file="+_4b+"$\"?"))){
+return true;
+}
+return false;
+}
+function confirmDeleteDir(dir,_4d){
+if(confirm(i18n("Delete folder \"$dir="+dir+"$\"?"))){
+return true;
+}
+return false;
+}
+function showPreview(_4e){
+window.parent.document.getElementById("f_preview").src=_4e?window.parent._backend_url+"__function=thumbs&img="+_4e:window.parent.opener.Xinha.getPluginDir("ExtendedFileManager")+"/img/1x1_transparent.gif";
+}
+addEvent(window,"load",init);
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/assets/manager.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/assets/manager.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,49 @@
+html, body, .dialog {  background-color: ButtonFace;  color: ButtonText; font: 11px Tahoma,Verdana,sans-serif; margin: 0; padding: 0;}
+body { padding: 5px; }
+fieldset { padding: 0;}
+.title { background-color: #ddf; color: #000; font-weight: bold; font-size: 120%; padding: 3px 10px; margin-bottom: 10px; border-bottom: 1px  solid black; letter-spacing: 2px;}
+form { padding: 0px;  margin: 0 auto; width: 100%;}
+/*.dirWidth { width: 60%; }*/
+a { padding: 5px; border: 1px solid ButtonFace;	}	
+a img	{ border: 0; }	
+a:hover { border-color: ButtonHighlight ButtonShadow ButtonShadow ButtonHighlight; }
+.dirs {	padding: 1em; 	}
+
+.imageFrame { overflow-x:hidden; width: 100%; height: 155px; margin:0px; background-color: #fff;}
+.smallWidth{ width: 4em; }
+.largelWidth{ width: 30em; }
+.extralargelWidth{ width: 100%; }
+.inputTable { margin: 1em auto 1em 0;width:100%}
+select, input, button { font: 11px Tahoma,Verdana,sans-serif; }
+.buttons { width: 70px; text-align: center; }
+.clearboth{ clear: both; }
+#messages {opacity:0.8;filter:Alpha(opacity=85);position:relative;height:20px;margin-bottom:-30px;background-color: white;  border: none; text-align: center; padding: 5px; }
+#message  { font-size: 15px; font-weight: bold; color: #69c; }
+iframe { border:1px inset; border-right:none; border-left:none; border-bottom:none; }
+#controls {padding-bottom:10px;}
+table { margin-top:10px; }
+th, td { padding-right:3px; text-align:left; font-family:small-caption,helvetica,sans-serif; }
+.dirWidth {width: 59%}
+
+.buttonColor {
+  width :1em;
+  margin-left: 2px;
+  cursor: default;
+}
+
+.buttonColor .chooser, .buttonColor .nocolor {
+  height: 0.6em;
+  border: 1px solid;
+  padding: 0px 1em;
+  border-color: ButtonHighlight ButtonShadow ButtonShadow ButtonHighlight;
+}
+
+.buttonColor .buttonClick {
+  border-color: ButtonShadow ButtonHighlight ButtonHighlight ButtonShadow;
+}
+.buttonColor .buttonColor-hilite {
+  border-color: ButtonShadow ButtonHighlight ButtonHighlight ButtonShadow;
+}
+
+.buttonColor .nocolor { padding: 0px; }
+.buttonColor .nocolor-hilite { background-color: #fff; color: #f00; }
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/assets/manager.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/assets/manager.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,401 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/ExtendedFileManager/assets/manager.js */
+function comboSelectValue(c,_2){
+var _3=c.getElementsByTagName("option");
+for(var i=_3.length;--i>=0;){
+var op=_3[i];
+op.selected=(op.value==_2);
+}
+c.value=_2;
+}
+function i18n(_6){
+return Xinha._lc(_6,"ExtendedFileManager");
+}
+function setAlign(_7){
+var _8=document.getElementById("f_align");
+for(var i=0;i<_8.length;i++){
+if(_8.options[i].value==_7){
+_8.selectedIndex=i;
+break;
+}
+}
+}
+function onTargetChanged(){
+var f=document.getElementById("f_other_target");
+if(this.value=="_other"){
+f.style.visibility="visible";
+f.select();
+f.focus();
+}else{
+f.style.visibility="hidden";
+}
+}
+function init(){
+if(typeof imgManager=="undefined"){
+setTimeout(init,10);
+return;
+}
+var w=650;
+var h=600;
+window.resizeTo(w,h);
+var _d=Xinha.pageSize(window);
+window.resizeTo(w,h);
+var _e=Xinha.viewportSize(window);
+window.resizeBy(0,_d.y-_e.y+5);
+_e=Xinha.viewportSize(window);
+if(!Xinha.is_ie){
+var x=opener.screenX+(opener.outerWidth-_e.x)/2;
+var y=opener.screenY+(opener.outerHeight-_e.x)/2;
+}else{
+var x=(self.screen.availWidth-_e.x)/2;
+var y=(self.screen.availHeight-_e.y)/2;
+}
+window.moveTo(x,y);
+__xinha_dlg_init();
+__dlg_translate("ExtendedFileManager");
+var _11=document.getElementById("uploadForm");
+if(_11){
+_11.target="imgManager";
+}
+var _12=window.dialogArguments.editor;
+var _13=window.dialogArguments.param;
+var _14=null;
+if(manager_mode=="image"&&_13){
+var _15=new RegExp("^https?://");
+if(_13.f_url.length>0&&!_15.test(_13.f_url)&&typeof _13.baseHref=="string"){
+_13.f_url=_13.baseHref+_13.f_url;
+}
+var _16=new RegExp("(https?://[^/]*)?"+base_url.replace(/\/$/,""));
+_13.f_url=_13.f_url.replace(_16,"");
+var rd=(_resized_dir)?_resized_dir.replace(Xinha.RE_Specials,"\\$1")+"/":"";
+var rp=_resized_prefix.replace(Xinha.RE_Specials,"\\$1");
+var _19=new RegExp("^(.*/)"+rd+rp+"_([0-9]+)x([0-9]+)_([^/]+)$");
+var _1a=_13.f_url.match(_19);
+if(_19.test(_13.f_url)){
+_13.f_url=RegExp.$1+RegExp.$4;
+_13.f_width=RegExp.$2;
+_13.f_height=RegExp.$3;
+}
+document.getElementById("f_url").value=_13["f_url"];
+document.getElementById("f_alt").value=_13["f_alt"];
+document.getElementById("f_title").value=_13["f_title"];
+document.getElementById("f_border").value=_13["f_border"];
+document.getElementById("f_width").value=_13["f_width"];
+document.getElementById("f_height").value=_13["f_height"];
+document.getElementById("f_margin").value=_13["f_margin"];
+document.getElementById("f_padding").value=_13["f_padding"];
+document.getElementById("f_borderColor").value=_13["f_borderColor"];
+document.getElementById("f_backgroundColor").value=_13["f_backgroundColor"];
+setAlign(_13["f_align"]);
+document.getElementById("f_url").focus();
+document.getElementById("orginal_width").value=_13["f_width"];
+document.getElementById("orginal_height").value=_13["f_height"];
+var _19=new RegExp("^(.*/)([^/]+)$");
+if(_19.test(_13["f_url"])){
+_14=RegExp.$1;
+}
+document.getElementById("f_preview").src=_backend_url+"__function=thumbs&img="+_13.f_url;
+}else{
+if(manager_mode=="link"&&_13){
+var _1b=document.getElementById("f_target");
+var _1c=true;
+var _15=new RegExp("^https?://");
+if(_13.f_href.length>0&&!_15.test(_13.f_href)&&typeof _13.baseHref=="string"){
+_13.f_href=_13.baseHref+_13.f_href;
+}
+var _1d=new RegExp("(https?://[^/]*)?"+base_url.replace(/\/$/,""));
+_13.f_href=_13.f_href.replace(_1d,"");
+var _19=new RegExp("^(.*/)([^/]+)$");
+if(_19.test(_13["f_href"])){
+_14=RegExp.$1;
+}else{
+_14=document.cookie.match(/EFMStartDirlink=(.*?)(;|$)/);
+if(_14){
+_14=_14[1];
+}
+}
+if(_13){
+if(typeof _13["f_usetarget"]!="undefined"){
+_1c=_13["f_usetarget"];
+}
+if(typeof _13["f_href"]!="undefined"){
+document.getElementById("f_href").value=_13["f_href"];
+document.getElementById("f_title").value=_13["f_title"];
+comboSelectValue(_1b,_13["f_target"]);
+if(_1b.value!=_13.f_target){
+var opt=document.createElement("option");
+opt.value=_13.f_target;
+opt.innerHTML=opt.value;
+_1b.appendChild(opt);
+opt.selected=true;
+}
+}
+}
+if(!_1c){
+document.getElementById("f_target_label").style.visibility="hidden";
+document.getElementById("f_target").style.visibility="hidden";
+document.getElementById("f_other_target").style.visibility="hidden";
+}
+var opt=document.createElement("option");
+opt.value="_other";
+opt.innerHTML=i18n("Other");
+_1b.appendChild(opt);
+_1b.onchange=onTargetChanged;
+document.getElementById("f_href").focus();
+}else{
+if(!_13){
+_14=document.cookie.match(new RegExp("EFMStartDir"+manager_mode+"=(.*?)(;|$)"));
+if(_14){
+_14=_14[1];
+}
+}
+}
+}
+if(_14){
+iframeUrl+="&dir="+_14;
+var _1f=document.getElementById("dirPath");
+for(var i=0;i<_1f.options.length;i++){
+if(_1f.options[i].value==encodeURIComponent(_14)){
+_1f.options[i].selected=true;
+break;
+}
+}
+}
+imgManager.location.replace(iframeUrl);
+if(manager_mode=="image"&&typeof Xinha.colorPicker!="undefined"&&document.getElementById("f_backgroundColor")&&document.getElementById("f_backgroundColor").type=="text"){
+var _21={cellsize:_12.config.colorPickerCellSize,granularity:_12.config.colorPickerGranularity,websafe:_12.config.colorPickerWebSafe,savecolors:_12.config.colorPickerSaveColors};
+new Xinha.colorPicker.InputBinding(document.getElementById("f_backgroundColor"),_21);
+new Xinha.colorPicker.InputBinding(document.getElementById("f_borderColor"),_21);
+}
+setTimeout(function(){
+resize();
+addEvent(window,"resize",resize);
+},500);
+}
+function pasteButton(_22){
+var _23=document.getElementById("pasteBtn");
+if(!_23.firstChild){
+var a=document.createElement("a");
+a.href="javascript:void(0);";
+var img=document.createElement("img");
+img.src=window.opener.Xinha.getPluginDir("ExtendedFileManager")+"/img/edit_paste.gif";
+img.alt=i18n("Paste");
+a.appendChild(img);
+_23.appendChild(a);
+}
+_23.onclick=function(){
+if(typeof imgManager!="undefined"){
+imgManager.paste(_22);
+}
+if(_22.action=="moveFile"||_22.action=="moveDir"){
+this.onclick=null;
+this.removeChild(this.firstChild);
+}
+};
+switch(_22.action){
+case "copyFile":
+_23.firstChild.title=i18n("Copy \"$file="+_22.file+"$\" from \"$dir="+decodeURIComponent(_22.dir)+"$\" here");
+break;
+case "copyDir":
+_23.firstChild.title=i18n("Copy folder \"$file="+_22.file+"$\" from \"$dir="+decodeURIComponent(_22.dir)+"$\" here");
+break;
+case "moveFile":
+_23.firstChild.title=i18n("Move \"$file="+_22.file+"$\" from \"$dir="+decodeURIComponent(_22.dir)+"$\" here");
+break;
+break;
+case "moveDir":
+_23.firstChild.title=i18n("Move folder \"$file="+_22.file+"$\" from \"$dir="+decodeURIComponent(_22.dir)+"$\" here");
+break;
+}
+}
+function onCancel(){
+__dlg_close(null);
+return false;
+}
+function onOK(){
+if(manager_mode=="image"){
+var _26=["f_url","f_alt","f_title","f_align","f_border","f_margin","f_padding","f_height","f_width","f_borderColor","f_backgroundColor"];
+var _27=new Object();
+for(var i in _26){
+var id=_26[i];
+var el=document.getElementById(id);
+if(id=="f_url"&&el.value.indexOf("://")<0&&el.value){
+_27[id]=makeURL(base_url,el.value);
+}else{
+_27[id]=el.value;
+}
+}
+var _2b={w:document.getElementById("orginal_width").value,h:document.getElementById("orginal_height").value};
+if((_2b.w!=_27.f_width)||(_2b.h!=_27.f_height)){
+var _2c=Xinha._geturlcontent(window.opener.Xinha.getPluginDir("ExtendedFileManager")+"/"+_backend_url+"&__function=resizer&img="+encodeURIComponent(document.getElementById("f_url").value)+"&width="+_27.f_width+"&height="+_27.f_height);
+_2c=eval(_2c);
+if(_2c){
+_27.f_url=makeURL(base_url,_2c);
+}
+}
+__dlg_close(_27);
+return false;
+}else{
+if(manager_mode=="link"){
+var _2d={};
+for(var i in _2d){
+var el=document.getElementById(i);
+if(!el.value){
+alert(_2d[i]);
+el.focus();
+return false;
+}
+}
+var _26=["f_href","f_title","f_target"];
+var _27=new Object();
+for(var i in _26){
+var id=_26[i];
+var el=document.getElementById(id);
+if(id=="f_href"&&el.value.indexOf("://")<0){
+_27[id]=makeURL(base_url,el.value);
+}else{
+_27[id]=el.value;
+}
+}
+if(_27.f_target=="_other"){
+_27.f_target=document.getElementById("f_other_target").value;
+}
+__dlg_close(_27);
+return false;
+}
+}
+}
+function makeURL(_2e,_2f){
+if(_2e.substring(_2e.length-1)!="/"){
+_2e+="/";
+}
+if(_2f.charAt(0)=="/"){
+}
+_2f=_2f.substring(1);
+return _2e+_2f;
+}
+function updateDir(_30){
+var _31=_30.options[_30.selectedIndex].value;
+changeDir(_31);
+}
+function goUpDir(){
+var _32=document.getElementById("dirPath");
+var _33=_32.options[_32.selectedIndex].text;
+if(_33.length<2){
+return false;
+}
+var _34=_33.split("/");
+var _35="";
+for(var i=0;i<_34.length-2;i++){
+_35+=_34[i]+"/";
+}
+for(var i=0;i<_32.length;i++){
+var _37=_32.options[i].text;
+if(_37==_35){
+_32.selectedIndex=i;
+var _38=_32.options[i].value;
+changeDir(_38);
+break;
+}
+}
+}
+function changeDir(_39){
+if(typeof imgManager!="undefined"){
+imgManager.changeDir(_39);
+}
+}
+function updateView(){
+refresh();
+}
+function toggleConstrains(_3a){
+var _3b=document.getElementById("imgLock");
+var _3a=document.getElementById("constrain_prop");
+if(_3a.checked){
+_3b.src="img/locked.gif";
+checkConstrains("width");
+}else{
+_3b.src="img/unlocked.gif";
+}
+}
+function checkConstrains(_3c){
+var _3d=document.getElementById("constrain_prop");
+if(_3d.checked){
+var obj=document.getElementById("orginal_width");
+var _3f=parseInt(obj.value);
+var obj=document.getElementById("orginal_height");
+var _40=parseInt(obj.value);
+var _41=document.getElementById("f_width");
+var _42=document.getElementById("f_height");
+var _43=parseInt(_41.value);
+var _44=parseInt(_42.value);
+if(_3f>0&&_40>0){
+if(_3c=="width"&&_43>0){
+_42.value=parseInt((_43/_3f)*_40);
+}
+if(_3c=="height"&&_44>0){
+_41.value=parseInt((_44/_40)*_3f);
+}
+}
+}
+}
+function showMessage(_45){
+var _46=document.getElementById("message");
+var _47=document.getElementById("messages");
+if(_46.firstChild){
+_46.removeChild(_46.firstChild);
+}
+_46.appendChild(document.createTextNode(i18n(_45)));
+_47.style.display="block";
+}
+function addEvent(obj,_49,fn){
+if(obj.addEventListener){
+obj.addEventListener(_49,fn,true);
+return true;
+}else{
+if(obj.attachEvent){
+var r=obj.attachEvent("on"+_49,fn);
+return r;
+}else{
+return false;
+}
+}
+}
+function doUpload(){
+var _4c=document.getElementById("uploadForm");
+if(_4c){
+showMessage("Uploading");
+}
+}
+function refresh(){
+var _4d=document.getElementById("dirPath");
+updateDir(_4d);
+}
+function newFolder(){
+function createFolder(_4e){
+var _4f=document.getElementById("dirPath");
+var dir=_4f.options[_4f.selectedIndex].value;
+if(_4e==thumbdir){
+alert(i18n("Invalid folder name, please choose another folder name."));
+return false;
+}
+if(_4e&&_4e!=""&&typeof imgManager!="undefined"){
+imgManager.newFolder(dir,encodeURI(_4e));
+}
+}
+if(Xinha.ie_version>6){
+popupPrompt(i18n("Please enter name for new folder..."),i18n("Untitled"),createFolder,i18n("New Folder"));
+}else{
+var _51=prompt(i18n("Please enter name for new folder..."),i18n("Untitled"));
+createFolder(_51);
+}
+}
+function resize(){
+var win=Xinha.viewportSize(window);
+var m=document.getElementById("messages");
+var _54=(m&&m.style.display!="none")?parseInt(document.getElementById("messages").offsetHeight,10):0;
+document.getElementById("imgManager").style.height=parseInt(win.y-130-document.getElementById("controls").offsetHeight,10)-_54+"px";
+return true;
+}
+Xinha.addOnloadHandler(init,window);
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/assets/popup.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/assets/popup.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,71 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/ExtendedFileManager/assets/popup.js */
+function __dlg_onclose(){
+if(opener.Dialog._return){
+opener.Dialog._return(null);
+}
+}
+function __dlg_init(_1,_2){
+__xinha_dlg_init(_2);
+}
+function __xinha_dlg_init(_3){
+if(window.__dlg_init_done){
+return true;
+}
+if(window.opener._editor_skin){
+var _4=document.getElementsByTagName("head")[0];
+var _5=document.createElement("link");
+_5.type="text/css";
+_5.href=window.opener._editor_url+"skins/"+window.opener._editor_skin+"/skin.css";
+_5.rel="stylesheet";
+_4.appendChild(_5);
+}
+if(!window.dialogArguments&&opener.Dialog._arguments){
+window.dialogArguments=opener.Dialog._arguments;
+}
+Xinha.addDom0Event(document.body,"keypress",__dlg_close_on_esc);
+window.__dlg_init_done=true;
+}
+function __dlg_translate(_6){
+var _7=["span","option","td","th","button","div","label","a","img","legend"];
+for(var _8=0;_8<_7.length;_8++){
+var _9=document.getElementsByTagName(_7[_8]);
+for(var i=_9.length;--i>=0;){
+var _b=_9[i];
+if(_b.firstChild&&_b.firstChild.data){
+var _c=Xinha._lc(_b.firstChild.data,_6);
+if(_c){
+_b.firstChild.data=_c;
+}
+}
+if(_b.title){
+var _c=Xinha._lc(_b.title,_6);
+if(_c){
+_b.title=_c;
+}
+}
+if(_b.alt){
+var _c=Xinha._lc(_b.alt,_6);
+if(_c){
+_b.alt=_c;
+}
+}
+}
+}
+document.title=Xinha._lc(document.title,_6);
+}
+function __dlg_close(_d){
+opener.Dialog._return(_d);
+window.close();
+}
+function popupPrompt(_e,_f,_10,_11){
+Dialog("prompt.html",function(_12){
+if(!_12){
+return false;
+}else{
+_10(_12.value);
+}
+},{prompt:_e,value:_f,title:_11});
+}
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/assets/slider.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/assets/slider.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,87 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/ExtendedFileManager/assets/slider.js */
+var ie=document.all;
+var ns6=document.getElementById&&!document.all;
+document.onmouseup=captureStop;
+var currentSlider=null,sliderField=null;
+var rangeMin=null,rangeMax=null,sx=-1,sy=-1,initX=0;
+function getMouseXY(e){
+x=ns6?e.clientX:event.clientX;
+y=ns6?e.clientY:event.clientY;
+if(sx<0){
+sx=x;
+}
+if(sy<0){
+sy=y;
+}
+var dx=initX+(x-sx);
+if(dx<=rangeMin){
+dx=rangeMin;
+}else{
+if(dx>=rangeMax){
+dx=rangeMax;
+}
+}
+var _3=(dx-rangeMin)/(rangeMax-rangeMin)*100;
+if(currentSlider!=null){
+currentSlider.style.left=dx+"px";
+}
+if(sliderField!=null){
+sliderField.value=parseInt(_3);
+}
+return false;
+}
+function initSlider(){
+if(currentSlider==null){
+currentSlider=document.getElementById("sliderbar");
+}
+if(sliderField==null){
+sliderField=document.getElementById("quality");
+}
+if(rangeMin==null){
+rangeMin=3;
+}
+if(rangeMax==null){
+var _4=document.getElementById("slidertrack");
+rangeMax=parseInt(_4.style.width);
+}
+}
+function updateSlider(_5){
+initSlider();
+var _6=parseInt(_5)/100*(rangeMax-rangeMin);
+if(_6<=rangeMin){
+_6=rangeMin;
+}else{
+if(_6>=rangeMax){
+_6=rangeMax;
+}
+}
+if(currentSlider!=null){
+currentSlider.style.left=_6+"px";
+}
+var _7=_6/(rangeMax-rangeMin)*100;
+if(sliderField!=null){
+sliderField.value=parseInt(_7);
+}
+}
+function captureStart(){
+initSlider();
+initX=parseInt(currentSlider.style.left);
+if(initX>rangeMax){
+initX=rangeMax;
+}else{
+if(initX<rangeMin){
+initX=rangeMin;
+}
+}
+document.onmousemove=getMouseXY;
+return false;
+}
+function captureStop(){
+sx=-1;
+sy=-1;
+document.onmousemove=null;
+return false;
+}
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/assets/wz_jsgraphics.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/assets/wz_jsgraphics.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,778 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/ExtendedFileManager/assets/wz_jsgraphics.js */
+var jg_ok,jg_ie,jg_fast,jg_dom,jg_moz;
+function _chkDHTM(x,i){
+x=document.body||null;
+jg_ie=x&&typeof x.insertAdjacentHTML!="undefined"&&document.createElement;
+jg_dom=(x&&!jg_ie&&typeof x.appendChild!="undefined"&&typeof document.createRange!="undefined"&&typeof (i=document.createRange()).setStartBefore!="undefined"&&typeof i.createContextualFragment!="undefined");
+jg_fast=jg_ie&&document.all&&!window.opera;
+jg_moz=jg_dom&&typeof x.style.MozOpacity!="undefined";
+jg_ok=!!(jg_ie||jg_dom);
+}
+function _pntCnvDom(){
+var x=this.wnd.document.createRange();
+x.setStartBefore(this.cnv);
+x=x.createContextualFragment(jg_fast?this._htmRpc():this.htm);
+if(this.cnv){
+this.cnv.appendChild(x);
+}
+this.htm="";
+}
+function _pntCnvIe(){
+if(this.cnv){
+this.cnv.insertAdjacentHTML("BeforeEnd",jg_fast?this._htmRpc():this.htm);
+}
+this.htm="";
+}
+function _pntDoc(){
+this.wnd.document.write(jg_fast?this._htmRpc():this.htm);
+this.htm="";
+}
+function _pntN(){
+}
+function _mkDiv(x,y,w,h){
+this.htm+="<div style=\"position:absolute;"+"left:"+x+"px;"+"top:"+y+"px;"+"width:"+w+"px;"+"height:"+h+"px;"+"clip:rect(0,"+w+"px,"+h+"px,0);"+"background-color:"+this.color+(!jg_moz?";overflow:hidden":"")+";\"></div>";
+}
+function _mkDivIe(x,y,w,h){
+this.htm+="%%"+this.color+";"+x+";"+y+";"+w+";"+h+";";
+}
+function _mkDivPrt(x,y,w,h){
+this.htm+="<div style=\"position:absolute;"+"border-left:"+w+"px solid "+this.color+";"+"left:"+x+"px;"+"top:"+y+"px;"+"width:0px;"+"height:"+h+"px;"+"clip:rect(0,"+w+"px,"+h+"px,0);"+"background-color:"+this.color+(!jg_moz?";overflow:hidden":"")+";\"></div>";
+}
+var _regex=/%%([^;]+);([^;]+);([^;]+);([^;]+);([^;]+);/g;
+function _htmRpc(){
+return this.htm.replace(_regex,"<div style=\"overflow:hidden;position:absolute;background-color:"+"$1;left:$2;top:$3;width:$4;height:$5\"></div>\n");
+}
+function _htmPrtRpc(){
+return this.htm.replace(_regex,"<div style=\"overflow:hidden;position:absolute;background-color:"+"$1;left:$2;top:$3;width:$4;height:$5;border-left:$4px solid $1\"></div>\n");
+}
+function _mkLin(x1,y1,x2,y2){
+if(x1>x2){
+var _x2=x2;
+var _y2=y2;
+x2=x1;
+y2=y1;
+x1=_x2;
+y1=_y2;
+}
+var dx=x2-x1,dy=Math.abs(y2-y1),x=x1,y=y1,yIncr=(y1>y2)?-1:1;
+if(dx>=dy){
+var pr=dy<<1,pru=pr-(dx<<1),p=pr-dx,ox=x;
+while(dx>0){
+--dx;
+++x;
+if(p>0){
+this._mkDiv(ox,y,x-ox,1);
+y+=yIncr;
+p+=pru;
+ox=x;
+}else{
+p+=pr;
+}
+}
+this._mkDiv(ox,y,x2-ox+1,1);
+}else{
+var pr=dx<<1,pru=pr-(dy<<1),p=pr-dy,oy=y;
+if(y2<=y1){
+while(dy>0){
+--dy;
+if(p>0){
+this._mkDiv(x++,y,1,oy-y+1);
+y+=yIncr;
+p+=pru;
+oy=y;
+}else{
+y+=yIncr;
+p+=pr;
+}
+}
+this._mkDiv(x2,y2,1,oy-y2+1);
+}else{
+while(dy>0){
+--dy;
+y+=yIncr;
+if(p>0){
+this._mkDiv(x++,oy,1,y-oy);
+p+=pru;
+oy=y;
+}else{
+p+=pr;
+}
+}
+this._mkDiv(x2,oy,1,y2-oy+1);
+}
+}
+}
+function _mkLin2D(x1,y1,x2,y2){
+if(x1>x2){
+var _x2=x2;
+var _y2=y2;
+x2=x1;
+y2=y1;
+x1=_x2;
+y1=_y2;
+}
+var dx=x2-x1,dy=Math.abs(y2-y1),x=x1,y=y1,yIncr=(y1>y2)?-1:1;
+var s=this.stroke;
+if(dx>=dy){
+if(dx>0&&s-3>0){
+var _s=(s*dx*Math.sqrt(1+dy*dy/(dx*dx))-dx-(s>>1)*dy)/dx;
+_s=(!(s-4)?Math.ceil(_s):Math.round(_s))+1;
+}else{
+var _s=s;
+}
+var ad=Math.ceil(s/2);
+var pr=dy<<1,pru=pr-(dx<<1),p=pr-dx,ox=x;
+while(dx>0){
+--dx;
+++x;
+if(p>0){
+this._mkDiv(ox,y,x-ox+ad,_s);
+y+=yIncr;
+p+=pru;
+ox=x;
+}else{
+p+=pr;
+}
+}
+this._mkDiv(ox,y,x2-ox+ad+1,_s);
+}else{
+if(s-3>0){
+var _s=(s*dy*Math.sqrt(1+dx*dx/(dy*dy))-(s>>1)*dx-dy)/dy;
+_s=(!(s-4)?Math.ceil(_s):Math.round(_s))+1;
+}else{
+var _s=s;
+}
+var ad=Math.round(s/2);
+var pr=dx<<1,pru=pr-(dy<<1),p=pr-dy,oy=y;
+if(y2<=y1){
+++ad;
+while(dy>0){
+--dy;
+if(p>0){
+this._mkDiv(x++,y,_s,oy-y+ad);
+y+=yIncr;
+p+=pru;
+oy=y;
+}else{
+y+=yIncr;
+p+=pr;
+}
+}
+this._mkDiv(x2,y2,_s,oy-y2+ad);
+}else{
+while(dy>0){
+--dy;
+y+=yIncr;
+if(p>0){
+this._mkDiv(x++,oy,_s,y-oy+ad);
+p+=pru;
+oy=y;
+}else{
+p+=pr;
+}
+}
+this._mkDiv(x2,oy,_s,y2-oy+ad+1);
+}
+}
+}
+function _mkLinDott(x1,y1,x2,y2){
+if(x1>x2){
+var _x2=x2;
+var _y2=y2;
+x2=x1;
+y2=y1;
+x1=_x2;
+y1=_y2;
+}
+var dx=x2-x1,dy=Math.abs(y2-y1),x=x1,y=y1,yIncr=(y1>y2)?-1:1,drw=true;
+if(dx>=dy){
+var pr=dy<<1,pru=pr-(dx<<1),p=pr-dx;
+while(dx>0){
+--dx;
+if(drw){
+this._mkDiv(x,y,1,1);
+}
+drw=!drw;
+if(p>0){
+y+=yIncr;
+p+=pru;
+}else{
+p+=pr;
+}
+++x;
+}
+}else{
+var pr=dx<<1,pru=pr-(dy<<1),p=pr-dy;
+while(dy>0){
+--dy;
+if(drw){
+this._mkDiv(x,y,1,1);
+}
+drw=!drw;
+y+=yIncr;
+if(p>0){
+++x;
+p+=pru;
+}else{
+p+=pr;
+}
+}
+}
+if(drw){
+this._mkDiv(x,y,1,1);
+}
+}
+function _mkOv(_2b,top,_2d,_2e){
+var a=(++_2d)>>1,b=(++_2e)>>1,wod=_2d&1,hod=_2e&1,cx=_2b+a,cy=top+b,x=0,y=b,ox=0,oy=b,aa2=(a*a)<<1,aa4=aa2<<1,bb2=(b*b)<<1,bb4=bb2<<1,st=(aa2>>1)*(1-(b<<1))+bb2,tt=(bb2>>1)-aa2*((b<<1)-1),w,h;
+while(y>0){
+if(st<0){
+st+=bb2*((x<<1)+3);
+tt+=bb4*(++x);
+}else{
+if(tt<0){
+st+=bb2*((x<<1)+3)-aa4*(y-1);
+tt+=bb4*(++x)-aa2*(((y--)<<1)-3);
+w=x-ox;
+h=oy-y;
+if((w&2)&&(h&2)){
+this._mkOvQds(cx,cy,x-2,y+2,1,1,wod,hod);
+this._mkOvQds(cx,cy,x-1,y+1,1,1,wod,hod);
+}else{
+this._mkOvQds(cx,cy,x-1,oy,w,h,wod,hod);
+}
+ox=x;
+oy=y;
+}else{
+tt-=aa2*((y<<1)-3);
+st-=aa4*(--y);
+}
+}
+}
+w=a-ox+1;
+h=(oy<<1)+hod;
+y=cy-oy;
+this._mkDiv(cx-a,y,w,h);
+this._mkDiv(cx+ox+wod-1,y,w,h);
+}
+function _mkOv2D(_30,top,_32,_33){
+var s=this.stroke;
+_32+=s+1;
+_33+=s+1;
+var a=_32>>1,b=_33>>1,wod=_32&1,hod=_33&1,cx=_30+a,cy=top+b,x=0,y=b,aa2=(a*a)<<1,aa4=aa2<<1,bb2=(b*b)<<1,bb4=bb2<<1,st=(aa2>>1)*(1-(b<<1))+bb2,tt=(bb2>>1)-aa2*((b<<1)-1);
+if(s-4<0&&(!(s-2)||_32-51>0&&_33-51>0)){
+var ox=0,oy=b,w,h,pxw;
+while(y>0){
+if(st<0){
+st+=bb2*((x<<1)+3);
+tt+=bb4*(++x);
+}else{
+if(tt<0){
+st+=bb2*((x<<1)+3)-aa4*(y-1);
+tt+=bb4*(++x)-aa2*(((y--)<<1)-3);
+w=x-ox;
+h=oy-y;
+if(w-1){
+pxw=w+1+(s&1);
+h=s;
+}else{
+if(h-1){
+pxw=s;
+h+=1+(s&1);
+}else{
+pxw=h=s;
+}
+}
+this._mkOvQds(cx,cy,x-1,oy,pxw,h,wod,hod);
+ox=x;
+oy=y;
+}else{
+tt-=aa2*((y<<1)-3);
+st-=aa4*(--y);
+}
+}
+}
+this._mkDiv(cx-a,cy-oy,s,(oy<<1)+hod);
+this._mkDiv(cx+a+wod-s,cy-oy,s,(oy<<1)+hod);
+}else{
+var _a=(_32-(s<<1))>>1,_b=(_33-(s<<1))>>1,_x=0,_y=_b,_aa2=(_a*_a)<<1,_aa4=_aa2<<1,_bb2=(_b*_b)<<1,_bb4=_bb2<<1,_st=(_aa2>>1)*(1-(_b<<1))+_bb2,_tt=(_bb2>>1)-_aa2*((_b<<1)-1),pxl=new Array(),pxt=new Array(),_pxb=new Array();
+pxl[0]=0;
+pxt[0]=b;
+_pxb[0]=_b-1;
+while(y>0){
+if(st<0){
+pxl[pxl.length]=x;
+pxt[pxt.length]=y;
+st+=bb2*((x<<1)+3);
+tt+=bb4*(++x);
+}else{
+if(tt<0){
+pxl[pxl.length]=x;
+st+=bb2*((x<<1)+3)-aa4*(y-1);
+tt+=bb4*(++x)-aa2*(((y--)<<1)-3);
+pxt[pxt.length]=y;
+}else{
+tt-=aa2*((y<<1)-3);
+st-=aa4*(--y);
+}
+}
+if(_y>0){
+if(_st<0){
+_st+=_bb2*((_x<<1)+3);
+_tt+=_bb4*(++_x);
+_pxb[_pxb.length]=_y-1;
+}else{
+if(_tt<0){
+_st+=_bb2*((_x<<1)+3)-_aa4*(_y-1);
+_tt+=_bb4*(++_x)-_aa2*(((_y--)<<1)-3);
+_pxb[_pxb.length]=_y-1;
+}else{
+_tt-=_aa2*((_y<<1)-3);
+_st-=_aa4*(--_y);
+_pxb[_pxb.length-1]--;
+}
+}
+}
+}
+var ox=-wod,oy=b,_oy=_pxb[0],l=pxl.length,w,h;
+for(var i=0;i<l;i++){
+if(typeof _pxb[i]!="undefined"){
+if(_pxb[i]<_oy||pxt[i]<oy){
+x=pxl[i];
+this._mkOvQds(cx,cy,x,oy,x-ox,oy-_oy,wod,hod);
+ox=x;
+oy=pxt[i];
+_oy=_pxb[i];
+}
+}else{
+x=pxl[i];
+this._mkDiv(cx-x,cy-oy,1,(oy<<1)+hod);
+this._mkDiv(cx+ox+wod,cy-oy,1,(oy<<1)+hod);
+ox=x;
+oy=pxt[i];
+}
+}
+this._mkDiv(cx-a,cy-oy,1,(oy<<1)+hod);
+this._mkDiv(cx+ox+wod,cy-oy,1,(oy<<1)+hod);
+}
+}
+function _mkOvDott(_39,top,_3b,_3c){
+var a=(++_3b)>>1,b=(++_3c)>>1,wod=_3b&1,hod=_3c&1,hodu=hod^1,cx=_39+a,cy=top+b,x=0,y=b,aa2=(a*a)<<1,aa4=aa2<<1,bb2=(b*b)<<1,bb4=bb2<<1,st=(aa2>>1)*(1-(b<<1))+bb2,tt=(bb2>>1)-aa2*((b<<1)-1),drw=true;
+while(y>0){
+if(st<0){
+st+=bb2*((x<<1)+3);
+tt+=bb4*(++x);
+}else{
+if(tt<0){
+st+=bb2*((x<<1)+3)-aa4*(y-1);
+tt+=bb4*(++x)-aa2*(((y--)<<1)-3);
+}else{
+tt-=aa2*((y<<1)-3);
+st-=aa4*(--y);
+}
+}
+if(drw&&y>=hodu){
+this._mkOvQds(cx,cy,x,y,1,1,wod,hod);
+}
+drw=!drw;
+}
+}
+function _mkRect(x,y,w,h){
+var s=this.stroke;
+this._mkDiv(x,y,w,s);
+this._mkDiv(x+w,y,s,h);
+this._mkDiv(x,y+h,w+s,s);
+this._mkDiv(x,y+s,s,h-s);
+}
+function _mkRectDott(x,y,w,h){
+this.drawLine(x,y,x+w,y);
+this.drawLine(x+w,y,x+w,y+h);
+this.drawLine(x,y+h,x+w,y+h);
+this.drawLine(x,y,x,y+h);
+}
+function jsgFont(){
+this.PLAIN="font-weight:normal;";
+this.BOLD="font-weight:bold;";
+this.ITALIC="font-style:italic;";
+this.ITALIC_BOLD=this.ITALIC+this.BOLD;
+this.BOLD_ITALIC=this.ITALIC_BOLD;
+}
+var Font=new jsgFont();
+function jsgStroke(){
+this.DOTTED=-1;
+}
+var Stroke=new jsgStroke();
+function jsGraphics(cnv,wnd){
+this.setColor=function(x){
+this.color=x.toLowerCase();
+};
+this.setStroke=function(x){
+this.stroke=x;
+if(!(x+1)){
+this.drawLine=_mkLinDott;
+this._mkOv=_mkOvDott;
+this.drawRect=_mkRectDott;
+}else{
+if(x-1>0){
+this.drawLine=_mkLin2D;
+this._mkOv=_mkOv2D;
+this.drawRect=_mkRect;
+}else{
+this.drawLine=_mkLin;
+this._mkOv=_mkOv;
+this.drawRect=_mkRect;
+}
+}
+};
+this.setPrintable=function(arg){
+this.printable=arg;
+if(jg_fast){
+this._mkDiv=_mkDivIe;
+this._htmRpc=arg?_htmPrtRpc:_htmRpc;
+}else{
+this._mkDiv=arg?_mkDivPrt:_mkDiv;
+}
+};
+this.setFont=function(fam,sz,sty){
+this.ftFam=fam;
+this.ftSz=sz;
+this.ftSty=sty||Font.PLAIN;
+};
+this.drawPolyline=this.drawPolyLine=function(x,y){
+for(var i=x.length-1;i;){
+--i;
+this.drawLine(x[i],y[i],x[i+1],y[i+1]);
+}
+};
+this.setColor=new Function("arg","this.color = arg;");
+this.getColor=new Function("return this.color");
+this.fillRect=function(x,y,w,h){
+this._mkDiv(x,y,w,h);
+};
+this.fillRectPattern=function(x,y,w,h,url){
+this.htm+="<div style=\"position:absolute;"+"left:"+x+"px;"+"top:"+y+"px;"+"width:"+w+"px;"+"height:"+h+"px;"+"clip:rect(0,"+w+"px,"+h+"px,0);"+"overflow:hidden;"+"background-image: url('"+url+"');"+"layer-background-image: url('"+url+"');"+"z-index:100;\"></div>";
+};
+this.drawHandle=function(x,y,w,h,_5f){
+this.htm+="<div style=\"position:absolute;"+"left:"+x+"px;"+"top:"+y+"px;"+"width:"+w+"px;"+"height:"+h+"px;"+"clip:rect(0,"+w+"px,"+h+"px,0);"+"padding: 2px;overflow:hidden;"+"cursor: '"+_5f+"';"+"\" class=\"handleBox\" id=\""+_5f+"\" ></div>";
+};
+this.drawHandleBox=function(x,y,w,h,_64){
+this.htm+="<div style=\"position:absolute;"+"left:"+x+"px;"+"top:"+y+"px;"+"width:"+w+"px;"+"height:"+h+"px;"+"clip:rect(0,"+(w+2)+"px,"+(h+2)+"px,0);"+"overflow:hidden; border: solid 1px "+this.color+";"+"cursor: '"+_64+"';"+"\" class=\"handleBox\" id=\""+_64+"\" ></div>";
+};
+this.drawPolygon=function(x,y){
+this.drawPolyline(x,y);
+this.drawLine(x[x.length-1],y[x.length-1],x[0],y[0]);
+};
+this.drawEllipse=this.drawOval=function(x,y,w,h){
+this._mkOv(x,y,w,h);
+};
+this.fillEllipse=this.fillOval=function(_6b,top,w,h){
+var a=w>>1,b=h>>1,wod=w&1,hod=h&1,cx=_6b+a,cy=top+b,x=0,y=b,oy=b,aa2=(a*a)<<1,aa4=aa2<<1,bb2=(b*b)<<1,bb4=bb2<<1,st=(aa2>>1)*(1-(b<<1))+bb2,tt=(bb2>>1)-aa2*((b<<1)-1),xl,dw,dh;
+if(w){
+while(y>0){
+if(st<0){
+st+=bb2*((x<<1)+3);
+tt+=bb4*(++x);
+}else{
+if(tt<0){
+st+=bb2*((x<<1)+3)-aa4*(y-1);
+xl=cx-x;
+dw=(x<<1)+wod;
+tt+=bb4*(++x)-aa2*(((y--)<<1)-3);
+dh=oy-y;
+this._mkDiv(xl,cy-oy,dw,dh);
+this._mkDiv(xl,cy+y+hod,dw,dh);
+oy=y;
+}else{
+tt-=aa2*((y<<1)-3);
+st-=aa4*(--y);
+}
+}
+}
+}
+this._mkDiv(cx-a,cy-oy,w,(oy<<1)+hod);
+};
+this.fillArc=function(iL,iT,iW,iH,_74,_75){
+var a=iW>>1,b=iH>>1,iOdds=(iW&1)|((iH&1)<<16),cx=iL+a,cy=iT+b,x=0,y=b,ox=x,oy=y,aa2=(a*a)<<1,aa4=aa2<<1,bb2=(b*b)<<1,bb4=bb2<<1,st=(aa2>>1)*(1-(b<<1))+bb2,tt=(bb2>>1)-aa2*((b<<1)-1),xEndA,yEndA,xEndZ,yEndZ,iSects=(1<<(Math.floor((_74%=360)/180)<<3))|(2<<(Math.floor((_75%=360)/180)<<3))|((_74>=_75)<<16),aBndA=new Array(b+1),aBndZ=new Array(b+1);
+_74*=Math.PI/180;
+_75*=Math.PI/180;
+xEndA=cx+Math.round(a*Math.cos(_74));
+yEndA=cy+Math.round(-b*Math.sin(_74));
+_mkLinVirt(aBndA,cx,cy,xEndA,yEndA);
+xEndZ=cx+Math.round(a*Math.cos(_75));
+yEndZ=cy+Math.round(-b*Math.sin(_75));
+_mkLinVirt(aBndZ,cx,cy,xEndZ,yEndZ);
+while(y>0){
+if(st<0){
+st+=bb2*((x<<1)+3);
+tt+=bb4*(++x);
+}else{
+if(tt<0){
+st+=bb2*((x<<1)+3)-aa4*(y-1);
+ox=x;
+tt+=bb4*(++x)-aa2*(((y--)<<1)-3);
+this._mkArcDiv(ox,y,oy,cx,cy,iOdds,aBndA,aBndZ,iSects);
+oy=y;
+}else{
+tt-=aa2*((y<<1)-3);
+st-=aa4*(--y);
+if(y&&(aBndA[y]!=aBndA[y-1]||aBndZ[y]!=aBndZ[y-1])){
+this._mkArcDiv(x,y,oy,cx,cy,iOdds,aBndA,aBndZ,iSects);
+ox=x;
+oy=y;
+}
+}
+}
+}
+this._mkArcDiv(x,0,oy,cx,cy,iOdds,aBndA,aBndZ,iSects);
+if(iOdds>>16){
+if(iSects>>16){
+var xl=(yEndA<=cy||yEndZ>cy)?(cx-x):cx;
+this._mkDiv(xl,cy,x+cx-xl+(iOdds&65535),1);
+}else{
+if((iSects&1)&&yEndZ>cy){
+this._mkDiv(cx-x,cy,x,1);
+}
+}
+}
+};
+this.fillPolygon=function(_78,_79){
+var i;
+var y;
+var _7c,maxy;
+var x1,y1;
+var x2,y2;
+var _7f,ind2;
+var _80;
+var n=_78.length;
+if(!n){
+return;
+}
+_7c=_79[0];
+maxy=_79[0];
+for(i=1;i<n;i++){
+if(_79[i]<_7c){
+_7c=_79[i];
+}
+if(_79[i]>maxy){
+maxy=_79[i];
+}
+}
+for(y=_7c;y<=maxy;y++){
+var _82=new Array();
+_80=0;
+for(i=0;i<n;i++){
+if(!i){
+_7f=n-1;
+ind2=0;
+}else{
+_7f=i-1;
+ind2=i;
+}
+y1=_79[_7f];
+y2=_79[ind2];
+if(y1<y2){
+x1=_78[_7f];
+x2=_78[ind2];
+}else{
+if(y1>y2){
+y2=_79[_7f];
+y1=_79[ind2];
+x2=_78[_7f];
+x1=_78[ind2];
+}else{
+continue;
+}
+}
+if((y>=y1)&&(y<y2)){
+_82[_80++]=Math.round((y-y1)*(x2-x1)/(y2-y1)+x1);
+}else{
+if((y==maxy)&&(y>y1)&&(y<=y2)){
+_82[_80++]=Math.round((y-y1)*(x2-x1)/(y2-y1)+x1);
+}
+}
+}
+_82.sort(_CompInt);
+for(i=0;i<_80;i+=2){
+this._mkDiv(_82[i],y,_82[i+1]-_82[i]+1,1);
+}
+}
+};
+this.drawString=function(txt,x,y){
+this.htm+="<div style=\"position:absolute;white-space:nowrap;"+"left:"+x+"px;"+"top:"+y+"px;"+"font-family:"+this.ftFam+";"+"font-size:"+this.ftSz+";"+"color:"+this.color+";"+this.ftSty+"\">"+txt+"</div>";
+};
+this.drawStringRect=function(txt,x,y,_89,_8a){
+this.htm+="<div style=\"position:absolute;overflow:hidden;"+"left:"+x+"px;"+"top:"+y+"px;"+"width:"+_89+"px;"+"text-align:"+_8a+";"+"font-family:"+this.ftFam+";"+"font-size:"+this.ftSz+";"+"color:"+this.color+";"+this.ftSty+"\">"+txt+"</div>";
+};
+this.drawImage=function(_8b,x,y,w,h,a){
+this.htm+="<div style=\"position:absolute;"+"left:"+x+"px;"+"top:"+y+"px;"+"width:"+w+"px;"+"height:"+h+"px;\">"+"<img src=\""+_8b+"\" width=\""+w+"\" height=\""+h+"\""+(a?(" "+a):"")+">"+"</div>";
+};
+this.clear=function(){
+this.htm="";
+if(this.cnv){
+this.cnv.innerHTML="";
+}
+};
+this._mkOvQds=function(cx,cy,x,y,w,h,wod,hod){
+var xl=cx-x,xr=cx+x+wod-w,yt=cy-y,yb=cy+y+hod-h;
+if(xr>xl+w){
+this._mkDiv(xr,yt,w,h);
+this._mkDiv(xr,yb,w,h);
+}else{
+w=xr-xl+w;
+}
+this._mkDiv(xl,yt,w,h);
+this._mkDiv(xl,yb,w,h);
+};
+this._mkArcDiv=function(x,y,oy,cx,cy,_9f,_a0,_a1,_a2){
+var _a3=cx+x+(_9f&65535),y2,h=oy-y,xl,xr,w;
+if(!h){
+h=1;
+}
+x=cx-x;
+if(_a2&16711680){
+y2=cy-y-h;
+if(_a2&255){
+if(_a2&2){
+xl=Math.max(x,_a1[y]);
+w=_a3-xl;
+if(w>0){
+this._mkDiv(xl,y2,w,h);
+}
+}
+if(_a2&1){
+xr=Math.min(_a3,_a0[y]);
+w=xr-x;
+if(w>0){
+this._mkDiv(x,y2,w,h);
+}
+}
+}else{
+this._mkDiv(x,y2,_a3-x,h);
+}
+y2=cy+y+(_9f>>16);
+if(_a2&65280){
+if(_a2&256){
+xl=Math.max(x,_a0[y]);
+w=_a3-xl;
+if(w>0){
+this._mkDiv(xl,y2,w,h);
+}
+}
+if(_a2&512){
+xr=Math.min(_a3,_a1[y]);
+w=xr-x;
+if(w>0){
+this._mkDiv(x,y2,w,h);
+}
+}
+}else{
+this._mkDiv(x,y2,_a3-x,h);
+}
+}else{
+if(_a2&255){
+if(_a2&2){
+xl=Math.max(x,_a1[y]);
+}else{
+xl=x;
+}
+if(_a2&1){
+xr=Math.min(_a3,_a0[y]);
+}else{
+xr=_a3;
+}
+y2=cy-y-h;
+w=xr-xl;
+if(w>0){
+this._mkDiv(xl,y2,w,h);
+}
+}
+if(_a2&65280){
+if(_a2&256){
+xl=Math.max(x,_a0[y]);
+}else{
+xl=x;
+}
+if(_a2&512){
+xr=Math.min(_a3,_a1[y]);
+}else{
+xr=_a3;
+}
+y2=cy+y+(_9f>>16);
+w=xr-xl;
+if(w>0){
+this._mkDiv(xl,y2,w,h);
+}
+}
+}
+};
+this.setStroke(1);
+this.setFont("verdana,geneva,helvetica,sans-serif","12px",Font.PLAIN);
+this.color="#000000";
+this.htm="";
+this.wnd=wnd||window;
+if(!jg_ok){
+_chkDHTM();
+}
+if(jg_ok){
+if(cnv){
+if(typeof (cnv)=="string"){
+this.cont=document.all?(this.wnd.document.all[cnv]||null):document.getElementById?(this.wnd.document.getElementById(cnv)||null):null;
+}else{
+if(cnv==window.document){
+this.cont=document.getElementsByTagName("body")[0];
+}else{
+this.cont=cnv;
+}
+}
+this.cnv=this.wnd.document.createElement("div");
+this.cnv.style.fontSize=0;
+this.cont.appendChild(this.cnv);
+this.paint=jg_dom?_pntCnvDom:_pntCnvIe;
+}else{
+this.paint=_pntDoc;
+}
+}else{
+this.paint=_pntN;
+}
+this.setPrintable(false);
+}
+function _mkLinVirt(_a4,x1,y1,x2,y2){
+var dx=Math.abs(x2-x1),dy=Math.abs(y2-y1),x=x1,y=y1,xIncr=(x1>x2)?-1:1,yIncr=(y1>y2)?-1:1,p,i=0;
+if(dx>=dy){
+var pr=dy<<1,pru=pr-(dx<<1);
+p=pr-dx;
+while(dx>0){
+--dx;
+if(p>0){
+_a4[i++]=x;
+y+=yIncr;
+p+=pru;
+}else{
+p+=pr;
+}
+x+=xIncr;
+}
+}else{
+var pr=dx<<1,pru=pr-(dy<<1);
+p=pr-dy;
+while(dy>0){
+--dy;
+y+=yIncr;
+_a4[i++]=x;
+if(p>0){
+x+=xIncr;
+p+=pru;
+}else{
+p+=pr;
+}
+}
+}
+for(var len=_a4.length,i=len-i;i;){
+_a4[len-(i--)]=x;
+}
+}
+function _CompInt(x,y){
+return (x-y);
+}
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/backend.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/backend.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,110 @@
+<?php 
+/**
+* Unified backend for ExtendedFileManager - copied from ImageManager
+*
+* Image Manager was originally developed by:
+*   Xiang Wei Zhuo, email: xiangweizhuo(at)hotmail.com Wei Shou.
+*
+* Unified backend sponsored by DTLink Software, http://www.dtlink.com
+* Implementation by Yermo Lamers, http://www.formvista.com
+*
+* (c) DTLink, LLC 2005.
+* Distributed under the same terms as Xinha itself.
+* This notice MUST stay intact for use (see license.txt).
+*
+* DESCRIPTION:
+*
+* Instead of using separate URL's for each function, ImageManager now
+* routes all requests to the server through this single, replaceable,
+* entry point. backend.php expects at least two URL variable parameters: 
+*
+* __plugin=ImageManager   for future expansion; identify the plugin being requested.
+* __function=thumbs|images|editorFrame|editor|manager  function being called.
+*
+* Having a single entry point that strictly adheres to a defined interface will 
+* make the backend code much easier to maintain and expand. It will make it easier
+* on integrators, not to mention it'll make it easier to have separate 
+* implementations of the backend in different languages (Perl, Python, ASP, etc.) 
+*
+* @see config.inc.php
+*/
+
+/**
+* ImageManager configuration
+*/
+
+require_once('config.inc.php');
+
+
+// Strip slashes if MQGPC is on
+set_magic_quotes_runtime(0);
+if(get_magic_quotes_gpc())
+{
+  $to_clean = array(&$_GET, &$_POST, &$_REQUEST, &$_COOKIE);
+  while(count($to_clean))
+  {
+    $cleaning =& $to_clean[array_pop($junk = array_keys($to_clean))];
+    unset($to_clean[array_pop($junk = array_keys($to_clean))]);
+    foreach(array_keys($cleaning) as $k)
+    {
+      if(is_array($cleaning[$k]))
+      {
+        $to_clean[] =& $cleaning[$k];
+      }
+      else
+      {
+        $cleaning[$k] = stripslashes($cleaning[$k]);
+      }
+    }
+  }
+}
+
+/**
+* ImageManager configuration
+*/
+
+$formVars = empty($_POST) ? $_GET : $_POST;
+
+// make sure the request is for us (this gives us the ability to eventually organize
+// a backend event handler system) For an include file the return doesn't make alot of
+// sense but eventually we'll want to turn all of this into at least functions 
+// separating out all the presentation HTML from the logic. (Right now all the HTML
+// used by ImageManager is in the same files as the PHP code ...)
+
+if ( @$formVars[ "__plugin" ] != "ExtendedFileManager" )
+	{
+	// not for us.
+
+	return true;
+	}
+
+// so we don't have to re-engineer the entire thing right now, since it's probably
+// going to get rewritten anyway, we just include the correct file based on the 
+// function request.
+
+switch ( @$formVars[ "__function" ] )
+	{
+
+	case "editor": 
+	case "editorFrame":
+	case "manager":
+	case "images":
+	case "thumbs":
+	case "resizer":
+
+		include_once $IMConfig['base_dir'] . '/' . $formVars['__function'] . '.php' ;
+		exit();
+		
+		break;
+
+	default:
+
+		break;
+
+	}	// end of switch.
+
+return false ;
+
+// END
+
+?>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/config.inc.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/config.inc.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,387 @@
+<?php
+/**
+ * ExtendedFileManager configuration file.
+ * Authors: Wei Zhuo, Afru
+ * Version: Updated on 08-01-2005 by Afru
+ * Version 1.1.2: Updated on 04-07-2006 by Krzysztof Kotowicz <koto@webworkers.pl>
+ * Package: ExtendedFileManager
+ * http://www.afrusoft.com/htmlarea
+ */
+
+/*  Configuration file usage:
+ *	There are two insertModes for this filemanager.
+ *	One is "image" and another is "link".
+ *	So you can assign config values as below
+ *
+ *	if($insertMode=="image") $IMConfig['property']=somevalueforimagemode;
+ *	else if($insertMode=="link") $IMConfig['property']=somevalueforlinkmode;
+ *
+ *	(or) you can directly as $IMConfig['property']=somevalueforbothmodes;
+ *
+ *	Best of Luck :) Afru.
+ */
+ 
+/*
+ *	Getting the mode for further differentiation
+ */
+
+if(isset($_REQUEST['mode'])) $insertMode=$_REQUEST['mode'];
+	if(!isset($insertMode)) $insertMode="image";
+
+/**
+* Default backend URL
+*
+* URL to use for unified backend.
+*
+* The ?__plugin=ExtendedFileManager& is required.
+*/
+
+$IMConfig['backend_url'] = "backend.php?__plugin=ExtendedFileManager&";
+
+/**
+* Backend Installation Directory
+*
+* location of backend install; these are used to link to css and js
+* assets because we may have the front end installed in a different
+* directory than the backend. (i.e. nothing assumes that the frontend
+* and the backend are in the same directory)
+*/
+$IMConfig['base_dir'] = getcwd();
+$IMConfig['base_url'] = '';
+
+
+/*
+	 File system path to the directory you want to manage the images
+	 for multiple user systems, set it dynamically.
+
+	 NOTE: This directory requires write access by PHP. That is,
+		   PHP must be able to create files in this directory.
+		   Able to create directories is nice, but not necessary.
+*/
+$IMConfig['images_dir'] = 'demo_images';
+//You may set a different directory for the link mode; if you don't, the above setting will be used for both modes
+//$IMConfig['files_dir'] = 'demo_files';
+
+/*
+ The URL to the above path, the web browser needs to be able to see it.
+ Please remove scripting capabilities in this directory
+ for this directory (i.e. disable PHP, Perl, CGI; see .htaccess file in demo_images folder).
+*/
+$IMConfig['images_url'] = str_replace( array("backend.php","manager.php"), "", $_SERVER["PHP_SELF"] ) . $IMConfig['images_dir'];
+//$IMConfig['files_url'] = 'url/to/files_dir';
+
+/*
+  Format of the Date Modified in list view.
+  It has to be a string understood by the PHP date() function (for possible values see http://http://php.net/manual/en/function.date.php)
+*/
+$IMConfig['date_format'] = "d.m.y H:i";
+/*
+  Possible values: true, false
+
+  TRUE - If PHP on the web server is in safe mode, set this to true.
+         SAFE MODE restrictions: directory creation will not be possible,
+		 only the GD library can be used, other libraries require
+		 Safe Mode to be off.
+
+  FALSE - Set to false if PHP on the web server is not in safe mode.
+*/
+$IMConfig['safe_mode'] = false;
+
+/*
+This specifies whether any image library is available to resize and edit images.TRUE - Thumbnails will be resized by image libraries and if there is no library, default thumbnail will be shown.
+FALSE - Thumbnails will be resized by browser ignoring image libraries.
+*/
+$IMConfig['img_library'] = true;
+
+
+/*
+View type when the File manager is in insert image mode.
+Valid values are "thumbview" and "listview".
+*/
+
+    
+if ($insertMode == 'image')
+	$IMConfig['view_type'] = "thumbview";
+	
+else if($insertMode == "link")
+	$IMConfig['view_type'] = "listview";
+
+$IMConfig['insert_mode'] = $insertMode;
+
+/* 
+ Possible values: 'GD', 'IM', or 'NetPBM'
+
+ The image manipulation library to use, either GD or ImageMagick or NetPBM.
+ If you have safe mode ON, or don't have the binaries to other packages, 
+ your choice is 'GD' only. Other packages require Safe Mode to be off.
+*/
+define('IMAGE_CLASS', 'GD');
+
+
+/*
+ After defining which library to use, if it is NetPBM or IM, you need to
+ specify where the binary for the selected library are. And of course
+ your server and PHP must be able to execute them (i.e. safe mode is OFF).
+ GD does not require the following definition.
+*/
+define('IMAGE_TRANSFORM_LIB_PATH', '/usr/bin/');
+//define('IMAGE_TRANSFORM_LIB_PATH', 'C:/"Program Files"/ImageMagick-5.5.7-Q16/');
+
+
+/*
+  The prefix for thumbnail files, something like .thumb will do. The
+  thumbnails files will be named as "prefix_imagefile.ext", that is,
+  prefix + orginal filename.
+*/
+$IMConfig['thumbnail_prefix'] = 't_';
+
+
+/*
+  Thumbnail can also be stored in a directory, this directory
+  will be created by PHP. If PHP is in safe mode, this parameter
+  is ignored, you can not create directories.
+
+  If you do not want to store thumbnails in a directory, set this
+  to false or empty string '';
+*/
+$IMConfig['thumbnail_dir'] = 't';
+
+/**
+* Resized prefix
+*
+* The prefix for resized files, something like .resized will do.  The
+* resized files will be named <prefix>_<width>x<height>_<original>
+* resized files are created when one changes the dimensions of an image
+* in the image manager selection dialog - the image is scaled when the
+* user clicks the ok button.
+*/
+
+$IMConfig['resized_prefix'] = '.resized';
+
+// -------------------------------------------------------------------------
+
+/**
+* Resized Directory
+*
+* Resized images may also be stored in a directory, except in safe mode.
+*/
+
+$IMConfig['resized_dir'] = '';
+
+/*
+  Possible values: true, false
+
+ TRUE -  Allow the user to create new sub-directories in the
+         $IMConfig['images_dir']/$IMConfig['files_dir'].
+
+ FALSE - No directory creation.
+
+ NOTE: If $IMConfig['safe_mode'] = true, this parameter
+       is ignored, you can not create directories
+*/
+$IMConfig['allow_new_dir'] = true;
+
+/*
+  Possible values: true, false
+
+ TRUE -  Allow the user to edit image by image editor.
+
+ FALSE - No edit icon will be displayed.
+
+ NOTE: If $IMConfig['img_library'] = false, this parameter
+       is ignored, you can not edit images.
+*/
+$IMConfig['allow_edit_image'] = true;
+
+/*
+  Possible values: true, false
+
+ TRUE -  Allow the user to rename files and folders.
+
+ FALSE - No rename icon will be displayed.
+
+*/
+$IMConfig['allow_rename'] = true;
+
+/*
+  Possible values: true, false
+
+ TRUE -  Allow the user to perform cut/copy/paste actions.
+
+ FALSE - No cut/copy/paste icons will be displayed.
+
+*/
+$IMConfig['allow_cut_copy_paste'] = true;
+
+/*
+  Possible values: true, false
+
+  TRUE - Display color pickers for image background / border colors
+
+  FALSE - Don't display color pickers
+*/
+$IMConfig['use_color_pickers'] = true;
+
+/*
+  Possible values: true, false
+
+ TRUE -  Allow the user to set alt (alternative text) attribute.
+
+ FALSE - No input field for alt attribute will be displayed.
+
+ NOTE: The alt attribute is _obligatory_ for images, so <img alt="" /> will be inserted
+      if 'images_enable_alt' is set to false
+*/
+$IMConfig['images_enable_alt'] = true;
+
+/*
+  Possible values: true, false
+
+ TRUE -  Allow the user to set title attribute (usually displayed when mouse is over element).
+
+ FALSE - No input field for title attribute will be displayed.
+
+*/
+$IMConfig['images_enable_title'] = false;
+
+/*
+  Possible values: true, false
+
+ TRUE -  Allow the user to set align attribute.
+
+ FALSE - No selection box for align attribute will be displayed.
+
+*/
+$IMConfig['images_enable_align'] = true;
+
+/*
+  Possible values: true, false
+
+ TRUE -  Allow the user to set margin, padding, and border styles for the image
+
+ FALSE - No styling input fields will be displayed.
+
+*/
+$IMConfig['images_enable_styling'] = true;
+
+/*
+  Possible values: true, false
+
+ TRUE -   Allow the user to set target attribute for link (the window in which the link will be opened).
+
+ FALSE - No selection box for target attribute will be displayed.
+
+*/
+$IMConfig['link_enable_target'] = true;
+/*
+  Possible values: true, false
+
+  TRUE - Allow the user to upload files.
+
+  FALSE - No uploading allowed.
+*/
+$IMConfig['allow_upload'] = true;
+
+/* Maximum upload file size
+
+  Possible values: number, "max"
+
+  number - maximum size in Kilobytes.
+
+  "max"  - the maximum allowed by the server (the value is retrieved from the server configuration).
+*/
+$IMConfig['max_filesize_kb_image'] = 200;
+
+$IMConfig['max_filesize_kb_link'] = 5000;
+
+/* Maximum upload folder size in Megabytes. Use 0 to disable limit */
+$IMConfig['max_foldersize_mb'] = 0;
+
+/*
+Allowed extensions that can be shown and allowed to upload.
+Available icons are for "doc,fla,gif,gz,html,jpg,js,mov,pdf,php,png,ppt,rar,txt,xls,zip"
+-Changed by AFRU.
+*/
+
+$IMConfig['allowed_image_extensions'] = array("jpg","gif","png","bmp");
+$IMConfig['allowed_link_extensions'] = array("jpg","gif","js","php","pdf","zip","txt","psd","png","html","swf","xml","xls","doc");
+
+
+/*
+ The default thumbnail and list view icon in case thumbnails are not created and the files are of unknown.
+*/
+$IMConfig['default_thumbnail'] = 'icons/def.gif';
+$IMConfig['default_listicon'] = 'icons/def_small.gif';
+
+
+/*
+Only files with these extensions will be shown as thumbnails. All other files will be shown as icons.
+*/
+$IMConfig['thumbnail_extensions'] = array("jpg", "gif", "png", "bmp");
+
+/*
+  Thumbnail dimensions.
+*/
+$IMConfig['thumbnail_width'] = 84;
+$IMConfig['thumbnail_height'] = 84;
+
+/*
+  Image Editor temporary filename prefix.
+*/
+$IMConfig['tmp_prefix'] = '.editor_';
+
+
+// Standard PHP Backend Data Passing
+//  if data was passed using xinha_pass_to_php_backend() we merge the items
+//  provided into the Config
+require_once(realpath(dirname(__FILE__) . '/../../contrib/php-xinha.php'));
+if($passed_data = xinha_read_passed_data())
+{
+  $IMConfig = array_merge($IMConfig, $passed_data);
+  $IMConfig['backend_url'] .= xinha_passed_data_querystring() . '&';
+}
+// Deprecated config passing, don't use this way any more!
+elseif(isset($_REQUEST['backend_config']))
+{
+  if(get_magic_quotes_gpc()) {
+    $_REQUEST['backend_config'] = stripslashes($_REQUEST['backend_config']);
+  }
+
+  // Config specified from front end, check that it's valid
+  session_start();
+  if (!array_key_exists($_REQUEST['backend_config_secret_key_location'], $_SESSION))
+    die("Backend security error.");
+
+  $secret = $_SESSION[$_REQUEST['backend_config_secret_key_location']];
+
+  if($_REQUEST['backend_config_hash'] !== sha1($_REQUEST['backend_config'] . $secret))
+  {
+    die("Backend security error.");
+  }
+
+  $to_merge = unserialize($_REQUEST['backend_config']);
+  if(!is_array($to_merge))
+  {
+    die("Backend config syntax error.");
+  }
+
+  $IMConfig = array_merge($IMConfig, $to_merge);
+
+   // changed config settings keys in relation to ImageManager
+  $IMConfig['backend_url'] .= "backend_config=" . rawurlencode($_REQUEST['backend_config']) . '&';
+  $IMConfig['backend_url'] .= "backend_config_hash=" . rawurlencode($_REQUEST['backend_config_hash']) . '&';
+  $IMConfig['backend_url'] .= "backend_config_secret_key_location=" . rawurlencode($_REQUEST['backend_config_secret_key_location']) . '&';
+
+}
+if ($IMConfig['max_filesize_kb_link'] == "max")
+{
+  $IMConfig['max_filesize_kb_link'] = upload_max_filesize_kb();
+}
+
+if ($IMConfig['max_filesize_kb_image'] == "max")
+{
+  $IMConfig['max_filesize_kb_image'] = upload_max_filesize_kb();
+}
+// END
+
+?>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/demo_images/.htaccess
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/demo_images/.htaccess	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,2 @@
+php_flag engine off
+AddType text/html .html .htm .shtml .php .php3 .phtml .phtm .pl .py .cgi
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/demo_images/bikerpeep.jpg
Binary file Xinha_0.95/plugins/ExtendedFileManager/demo_images/bikerpeep.jpg has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/demo_images/linux/linux.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/demo_images/linux/linux.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/demo_images/wesnoth078.jpg
Binary file Xinha_0.95/plugins/ExtendedFileManager/demo_images/wesnoth078.jpg has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/editor.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/editor.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,172 @@
+<?php
+/**
+ * ExtendedFileManager editor.php file.
+ * Authors: Wei Zhuo, Afru, Krzysztof Kotowicz
+ * Version: Updated on 08-01-2005 by Afru
+ * Version: Updated on 21-06-2006 by Krzysztof Kotowicz
+ * Version: Updated on 20-01-2008 by Raimund Meyer
+ * Package: ExtendedFileManager (EFM 1.4)
+ * http://www.afrusoft.com/htmlarea
+ */
+if(isset($_REQUEST['mode'])) $insertMode=$_REQUEST['mode'];
+	if(!isset($insertMode)) $insertMode="image";
+
+require_once('config.inc.php');
+require_once('Classes/ExtendedFileManager.php');
+require_once('../ImageManager/Classes/ImageEditor.php');
+
+$manager = new ExtendedFileManager($IMConfig,$insertMode);
+$editor = new ImageEditor($manager);
+
+?>
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+
+<html>
+<head>
+	<title>Xinha Image Editor</title>
+	<link href="<?php print $IMConfig['base_url'];?>assets/editor.css" rel="stylesheet" type="text/css" />
+<script type="text/javascript" src="<?php print $IMConfig['base_url'];?>assets/slider.js"></script>
+<script type="text/javascript" src="../../popups/popup.js"></script>
+<script type="text/javascript" src="<?php print $IMConfig['base_url'];?>assets/popup.js"></script>
+<script type="text/javascript">
+/*<![CDATA[*/
+
+    var _backend_url = "<?php print $IMConfig['backend_url']."&mode=$insertMode"; ?>&";
+
+	if(window.opener)
+		Xinha = window.opener.Xinha;
+/*]]>*/
+</script>
+<script type="text/javascript" src="<?php print $IMConfig['base_url'];?>assets/editor.js"></script>
+</head>
+
+<body>
+<table style="width:100%">
+<tr>
+	<td id="indicator">
+    	<img src="<?php print $IMConfig['base_url'];?>img/spacer.gif" id="indicator_image" height="20" width="20" alt=""/>
+	</td>
+	<td id="tools">
+		<div id="tools_crop" style="display:none;">
+			<div class="tool_inputs">
+				<label for="cx">Start X:</label><input type="text" id="cx"  class="textInput" onchange="updateMarker('crop')"/>
+				<label for="cy">Start Y:</label><input type="text" id="cy" class="textInput" onchange="updateMarker('crop')"/>
+				<label for="cw">Width:</label><input type="text" id="cw" class="textInput" onchange="updateMarker('crop')"/>
+				<label for="ch">Height:</label><input type="text" id="ch" class="textInput" onchange="updateMarker('crop')"/>			<img src="<?php print $IMConfig['base_url'];?>img/div.gif" height="30" width="2" class="div" alt="|" />
+			</div>	
+			<a href="javascript:void(0);" onclick="editor.doSubmit('crop');" class="buttons" title="OK"><img src="<?php print $IMConfig['base_url'];?>img/btn_ok.gif" height="30" width="30" alt="OK" /></a>
+			<a href="javascript:void(0);" onclick="editor.reset();" class="buttons" title="Cancel"><img src="<?php print $IMConfig['base_url'];?>img/btn_cancel.gif" height="30" width="30" alt="Cancel" /></a>
+		</div>	
+		<div id="tools_scale" style="display:none;">
+			<div class="tool_inputs">
+				<label for="sw">Width:</label><input type="text" id="sw" class="textInput" onchange="checkConstrains('width')"/>
+				<a href="javascript:void(0);" onclick="toggleConstraints();" title="Lock"><img src="<?php print $IMConfig['base_url'];?>img/islocked2.gif" id="scaleConstImg" height="14" width="8" alt="Lock" class="div" /></a><label for="sh">Height:</label>
+				<input type="text" id="sh" class="textInput" onchange="checkConstrains('height')"/>
+				<input type="checkbox" id="constProp" value="1" checked="checked" onclick="toggleConstraints()"/>
+				<label for="constProp">Constrain Proportions</label>
+				<img src="<?php print $IMConfig['base_url'];?>img/div.gif" height="30" width="2" class="div" alt="|" />
+			</div>	
+			<a href="javascript:void(0);" onclick="editor.doSubmit('scale');" class="buttons" title="OK"><img src="<?php print $IMConfig['base_url'];?>img/btn_ok.gif" height="30" width="30" alt="OK" /></a>
+			<a href="javascript:void(0);" onclick="zoom();" class="buttons" title="Cancel"><img src="<?php print $IMConfig['base_url'];?>img/btn_cancel.gif" height="30" width="30" alt="Cancel" /></a>
+		</div>	
+		<div id="tools_rotate" style="display:none;">
+			<div class="tool_inputs">
+				<select id="rotate_sub_action" name="rotate_sub_action" onchange="rotateSubActionSelect(this)" style="margin-left: 10px; vertical-align: middle;">
+					<option selected="selected" value="rotate">Rotate Image</option>
+					<option value="flip">Flip Image</option>
+				</select>
+				<select id="rotate_preset_select" name="rotate_preset_select" onchange="rotatePreset(this)" style="margin-left: 20px; vertical-align: middle;">
+					<option>Preset</option>
+					<option value="180">Rotate 180 &deg;</option>
+					<option value="90">Rotate 90 &deg; CW</option>
+					<option value="-90">Rotate 90 &deg; CCW</option>
+				</select>
+				<select id="flip" name="flip" style="margin-left: 20px; vertical-align: middle;display:none">
+					<option value="hoz">Flip Horizontal</option>
+					<option value="ver">Flip Vertical</option>
+				</select>
+				<label for="ra">Angle:<input type="text" id="ra" class="textInput" /></label>
+				<img src="<?php print $IMConfig['base_url'];?>img/div.gif" height="30" width="2" class="div" alt="|" />
+			</div>	
+			<a href="javascript:void(0);" onclick="editor.doSubmit('rotate');" class="buttons" title="OK"><img src="<?php print $IMConfig['base_url'];?>img/btn_ok.gif" height="30" width="30" alt="OK" /></a>
+			<a href="javascript:void(0);" onclick="editor.reset();" class="buttons" title="Cancel"><img src="<?php print $IMConfig['base_url'];?>img/btn_cancel.gif" height="30" width="30" alt="Cancel" /></a>
+		</div>		
+		<div id="tools_measure" style="display:none;">
+			<div class="tool_inputs">
+				<label>X:</label><input type="text" class="measureStats" id="sx" />
+				<label>Y:</label><input type="text" class="measureStats" id="sy" />
+				<img src="<?php print $IMConfig['base_url'];?>img/div.gif" height="30" width="2" class="div" alt="|" />
+				<label>W:</label><input type="text" class="measureStats" id="mw" />
+				<label>H:</label><input type="text" class="measureStats" id="mh" />
+				<img src="<?php print $IMConfig['base_url'];?>img/div.gif" height="30" width="2" class="div" alt="|" />
+				<label>A:</label><input type="text" class="measureStats" id="ma" />		
+				<label>D:</label><input type="text" class="measureStats" id="md" />		
+				<img src="<?php print $IMConfig['base_url'];?>img/div.gif" height="30" width="2" class="div" alt="|" />
+				<button type="button" onclick="editor.reset();" >Clear</button>
+			</div>	
+		</div>
+		<div id="tools_save" style="display:none;">
+			<div class="tool_inputs">
+				<label for="save_filename">Filename:</label><input type="text" id="save_filename" value="<?php echo $editor->getDefaultSaveFile();?>"/>
+				<select name="format" id="save_format" style="margin-left: 10px; vertical-align: middle;" onchange="updateFormat(this)">
+	            <option value="jpeg,85">JPEG High</option>
+	            <option value="jpeg,60">JPEG Medium</option>
+	            <option value="jpeg,35">JPEG Low</option>
+	            <option value="png">PNG</option>
+				<?php if($editor->isGDGIFAble() != -1) { ?>
+	            <option value="gif">GIF</option>
+				<?php } ?>
+	         </select>
+			 <div id="slider" style="display:inline">
+				<label>Quality:</label>
+				<table style="display: inline; vertical-align: middle;" cellpadding="0" cellspacing="0">
+					<tr>
+					<td>
+						<div id="slidercasing"> 
+					<div id="slidertrack" style="width:100px"><img src="<?php print $IMConfig['base_url'];?>img/spacer.gif" width="1" height="1" border="0" alt="track" /></div>
+	            <div id="sliderbar" style="left:85px" onmousedown="captureStart();"><img src="<?php print $IMConfig['base_url'];?>img/spacer.gif" width="1" height="1" border="0" alt="track" /></div>
+				</div>	
+					</td>
+					</tr>
+				</table>
+				<input type="text" id="quality" onchange="updateSlider(this.value)" style="width: 2em;" value="85"/>
+			</div>
+			<img src="<?php print $IMConfig['base_url'];?>img/div.gif" height="30" width="2" class="div" alt="|" />
+			<div style="display:inline;font-size:10px">
+			<span>Filesize:</span> <span id="filesize"></span>
+			</div> 
+			<img src="<?php print $IMConfig['base_url'];?>img/div.gif" height="30" width="2" class="div" alt="|" />
+			</div>	
+			<button type="button" style="float:left;margin:17px 5px 0 ;" onclick="editor.doSubmit('preview')">Preview</button>
+			<button type="button" style="float:left;margin-top:17px;" onclick="editor.doSubmit('save');">Save</button>
+			</div>	
+	</td>
+</tr>
+<tr>
+	<td id="toolbar">
+		<a href="javascript:void(0);"  onclick="toggle('crop')" id="icon_crop" title="Crop"><img src="<?php print $IMConfig['base_url'];?>img/crop.gif" height="20" width="20" alt="Crop" /><span>Crop</span></a>
+		<a href="javascript:void(0);" onclick="toggle('scale')" id="icon_scale" title="Resize"><img src="<?php print $IMConfig['base_url'];?>img/scale.gif" height="20" width="20" alt="Resize" /><span>Resize</span></a>
+		<a href="javascript:void(0);" onclick="toggle('rotate')" id="icon_rotate" title="Rotate"><img src="<?php print $IMConfig['base_url'];?>img/rotate.gif" height="20" width="20" alt="Rotate" /><span>Rotate</span></a>
+		<a href="javascript:void(0);" onclick="toggle('measure')" id="icon_measure" title="Measure"><img src="<?php print $IMConfig['base_url'];?>img/measure.gif" height="20" width="20" alt="Measure" /><span>Measure</span></a>
+		<a href="javascript:void(0);" onclick="toggleMarker();" title="Toggle marker color"><img id="markerImg" src="<?php print $IMConfig['base_url'];?>img/t_black.gif" height="20" width="20" alt="Marker" /><span>Marker</span></a>
+		<a href="javascript:void(0);" onclick="toggle('save')" id="icon_save" title="Save"><img src="<?php print $IMConfig['base_url'];?>img/save.gif" height="20" width="20" alt="Save" /><span>Save</span></a>
+		<div style="margin-top:10px">Zoom</div>
+		<select id="zoom" onchange="zoom(this.value)">
+			<option value="10">10%</option>
+			<option value="25">25%</option>
+			<option value="50">50%</option>
+			<option value="75">75%</option>
+			<option value="100" selected="selected">100%</option>
+			<option value="200">200%</option>
+		</select>
+	</td>
+	<td id="contents">
+		<?php
+		$iframe_src = $IMConfig['backend_url'].'__function=editorFrame&img='.((isset($_GET['img'])) ? rawurlencode($_GET['img']) : '').'&mode='. $insertMode;
+		?>
+		<iframe src="<?php print htmlspecialchars($iframe_src) ?>" name="editor" id="editor"  scrolling="auto" title="Image Editor" frameborder="0"></iframe>
+	</td>
+</tr>
+</table>
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/editorFrame.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/editorFrame.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,84 @@
+<?php
+/**
+ * ExtendedFileManager editorframe.php file.
+ * Authors: Wei Zhuo, Afru, Krzysztof Kotowicz
+ * Version: Updated on 08-01-2005 by Afru
+ * Version: Updated on 21-06-2006 by Krzysztof Kotowicz
+ * Version: Updated on 20-01-2008 by Raimund Meyer
+ * Package: ExtendedFileManager (EFM 1.4)
+ * http://www.afrusoft.com/htmlarea
+ */
+if(isset($_REQUEST['mode'])) $insertMode=$_REQUEST['mode'];
+	if(!isset($insertMode)) $insertMode="image";
+
+require_once('config.inc.php');
+require_once('Classes/ExtendedFileManager.php');
+require_once('../ImageManager/Classes/ImageEditor.php');
+
+$manager = new ExtendedFileManager($IMConfig,$insertMode);
+$editor = new ImageEditor($manager);
+$imageInfo = $editor->processImage();
+
+?>
+
+<html>
+<head>
+	<title></title>
+<link href="<?php print $IMConfig['base_url'];?>assets/editorFrame.css" rel="stylesheet" type="text/css" />
+<script type="text/javascript" src="<?php print $IMConfig['base_url'];?>assets/wz_jsgraphics.js"></script>
+<script type="text/javascript" src="<?php print $IMConfig['base_url'];?>assets/EditorContent.js"></script>
+<script type="text/javascript">
+    var _backend_url = "<?php print $IMConfig['backend_url']."&mode=$insertMode"; ?>&";
+
+    if(window.top)
+    	Xinha = window.top.Xinha;
+
+    function i18n(str) {
+        return Xinha._lc(str, 'ImageManager');
+    }
+
+	var mode = "<?php echo $editor->getAction(); ?>" //crop, scale, measure
+	var currentImageFile = "<?php if(count($imageInfo)>0) echo rawurlencode($imageInfo['file']); ?>";
+	var fileSize = "<?php echo (round($imageInfo['filesize'] / 1024,1)).' KB' ?>";
+	
+
+<?php if ($editor->isFileSaved() == 1) { ?>
+	alert(i18n('File saved.'));
+
+    window.parent.opener.parent.refresh();
+    window.parent.opener.selectImage
+    (
+  	'<?php echo $imageInfo['saveFile'] ?>',
+  	'<?php echo $imageInfo['saveFile'] ?>'.replace(/^.*\/?([^\/]*)$/, '$1'),
+  	<?php echo $imageInfo['width'] ?>,
+  	<?php echo $imageInfo['height'] ?>
+  	);
+  	window.parent.close();
+  	
+<?php } else if ($editor->isFileSaved() == -1) { ?>
+	alert(i18n('File was not saved.'));
+<?php } ?>
+
+</script>
+<script type="text/javascript" src="<?php print $IMConfig['base_url'];?>assets/editorFrame.js"></script>
+</head>
+
+<body>
+<div id="status"></div>
+<div id="ant" class="selection" style="visibility:hidden"><img src="<?php print $IMConfig['base_url'];?>img/spacer.gif" width="0" height="0" border="0" alt="" id="cropContent"></div>
+<?php if ($editor->isGDEditable() == -1) { ?>
+	<div style="text-align:center; padding:10px;"><span class="error">GIF format is not supported, image editing not supported.</span></div>
+<?php } ?>
+<table height="100%" width="100%">
+	<tr>
+		<td>
+<?php if(count($imageInfo) > 0 && is_file($imageInfo['fullpath'])) { ?>
+	<span id="imgCanvas" class="crop"><img src="<?php echo $imageInfo['src']; ?>" <?php echo $imageInfo['dimensions']; ?> alt="" id="theImage" name="theImage"></span>
+<?php } else { ?>
+	<span class="error">No Image Available</span>
+<?php } ?>
+		</td>
+	</tr>
+</table>
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/extended-file-manager.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/extended-file-manager.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,242 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/ExtendedFileManager/extended-file-manager.js */
+function ExtendedFileManager(_1){
+this.editor=_1;
+var _2=_1.config;
+var _3=_2.toolbar;
+var _4=this;
+if(_2.ExtendedFileManager.use_linker){
+_2.registerButton({id:"linkfile",tooltip:Xinha._lc("Insert File Link","ExtendedFileManager"),image:Xinha.getPluginDir("ExtendedFileManager")+"/img/ed_linkfile.gif",textMode:false,action:function(_5){
+_5._linkFile();
+}});
+_2.addToolbarElement("linkfile","createlink",1);
+}
+var _6=_1.config.ExtendedFileManager.backend+"__function=manager";
+if(_2.ExtendedFileManager.backend_config!=null){
+_6+="&backend_config="+encodeURIComponent(_2.ExtendedFileManager.backend_config);
+_6+="&backend_config_hash="+encodeURIComponent(_2.ExtendedFileManager.backend_config_hash);
+_6+="&backend_config_secret_key_location="+encodeURIComponent(_2.ExtendedFileManager.backend_config_secret_key_location);
+}
+if(_2.ExtendedFileManager.backend_data!=null){
+for(var i in _2.ExtendedFileManager.backend_data){
+_6+="&"+i+"="+encodeURIComponent(_2.ExtendedFileManager.backend_data[i]);
+}
+}
+_2.ExtendedFileManager.manager=_6;
+}
+ExtendedFileManager._pluginInfo={name:"ExtendedFileManager",version:"1.4",developer:"Afru, Krzysztof Kotowicz, Raimund Meyer",developer_url:"http://xinha.org",license:"htmlArea"};
+Xinha.Config.prototype.ExtendedFileManager={"use_linker":true,"backend":Xinha.getPluginDir("ExtendedFileManager")+"/backend.php?__plugin=ExtendedFileManager&","backend_data":null,"backend_config":null,"backend_config_hash":null,"backend_config_secret_key_location":"Xinha:ImageManager"};
+if(typeof ImageManager=="undefined"){
+Xinha.prototype._insertImage=function(_8){
+var _9=this;
+var _a={"editor":this,param:null};
+if(typeof _8=="undefined"){
+_8=this.getParentElement();
+if(_8&&!/^img$/i.test(_8.tagName)){
+_8=null;
+}
+}
+if(_8){
+_a.param={f_url:Xinha.is_ie?_8.src:_8.getAttribute("src"),f_alt:_8.alt,f_title:_8.title,f_border:_8.style.borderWidth?_8.style.borderWidth:_8.border,f_align:_8.align,f_width:_8.width,f_height:_8.height,f_padding:_8.style.padding,f_margin:_8.style.margin,f_backgroundColor:_8.style.backgroundColor,f_borderColor:_8.style.borderColor,baseHref:_9.config.baseHref};
+_a.param.f_border=shortSize(_a.param.f_border);
+_a.param.f_padding=shortSize(_a.param.f_padding);
+_a.param.f_margin=shortSize(_a.param.f_margin);
+_a.param.f_backgroundColor=convertToHex(_a.param.f_backgroundColor);
+_a.param.f_borderColor=convertToHex(_a.param.f_borderColor);
+}
+Dialog(this.config.ExtendedFileManager.manager,function(_b){
+if(!_b){
+return false;
+}
+var _c=_8;
+if(!_c){
+if(!_b.f_url){
+return false;
+}
+if(Xinha.is_ie){
+var _d=_9.getSelection();
+var _e=_9.createRange(_d);
+_9._doc.execCommand("insertimage",false,_b.f_url);
+_c=_e.parentElement();
+if(_c.tagName.toLowerCase()!="img"){
+_c=_c.previousSibling;
+}
+}else{
+_c=document.createElement("img");
+_c.src=_b.f_url;
+_9.insertNodeAtSelection(_c);
+}
+}else{
+if(!_b.f_url){
+_c.parentNode.removeChild(_c);
+_9.updateToolbar();
+return false;
+}else{
+_c.src=_b.f_url;
+}
+}
+_c.alt=_c.alt?_c.alt:"";
+for(field in _b){
+var _f=_b[field];
+switch(field){
+case "f_alt":
+_c.alt=_f;
+break;
+case "f_title":
+_c.title=_f;
+break;
+case "f_border":
+if(_f){
+_c.style.borderWidth=/[^0-9]/.test(_f)?_f:(_f!="")?(parseInt(_f)+"px"):"";
+if(_c.style.borderWidth&&!_c.style.borderStyle){
+_c.style.borderStyle="solid";
+}else{
+if(!_c.style.borderWidth){
+_c.style.border="";
+}
+}
+}
+break;
+case "f_borderColor":
+_c.style.borderColor=_f;
+break;
+case "f_backgroundColor":
+_c.style.backgroundColor=_f;
+break;
+case "f_align":
+_c.align=_f;
+break;
+case "f_width":
+if(parseInt(_f)>0){
+_c.width=parseInt(_f);
+}
+break;
+case "f_height":
+if(parseInt(_f)>0){
+_c.height=parseInt(_f);
+}
+break;
+case "f_padding":
+_c.style.padding=/[^0-9]/.test(_f)?_f:(_f!="")?(parseInt(_f)+"px"):"";
+break;
+case "f_margin":
+_c.style.margin=/[^0-9]/.test(_f)?_f:(_f!="")?(parseInt(_f)+"px"):"";
+break;
+}
+}
+},_a);
+};
+}
+Xinha.prototype._linkFile=function(_10){
+var _11=this;
+var _12={"editor":this,param:null};
+if(typeof _10=="undefined"){
+_10=this.getParentElement();
+if(_10){
+if(/^img$/i.test(_10.tagName)){
+_10=_10.parentNode;
+}
+if(!/^a$/i.test(_10.tagName)){
+_10=null;
+}
+}
+}
+if(!_10){
+var sel=_11.getSelection();
+var _14=_11.createRange(sel);
+var _15=0;
+if(Xinha.is_ie){
+if(sel.type=="Control"){
+_15=_14.length;
+}else{
+_15=_14.compareEndPoints("StartToEnd",_14);
+}
+}else{
+_15=_14.compareBoundaryPoints(_14.START_TO_END,_14);
+}
+if(_15==0){
+alert(Xinha._lc("You must select some text before making a new link.","ExtendedFileManager"));
+return;
+}
+_12.param={f_href:"",f_title:"",f_target:"",f_usetarget:_11.config.makeLinkShowsTarget,baseHref:_11.config.baseHref};
+}else{
+_12.param={f_href:Xinha.is_ie?_10.href:_10.getAttribute("href"),f_title:_10.title,f_target:_10.target,f_usetarget:_11.config.makeLinkShowsTarget,baseHref:_11.config.baseHref};
+}
+Dialog(this.config.ExtendedFileManager.manager+"&mode=link",function(_16){
+if(!_16){
+return false;
+}
+var a=_10;
+if(!a){
+try{
+_11._doc.execCommand("createlink",false,_16.f_href);
+a=_11.getParentElement();
+var sel=_11.getSelection();
+var _19=_11.createRange(sel);
+if(!Xinha.is_ie){
+a=_19.startContainer;
+if(!/^a$/i.test(a.tagName)){
+a=a.nextSibling;
+if(a==null){
+a=_19.startContainer.parentNode;
+}
+}
+}
+}
+catch(e){
+}
+}else{
+var _1a=_16.f_href.trim();
+_11.selectNodeContents(a);
+if(_1a==""){
+_11._doc.execCommand("unlink",false,null);
+_11.updateToolbar();
+return false;
+}else{
+a.href=_1a;
+}
+}
+if(!(a&&/^a$/i.test(a.tagName))){
+return false;
+}
+a.target=_16.f_target.trim();
+a.title=_16.f_title.trim();
+_11.selectNodeContents(a);
+_11.updateToolbar();
+},_12);
+};
+function shortSize(_1b){
+if(/ /.test(_1b)){
+var _1c=_1b.split(" ");
+var _1d=true;
+for(var i=1;i<_1c.length;i++){
+if(_1c[0]!=_1c[i]){
+_1d=false;
+break;
+}
+}
+if(_1d){
+_1b=_1c[0];
+}
+}
+return _1b;
+}
+function convertToHex(_1f){
+if(typeof _1f=="string"&&/, /.test.color){
+_1f=_1f.replace(/, /,",");
+}
+if(typeof _1f=="string"&&/ /.test.color){
+var _20=_1f.split(" ");
+var _21="";
+for(var i=0;i<_20.length;i++){
+_21+=Xinha._colorToRgb(_20[i]);
+if(i+1<_20.length){
+_21+=" ";
+}
+}
+return _21;
+}
+return Xinha._colorToRgb(_1f);
+}
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/def.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/def.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/def_small.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/def_small.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/doc.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/doc.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/doc_small.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/doc_small.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/fla.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/fla.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/fla_small.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/fla_small.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/folder.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/folder.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/folder_small.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/folder_small.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/gif_small.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/gif_small.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/gz.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/gz.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/gz_small.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/gz_small.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/html.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/html.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/html_small.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/html_small.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/jpg_small.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/jpg_small.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/js.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/js.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/js_small.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/js_small.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/mov.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/mov.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/mov_small.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/mov_small.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/pdf.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/pdf.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/pdf_small.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/pdf_small.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/php.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/php.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/php_small.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/php_small.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/png_small.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/png_small.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/ppt.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/ppt.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/ppt_small.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/ppt_small.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/rar.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/rar.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/rar_small.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/rar_small.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/txt.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/txt.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/txt_small.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/txt_small.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/xls.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/xls.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/xls_small.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/xls_small.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/zip.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/zip.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/icons/zip_small.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/icons/zip_small.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/images.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/images.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,391 @@
+<?php
+/**
+ * ExtendedFileManager images.php file. Shows folders and files.
+ * Authors: Wei Zhuo, Afru, Krzysztof Kotowicz, Raimund Meyer
+ * Version: Updated on 08-01-2005 by Afru
+ * Version: Updated on 04-07-2006 by Krzysztof Kotowicz
+ * Version: Updated on 29-10-2006 by Raimund Meyer
+ * Version: Updated on 20-01-2008 by Raimund Meyer
+ * Package: ExtendedFileManager (EFM 1.4)
+ * http://www.afrusoft.com/htmlarea
+ */
+
+	if(isset($_REQUEST['mode'])) $insertMode=$_REQUEST['mode'];
+	if(!isset($insertMode)) $insertMode="image";
+
+require_once('config.inc.php');
+require_once('Classes/ExtendedFileManager.php');
+$backend_url_enc = htmlspecialchars( $IMConfig['backend_url'] );
+//default path is /
+$relative = '/';
+$manager = new ExtendedFileManager($IMConfig, $insertMode);
+
+//process any file uploads
+$uploadStatus=$manager->processUploads();
+
+//process any file renames
+$renameStatus=$manager->processRenames();
+
+//process paste
+$pasteStatus = (isset($_GET['paste'])) ? 	$manager->processPaste() : false;
+
+$refreshFile = ($manager->deleteFiles()) ? true : false;
+
+$refreshDir = false;
+//process any directory functions
+if($manager->deleteDirs() || $manager->processNewDir() || $pasteStatus || $renameStatus )
+	$refreshDir = true;
+
+
+$diskInfo=$manager->getDiskInfo();
+
+//check for any sub-directory request
+//check that the requested sub-directory exists
+//and valid
+if(isset($_REQUEST['dir']))
+{
+	$path = rawurldecode($_REQUEST['dir']);
+	if($manager->validRelativePath($path))
+		$relative = $path;
+}
+
+$afruViewType = (isset($_REQUEST['viewtype'])) ? $afruViewType=$_REQUEST['viewtype'] : '';
+
+if($afruViewType!="thumbview" && $afruViewType!="listview")
+{
+  $afruViewType=$IMConfig['view_type'];
+}
+//get the list of files and directories
+$list = $manager->getFiles($relative);
+
+
+/* ================= OUTPUT/DRAW FUNCTIONS ======================= */
+
+
+/**
+ * Draw folders and files. Changed by Afru
+ */
+function drawDirs_Files($list, &$manager) 
+{
+	global $relative, $afruViewType, $IMConfig, $insertMode,$backend_url_enc;
+
+    switch ($afruViewType) {
+        case 'listview':
+    		$maxNameLength = 30;
+    		?>
+            <table class="listview" id="listview">
+            <thead>
+            <tr><th>Name</th><th>Size</th><th>Image Size</th><th>Date Modified</th><th>&nbsp;</th></tr></thead>
+            <tbody>
+            <?php
+    		// start of foreach for draw listview folders .
+    		foreach($list[0] as $path => $dir)
+    		{ ?>
+    			<tr>
+    			<td><span style="width:20px;"><img src="<?php print $IMConfig['base_url'];?>icons/folder_small.gif" alt="" /></span>
+				<a href="<?php print $backend_url_enc; ?>__function=images&amp;mode=<?php echo $insertMode;?>&amp;dir=<?php echo rawurlencode($path); ?>&amp;viewtype=<?php echo $afruViewType; ?>" onclick="updateDir('<?php echo $path; ?>')" title="<?php echo $dir['entry']; ?>">
+    			<?php
+    			if(strlen($dir['entry'])>$maxNameLength) echo substr($dir['entry'],0,$maxNameLength)."..."; else echo $dir['entry'];
+    			?>
+    			</a></td>
+    			<td colspan="2" >Folder</td>
+
+    			<td ><?php echo date($IMConfig['date_format'],$dir['stat']['mtime']); ?></td>
+
+    			<td class="actions" >
+    				<a href="<?php print $backend_url_enc; ?>__function=images&amp;mode=<?php echo $insertMode;?>&amp;dir=<?php echo $relative; ?>&amp;deld=<?php echo rawurlencode($path); ?>&amp;viewtype=<?php echo $afruViewType; ?>" title="Trash" onclick="return confirmDeleteDir('<?php echo $dir['entry']; ?>', <?php echo $dir['count']; ?>);" style="border:0px;"><img src="<?php print $IMConfig['base_url'];?>img/edit_trash.gif" height="15" width="15" alt="Trash" border="0" /></a>
+			    	<?php if ($IMConfig['allow_rename']) { ?>
+			                    <a href="#" title="Rename" onclick="renameDir('<?php echo rawurlencode($dir['entry']);?>'); return false;"><img src="<?php print $IMConfig['base_url'];?>img/edit_rename.gif" height="15" width="15" alt="Rename" border="0" /></a>
+			        <?php }  ?>
+    				<?php if ($IMConfig['allow_cut_copy_paste']) { ?>
+                    <a href="#" title="Cut" onclick="copyDir('<?php echo rawurlencode($dir['entry']);?>','move'); return false;"><img src="<?php print $IMConfig['base_url'];?>img/edit_cut.gif" height="15" width="15" alt="Cut" /></a>
+                     <a href="#" title="Copy" onclick="copyDir('<?php echo rawurlencode($dir['entry']);?>','copy'); return false;"><img src="<?php print $IMConfig['base_url'];?>img/edit_copy.gif" height="15" width="15" alt="Copy" /></a>
+     		   		<?php }  ?>
+    			</td>
+    			</tr>
+    		  <?php
+    		} // end of foreach for draw listview folders .
+
+    		clearstatcache();
+
+    		// start of foreach for draw listview files .
+    		foreach($list[1] as $entry => $file)
+    		{
+    			?>
+                <tr>
+        		  <td><span style="width:20px;"><img src="<?php print $IMConfig['base_url']; if(is_file('icons/'.$file['ext'].'_small.gif')) echo "icons/".$file['ext']."_small.gif"; else echo $IMConfig['default_listicon']; ?>" alt="" /></span>
+					<a href="#" class="thumb" style="cursor: pointer;" ondblclick="this.onclick();window.top.onOK();" onclick="selectImage('<?php echo $file['relative'];?>', '<?php echo preg_replace('#\..{3,4}$#', '', $entry); ?>', <?php echo $file['image'][0];?>, <?php echo $file['image'][1]; ?>);return false;" title="<?php echo $entry; ?> - <?php echo Files::formatSize($file['stat']['size']); ?>" <?php if ($insertMode == 'image') { ?> onmouseover="showPreview('<?php echo $file['relative'];?>')" onmouseout="showPreview(window.parent.document.getElementById('f_url').value)" <?php } ?> >
+        			<?php
+        			if(strlen($entry)>$maxNameLength) echo substr($entry,0,$maxNameLength)."..."; else echo $entry;
+        			?>
+                  </a></td>
+                  <td><?php echo Files::formatSize($file['stat']['size']); ?></td>
+                  <td><?php if($file['image'][0] > 0){ echo $file['image'][0].'x'.$file['image'][1]; } ?></td>
+    			  <td ><?php echo date($IMConfig['date_format'],$file['stat']['mtime']); ?></td>
+                  <td class="actions">
+                    <?php if($IMConfig['img_library'] && $IMConfig['allow_edit_image'] && $file['image'][0] > 0) { ?>
+                    <a href="javascript:;" title="Edit" onclick="editImage('<?php echo rawurlencode($file['relative']);?>');"><img src="<?php print $IMConfig['base_url'];?>img/edit_pencil.gif" height="15" width="15" alt="Edit" border="0" /></a>
+                    <?php }  ?>  
+                    <a href="<?php print $backend_url_enc; ?>__function=images&amp;dir=<?php echo $relative; ?>&amp;delf=<?php echo rawurlencode($file['relative']);?>&amp;mode=<?php echo $insertMode;?>&amp;viewtype=<?php echo $afruViewType; ?>" title="Trash" onclick="return confirmDeleteFile('<?php echo $entry; ?>');"><img src="<?php print $IMConfig['base_url'];?>img/edit_trash.gif" height="15" width="15" alt="Trash" border="0" /></a>
+        			<?php if ($IMConfig['allow_rename']) { ?>
+                    <a href="#" title="Rename" onclick="renameFile('<?php echo rawurlencode($file['relative']);?>'); return false;"><img src="<?php print $IMConfig['base_url'];?>img/edit_rename.gif" height="15" width="15" alt="Rename" border="0" /></a>
+                    <?php }  ?>
+        			<?php if ($IMConfig['allow_cut_copy_paste']) { ?>
+                    <a href="#" title="Cut" onclick="copyFile('<?php echo rawurlencode($entry);?>','move'); return false;"><img src="<?php print $IMConfig['base_url'];?>img/edit_cut.gif" height="15" width="15" alt="Cut" /></a>
+                     <a href="#" title="Copy" onclick="copyFile('<?php echo rawurlencode($entry);?>','copy'); return false;"><img src="<?php print $IMConfig['base_url'];?>img/edit_copy.gif" height="15" width="15" alt="Copy" /></a>
+                    <?php }  ?>
+                  </td>
+                </tr>
+    		  <?php
+    		}//end of foreach of draw listview files
+            ?>
+            </tbody>
+            </table>
+            <?php
+        break;
+        case 'thumbview': // thumbview is default
+        default:
+    		$maxFileNameLength=16;
+    		$maxFolderNameLength=16;
+    		// start of foreach for draw thumbview folders.
+    		foreach($list[0] as $path => $dir)
+    		{ ?>
+    <div class="dir_holder">
+      <a class="dir" href="<?php print $backend_url_enc;?>__function=images&amp;mode=<?php echo $insertMode;?>&amp;dir=<?php echo rawurlencode($path); ?>&amp;viewtype=<?php echo $afruViewType; ?>" onclick="updateDir('<?php echo $path; ?>')" title="<?php echo $dir['entry']; ?>"><img src="<?php print $IMConfig['base_url'];?>img/folder.gif" height="80" width="80" alt="<?php echo $dir['entry']; ?>" /></a>
+
+      <div class="fileName">
+      <?php if(strlen($dir['entry']) > $maxFolderNameLength)
+                echo substr($dir['entry'], 0, $maxFolderNameLength) . "...";
+              else
+                echo $dir['entry']; ?>
+      </div>
+      <div class="edit">
+        <a href="<?php print $backend_url_enc;?>__function=images&amp;mode=<?php echo $insertMode;?>&amp;dir=<?php echo $relative; ?>&amp;deld=<?php echo rawurlencode($path); ?>&amp;viewtype=<?php echo $afruViewType; ?>" title="Trash" onclick="return confirmDeleteDir('<?php echo $dir['entry']; ?>', <?php echo $dir['count']; ?>);"><img src="<?php print $IMConfig['base_url'];?>img/edit_trash.gif" height="15" width="15" alt="Trash" /></a>
+    	<?php if ($IMConfig['allow_rename']) { ?>
+                    <a href="#" title="Rename" onclick="renameDir('<?php echo rawurlencode($dir['entry']);?>'); return false;"><img src="<?php print $IMConfig['base_url'];?>img/edit_rename.gif" height="15" width="15" alt="Rename" border="0" /></a>
+        <?php }  ?>
+        <?php if ($IMConfig['allow_cut_copy_paste']) { ?>
+                    <a href="#" title="Cut" onclick="copyDir('<?php echo rawurlencode($dir['entry']);?>','move'); return false;"><img src="<?php print $IMConfig['base_url'];?>img/edit_cut.gif" height="15" width="15" alt="Cut" /></a>
+                     <a href="#" title="Copy" onclick="copyDir('<?php echo rawurlencode($dir['entry']);?>','copy'); return false;"><img src="<?php print $IMConfig['base_url'];?>img/edit_copy.gif" height="15" width="15" alt="Copy" /></a>
+        <?php }  ?>
+      </div>
+    </div>
+    		  <?php
+    		} // end of foreach for draw thumbview folders.
+
+
+    		// start of foreach for draw thumbview files.
+    		foreach($list[1] as $entry => $file)
+    		{
+    			$afruimgdimensions=$manager->checkImageSize($file['relative']);
+    			$thisFileNameLength = $maxFileNameLength;
+    			?>
+                <div class="thumb_holder" id="holder_<?php echo asc2hex($entry) ?>">
+                  <a href="#" class="thumb" style="cursor: pointer;" ondblclick="this.onclick();window.top.onOK();" onclick="selectImage('<?php echo $file['relative'];?>', '<?php echo preg_replace('#\..{3,4}$#', '', $entry); ?>', <?php echo $file['image'][0];?>, <?php echo $file['image'][1]; ?>);return false;" title="<?php echo $entry; ?> - <?php echo Files::formatSize($file['stat']['size']); ?>">
+                    <img src="<?php print $manager->getThumbnail($file['relative']); ?>" alt="<?php echo $entry; ?> - <?php echo Files::formatSize($file['stat']['size']); ?>" />
+                  </a>
+                   <div class="fileName">
+                   <?php
+            			if(strlen($entry) > $thisFileNameLength + 3) echo strtolower(substr($entry,0,$thisFileNameLength))."..."; else echo $entry;
+            		?>
+                   </div>
+                  <div class="edit">
+                    <?php if($IMConfig['img_library'] && $IMConfig['allow_edit_image'] && $file['image'][0] > 0 )
+                    { ?>
+                    <a href="javascript:;" title="Edit" onclick="editImage('<?php echo rawurlencode($file['relative']);?>');"><img src="<?php print $IMConfig['base_url'];?>img/edit_pencil.gif" height="15" width="15" alt="Edit" /></a>
+            		<?php $thisFileNameLength -= 3; } ?>
+                    <a href="<?php print $backend_url_enc; ?>__function=images&amp;mode=<?php echo $insertMode;?>&amp;dir=<?php echo $relative; ?>&amp;delf=<?php echo rawurlencode($file['relative']);?>&amp;viewtype=<?php echo $afruViewType; ?>" title="Trash" onclick="return confirmDeleteFile('<?php echo $entry; ?>');"><img src="<?php print $IMConfig['base_url'];?>img/edit_trash.gif" height="15" width="15" alt="Trash" /></a>
+        			<?php if ($IMConfig['allow_rename']) { ?>
+                    <a href="#" title="Rename" onclick="renameFile('<?php echo rawurlencode($file['relative']);?>'); return false;"><img src="<?php print $IMConfig['base_url'];?>img/edit_rename.gif" height="15" width="15" alt="Rename" /></a>
+                    <?php $thisFileNameLength -= 3; }  ?>
+                	<?php if ($IMConfig['allow_cut_copy_paste']) { ?>
+                    <a href="#" title="Cut" onclick="copyFile('<?php echo rawurlencode($entry);?>','move'); return false;"><img src="<?php print $IMConfig['base_url'];?>img/edit_cut.gif" height="15" width="15" alt="Cut" /></a>
+                     <a href="#" title="Copy" onclick="copyFile('<?php echo rawurlencode($entry);?>','copy'); return false;"><img src="<?php print $IMConfig['base_url'];?>img/edit_copy.gif" height="15" width="15" alt="Copy" /></a>
+                    <?php $thisFileNameLength -= 6; }  ?>
+            		
+                  </div>
+                </div>
+    		  <?php
+    		}//end of foreach of draw thumbview files
+
+    }
+}//end of function drawDirs_Files
+
+
+/**
+ * No directories and no files.
+ */
+function drawNoResults() 
+{
+?>
+<div class="noResult">No Files Found</div>
+<?php
+}
+
+/**
+ * No directories and no files.
+ */
+function drawErrorBase(&$manager) 
+{
+?>
+<div class="error"><span>Invalid base directory:</span> <?php echo $manager->getImagesDir(); ?></div>
+<?php
+}
+
+/**
+ * Utility to convert ascii string to hex
+ */
+function asc2hex ($temp)
+{
+  $data = '';
+  $len = strlen($temp);
+  for ($i=0; $i<$len; $i++) $data.=sprintf("%02x",ord(substr($temp,$i,1)));
+  return $data;
+}
+
+?>
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
+    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+	<title>File List</title>
+  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
+	<link href="<?php print $IMConfig['base_url'];?>assets/imagelist.css" rel="stylesheet" type="text/css" />
+<script type="text/javascript" src="<?php print $IMConfig['base_url'];?>assets/dialog.js"></script>
+<script type="text/javascript">
+/*<![CDATA[*/
+
+    var _backend_url = "<?php print $IMConfig['backend_url']; ?>";
+
+	if(window.top)
+		Xinha = window.top.Xinha;
+
+	function hideMessage()
+	{
+		var topDoc = window.top.document;
+		var messages = topDoc.getElementById('messages');
+		if (messages)
+		{
+			messages.style.display = "none";
+		}
+		//window.parent.resize();
+	}
+
+	init = function()
+	{
+        __dlg_translate('ExtendedFileManager');
+        
+		hideMessage();
+		<?php if ($afruViewType == 'listview')
+			print "var d = new dragTableCols('listview');";
+		
+		if(isset($uploadStatus) && !is_numeric($uploadStatus) && !is_bool($uploadStatus))
+		echo "alert(i18n('$uploadStatus'));";
+		else if(isset($uploadStatus) && $uploadStatus==false)
+		echo 'alert(i18n("Unable to upload File. \nEither Maximum file size [$max_size='.($insertMode == 'image' ? $IMConfig['max_filesize_kb_image'] : $IMConfig['max_filesize_kb_link'] ).'$ KB] exceeded or\nFolder doesn\'t have write permission."));';
+		?>
+
+		<?php
+		if(isset($renameStatus) && !is_numeric($renameStatus) && !is_bool($renameStatus))
+		echo 'alert(i18n("'.$renameStatus.'"));';
+		else if(isset($renameStatus) && $renameStatus===false)
+		echo 'alert(i18n("Unable to rename file. File of the same name already exists or\nfolder doesn\'t have write permission."));';
+		?>
+		
+		<?php
+		if (isset($pasteStatus) && is_numeric($pasteStatus))
+		{
+			switch ($pasteStatus)
+			{
+				case 100 :
+					$pasteStatus = 'Source file/folder not found.';
+				break;
+				case 101 :
+					$pasteStatus = 'Copy failed.\nMaybe folder doesn\'t have write permission.';
+				break;
+				case 102 :
+					$pasteStatus = 'Could not create destination folder.';
+				break;
+				case 103 :
+					$pasteStatus = 'File pasted OK.';
+				break;
+				case 104 :
+					$pasteStatus = 'Destination file/folder already exists.';
+				break;
+			}
+		}
+		if(isset($pasteStatus) && !is_bool($pasteStatus))
+		{
+			echo 'alert(i18n("'.$pasteStatus.'"));';
+		}
+		?>
+
+		var topDoc = window.top.document;
+
+<?php
+	//we need to refesh the drop directory list
+	//save the current dir, delete all select options
+	//add the new list, re-select the saved dir.
+	if($refreshDir) 
+	{ 
+		$dirs = $manager->getDirs();
+?>
+		var selection = topDoc.getElementById('dirPath');
+		var currentDir = selection.options[selection.selectedIndex].text;
+
+		while(selection.length > 0)
+		{	selection.remove(0); }
+		
+		selection.options[selection.length] = new Option("/","<?php echo rawurlencode('/'); ?>");
+		<?php foreach($dirs as $relative=>$fullpath) { ?>
+		selection.options[selection.length] = new Option("<?php echo $relative; ?>","<?php echo rawurlencode($relative); ?>");
+		<?php } ?>
+		
+		for(var i = 0; i < selection.length; i++)
+		{
+			var thisDir = selection.options[i].text;
+			if(thisDir == currentDir)
+			{
+				selection.selectedIndex = i;
+				break;
+			}
+		}		
+<?php } ?>
+	}
+    
+	function editImage(image) 
+	{
+		var url = "<?php print $IMConfig['backend_url']; ?>__function=editor&img="+image+"&mode=<?php print $insertMode ?>";
+        Dialog(url, function(param)
+		{
+			if (!param) { // user must have pressed Cancel
+				return false;
+			} else
+			{
+				return true;
+			}
+		}, null);
+	}
+
+/*]]>*/
+</script>
+<script type="text/javascript" src="<?php print $IMConfig['base_url'];?>assets/images.js"></script>
+<script type="text/javascript" src="<?php print $IMConfig['base_url'];?>assets/popup.js"></script>
+<script type="text/javascript">
+<!--
+// Koto: why emptying? commented out
+//if(window.top.document.getElementById('manager_mode').value=="image")
+//emptyProperties();
+<?php if(isset($diskInfo)) echo 'updateDiskMesg(i18n(\''.$diskInfo.'\'));'; ?>
+//-->
+</script>
+<script type="text/javascript" src="<?php print $IMConfig['base_url'];?>assets/dragTableCols.js"></script>
+</head>
+
+<body>
+<?php if ($manager->isValidBase() == false) { drawErrorBase($manager); }
+	elseif(count($list[0]) > 0 || count($list[1]) > 0) { ?>
+	<?php drawDirs_Files($list, $manager); ?>
+<?php } else { drawNoResults(); } ?>
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/1x1_transparent.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/1x1_transparent.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/2x2.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/2x2.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/2x2_w.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/2x2_w.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/btnFolderNew.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/btnFolderNew.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/btnFolderNew1.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/btnFolderNew1.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/btnFolderUp.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/btnFolderUp.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/btnFolderUp1.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/btnFolderUp1.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/btn_cancel.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/btn_cancel.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/btn_ok.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/btn_ok.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/crop.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/crop.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/default.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/default.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/div.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/div.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/dots.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/dots.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/ed_linkfile.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/ed_linkfile.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/ed_linkfile1.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/ed_linkfile1.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/edit_active.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/edit_active.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/edit_copy.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/edit_copy.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/edit_cut.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/edit_cut.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/edit_paste.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/edit_paste.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/edit_pencil.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/edit_pencil.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/edit_rename.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/edit_rename.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/edit_trash.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/edit_trash.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/folder.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/folder.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/hand.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/hand.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/islocked2.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/islocked2.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/locked.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/locked.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/measure.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/measure.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/noimages.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/noimages.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/rotate.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/rotate.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/save.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/save.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/scale.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/scale.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/spacer.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/spacer.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/t_black.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/t_black.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/t_white.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/t_white.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/unlocked.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/unlocked.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/unlocked2.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/unlocked2.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/img/unlocked_empty.gif
Binary file Xinha_0.95/plugins/ExtendedFileManager/img/unlocked_empty.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/lang/de.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/lang/de.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,119 @@
+// I18N constants
+// LANG: "de", ENCODING: UTF-8
+// translated: sven schomacker, http://www.hilope.de, mail@hilope.de
+{
+  "File Manager": "Dateimanager",
+  "Insert Image": "Bild einfgen",
+  "Directory": "Verzeichnis",
+  "Directory Up": "Aufwrts",
+  "New Folder": "Neues Verzeichnis erstellen",
+  "Trash": "Papierkorb",
+  "Edit": "Bearbeiten",
+  "Image File": "Bilddatei",
+  "Upload": "Hochladen",
+  "Width": "Breite",
+  "Height": "Hhe",
+  "Width:": "Breite:",
+  "Height:": "Hhe:",
+  "Constrain Proportions": "Proportionen beibehalten",
+  "Border": "Rahmen",
+  "Margin": "Aussenabstand",
+  "Padding": "Innenabstand",
+  "Refresh": "Aktualisieren",
+  "Uploading...": "Lade hoch...",
+  "Uploading": "Hochladen",
+  "Crop": "Beschneiden",
+  "Resize": "Gre ndern",
+  "Rotate": "Drehen",
+  "Measure": "Mae",
+  "Marker": "Rahmen",
+  "Toggle marker color" : "Farbe der Markierung umschalten",
+  "Save": "Speichern",
+  "Filename:": "Dateiname:",
+  "Image Format": "Bildformat:",
+  "Quality:": "Qualitt",
+  "JPEG High": "JPEG hoch",
+  "JPEG Medium": "JPEG mittel",
+  "JPEG Low": "JPEG niedrig",
+  "File saved.": "Datei gespeichert.",
+  "File was not saved.": "Datei wurde nicht gespeichert.",
+  "Start X:": "Start X",
+  "Start Y:": "Start Y",
+  "Lock": "Feststellen",
+  "Flip Image": "Bild spiegeln",
+  "Flip Horizontal": "hor. spiegeln",
+  "Flip Vertical": "ver. spiegeln",
+  "Rotate Image": "Bild drehen",
+  "Rotate 180 ": "Drehung um 180",
+  "Rotate 90  CW": "Drehung um 90 im Uhrzeigersinn",
+  "Rotate 90  CCW": "Drehung um 90 gegen Uhrzeigersinn",
+  "Angle:": "Winkel:",
+  "W:": "W:",
+  "Clear": "Lschen",
+  "Loading": "Laden",
+  "Invalid base directory:": "Ungltiges Basisverzeichnis:",
+  'Delete file "$file"?': 'Datei "$file" lschen?',
+  "Please delete all files/folders inside the folder you wish to delete first.": "Bitte zuerst alle untergeordneten Ordner lschen.",
+  'Delete folder "$dir"?': 'Verzeichnis "$dir" lschen?',
+  "Folder Name:": "Verzeichnisname",
+  "No Files Found": "Keine Dateien gefunden",
+  "Invalid folder name, please choose another folder name.": "Ungltiger Verzeichnisname - bitte neu whlen.",
+  "GIF format is not supported, image editing not supported.": "GIF-Format nicht untersttzt, bearbeiten nicht mglich.",
+  "No Image Available": "Kein Bild verfgbar",
+  "No Image selected.": "Kein Bild ausgewhlt.",
+  "Description:": "Beschreibung:",
+  "Align": "Anordnung",
+  "Margin": "Aussenabstand",
+  "Padding": "Innenabstand",
+  "Border": "Rahmen",
+  "Color": "Farbe",
+  "Border Color": "Rahmenfarbe",
+  "Upload": "Hochladen",
+  "Alt": "Alt",
+  "File Name": "Dateiname",
+  "Thumbnail View": "Miniaturansicht",
+  "List View": "Listenansicht",
+  "Title (tooltip)": "Titel (Tooltip)",
+  "Target Window": "Zielfenster",
+  "Name": "Name",
+  "Size": "Gre",
+  "Date Modified": "Datum letzte nderung",
+  "Total Size": "Gesamtgre",
+  "Free Space": "Freier Speicher",
+  "Positioning of this image" : "Anordnung dieses Bildes",
+  "Insert File Link": "Dateilink einfgen",
+  "Untitled": "Unbetitelt",
+  'Please enter name for new folder...': "Bitte Namen fr neuen Ordner eingeben...",
+  "You must select some text before making a new link.": "Bitte zuerst Text markieren.",
+  "Folder is not empty. Please delete all Files and Subfolders inside.": "Verzeichnis ist nicht leer. Bitte zuerst alle Unterordner und Dateien lschen.",
+  "Image Size": "Bildgre",
+  "Other" : "Andere...",
+  "Rename": "Umbenennen",
+  "Please enter new name for this file...": "Bitte neuen Namen fr diese Datei eingeben...",
+  "Unable to rename file. File of the same name already exists or\nfolder doesn't have write permission.": "Umbenennen nicht mglich. Evtl. Dateiname schon vorhanden oder keine Schreibrechte.",
+  "Cancelled rename.": "Umbenennen abgebrochen.",
+  'File "$file" successfully uploaded.': 'Datei "$file" erfolgreich hochgeladen.',
+  "Cannot upload. Maximum folder size reached. Delete unwanted files and try again.":"Die maximale Ordnergre ist erreicht. Bitte lschen Sie Dateien, die Sie nicht mehr bentigen.",
+  "Maximum file size [$max_size KB] exceeded.":"Maximale Dateigre [$max_size KB] berschritten.",
+  "Cannot upload $extension Files. Permission denied.": "$extension Dateien drfen nicht hochgeladen werden.",
+  "Unable to upload File. \nEither Maximum file size [$max_size KB] exceeded or\nFolder doesn\'t have write permission.":"Konnte Datei nicht hochladen.\nEntweder die maximale Dateigre [$max_size KB] ist berschritten\noder das Verzeichnis hat keine Schreibrechte.",
+  "Total Size : $max_foldersize_mb MB, Free Space: $free_space": "Max. Ordergre: $max_foldersize_mb MB, noch frei: $free_space",
+  "Please enter new name for this folder...":"Bitte neuen Namen fr diesen Ordner eingeben...",
+
+  "Cut":"Ausschneiden",
+  "Copy":"Kopieren",
+  "Paste":"Einfgen",
+  
+  'Copy "$file" from "$dir" here': '"$file" aus Ordner "$dir" hierher kopieren',
+  'Copy folder "$file" from "$dir" here' : '"Ordner $file" aus "$dir" hierher kopieren',
+  'Move "$file" from "$dir" here':'"$file" aus Ordner "$dir" hierher verschieben',
+  'Move folder "$file" from "$dir" here':'Ordner "$file" aus "$dir" hierher verschieben',
+  
+  "Source file/folder not found.":"Quelldatei/-ordner nicht gefunden",
+  "Paste failed.\nMaybe folder doesn't have write permission.": "Einfgen fehlgeschlagen.\nMglicherweise hat der Ordner keine Schreibberechtigung.",
+  "Could not create destination folder.":"Konnte Zielordner nicht erstellen.",
+  "Destination file/folder already exists.":"Zieldatei/-ordner existiert bereits",
+  "File pasted OK.": "File pasted OK.",
+  
+  "Filesize:" : "Dateigre:"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/lang/es.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/lang/es.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,70 @@
+// I18N constants
+// LANG: "es", ENCODING: UTF-8
+// translated: michael Hauptmnn (mhauptma73) , http://www.azahost.com/, miguel@azalorea.com
+{
+  "Image Manager": "Editor de imgenes",
+  "Insert Image": "insertar imagen",
+  "Directory": "Directorio",
+  "Directory Up": "Directorio superior",
+  "New Folder": "Crear directorio",
+  "Trash": "Basura",
+  "Edit": "editar",
+  "Image File": "Fichero",
+  "Upload": "Subir",
+  "Width": "Ancho",
+  "Height": "Alto",
+  "Width:": "Ancho:",
+  "Height:": "Alto:",
+  "Constrain Proportions": "Proporcional",
+  "Border": "Borde",
+  "V Space": "espacio vertical",
+  "H Space": "espacio horizontal",
+  "Refresh": "Actualizar",
+  "Uploading...": "Subir...",
+  "Crop": "Recortar",
+  "Resize": "Cambiar tamao",
+  "Rotate": "Girar",
+  "Measure": "Dimensiones",
+  "Marker": "Marcador",
+  "Save": "Guardar",
+  "Filename:": "Nombre del fichero:",
+  "Image Format": "Formato:",
+  "Quality:": "Calidad",
+  "JPEG High": "JPEG alto",
+  "JPEG Medium": "JPEG medio",
+  "JPEG Low": "JPEG bajo",
+  "File saved.": "Fichero guardado.",
+  "File was not saved.": "el fichero no ha sido guardado.",
+  "Start X:": "Inicio X",
+  "Start Y:": "Inicio Y",
+  "Lock": "Bloquear",
+  "Flip Image": "invertir imagen",
+  "Flip Horizontal": "invertir horizontalmente",
+  "Flip Vertical": "invertir verticalmente",
+  "Rotate Image": "Girar imagen",
+  "Rotate 180 ": "Girar 180",
+  "Rotate 90  CW": "Girar 90 sentido reloj",
+  "Rotate 90  CCW": "Girar 90 sentido contrareloj",
+  "Angle:": "ngulo:",
+  "W:": "B:",
+  "Clear": "Eliminar",
+  "Loading": "Cargar",
+  "Invalid base directory:": "Directorio de inicio invlido:",
+  "Delete file?": "Borrar fichero?",
+  "Please delete all files/folders inside the folder you wish to delete first.": "Primero tiene que borrar todoas los ficheros de este directorio.",
+  "Delete folder?": "Borrar directorio?",
+  "Folder Name:": "Nombre del directorio:",
+  "No Images Found": "No se ha encontrado imagen",
+  "Invalid folder name, please choose another folder name.": "Nombre de directorio invlido... por favor elija otro nombre.",
+  "GIF format is not supported, image editing not supported.": "No hay soporte para imgenes en formato GIF.",
+  "No Image Available": "No hay imagen",
+  "No Image selected.": "No ha seleccionado imagen.",
+  "Description:": "Descripcin:",
+  "Align:": "Alineado:",
+  "Description:": "Descripcin:",
+  "Margin:": "Margen exterior:",
+  "Padding:": "Margen interior:",
+  "Border:": "Borde:",
+  "Color:": "Color:",
+  "Upload:": "Subir:"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/lang/fr.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/lang/fr.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,117 @@
+// LANG: "fr", ENCODING: UTF-8
+// translated: Kevin Huppert - Crabilis, http://www.creabilis.com, kevin.huppert@worldonline.fr
+{ 
+  "File Manager": "Gestionnaire de fichiers",
+  "Insert Image": "Insrer une image",
+  "Directory": "Rpertoire",
+  "Directory Up": "Remonter",
+  "New Folder": "Nouveau dossier",
+  "Trash": "Corbeille",
+  "Edit": "Modifier",
+  "Image File": "Fichier image",
+  "Upload": "Envoyer",
+  "Width": "Largeur",
+  "Height": "Hauteur",
+  "Width:": "Largeur:",
+  "Height:": "Hauteur:",
+  "Constrain Proportions": "Maintenir les proportions",
+  "Border": "Bordure",
+  "Margin": "Marge",
+  "Padding": "Marge intrieure",
+  "Refresh": "Actualiser",
+  "Uploading...": "Envoi en cours...",
+  "Uploading": "Envoi",
+  "Crop": "Recadrer",
+  "Resize": "Redimen.",
+  "Rotate": "Pivoter",
+  "Measure": "Rgle",
+  "Marker": "Marqueur",
+  "Toggle marker color" : "Changer la couleur du marqueur",
+  "Save": "Enregistrer",
+  "Filename:": "Nom du fichier:",
+  "Image Format": "Format d\'image:",
+  "Quality:": "Qualit:",
+  "JPEG High": "JPEG haut",
+  "JPEG Medium": "JPEG moyen",
+  "JPEG Low": "JPEG bas",
+  "File saved.": "Fichier enregistr.",
+  "File was not saved.": "Le fichier n\'a pas t enregistr.",
+  "Start X:": "Dpart X",
+  "Start Y:": "Dpart Y",
+  "Lock": "Verrouiller",
+  "Flip Image": "Symtrie",
+  "Flip Horizontal": "Symtrie hor.",
+  "Flip Vertical": "Symtrie ver.",
+  "Rotate Image": "Pivoter l\'image",
+  "Rotate 180 ": "Rotation  180",
+  "Rotate 90  CW": "Rotation  90 horaire",
+  "Rotate 90  CCW": "Rotation  90 antihoraire",
+  "Angle:": "Angle:",
+  "W:": "W:",
+  "Clear": "Effacer",
+  "Loading": "Chargement",
+  "Invalid base directory:": "Dossier racine invalide:",
+  'Delete file "$file"?': 'Effacer le fichier "$file" ?',
+  "Please delete all files/folders inside the folder you wish to delete first.": "Effacez s\'il vous plat tous les fichiers/dossiers dans le dossier que vous souhaitez effacer d\'abord.",
+  'Delete folder "$dir"?': 'Effacer le dossier "$dir" ?',
+  "Folder Name:": "Nom du dossier:",
+  "No Files Found": "Aucun fichier",
+  "Invalid folder name, please choose another folder name.": "Nom de dossier invalide - choisissez un autre nomd de dossier.",
+  "GIF format is not supported, image editing not supported.": "Le format GIF n\'est pas support, dition d\'image impossible.",
+  "No Image Available": "Aucune image disponible",
+  "No Image selected.": "Aucune image slectionne.",
+  "Description:": "Description:",
+  "Align": "Alignement",
+  "Margin": "Marge",
+  "Padding": "Marge intrieure",
+  "Border": "Bordure",
+  "Color": "Couleur",
+  "Border Color": "Couleur de la bordure",
+  "Upload": "Envoyer",
+  "Alt": "Alt",
+  "File Name": "Nom du fichier",
+  "Thumbnail View": "Vue miniatures",
+  "List View": "Vue liste",
+  "Title (tooltip)": "Tooltip",
+  "Target Window": "Fentre cible",
+  "Name": "Nom",
+  "Size": "Taille",
+  "Date Modified": "Date de modification",
+  "Total Size": "Taille totale",
+  "Free Space": "Espace libre",
+  "Positioning of this image" : "Position de cette image",
+  "Insert File Link": "Insrer un lien vers fichier",
+  "Untitled": "Sans titre",
+  'Please enter name for new folder...': "Entrez un nom pour le nouveau dossier...",
+  "You must select some text before making a new link.": "Vous devez slectionner du texte avant de faire un nouveau lien.",
+  "Folder is not empty. Please delete all Files and Subfolders inside.": "Le dossier n\'est pas vide. Effacez tous les fichiers et sous-dossiers qu\'il contient.",
+  "Image Size": "Dimensions de l\'image",
+  "Other" : "Autre...",
+  "Rename": "Renommer",
+  "Please enter new name for this file...": "Entrez un nouveau nom pour ce fichier...",
+  "Unable to rename file. File of the same name already exists or\nfolder doesn't have write permission.": "Impossible de renommer le fichier. \n Un fichier de mme nom existe dj ou l\'criture est impossible.",
+  "Cancelled rename.": "Renommage annul.",
+  'File "$file" successfully uploaded.': 'Fichier "$file" envoy.',
+  "Cannot upload. Maximum folder size reached. Delete unwanted files and try again.":"La taille maximale pour le dossier est atteinte. Vous devez effacer des fichiers pour librer de la place",
+  "Maximum file size [$max_size KB] exceeded.":"Taille de fichier [$max_size Ko] dpasse.",
+  "Cannot upload $extension Files. Permission denied.": "Impossible d\'envoyer des fichiers $extension.",
+  "Unable to upload File. \nEither Maximum file size [$max_size KB] exceeded or\nFolder doesn\'t have write permission.":"Impossible d'envoyer le fichier.\nSoit la taille maximale [$max_size Ko] est dpasse\nsoit le dossier ne possde pas les droits d\'criture.",
+  "Total Size : $max_foldersize_mb MB, Free Space: $free_space": "Taille maximale: $max_foldersize_mb Mo, libre: $free_space",
+  "Please enter new name for this folder...":"Entrez un nouveau nom pour ce dossier...",
+
+  "Cut":"Couper",
+  "Copy":"Copier",
+  "Paste":"Coller",
+  
+  'Copy "$file" from "$dir" here': 'Copier "$file" du dossier "$dir" ici',
+  'Copy folder "$file" from "$dir" here' : 'Copier le dossier "$file" de "$dir" ici',
+  'Move "$file" from "$dir" here':'Dplacer "$file" du dossier "$dir" ici',
+  'Move folder "$file" from "$dir" here':'Dplacer le dossier "$file" de "$dir" ici',
+  
+  "Source file/folder not found.":"Dossier ou fichier source introuvable.",
+  "Paste failed.\nMaybe folder doesn't have write permission.": "Echec lors du coller.\nLe dossier n\' peut tre pas les droits d\'criture.",
+  "Could not create destination folder.":"Impossible de crer le dossier de destination.",
+  "Destination file/folder already exists.":"Fichier/dossier dj existant.",
+  "File pasted OK.": "Fichier correctement coll.",
+  "Filesize:" : "Taille du fichier:"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/lang/ja.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/lang/ja.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,118 @@
+// I18N constants
+// LANG: "ja", ENCODING: UTF-8
+{
+  "File Manager": "",
+  "Insert Image": "",
+  "Directory": "",
+  "Directory Up": "",
+  "New Folder": "",
+  "Trash": "",
+  "Edit": "",
+  "Image File": "",
+  "Upload": "",
+  "Width": "",
+  "Height": "",
+  "Width:": ":",
+  "Height:": ":",
+  "Constrain Proportions": "",
+  "Border": "",
+  "Margin": "",
+  "Padding": "",
+  "Refresh": "",
+  "Uploading...": "...",
+  "Uploading": "",
+  "Crop": "",
+  "Resize": "",
+  "Rotate": "",
+  "Measure": "",
+  "Marker": "",
+  "Save": "",
+  "Filename:": ":",
+  "Image Format": "",
+  "Quality:": ":",
+  "JPEG High": "JPEG ",
+  "JPEG Medium": "JPEG ",
+  "JPEG Low": "JPEG ",
+  "File saved.": "",
+  "File was not saved.": "",
+  "Start X:": " X",
+  "Start Y:": " Y",
+  "Lock": "",
+  "Flip Image": "",
+  "Flip Horizontal": "",
+  "Flip Vertical": "",
+  "Rotate Image": "",
+  "Rotate 180 ": "180",
+  "Rotate 90  CW": "90 ",
+  "Rotate 90  CCW": "90 ",
+  "Angle:": ":",
+  "W:": "W:",
+  "Clear": "",
+  "Loading": "",
+  "Invalid base directory:": ":",
+  'Delete file "$file"?': ' "$file" ?',
+  "Please delete all files/folders inside the folder you wish to delete first.": "",
+  'Delete folder "$dir"?': ' "$dir" ?',
+  "Folder Name:": ":",
+  "No Files Found": "",
+  "Invalid folder name, please choose another folder name.": "",
+  "GIF format is not supported, image editing not supported.": "GIF",
+  "No Image Available": "",
+  "No Image selected.": "",
+  "Description:": ":",
+  "Align": "",
+  "Description:": ":",
+  "Margin:": ":",
+  "Padding:": ":",
+  "Border:": ":",
+  "Color:": ":",
+  "Border Color:": ":",
+  "Upload:": ":",
+  "Alt": "Alt",
+  "Alt": "Alt",
+  "File Name": "",
+  "Thumbnail View": "",
+  "List View": "",
+  "Title (tooltip)": "",
+  "Target Window": "",
+  "Name": "",
+  "Size": "",
+  "Date Modified": "",
+  "Total Size": "",
+  "Free Space": "",
+  "Positioning of this image" : "",
+  "Insert File Link": "",
+  "Untitled": "",
+  'Please enter name for new folder...': "...",
+  "You must select some text before making a new link.": "",
+  "Folder is not empty. Please delete all Files and Subfolders inside.": "",
+  "Image Size": "",
+  "Other" : "",
+  "Rename": "",
+  "Please enter new name for this file...": "...",
+  "Unable to rename file. File of the same name already exists or\nfolder doesn't have write permission.": 
+  "\n",
+  "Cancelled rename.": "",
+  'File "$file" successfully uploaded.': ' "$file" ',
+  "Cannot upload. Maximum folder size reached. Delete unwanted files and try again.":"",
+  "Maximum file size [$max_size KB] exceeded.":" [$max_size KB] ",
+  "Cannot upload $extension Files. Permission denied.": "$extension ",
+  "Unable to upload File. \nEither Maximum file size [$max_size KB] exceeded or\nFolder doesn\'t have write permission.":"\n [$max_size KB] \n",
+  "Total Size : $max_foldersize_mb MB, Free Space: $free_space": ": $max_foldersize_mb MB, : $free_space",
+  "Please enter new name for this folder...":"...",
+
+  "Cut":"",
+  "Copy":"",
+  "Paste":"",
+  
+  'Copy "$file" from "$dir" here': '"$file"  "$dir" ',
+  'Copy folder "$file" from "$dir" here' : ' "$file"  "$dir" ',
+  'Move "$file" from "$dir" here':'"$file"  "$dir" ',
+  'Move folder "$file" from "$dir" here':' "$file"  "$dir" ',
+  
+  "Source file/folder not found.":"/",
+  "Paste failed.\nMaybe folder doesn't have write permission.": "\n",
+  "Could not create destination folder.":"",
+  "Destination file/folder already exists.":"/",
+  "File pasted OK.": ""
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/lang/nb.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/lang/nb.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,110 @@
+// I18N constants
+// LANG: "nb", ENCODING: UTF-8
+// translated: Kim Steinhaug, http://www.easycms.no/, kim@easycms.no
+{
+  "File Manager": "Filbehandler",
+  "Insert Image": "Sett inn bilde",
+  "Directory": "Mappe",
+  "Directory Up": "Opp et niv",
+  "New Folder": "Ny mappe",
+  "Trash": "Sppel",
+  "Edit": "Rediger",
+  "Image File": "Bildefil",
+  "Upload": "Last opp",
+  "Upload:": "Last opp:",
+  "Width": "Bredde",
+  "Height": "Hyde",
+  "Constrain Proportions": "Beholde proposjoner",
+  "Border": "Ramme",
+  "Margin": "Marg",
+  "Padding": "Innvendig marg",
+  "Refresh": "Oppfrisk side",
+  "Uploading...": "Laster opp...",
+  "Uploading": "Laster opp",
+  "Crop": "Beskjr",
+  "Resize": "Endre strrelse",
+  "Rotate": "Roter",
+  "Measure": "Ml",
+  "Marker": "Markr",
+  "Save": "Lagre",
+  "Filename:": "Filnavn:",
+  "Image Format": "Bildeformat:",
+  "Quality:": "Kvalitet",
+  "JPEG High": "JPEG hy",
+  "JPEG Medium": "JPEG middels",
+  "JPEG Low": "JPEG lav",
+  "File saved.": "Fil er lagret.",
+  "File was not saved.": "Filen ble ikke lagret.",
+  "Start X:": "Start X",
+  "Start Y:": "Start Y",
+  "Lock": "Ls",
+  "Flip Image": "Vend bilde",
+  "Flip Horizontal": "Vend horisontal",
+  "Flip Vertical": "Vend vertikal",
+  "Rotate Image": "Roter bilde",
+  "Rotate 180 ": "Roter 180",
+  "Rotate 90  CW": "Roter 90 med klokka",
+  "Rotate 90  CCW": "Roter 90 mot klokka",
+  "Angle:": "Vinkel:",
+  "W:": "L:",
+  "Clear": "Tm",
+  "Loading": "Laster",
+  "Invalid base directory:": "Ugyldig sti til mappe:",
+  'Delete file "$file"?': "$file\n\nSlette fil?",
+  "Please delete all files/folders inside the folder you wish to delete first.": "Vennligst slett alle filer og mapper i mappen du nsker  slette frst!",
+  'Delete folder "$dir"?': "$dir\n\nSlette mappe?",
+  "Folder Name:": "Mappe navn",
+  "No Files Found": "Ingen filer funnet",
+  "Invalid folder name, please choose another folder name.": "Ugyldig mappenavn, vennligst velg et annet mappenavn",
+  "GIF format is not supported, image editing not supported.": "GIF format er ikke stttet og bilderedigering er derfor ikke tilgjengelig.",
+  "No Image Available": "Inget bilde tilgjengelig.",
+  "No Image selected.": "Inget bilde valgt.",
+  "Description:": "Beskrivelse:",
+  "Align": "Juster",
+  "Color:": "Farge:",
+  "Border Color:": "Ramme farge:",
+  "Alt": "Alt",
+  "File Name": "Filnavn",
+  "Thumbnail View": "Miniatyrbilde",
+  "List View": "Liste",
+  "Title (tooltip)": "Tittel (tooltip)",
+  "Target Window": "Ml",
+  "Name": "Navn",
+  "Size": "Strrelse",
+  "Date Modified": "Siste endret",
+  "Total Size": "Total strrelse",
+  "Free Space": "Ledig plass",
+  "Positioning of this image" : "Bildepossisjon",
+  "Insert File Link": "Sett inn lenke til fil",
+  "Untitled": "Uten navn",
+  'Please enter name for new folder...': "Skriv inn navn for ny mappe...",
+  "You must select some text before making a new link.": "Du m velge noe tekst fr du kan lage en ny lenke.",
+  "Folder is not empty. Please delete all Files and Subfolders inside.": "Mappen er ikke tom. Du m slette alle filer og mapper i mappen frst.",
+  "Image Size": "Bilde strrelse",
+  "Other" : "Andre...",
+  "Rename": "Nytt navn",
+  "Please enter new name for this file...": "Vennligst skriv inn nytt navn for denne fil...",
+  "Unable to rename file. File of the same name already exists or\nfolder doesn't have write permission.": "Kan ikke omdpe fil. En fil har allerede samme navn eller\nmappen har ikke skriverettigheter.",
+  "Cancelled rename.": "Omdping av filnavn avbrutt.",
+   'File "$file" successfully uploaded.':  'File "$file" successfully uploaded.',
+  "Cannot upload. Maximum folder size reached. Delete unwanted files and try again.":"Cannot upload. Maximum folder size reached. Delete unwanted files and try again.",
+  "Maximum file size [$max_size KB] exceeded.":"Maximum file size [$max_size KB] exceeded.",
+  "Cannot upload $extension Files. Permission denied.": "Cannot upload $extension Files. Permission denied.",
+  "Unable to upload File. \nEither Maximum file size [$max_size KB] exceeded or\nFolder doesn\'t have write permission.":"Unable to upload File. \nEither Maximum file size [$max_size KB] exceeded or\nFolder doesn\'t have write permission.",
+  "Total Size : $max_foldersize_mb MB, Free Space: $free_space": "Total Size : $max_foldersize_mb MB, Free Space: $free_space",
+  "Please enter new name for this folder...":"Please enter new name for this folder...",
+
+  "Cut":"Cut",
+  "Copy":"Copy",
+  "Paste":"Paste",
+  
+  'Copy "$file" from "$dir" here': 'Copy "$file" from "$dir" here',
+  'Copy folder "$file" from "$dir" here' : 'Copy folder "$file" from "$dir" here',
+  'Move "$file" from "$dir" here':'Move "$file" from "$dir" here',
+  'Move folder "$file" from "$dir" here':'Move folder "$file" from "$dir" here',
+  
+  "Source file/folder not found.":"Source file/folder not found.",
+  "Paste failed.\nMaybe folder doesn't have write permission.": "Paste failed.\nMaybe folder doesn't have write permission.",
+  "Could not create destination folder.":"Could not create destination folder.",
+  "Destination file/folder already exists.":"Destination file/folder already exists.",
+  "File pasted OK.": "File pasted OK."
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/lang/nl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/lang/nl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,116 @@
+// I18N constants
+// LANG: "nl", ENCODING: UTF-8
+// Author: Maarten Molenschot, maarten@nrgmm.nl
+{
+  "File Manager": "Bestandsbeheer",
+  "Insert Image": "Beeld invoegen",
+  "Directory": "Map",
+  "Directory Up": "Bovenliggende map",
+  "New Folder": "Nieuw map",
+  "Trash": "Prullenbak",
+  "Edit": "Bewerken",
+  "Image File": "Beeldbestand",
+  "Upload": "Upload",
+  "Upload:": "Upload:",
+  "Width": "Breed",
+  "Height": "Hoog",
+  "Constrain Proportions": "Proportie behouden",
+  "Border": "Kader",
+  "Margin": "Inspringen",
+  "Padding": "Uitvullen",
+  "Refresh": "Vernieuwen",
+  "Uploading...": "Uploaden...",
+  "Uploading": "Uploaden",
+  "Crop": "Uitsneden",
+  "Resize": "Formaat wijzigen",
+  "Rotate": "Draaien",
+  "Measure": "Opmeten",
+  "Marker": "Markeren",
+  "Save": "Opslaan",
+  "Filename:": "Bestandsnaam:",
+  "Image Format": "Beeldformaat:",
+  "Quality:": "Kwaliteit",
+  "JPEG High": "JPEG hoog",
+  "JPEG Medium": "JPEG midden",
+  "JPEG Low": "JPEG laag",
+  "File saved.": "Bestand opgeslagen.",
+  "File was not saved.": "Bestand niet opgeslagen.",
+  "Start X:": "Start X",
+  "Start Y:": "Start Y",
+  "Lock": "Op-slot",
+  "Flip Image": "Beeld spiegelen",
+  "Flip Horizontal": "hor. spiegelen",
+  "Flip Vertical": "ver. spiegelen",
+  "Rotate Image": "Beeld draaien",
+  "Rotate 180 ": "Draai 180 om",
+  "Rotate 90  CW": "Draai rechts om 90",
+  "Rotate 90  CCW": "Draai links om 90",
+  "Angle:": "Hoek:",
+  "W:": "W:",
+  "Clear": "Wissen",
+  "Loading": "Laden",
+  "Invalid base directory:": "Ongeldig pad:",
+  'Delete file "$file"?': 'Bestand "$file" verwijderen?',
+  "Please delete all files/folders inside the folder you wish to delete first.": "Vewijder alle onderliggende bestanden/mappen eerst.",
+  'Delete folder "$dir"?': 'Wis map "$dir"?',
+  "Folder Name:": "Map naam",
+  "No Files Found": "Geen bestaand gevonden",
+  "Invalid folder name, please choose another folder name.": "Ongeldig map naam, kies een andere naam s.v.p..",
+  "GIF format is not supported, image editing not supported.": "GIF-format niet ondersteund, beeldbewerking niet ondersteund.",
+  "No Image Available": "Geen beeld beschikbaar",
+  "No Image selected.": "Geen beeld geselecteerd.",
+  "Description:": "Beschrijving:",
+  "Align": "Uitlijnen",
+  "Description:": "Beschrijving:",
+  "Margin": "Inspringen",
+  "Padding": "Uitvullen",
+  "Border": "Kader",
+  "Color:": "Kleur:",
+  "Border Color:": "Kaderkleur:",
+  "Upload:": "Upload:",
+  "Alt": "Alt",
+  "Alt": "Alt",
+  "File Name": "Bestandsnaam",
+  "Thumbnail View": "Miniaturen",
+  "List View": "Lijst",
+  "Title (tooltip)": "Titel (tooltip)",
+  "Target Window": "Doel venster",
+  "Name": "Naam",
+  "Size": "Grootte",
+  "Date Modified": "Datum aangepast",
+  "Total Size": "Totaalgrootte",
+  "Free Space": "Vrije ruimte",
+  "Positioning of this image" : "Uitlijnen van dit beeld",
+  "Insert File Link": "Hypelink van bestandinvoegen",
+  "Untitled": "Geen titel",
+  'Please enter name for new folder...': "Naam van nieuwe map...",
+  "You must select some text before making a new link.": "Eerst tekst selecteren.",
+  "Folder is not empty. Please delete all Files and Subfolders inside.": "Map is niet leeg. Verwijder eerst alle bestanden en onderliggendemappen.",
+  "Image Size": "Beeld afmetingen",
+  "Other" : "Andere...",
+  "Rename": "Naam wijzigen",
+  "Please enter new name for this file...": "Nieuwe bestandsnaam...",
+  "Unable to rename file. File of the same name already exists or\nfolder doesn't have write permission.": "Hernoemen niet mogelijk. Bestand bestaat al of\nmap heeft geen schrijf toestemming.",
+  "Cancelled rename.": "Hernoemen geannuleerd.",
+  'File "$file" successfully uploaded.': '"$file" bestand upload voltooid.',
+  "Cannot upload. Maximum folder size reached.": "Uploaden is niet mogelijk. De doel map is vol.",
+  "Maximum file size [$max_size KB] exceeded.": "Maximale bestandgrootte [$max_size KB] overschreden.",
+  "Cannot upload $extension Files. Permission denied.": "Het is niet mogelijk om $extension bestanden te uploaden.",
+  "Unable to upload File. \nEither Maximum file size [$max_size KB] exceeded or\nFolder doesn\'t have write permission.": "Bestands upload niet mogelijk.\nMaximale bestandsgrootte [$max_size KB] overtreden\nof de map heeft geen schrijf toestemming.",
+  "Total Size : $max_foldersize_mb MB, Free Space: $free_space": "Totaalgrootte: $max_foldersize_mb MB, nog vrij: $free_space",
+  "Please enter new name for this folder...":"Geef een nieuwe naam voor deze map...",
+
+  "Cut":"Knippen",
+  "Copy":"Kopiren",
+  "Paste":"Plakken",
+  
+  'Copy "$file" from "$dir" here': 'Kopieer "$file" van "$dir" naar',
+  'Copy folder "$file" from "$dir" here' : 'Kopieer map "$file" van "$dir" naar',
+  'Move "$file" from "$dir" here':'Verplaats "$file" van "$dir" naar',
+  'Move folder "$file" from "$dir" here':'Verplaats map "$file" van "$dir" naar',
+  
+  "Source file/folder not found.":"Bron bestand/map niet gevonden.",
+  "Paste failed.\nMaybe folder doesn't have write permission.": "Plakken mislukt..\nDe map heeft mogelijk niet de juiste schrijfrechten.",
+  "Could not create destination folder.":"Bestemmings map kon niet worden gemaakt..",
+  "Destination file/folder already exists.":"Bestemmings bestand/map bestaat al."
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/lang/pl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/lang/pl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,110 @@
+// I18N constants
+// LANG: "pl", ENCODING: UTF-8
+// translated: Krzysztof Kotowicz, http://www.web.eskot.pl, koto@webworkers.pl
+{
+  "File Manager": "Meneder plikw",
+  "Insert Image": "Wstaw obrazek",
+  "Directory": "Katalog",
+  "Directory Up": "Katalog wyej",
+  "New Folder": "Nowy katalog",
+  "Trash": "Usu",
+  "Edit": "Edytuj",
+  "Image File": "Plik obrazka",
+  "Upload": "Wgraj",
+  "Width": "Szeroko",
+  "Height": "Wysoko",
+  "Width:": "Szeroko:",
+  "Height:": "Wysoko:",
+  "Constrain Proportions": "Zachowaj proporcje",
+  "Border": "Ramka",
+  "Margin": "Odstp",
+  "Padding": "Wcicie",
+  "Refresh": "Odwie",
+  "Uploading...": "Wgrywanie...",
+  "Uploading": "Wgrywam",
+  "Crop": "Przytnij",
+  "Resize": "Przeskaluj",
+  "Rotate": "Obr",
+  "Measure": "Zmierz",
+  "Marker": "Zaznacz",
+  "Save": "Zapisz",
+  "Filename:": "Nazwa pliku:",
+  "Image Format": "Format pliku:",
+  "Quality:": "Jako",
+  "JPEG High": "JPEG wysoka",
+  "JPEG Medium": "JPEG rednia",
+  "JPEG Low": "JPEG niska",
+  "File saved.": "Zapisano plik.",
+  "File was not saved.": "Nie zapisano pliku.",
+  "Start X:": "Pocztek X:",
+  "Start Y:": "Pocztek Y:",
+  "Lock": "Zablokuj",
+  "Flip Image": "Odwr",
+  "Flip Horizontal": "Odwr poziomo",
+  "Flip Vertical": "Odwr pionowo",
+  "Rotate Image": "Obr",
+  "Rotate 180 ": "Obr 180",
+  "Rotate 90  CW": "Obr 90 w prawo",
+  "Rotate 90  CCW": "Obr 90 w lewo",
+  "Angle:": "Kt:",
+  "W:": "L:",
+  "Clear": "Wyczy",
+  "Loading": "adowanie",
+  "Invalid base directory:": "Nieprawidowy katalog bazowy:",
+  'Delete file "$file"?': "$file\n\nUsun plik?",
+  "Please delete all files/folders inside the folder you wish to delete first.": "Najpierw usu wszystkie pliki i podkatalogi katalogu.",
+  'Delete folder "$dir"?': "$dir\n\nUsun katalog ?",
+  "No Files Found": "Nie znaleziono plikw",
+  "Invalid folder name, please choose another folder name.": "Nieprawidowa nazwa katalogu, wybierz inn.",
+  "GIF format is not supported, image editing not supported.": "Brak obsugi plikw GIF, edycja jest niemoliwa.",
+  "No Image Available": "Obrazek niedostpny",
+  "No Image selected.": "Nie zaznaczono obrazka.",
+  "Align": "Wyrwnanie",
+  "Color": "Kolor",
+  "Border Color": "Kolor ramki",
+  "Alt": "Alt",
+  "File Name": "Nazwa pliku",
+  "Thumbnail View": "Miniaturki",
+  "List View": "Lista",
+  "Title (tooltip)": "Tytu",
+  "Target Window": "Docelowe okno",
+  "Name": "Nazwa",
+  "Size": "Rozmiar",
+  "Date Modified": "Data ost.modyf.",
+  "Total Size": "Miejsce na serwerze",
+  "Free Space": "Pozostao",
+  "Positioning of this image" : "Wyrwnanie tego obrazka na stronie",
+  "Insert File Link": "Wstaw odnonik do pliku na serwerze",
+  "Untitled": "Bez_nazwy",
+  'Please enter name for new folder...': "Podaj nazw nowego folderu...",
+  "You must select some text before making a new link.": "Zaznacz tekst przed dodaniem odnonika.",
+  "Folder is not empty. Please delete all Files and Subfolders inside.": "Folder nie jest pusty. Najpierw usu wszystkie pliki i podfoldery tego folderu.",
+  "Image Size": "Wymiary",
+  "Other" : "Inne...",
+  "Rename": "Zmie nazw",
+  "Please enter new name for this file...": "Podaj now nazw dla tego pliku...",
+  "Unable to rename file. File of the same name already exists or\nfolder doesn't have write permission.": "Nie mogem zmieni nazwy pliku. Plik o nowej nazwie ju istnieje\nlub prak praw zapisu do katalogu.",
+  "Cancelled rename.": "Anulowano zmian nazwy pliku.",
+  'File "$file" successfully uploaded.':  'Plik "$file" wgrano na serwer.',
+  "Cannot upload. Maximum folder size reached. Delete unwanted files and try again.":"Wgrywanie nie powiodo si.\n\nPrzekroczono dozwolony limit miejsca. Usu niechciane pliki i sprbuj ponownie.",
+  "Maximum file size [$max_size KB] exceeded.":"Wgrywanie nie powiodo si.\n\nPrzekroczono maksymalny rozmiar pliku [$max_size KB].",
+  "Cannot upload $extension Files. Permission denied.": "Nie mona byo wgra pliku.\n\nNiedozwolone rozszerzenie pliku [$extension].",
+  "Unable to upload File. \nEither Maximum file size [$max_size KB] exceeded or\nFolder doesn\'t have write permission.":"Wgrywanie nie powiodo si.\n\nPrzekroczono maksymalny rozmiar pliku [$max_size KB] lub nie ma ustawionych praw zapisu do folderu.",
+  "Total Size : $max_foldersize_mb MB, Free Space: $free_space": "Dostpny limit: $max_foldersize_mb MB, Wolne: $free_space",
+  "Please enter new name for this folder...":"Podaj now nazw dla tego folderu...",
+
+  "Cut":"Wytnij",
+  "Copy":"Kopiuj",
+  "Paste":"Wklej",
+  
+  'Copy "$file" from "$dir" here': 'Skopiuj "$file" z "$dir" tutaj',
+  'Copy folder "$file" from "$dir" here' : 'Skopiuj folder "$file" z "$dir" tutaj',
+  'Move "$file" from "$dir" here':'Przenie "$file" z "$dir" tutaj',
+  'Move folder "$file" from "$dir" here':'Przenie folder "$file" z "$dir" tutaj',
+  
+  "Source file/folder not found.":"Nie znaleziono pliku/folderu rdowego.",
+  "Paste failed.\nMaybe folder doesn't have write permission.": "Wklejenie nie powiodo si.\nPrawdopodobnie nie masz praw zapisu w tym folderze.",
+  "Could not create destination folder.":"Nie mona byo utworzy folderu docelowego.",
+  "Destination file/folder already exists.":"Plik/folder docelowy ju istnieje.",
+  "File pasted OK.": "Wklejono plik."
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,102 @@
+// I18N constants
+
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+
+// Last revision: 05 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  ">List View": ">Lista",
+  ">Thumbnail View": ">Miniaturas",
+  "A:": "A:",
+  "Absbottom": "Inferior absoluto",
+  "Absmiddle": "Meio absoluto",
+  "Align": "Alinhamento",
+  "Alt": "Alt",
+  "Angle:": "Angulo:",
+  "Baseline": "Linha de base",
+  "Border": "Borda",
+  "Border Color": "Cr da Borda",
+  "Bottom": "Inferior",
+  "Cancel": "Cancelar",
+  "Clear": "Limpar",
+  "Color": "Cr",
+  "Constrain Proportions": "Manter Proporcionalidade",
+  "Copy": "Copiar",
+  "Crop": "Recortar",
+  "Cut": "Cortar",
+  "Directory": "Diretrio",
+  "Directory Up": "Diretrio Acima",
+  "Edit": "Editar",
+  "File List": "Lista de Arquivos",
+  "File Manager": "Gerenciador de Arquivos",
+  "Filename:": "Nome do Arquivo:",
+  "Flip Horizontal": "Espelhar Horizontalmente",
+  "Flip Image": "Espelhar Imagem",
+  "Flip Vertical": "Espelhar Verticalmente",
+  "Folder": "Pasta",
+  "GIF format is not supported, image editing not supported.": "Formato GIF no  suportado, no  possvel editar imagem.",
+  "H:": "A:",
+  "Height": "Altura",
+  "Height:": "Altura:",
+  "Image Editor": "Editor de Imagem",
+  "Image Format": "Formato da Imagem",
+  "Image Selection": "Seleo de Imagem",
+  "Insert File Link": "Inserir Link de Arquivo",
+  "Invalid base directory:": "Diretrio base invlido",
+  "JPEG High": "JPEG Alto",
+  "JPEG Low": "JPEG Baixo",
+  "JPEG Medium": "JPEG Mdio",
+  "Left": "Esquerda",
+  "Loading": "Carregando",
+  "Lock": "Travar",
+  "Margin": "Margem",
+  "Marker": "Marcar",
+  "Maximum folder size limit reached. Upload disabled.": "Atingido o limite mximo da pasta. Envio desativado.",
+  "Measure": "Medida:",
+  "Middle": "Meio",
+  "New Folder": "Nova Pasta",
+  "New window (_blank)": "Nova janela (_blank)",
+  "No Files Found": "Nenhum Arquivo Encontrado",
+  "No Image Available": "Nenhuma Imagem Disponvel",
+  "None (use implicit)": "Nenhum (uso implcito)",
+  "Not set": "No definido",
+  "Padding": "Espaamento Interno",
+  "Please enter value": "Por favor, entre o valor",
+  "Positioning of this image": "Posicionamento desta imagem",
+  "Quality:": "Qualidade:",
+  "Refresh": "Atualizar",
+  "Rename": "Renomear",
+  "Resize": "Redimencionar",
+  "Right": "Direita(o)",
+  "Rotate": "Rotacionar",
+  "Rotate 180 &deg;": "Rotacionar 180 &deg;",
+  "Rotate 90 &deg; CCW": "Rotacionar 90 &deg; anti-horrio",
+  "Rotate 90 &deg; CW": "Rotacionar 90 &deg; horrio",
+  "Rotate Image": "Rotacionar Imagem",
+  "Same frame (_self)": "Mesma frame (_self)",
+  "Save": "Gravar",
+  "Start X:": "Incio X:",
+  "Start Y:": "Incio Y",
+  "Target Window": "Janela Destino",
+  "Texttop": "Texto no topo",
+  "Title (tooltip)": "Ttulo (tooltip)",
+  "Top": "Topo",
+  "Top frame (_top)": "Frame do topo (_top)",
+  "Trash": "Lixo",
+  "Upload": "Enviar",
+  "W:": "L:",
+  "Width": "Largura",
+  "Width:": "Largura:",
+  "X:": "X:",
+  "Y:": "Y:",
+  "You must select some text before making a new link.": "Voc precisa selecionar um texto antes de criar um novo link."
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/manager.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/manager.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,285 @@
+<?php
+/**
+ * The main GUI for the ExtendedFileManager.
+ * Authors: Wei Zhuo, Afru, Krzysztof Kotowicz, Raimund Meyer
+ * Version: Updated on 08-01-2005 by Afru
+ * Version: Updated on 04-07-2006 by Krzysztof Kotowicz
+ * Version: Updated on 29-10-2006 by Raimund Meyer
+ * Version: Updated on 20-01-2008 by Raimund Meyer
+ * Package: ExtendedFileManager (EFM 1.4)
+ * http://www.afrusoft.com/htmlarea
+ */
+
+	if(isset($_REQUEST['mode'])) $insertMode=$_REQUEST['mode'];
+	if(!isset($insertMode)) $insertMode="image";
+
+	require_once('config.inc.php');
+	require_once('Classes/ExtendedFileManager.php');
+	
+	$manager = new ExtendedFileManager($IMConfig);
+	$dirs = $manager->getDirs();
+
+	// calculate number of table rows to span for the preview cell
+	$num_rows = 4; // filename & upload & disk info message & width+margin
+		
+	if ($insertMode=='image')
+	{
+		if ($IMConfig['images_enable_styling'] === false)
+		{
+			$hidden_fields[] = 'f_margin';
+			$hidden_fields[] = 'f_padding';
+			$hidden_fields[] = 'f_border';
+			$hidden_fields[] = 'f_backgroundColor';
+			$hidden_fields[] = 'f_borderColor';
+			$num_rows +=2;
+		}
+		else if ($IMConfig['use_color_pickers'] === false)
+		{
+			$hidden_fields[] = 'f_backgroundColor';
+			$hidden_fields[] = 'f_borderColor';
+			$num_rows +=2;
+		}
+		
+		if ($IMConfig['images_enable_align'] === false)
+		{
+			$hidden_fields[] = 'f_align';
+		}
+		if ($IMConfig['images_enable_alt'])
+		{
+			$num_rows++;
+		}
+		else 
+		{
+			$hidden_fields[] = 'f_alt';
+		}
+		if ($IMConfig['images_enable_title'])
+		{
+			$num_rows++;
+		}
+		else 
+		{
+			$hidden_fields[] = 'f_title';
+		}
+	}
+	
+	if ($insertMode == 'link')
+	{
+		if ($IMConfig['link_enable_target'] === false)
+		{
+			$hidden_fields[] = 'f_target';
+		}
+		$num_rows +=2;
+	}
+?>
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
+    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+	<title>Insert <?php echo ($insertMode == 'image' ? 'Image' : 'File Link') ?></title>
+  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
+ <link href="<?php print $IMConfig['base_url'];?>assets/manager.css" rel="stylesheet" type="text/css" />
+ <link href="../../popups/popup.css" rel="stylesheet" type="text/css" />
+<script type="text/javascript" src="../../popups/popup.js"></script>
+<script type="text/javascript" src="<?php print $IMConfig['base_url'];?>assets/popup.js"></script>
+<script type="text/javascript" src="<?php print $IMConfig['base_url'];?>assets/dialog.js"></script>
+<?php if (!empty($IMConfig['use_color_pickers'])) { ?><script type="text/javascript" src="../../modules/ColorPicker/ColorPicker.js"></script><?php } ?>
+<script type="text/javascript">
+/* <![CDATA[ */
+
+	if(window.opener)
+		Xinha = window.opener.Xinha;
+		
+	var thumbdir = "<?php echo $IMConfig['thumbnail_dir']; ?>";
+	var base_url = "<?php echo $manager->getImagesURL(); ?>";
+    var _backend_url = "<?php print $IMConfig['backend_url']; ?>";
+    var _resized_prefix = "<?php echo $IMConfig['resized_prefix']; ?>";
+  	var _resized_dir = "<?php echo $IMConfig['resized_dir']; ?>";
+	<?php
+	if(isset($_REQUEST['mode']))
+	{
+		echo 'var manager_mode="'.$_REQUEST['mode'].'";';
+	}
+	else
+	{
+		echo 'var manager_mode="image";';
+	}
+	//IE doesn't like a relative URL when changing a window's location
+	$iframe_url = str_replace( array("backend.php","manager.php"), "", $_SERVER["PHP_SELF"] ) . $IMConfig['backend_url'];
+	?>
+	
+	var iframeUrl = '<?php print $iframe_url ?>__function=images&mode=<?php echo $insertMode;?>&viewtype=<?php echo $IMConfig['view_type'] ?>';
+
+/* ]]> */
+</script>
+<script type="text/javascript" src="<?php print $IMConfig['base_url'];?>assets/manager.js"></script>
+</head>
+<body class="dialog" >
+<div class="title">Insert <?php echo ($insertMode == 'image' ? 'Image' : 'File Link') ?></div>
+<form action="<?php print htmlspecialchars($IMConfig['backend_url']); ?>" id="uploadForm" method="post" enctype="multipart/form-data">
+<input type="hidden" name="__plugin" value="ExtendedFileManager" />
+<input type="hidden" name="__function" value="images" />
+<input type="hidden" name="mode" value="<?php echo $insertMode; ?>" />
+<input type="hidden" id="manager_mode" value="<?php echo $insertMode;?>" />
+<fieldset><legend>File Manager</legend>
+<table border="0" cellpadding="0" cellspacing="0" width="100%">
+<tr>
+<td nowrap="nowrap" style="padding:10px;">
+
+	<label for="dirPath">Directory</label>
+	<select name="dir" class="dirWidth" id="dirPath" onchange="updateDir(this)">
+	<option value="/">/</option>
+<?php foreach($dirs as $relative=>$fullpath) { ?>
+		<option value="<?php echo rawurlencode($relative); ?>"><?php echo $relative; ?></option>
+<?php } ?>
+	</select>
+
+	<a href="#" onclick="javascript: goUpDir();" title="Directory Up"><img src="<?php print $IMConfig['base_url'];?>img/btnFolderUp.gif" height="15" width="15" alt="Directory Up" /></a>
+
+
+<?php if($IMConfig['safe_mode'] == false && $IMConfig['allow_new_dir']) { ?>
+	<a href="#" onclick="newFolder();" title="New Folder"><img src="<?php print $IMConfig['base_url'];?>img/btnFolderNew.gif" height="15" width="15" alt="New Folder" /></a>
+<?php } ?>
+<span id="pasteBtn"></span>
+
+	<select name="viewtype" id="viewtype" onchange="updateView()">
+	<option value="thumbview" <?php if($IMConfig['view_type']=="thumbview") echo 'selected="selected"';?> >Thumbnail View</option>
+	<option value="listview" <?php if($IMConfig['view_type']=="listview") echo 'selected="selected"';?> >List View</option>
+	</select>
+</td>
+</tr>
+<tr><td style="padding:10px; padding-top:0px;">
+	<div id="messages"><span id="message">Loading</span><img src="<?php print $IMConfig['base_url'];?>img/dots.gif" width="22" height="12" alt="..." /></div>
+	<iframe src="about:blank" name="imgManager" id="imgManager" class="imageFrame" scrolling="auto" title="Image Selection" frameborder="0"></iframe>
+</td></tr>
+</table>
+</fieldset>
+<!-- image properties -->
+<div id="controls">
+	<table class="inputTable">
+		<tr>
+			<td style="text-align: right;" nowrap="nowrap"><label for="f_url"><?php if($insertMode=='image') echo 'File Name'; else echo 'URL';?></label></td>
+			<td colspan="5"><input type="text" id="<?php if($insertMode=='image') echo 'f_url'; else echo 'f_href';?>" class="largelWidth" value="" /></td>
+            <td rowspan="<?php echo $num_rows ?>" colspan="2" style="vertical-align: top; text-align: center;"><?php if($insertMode=='image') { ?>
+            <div style="padding:4px;background-color:#CCC;border:1px inset;width: 100px; height: 100px;">
+            <img src="<?php print $IMConfig['base_url'];?>img/1x1_transparent.gif" alt="" id="f_preview" />
+            </div>
+            <?php } else if($insertMode=="link" && $IMConfig['link_enable_target'] !== false) {?><label for="f_align" id="f_target_label">Target Window</label>
+			<select id="f_target" style="width:125px;">
+			  <option value="">None (use implicit)</option>
+			  <option value="_blank">New window (_blank)</option>
+			  <option value="_self">Same frame (_self)</option>
+		      <option value="_top">Top frame (_top)</option>
+		    </select><br /><br />
+<input type="text" name="f_other_target" id="f_other_target" style="visibility:hidden; width:120px;" />
+            <?php } ?></td>
+            </tr>
+<?php if($insertMode == 'image' && $IMConfig['images_enable_alt']) { ?>
+		<tr>
+			<td style="text-align: right;"><label for="f_alt">Alt</label></td>
+			<td colspan="5"><input type="text" id="f_alt" class="largelWidth" value="" /></td>
+        </tr>
+<?php }
+      if ($insertMode == 'link' || $IMConfig['images_enable_title']) { ?>
+      <tr>
+			<td style="text-align: right;"><label for="f_title">Title (tooltip)</label></td>
+			<td colspan="5"><input type="text" id="f_title" class="largelWidth" value="" /></td>
+      </tr>
+<?php } ?>
+		<tr>
+<?php
+if (!empty($IMConfig['max_foldersize_mb']) && Files::dirSize($manager->getImagesDir()) > ($IMConfig['max_foldersize_mb']*1048576))
+{ ?>
+	<td colspan="6" style="text-align: right;">Maximum folder size limit reached. Upload disabled.</td>
+<?php }
+else if($IMConfig['allow_upload']) { ?>
+			<td style="text-align: right;"><label for="upload">Upload</label></td>
+			<td colspan="5">
+				<table cellpadding="0" cellspacing="0" border="0">
+                  <tr>
+                    <td><input type="hidden" name="MAX_FILE_SIZE" value="<?php echo $max = (($insertMode == 'image' ? $IMConfig['max_filesize_kb_image'] : $IMConfig['max_filesize_kb_link'] )*1024); ?>" />
+<input type="file" name="upload" id="upload" /></td>
+                    <td><button type="submit" name="submit" onclick="doUpload();">Upload</button>(<?php echo $max/1024 . 'KB'?> max.)</td>
+                  </tr>
+                </table>
+			</td>
+<?php } else { ?>
+			<td colspan="6"></td>
+<?php } ?>
+		</tr>
+		<tr>
+		 <td><?php if (!empty($hidden_fields)) foreach ($hidden_fields as $hf) echo "<input type=\"hidden\" id=\"{$hf}\" name=\"{$hf}\" value=\"\" />"; ?></td>
+		 <td colspan="5"><span id="diskmesg"></span></td>
+      </tr>
+<tr>
+			<td style="text-align: right;"><?php if($insertMode=='image') { ?> <label for="f_width">Width</label><?php }?></td>
+
+			<td><?php if($insertMode=='image') { ?> <input type="text" id="f_width" class="smallWidth" value="" onchange="javascript:checkConstrains('width');"/><?php } else echo "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";?></td>
+
+			<td rowspan="2"><?php if($insertMode=='image') { ?><img src="<?php print $IMConfig['base_url'];?>img/locked.gif" id="imgLock" width="25" height="32" alt="Constrained Proportions" />
+				<input type="hidden" id="orginal_width" />
+				<input type="hidden" id="orginal_height" />
+            <input type="checkbox" id="constrain_prop" checked="checked" onclick="javascript:toggleConstrains(this);" /><br />
+            <label for="constrain_prop">Constrain Proportions</label><?php }?>
+            </td>
+
+			<td rowspan="3" style="text-align: right;"></td>
+
+			<td style="text-align: right;"><?php if($insertMode=='image' && $IMConfig['images_enable_styling'] !== false) { ?><label for="f_margin">Margin</label><?php }?></td>
+
+			<td><?php if($insertMode=='image' && $IMConfig['images_enable_styling'] !== false) { ?><input type="text" id="f_margin" class="smallWidth" value="" /><?php } ?></td>
+</tr>
+<tr>
+			<td style="text-align: right;"><?php if($insertMode=='image') { ?><label for="f_height">Height</label><?php }?></td>
+
+			<td class="smallWidth"><?php if($insertMode=='image') { ?><input type="text" id="f_height" class="smallWidth" value="" onchange="javascript:checkConstrains('height');"/><?php }?></td>
+
+			<td style="text-align: right;"><?php if($insertMode=='image' && $IMConfig['images_enable_styling'] !== false) { ?><label for="f_padding">Padding</label><?php }?></td>
+
+			<td><?php if($insertMode=='image' && $IMConfig['images_enable_styling'] !== false) { ?><input type="text" id="f_padding" class="smallWidth" value="" />
+			<?php }?></td>
+
+            <?php if($insertMode=='image' && !empty($IMConfig['use_color_pickers']) && $IMConfig['images_enable_styling'] !== false) { ?>
+   	            <td style="text-align: left;">Color</td>
+  	            <td>
+                  <input name="f_backgroundColor" type="text" id="f_backgroundColor" size="7" />
+                </td>
+  	        <?php } ?>
+</tr>
+<tr>
+			<td style="text-align: right;"><?php if($insertMode=='image' && $IMConfig['images_enable_align'] !== false) { ?><label for="f_align">Align</label><?php }?></td>
+
+			<td colspan="2"><?php if($insertMode=='image' && $IMConfig['images_enable_align'] !== false) { ?>
+				<select size="1" id="f_align"  title="Positioning of this image">
+				  <option value="" selected="selected"         >Not set</option>
+				  <option value="left"                         >Left</option>
+				  <option value="right"                        >Right</option>
+				  <option value="texttop"                      >Texttop</option>
+				  <option value="absmiddle"                    >Absmiddle</option>
+				  <option value="baseline"                     >Baseline</option>
+				  <option value="absbottom"                    >Absbottom</option>
+				  <option value="bottom"                       >Bottom</option>
+				  <option value="middle"                       >Middle</option>
+				  <option value="top"                          >Top</option>
+				</select><?php } ?>
+			</td>
+
+			<td style="text-align: right;"><?php if($insertMode=='image' && $IMConfig['images_enable_styling'] !== false) { ?><label for="f_border">Border</label><?php }?></td>
+			<td><?php if($insertMode=='image' && $IMConfig['images_enable_styling'] !== false) { ?><input type="text" id="f_border" class="smallWidth" value="" /><?php }?></td>
+			<?php if($insertMode=='image' && !empty($IMConfig['use_color_pickers']) && $IMConfig['images_enable_styling'] !== false) { ?>
+  	        <td style="text-align: left;">Border Color</td>
+            <td><input name="f_borderColor" type="text" id="f_borderColor" size="7" /></td>
+            <?php } ?>
+</tr>
+</table>
+
+<!--// image properties -->	
+	<div style="text-align: right;"> 
+          <hr />
+		  <button type="button" class="buttons" onclick="return refresh();">Refresh</button>
+          <button type="button" class="buttons" onclick="return onOK();">OK</button>
+          <button type="button" class="buttons" onclick="return onCancel();">Cancel</button>
+    </div>
+</div>
+</form>
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/prompt.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/prompt.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,92 @@
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html>
+<head>
+<title></title>
+ <script type="text/javascript" src="../../popups/popup.js"></script>
+ <style type="text/css">
+ /*<![CDATA[*/
+ html, body {  background-color: ButtonFace;  color: ButtonText; font: 11px Tahoma,Verdana,sans-serif; margin: 0; padding: 0;}
+body { padding: 5px; }
+ .title { background-color: #ddf; color: #000; font-weight: bold; font-size: 120%; padding: 3px 10px; margin-bottom: 10px; border-bottom: 1px  solid black; letter-spacing: 2px;}
+select, input, button { font: 11px Tahoma,Verdana,sans-serif; }
+.buttons { width: 70px; text-align: center; }
+form { padding: 0px;  margin: 0;}
+form .elements{
+	padding: 10px; text-align: center;
+}
+ /*]]>*/
+ </style>
+<script type="text/javascript" src="../../popups/popup.js"></script>
+<script type="text/javascript">
+/*<![CDATA[*/
+	
+    if(window.opener)
+        HTMLArea = window.opener.HTMLArea;
+
+	init = function ()
+	{
+		__dlg_translate('ImageManager');
+		
+		var param = opener.Dialog._arguments;
+		
+		if ( param )
+		{
+		  if ( param.title )
+		  {
+		    document.title = param.title;
+		    document.getElementById("title").innerHTML = param.title;
+		  }
+		  if ( param.prompt )
+		  {
+		    document.getElementById("prompt").innerHTML = param.prompt;
+		  }
+		  if ( param.value )
+		  {
+		    document.getElementById("f_input").value = param.value;
+		  }
+		}
+		document.getElementById("f_input").focus();
+		
+		__xinha_dlg_init();
+		
+	};
+
+	function onCancel()
+	{
+		__dlg_close(null);
+		return false;
+	}
+
+	function onOK()
+	{
+		 // pass data back to the calling window
+	  __dlg_close({value:document.getElementById("f_input").value});
+	  return false;
+	}
+
+	function addEvent(obj, evType, fn)
+	{
+		if (obj.addEventListener) { obj.addEventListener(evType, fn, true); return true; }
+		else if (obj.attachEvent) {  var r = obj.attachEvent("on"+evType, fn);  return r;  }
+		else {  return false; }
+	}
+
+	addEvent(window, 'load', init);
+//-->
+</script>
+</head>
+<body >
+<div class="title" id="title" style="white-space:nowrap">Please enter value</div>
+<form action="">
+<div class="elements">
+	<label for="f_input" id="prompt"></label>
+	<input type="text" id="f_input" style="width:50%"/>
+</div>
+<div style="text-align: right;">
+	  <hr />
+	  <button type="button" class="buttons" onclick="return onOK();">OK</button>
+	  <button type="button" class="buttons" onclick="return onCancel();">Cancel</button>
+</div>
+</form>
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/resizer.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/resizer.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,83 @@
+<?php
+header('Content-Type: text/javascript; charset=UTF-8');
+
+/**
+ * Resize images to a given size, and saving in a new file.
+ * resize.php?img=/relative/path/to/image.jpg&width=<pixels>&height=<pixels>[&to=/relative/path/to/newimage.jpg]
+ * relative to the base_dir given in config.inc.php
+ * This is pretty much just thumbs.php with some mods, I'm too lazy to do it properly
+ * @author $Author:ray $
+ * @version $Id:resizer.php 922 2007-12-30 14:35:46Z ray $
+ * @package ImageManager
+ */
+
+require_once('config.inc.php');
+require_once('Classes/ExtendedFileManager.php');
+require_once('../ImageManager/Classes/Thumbnail.php');
+
+function js_fail($message)    { echo 'alert(\'ha ' . $message . '\'); false'; exit;   }
+function js_success($resultFile)    { echo '\'' . $resultFile . '\''; exit;   }
+
+//check for img parameter in the url
+if(!isset($_GET['img']) || !isset($_GET['width']) || !isset($_GET['height']))
+{
+  js_fail('Missing parameter.');
+}
+
+$manager = new ExtendedFileManager($IMConfig);
+
+//get the image and the full path to the image
+$image = $_GET['img'];
+$fullpath = Files::makeFile($manager->getImagesDir(),$image);
+
+//not a file, so exit
+if(!is_file($fullpath))
+{
+  js_fail("File {$fullpath} does not exist.");
+}
+
+$imgInfo = @getImageSize($fullpath);
+
+//Not an image, bail out.
+if(!is_array($imgInfo))
+{
+	js_fail("File {$fullpath} is not an image.");
+}
+
+if(!isset($_GET['to']))
+{
+  $resized    = $manager->getResizedName($fullpath,$_GET['width'],$_GET['height']);
+  $_GET['to'] = $manager->getResizedName($image,$_GET['width'],$_GET['height'], FALSE);
+}
+else
+{
+  $resized = Files::makeFile($manager->getImagesDir(),$_GET['to']);
+}
+
+// Check to see if it already exists
+if(is_file($resized))
+{
+	// And is newer
+	if(filemtime($resized) >= filemtime($fullpath))
+	{
+		js_success($_GET['to']);
+	}
+}
+
+
+
+// resize (thumbnailer will do this for us just fine)
+$thumbnailer = new Thumbnail($_GET['width'],$_GET['height']);
+$thumbnailer->proportional = FALSE;
+$thumbnailer->createThumbnail($fullpath, $resized);
+
+// did it work?
+if(is_file($resized))
+{
+	js_success($_GET['to']);
+}
+else
+{
+	js_fail("Resize Failed.");
+}
+?>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ExtendedFileManager/thumbs.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ExtendedFileManager/thumbs.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,85 @@
+<?php
+/**
+ * On the fly Thumbnail generation.
+ * Creates thumbnails given by thumbs.php?img=/relative/path/to/image.jpg
+ * relative to the base_dir given in config.inc.php
+ * Authors: Wei Zhuo, Afru, Krzysztof Kotowicz
+ * Version: Updated on 08-01-2005 by Afru
+ * Version: Updated on 21-06-2006 by Krzysztof Kotowicz
+ * Package: ExtendedFileManager (EFM 1.1.1)
+ * http://www.afrusoft.com/htmlarea
+ */
+if(isset($_REQUEST['mode'])) $insertMode=$_REQUEST['mode'];
+if(!isset($insertMode)) $insertMode="image";
+
+require_once('config.inc.php');
+require_once('Classes/ExtendedFileManager.php');
+require_once('../ImageManager/Classes/Thumbnail.php');
+
+//check for img parameter in the url
+if(!isset($_GET['img']))
+	exit();
+
+$manager = new ExtendedFileManager($IMConfig,$insertMode);
+
+//get the image and the full path to the image
+$image = rawurldecode($_GET['img']);
+$fullpath = Files::makeFile($manager->getImagesDir(),$image);
+
+//not a file, so exit
+if(!is_file($fullpath))
+	exit();
+
+$imgInfo = @getImageSize($fullpath);
+
+//Not an image, send default thumbnail
+if(!is_array($imgInfo))
+{
+	//show the default image, otherwise we quit!
+	$default = $manager->getDefaultThumb();
+	if($default)
+	{
+		header('Location: '.$default);
+		exit();
+	}
+}
+//if the image is less than the thumbnail dimensions
+//send the original image as thumbnail
+if ($imgInfo[0] <= $IMConfig['thumbnail_width']
+ && $imgInfo[1] <= $IMConfig['thumbnail_height'])
+ {
+	 header('Location: '.$manager->getFileURL($image));
+	 exit();
+ }
+
+//Check for thumbnails
+$thumbnail = $manager->getThumbName($fullpath);
+if(is_file($thumbnail))
+{
+	//if the thumbnail is newer, send it
+	if(filemtime($thumbnail) >= filemtime($fullpath))
+	{
+		header('Location: '.$manager->getThumbURL($image));
+		exit();
+	}
+}
+
+//creating thumbnails
+$thumbnailer = new Thumbnail($IMConfig['thumbnail_width'],$IMConfig['thumbnail_height']);
+$thumbnailer->createThumbnail($fullpath, $thumbnail);
+
+//Check for NEW thumbnails
+if(is_file($thumbnail))
+{
+	//send the new thumbnail
+	header('Location: '.$manager->getThumbURL($image));
+	exit();
+}
+else
+{
+	//show the default image, otherwise we quit!
+	$default = $manager->getDefaultThumb();
+	if($default)
+		header('Location: '.$default);
+}
+?>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Filter/filter.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Filter/filter.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,46 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/Filter/filter.js */
+function Filter(_1){
+this.editor=_1;
+var _2=_1.config;
+var _3=this;
+_2.registerButton({id:"filter",tooltip:this._lc("Filter"),image:_1.imgURL("ed_filter.gif","Filter"),textMode:false,action:function(_4){
+_3.buttonPress(_4);
+}});
+if(!_2.Filters){
+_2.Filters=["Paragraph","Word"];
+}
+for(var i=0;i<_1.config.Filters.length;i++){
+_3.add(_1.config.Filters[i]);
+}
+_2.addToolbarElement("filter","removeformat",1);
+}
+Filter._pluginInfo={name:"Filter",version:"1.0",developer:"Udo Schmal (gocher)",developer_url:"",sponsor:"L.N.Schaffrath NeueMedien",sponsor_url:"http://www.schaffrath-neuemedien.de/",c_owner:"Udo Schmal & Schaffrath-NeueMedien",license:"htmlArea"};
+Filter.prototype.add=function(_6){
+if(eval("typeof "+_6)=="undefined"){
+var _7=Xinha.getPluginDir("Filter")+"/filters/"+_6+".js";
+var _8=document.getElementsByTagName("head")[0];
+var _9=Xinha.is_ie?"onreadystatechange":"onload";
+var _a=document.createElement("script");
+_a.type="text/javascript";
+_a.src=_7;
+_a[_9]=function(){
+if(Xinha.is_ie&&!/loaded|complete/.test(window.event.srcElement.readyState)){
+return;
+}
+};
+_8.appendChild(_a);
+}
+};
+Filter.prototype._lc=function(_b){
+return Xinha._lc(_b,"Filter");
+};
+Filter.prototype.buttonPress=function(_c){
+var _d=_c.getInnerHTML();
+for(var i=0;i<_c.config.Filters.length;i++){
+_d=eval(_c.config.Filters[i])(_d);
+}
+_c.setHTML(_d);
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Filter/filters/paragraph.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Filter/filters/paragraph.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,10 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/Filter/filters/paragraph.js */
+Paragraph=function(_1){
+_1=_1.replace(/<\s*p[^>]*>/gi,"");
+_1=_1.replace(/<\/\s*p\s*>/gi,"");
+_1=_1.trim();
+return _1;
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Filter/filters/word.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Filter/filters/word.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,30 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/Filter/filters/word.js */
+Word=function(_1){
+_1=_1.replace(/<!--[\w\s\d@{}:.;,'"%!#_=&|?~()[*+\/\-\]]*-->/gi,"");
+_1=_1.replace(/<!--[^\0]*-->/gi,"");
+_1=_1.replace(/<\/?\s*HTML[^>]*>/gi,"");
+_1=_1.replace(/<\/?\s*BODY[^>]*>/gi,"");
+_1=_1.replace(/<\/?\s*META[^>]*>/gi,"");
+_1=_1.replace(/<\/?\s*SPAN[^>]*>/gi,"");
+_1=_1.replace(/<\/?\s*FONT[^>]*>/gi,"");
+_1=_1.replace(/<\/?\s*IFRAME[^>]*>/gi,"");
+_1=_1.replace(/<\/?\s*STYLE[^>]*>(.|[\n\r\t])*<\/\s*STYLE\s*>/gi,"");
+_1=_1.replace(/<\s*TITLE[^>]*>(.|[\n\r\t])*<\/\s*TITLE\s*>/gi,"");
+_1=_1.replace(/<\s*SCRIPT[^>]*>[^\0]*<\/\s*SCRIPT\s*>/gi,"");
+_1=_1.replace(/<\s*HEAD[^>]*>(.|[\n\r\t])*<\/\s*HEAD\s*>/gi,"");
+_1=_1.replace(/<\s*(\w[^>]*) class=([^ |>]*)([^>]*)/gi,"<$1$3");
+_1=_1.replace(/<\s*(\w[^>]*) style="([^"]*)"([^>]*)/gi,"<$1$3");
+_1=_1.replace(/<\s*(\w[^>]*) lang=([^ |>]*)([^>]*)/gi,"<$1$3");
+_1=_1.replace(/<\\?\?xml[^>]*>/gi,"");
+_1=_1.replace(/<\/?\w+:[^>]*>/gi,"");
+_1=_1.replace(/&nbsp;/," ");
+_1=_1.replace(/<\s*p[^>]*><\s*br\s*\/?>\s*<\/\s*p[^>]*>/gi,"<br>");
+_1=_1.replace(/<\s*p[^>]*>/gi,"");
+_1=_1.replace(/<\/\s*p[^>]*>/gi,"<br>");
+_1=_1.replace(/(\s*<br>\s*)*$/,"");
+_1=_1.trim();
+return _1;
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Filter/img/ed_filter.gif
Binary file Xinha_0.95/plugins/Filter/img/ed_filter.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Filter/lang/ja.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Filter/lang/ja.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,5 @@
+// I18N constants
+// LANG: "ja", ENCODING: UTF-8
+{
+  "Filter": ""
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Filter/lang/nl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Filter/lang/nl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,6 @@
+// I18N constants
+// LANG: "nl", ENCODING: UTF-8
+// Author: Maarten Molenschot, maarten@nrgmm.nl
+{
+  "Filter": "Filter"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Filter/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Filter/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,18 @@
+// I18N constants
+
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+
+// Last revision: 05 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "Filter": "Filtro"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FindReplace/find-replace.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FindReplace/find-replace.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,27 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/FindReplace/find-replace.js */
+function FindReplace(_1){
+this.editor=_1;
+var _2=_1.config;
+var _3=this;
+_2.registerButton("FR-findreplace",this._lc("Find and Replace"),_1.imgURL("ed_find.gif","FindReplace"),false,function(_4){
+_3.buttonPress(_4);
+});
+_2.addToolbarElement(["FR-findreplace","separator"],["formatblock","fontsize","fontname"],-1);
+}
+FindReplace.prototype.buttonPress=function(_5){
+FindReplace.editor=_5;
+var _6=_5.getSelectedHTML();
+if(/\w/.test(_6)){
+_6=_6.replace(/<[^>]*>/g,"");
+_6=_6.replace(/&nbsp;/g,"");
+}
+var _7=/\w/.test(_6)?{fr_pattern:_6}:null;
+_5._popupDialog("plugin://FindReplace/find_replace",null,_7);
+};
+FindReplace._pluginInfo={name:"FindReplace",version:"1.0 - beta",developer:"Cau Guanabara",developer_url:"mailto:caugb@ibest.com.br",c_owner:"Cau Guanabara",sponsor:"Independent production",sponsor_url:"http://www.netflash.com.br/gb/HA3-rc1/examples/find-replace.html",license:"htmlArea"};
+FindReplace.prototype._lc=function(_8){
+return Xinha._lc(_8,"FindReplace");
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FindReplace/fr_engine.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FindReplace/fr_engine.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,147 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/FindReplace/fr_engine.js */
+var FindReplace=window.opener.FindReplace;
+var editor=FindReplace.editor;
+var is_mo=window.opener.Xinha.is_gecko;
+var tosearch="";
+var pater=null;
+var buffer=null;
+var matches=0;
+var replaces=0;
+var fr_spans=new Array();
+function _lc(_1){
+return (window.opener.Xinha._lc(_1,"FindReplace"));
+}
+function execSearch(_2){
+var _3=editor._doc.body.innerHTML;
+if(buffer==null){
+buffer=_3;
+}
+if(_2["fr_pattern"]!=tosearch){
+if(tosearch!=""){
+clearDoc();
+}
+tosearch=_2["fr_pattern"];
+}
+if(matches==0){
+er=_2["fr_words"]?"/(?!<[^>]*)(\\b"+_2["fr_pattern"]+"\\b)(?![^<]*>)/g":"/(?!<[^>]*)("+_2["fr_pattern"]+")(?![^<]*>)/g";
+if(!_2["fr_matchcase"]){
+er+="i";
+}
+pater=eval(er);
+var _4="<span id=frmark>";
+var _5="</span>";
+var _6=_3.replace(pater,_4+"$1"+_5);
+editor.setHTML(_6);
+var _7=editor._doc.body.getElementsByTagName("span");
+for(var i=0;i<_7.length;i++){
+if(/^frmark/.test(_7[i].id)){
+fr_spans.push(_7[i]);
+}
+}
+}
+spanWalker(_2["fr_pattern"],_2["fr_replacement"],_2["fr_replaceall"]);
+}
+function spanWalker(_9,_a,_b){
+var _c=false;
+clearMarks();
+for(var i=matches;i<fr_spans.length;i++){
+var _e=fr_spans[i];
+_c=true;
+if(!(/[0-9]$/.test(_e.id))){
+matches++;
+disab("fr_clear",false);
+_e.id="frmark_"+matches;
+_e.style.color="white";
+_e.style.backgroundColor="highlight";
+_e.style.fontWeight="bold";
+_e.scrollIntoView(false);
+if(/\w/.test(_a)){
+if(_b||confirm(_lc("Substitute this occurrence?"))){
+_e.firstChild.replaceData(0,_e.firstChild.data.length,_a);
+replaces++;
+disab("fr_undo",false);
+}
+if(_b){
+clearMarks();
+continue;
+}
+}
+break;
+}
+}
+var _f=(i>=fr_spans.length-1);
+if(_f||!_c){
+var _10=_lc("Done")+":\n\n";
+if(matches>0){
+if(matches==1){
+_10+=matches+" "+_lc("found item");
+}else{
+_10+=matches+" "+_lc("found items");
+}
+if(replaces>0){
+if(replaces==1){
+_10+=",\n"+replaces+" "+_lc("replaced item");
+}else{
+_10+=",\n"+replaces+" "+_lc("replaced items");
+}
+}
+hiliteAll();
+disab("fr_hiliteall",false);
+}else{
+_10+="\""+_9+"\" "+_lc("not found");
+}
+alert(_10+".");
+}
+}
+function clearDoc(){
+var doc=editor._doc.body.innerHTML;
+var er=/(<span\s+[^>]*id=.?frmark[^>]*>)([^<>]*)(<\/span>)/gi;
+editor._doc.body.innerHTML=doc.replace(er,"$2");
+pater=null;
+tosearch="";
+fr_spans=new Array();
+matches=0;
+replaces=0;
+disab("fr_hiliteall,fr_clear",true);
+}
+function clearMarks(){
+var _13=editor._doc.body.getElementsByTagName("span");
+for(var i=0;i<_13.length;i++){
+var elm=_13[i];
+if(/^frmark/.test(elm.id)){
+var _16=editor._doc.getElementById(elm.id).style;
+_16.backgroundColor="";
+_16.color="";
+_16.fontWeight="";
+}
+}
+}
+function hiliteAll(){
+var _17=editor._doc.body.getElementsByTagName("span");
+for(var i=0;i<_17.length;i++){
+var elm=_17[i];
+if(/^frmark/.test(elm.id)){
+var _1a=editor._doc.getElementById(elm.id).style;
+_1a.backgroundColor="highlight";
+_1a.color="white";
+_1a.fontWeight="bold";
+}
+}
+}
+function resetContents(){
+if(buffer==null){
+return;
+}
+var _1b=editor._doc.body.innerHTML;
+editor._doc.body.innerHTML=buffer;
+buffer=_1b;
+}
+function disab(_1c,_1d){
+var _1e=_1c.split(/[,; ]+/);
+for(var i=0;i<_1e.length;i++){
+document.getElementById(_1e[i]).disabled=_1d;
+}
+}
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FindReplace/img/ed_find.gif
Binary file Xinha_0.95/plugins/FindReplace/img/ed_find.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FindReplace/lang/de.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FindReplace/lang/de.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,27 @@
+// I18N constants
+// LANG: "de", ENCODING: UTF-8
+// translated: Udo Schmal (gocher), http://www.schaffrath-neuemedien.de/, udo.schmal@t-online.de
+{
+  // messages
+  "Substitute this occurrence?": "Treffer ersetzen?",
+  "Enter the text you want to find": "Geben Sie einen Text ein den Sie finden mchten",
+  "Inform a replacement word": "Geben sie einen Text zum ersetzen ein",
+  "found items": "alle Treffer",
+  "replaced items": "ersetzte Treffer",
+  "found item": "Treffer",
+  "replaced item": "ersetzter Treffer",
+  "not found": "kein Teffer",
+  // window
+  "Find and Replace": "Suchen und ersetzen",
+  "Search for:": "Suchen nach:",
+  "Replace with:": "Ersetzen durch:",
+  "Options": "Optionen",
+  "Whole words only": "Ganze Wrter",
+  "Case sensitive search": "Gro-/Kleinschreibung",
+  "Substitute all occurrences": "alle Treffer ersetzen",
+  "Clear": "Nchstes ersetzen",
+  "Highlight": "Hervorheben",
+  "Undo": "Rckgngig",
+  "Next": "Nchster",
+  "Done": "Fertig"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FindReplace/lang/fr.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FindReplace/lang/fr.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,26 @@
+// I18N constants
+// LANG: "fr", ENCODING: UTF-8
+{
+  // messages
+  "Substitute this occurrence?": "Remplacer cette occurrence ?",
+  "Enter the text you want to find": "Texte  trouver",
+  "Inform a replacement word": "Indiquez un mot de remplacement",
+  "found items": "lments trouvs",
+  "replaced items": "lments remplacs",
+  "found item": "lment trouv",
+  "replaced item": "lment remplac",
+  "not found": "non trouv",
+  // window
+  "Find and Replace": "Chercher et Remplacer",
+  "Search for:": "Chercher",
+  "Replace with:": "Remplacer par",
+  "Options": "Options",
+  "Whole words only": "Mots entiers seulement",
+  "Case sensitive search": "Recherche sensible  la casse",
+  "Substitute all occurrences": "Remplacer toutes les occurences",
+  "Clear": "Effacer",
+  "Highlight": "Surligner",
+  "Undo": "Annuler",
+  "Next": "Suivant",
+  "Done": "Fin"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FindReplace/lang/ja.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FindReplace/lang/ja.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,26 @@
+// I18N constants
+// LANG: "ja", ENCODING: UTF-8
+{
+  // messages
+  "Substitute this occurrence?": "?",
+  "Enter the text you want to find": "",
+  "Inform a replacement word": "",
+  "found items": "",
+  "replaced items": "",
+  "found item": "",
+  "replaced item": "",
+  "not found": "",
+  // window
+  "Find and Replace": "/",
+  "Search for:": ":",
+  "Replace with:": ":",
+  "Options": "",
+  "Whole words only": "",
+  "Case sensitive search": "/",
+  "Substitute all occurrences": "",
+  "Clear": "",
+  "Highlight": "",
+  "Undo": "",
+  "Next": "",
+  "Done": ""
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FindReplace/lang/nb.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FindReplace/lang/nb.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,27 @@
+// I18N constants
+// LANG: "nb", ENCODING: UTF-8
+// translated: Kim Steinhaug, http://www.steinhaug.com/, kim@steinhaug.com
+{
+  // messages
+  "Substitute this occurrence?": "Vennligst bekreft at du vil erstatte?",
+  "Enter the text you want to find": "Skriv inn teksten du nsker  finne",
+  "Inform a replacement word": "Vennligst skriv inn et erstatningsord / setning",
+  "found items": "forekomster funnet i sket",
+  "replaced items": "forekomster erstattet",
+  "found item": "Treff",
+  "replaced item": "erstattet treff",
+  "not found": "ikke funnet",
+  // window
+  "Find and Replace": "Sk og erstatt",
+  "Search for:": "Sk etter:",
+  "Replace with:": "Erstatt med:",
+  "Options": "Valg", 
+  "Whole words only": "Bare hele ord",
+  "Case sensitive search": "Skille mellom store og sm bokstaver",
+  "Substitute all occurrences": "Erstatt alle treff",
+  "Clear": "Tm",
+  "Highlight": "Uthev",
+  "Undo": "Tilbake",
+  "Next": "Neste",
+  "Done": "Ferdig"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FindReplace/lang/nl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FindReplace/lang/nl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,27 @@
+// I18N constants
+// LANG: "nl", ENCODING: UTF-8
+// Author: Maarten Molenschot, maarten@nrgmm.nl
+{
+  // messages
+  "Substitute this occurrence?": "Deze overeenkomst vervangen?",
+  "Enter the text you want to find": "Voer tekst in waar je op wilt zoeken",
+  "Inform a replacement word": "Voer een vervang woord of zin in",
+  "found items": "gevonden overeenkomsten",
+  "replaced items": "vervangen items",
+  "found item": "gevonden overeenkomst",
+  "replaced item": "vervangen item",
+  "not found": "niet gevonden",
+  // window
+  "Find and Replace": "Zoek en vervang",
+  "Search for:": "Zoek naar:",
+  "Replace with:": "Vervang met:",
+  "Options": "Opties", 
+  "Whole words only": "Alleen hele woorden",
+  "Case sensitive search": "Exact zoeken",
+  "Substitute all occurrences": "Vervang alle overeenkomsten",
+  "Clear": "Leeg",
+  "Highlight": "Markeren",
+  "Undo": "Ongedaan maken",
+  "Next": "Volgende",
+  "Done": "Voltooien"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FindReplace/lang/pl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FindReplace/lang/pl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,27 @@
+// I18N constants
+// LANG: "pl", ENCODING: UTF-8
+// translated: Krzysztof Kotowicz, koto1sa@o2.pl, http://www.eskot.krakow.pl/portfolio
+{
+  // messages
+  "Substitute this occurrence?": "Zamieni to wystpienie?",
+  "Enter the text you want to find": "Podaj tekst, jaki chcesz wyszuka",
+  "Inform a replacement word": "Podaj tekst do zamiany",
+  "found items": "znalezionych",
+  "replaced items": "zamienionych",
+  "found item": "znaleziony",
+  "replaced item": "zamieniony",
+  "not found": "nie znaleziony",
+  // window
+  "Find and Replace": "Znajd i zamie",
+  "Search for:": "Szukaj:",
+  "Replace with:": "Zamie na:",
+  "Options": "Opcje",
+  "Whole words only": "Cae sowa",
+  "Case sensitive search": "Wg wielkoci liter",
+  "Substitute all occurrences": "Zamie wszystkie wystpienia",
+  "Clear": "Wyczy",
+  "Highlight": "Podwietl",
+  "Undo": "Cofnij",
+  "Next": "Nastpny",
+  "Done": "Gotowe"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FindReplace/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FindReplace/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,41 @@
+// I18N constants
+//
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+//
+// Initial basic translation
+// Author: Cau guanabara (independent developer), caugb@ibest.com.br
+//
+// Final translation
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+//
+// Last revision: 06 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+//
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "Case sensitive search": "Procura diferenciada Maisculas/Minsculas",
+  "Clear": "Limpar",
+  "Done": "Executado",
+  "Enter the text you want to find": "Fornea o texto que deseja procurar",
+  "Find and Replace": "Procurar e Substituir",
+  "Highlight": "Marcar",
+  "Inform a replacement word": "Informe uma palavra para substituir",
+  "Next": "Prxima",
+  "Options": "Opes",
+  "Replace with:": "Substituir por:",
+  "Search for:": "Procurar por:",
+  "Substitute all occurrences": "Substituir todas as ocorrncias",
+  "Substitute this occurrence?": "Substituir todas as ocorrncias?",
+  "Undo": "Desfazer",
+  "Whole words only": "Apenas palavras inteiras",
+  "found item": "Item encontrado",
+  "found items": "Itens encontrados",
+  "not found": "nada encontrado",
+  "replaced item": "substituir item",
+  "replaced items": "substituir itens"
+}
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FindReplace/lang/ru.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FindReplace/lang/ru.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,28 @@
+// I18N constants
+// LANG: "ru", ENCODING: UTF-8
+// Author: Andrei Blagorazumov, a@fnr.ru
+
+{
+  // messages
+  "Substitute this occurrence?": "  ?",
+  "Enter the text you want to find": " ,    ",
+  "Inform a replacement word": "  ",
+  "found items": "",
+  "replaced items": "",
+  "found item": "",
+  "replaced item": "",
+  "not found": " ",
+  // window
+  "Find and Replace": "  ",
+  "Search for:": "",
+  "Replace with:": " ",
+  "Options": "",
+  "Whole words only": "  ",
+  "Case sensitive search": "   ",
+  "Substitute all occurrences": "  ",
+  "Clear": "",
+  "Highlight": "",
+  "Undo": "",
+  "Next": ".",
+  "Done": "OK"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FindReplace/lang/sv.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FindReplace/lang/sv.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,27 @@
+// I18N constants
+// LANG: "sv" (Swedish), ENCODING: UTF-8
+// translated: Erik Daln, <dalen@jpl.se>
+{
+  // messages
+  "Substitute this occurrence?": "Erstt denna?",
+  "Enter the text you want to find": "Skriv in text du vill ska",
+  "Inform a replacement word": "Skriv in ett ersttningsord",
+  "found items": "frekomster funna i skningen",
+  "replaced items": "frekomster erstatta",
+  "found item": "Trff",
+  "replaced item": "erstatt trff",
+  "not found": "inte funnet",
+  // window
+  "Find and Replace": "Sk och erstt",
+  "Search for:": "Sk efter:",
+  "Replace with:": "Erstt med:",
+  "Options": "Vlj", 
+  "Whole words only": "Bara hela ord",
+  "Case sensitive search": "Skilj mellan stora och sm bokstver",
+  "Substitute all occurrences": "Erstatt alla trffar",
+  "Clear": "Tm",
+  "Highlight": "Markera",
+  "Undo": "Tillbaka",
+  "Next": "Nsta",
+  "Done": "Frdig"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FindReplace/popups/find_replace.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FindReplace/popups/find_replace.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,162 @@
+<html>
+<head>
+  <title>Find and Replace</title>
+<!--
+/*---------------------------------------*\
+ Find and Replace Plugin for HTMLArea-3.0
+ -----------------------------------------
+ author: Cau guanabara 
+ e-mail: caugb@ibest.com.br
+\*---------------------------------------*/
+-->
+<script type="text/javascript" src="../fr_engine.js"></script>
+<script type="text/javascript" src="../../../popups/popup.js"></script>
+<link rel="stylesheet" type="text/css" href="../../../popups/popup.css" />
+
+<script type="text/javascript">
+
+window.resizeTo(335, 250);
+
+var accepted = {
+                'fr_pattern'       : true,
+                'fr_replacement'   : true,
+                'fr_words'         : true,
+                'fr_matchcase'     : true,
+                'fr_replaceall'    : true
+               };
+
+function Init() {
+__dlg_translate('FindReplace');
+__dlg_init();
+
+disab("fr_undo,fr_clear,fr_hiliteall",true);
+
+var params = window.dialogArguments;
+  if(params) {
+  document.getElementById('fr_pattern').value = params["fr_pattern"];
+  document.getElementById('fr_replacement').focus();
+  } else {
+  document.getElementById('fr_pattern').focus();
+  }
+  
+document.body.onkeypress = __dlg_key_press;
+}
+
+function onCancel() {
+  clearDoc();
+  __dlg_close(null);
+  return false;
+}
+
+function onOK() {
+  var required = {'fr_pattern' : _lc("Enter the text you want to find")};
+  for (var i in required) {
+    var el = document.getElementById(i);
+      if (!el.value) {
+        alert(required[i]);
+        el.focus();
+        return false;
+      }
+  }
+
+  var param = {};
+  for (var i in accepted) {
+  var el = document.getElementById(i);
+  param[i] = el.type == 'checkbox' ? el.checked : el.value;
+  }
+  execSearch(param);
+  return false;
+}
+
+function __dlg_key_press(ev) {
+ev || (ev = window.event);
+  switch(ev.keyCode) {
+    case 13:
+    document.getElementById('fr_go').click();
+    document.getElementById('fr_pattern').focus();
+      break;
+    case 27:
+    clearDoc();
+    window.close();
+    return false;
+  }
+return true;
+}
+
+</script>
+
+<style type="text/css">
+table .label { text-align: right; width: 12em; }
+.title {
+background: #ddf;
+color: #000;
+font-weight: bold;
+font-size: 120%;
+padding: 3px 10px;
+margin-bottom: 10px;
+border-bottom: 1px solid black;
+letter-spacing: 2px;
+}
+.buttons { border-top: 1px solid #999; padding: 2px; text-align: right; }
+.hrstyle { border-width: 1px; border-color: #666; width: 95%; padding: 2px; }
+</style>
+  </head>
+  <body class="dialog" onload="Init()">
+  <div class="title">Find and Replace</div>
+  <form action="" method="get">
+  <table border="0" style="width: 100%; padding: 2px;"><!---->
+    <tbody>
+      <tr> 
+        <td width="29%" style="text-align: right; vertical-align: bottom;">Search for:</td>
+        <td width="71%" colspan="2" style="vertical-align: bottom;"> 
+        <input id="fr_pattern" type="text" style="width: 200px" onFocus="this.select();"> 
+        </td>
+      </tr>
+      <tr> 
+        <td style="text-align: right;">Replace with:</td>
+        <td colspan="2"> 
+        <input id="fr_replacement" type="text" style="width: 200px" onFocus="this.select();"> 
+        </td>
+      </tr>
+      <tr> 
+        <td colspan="3"><table width="100%" border="0" cellpadding="1" cellspacing="0">
+            <tr> 
+              <td width="78%" style="padding: 2px">
+              <FIELDSET style="width:90%; padding: 5px">
+                <LEGEND><span>Options</span></LEGEND>
+                  <input id="fr_words" type="checkbox" checked onClick="clearDoc();">
+                <span onClick="e = document.getElementById('fr_words'); 
+                e.click(); e.focus();" style="cursor:default"> 
+                  <span>Whole words only</span></span><br />
+                  <input id="fr_matchcase" type="checkbox" onClick="clearDoc();">
+                <span onClick="e = document.getElementById('fr_matchcase'); 
+                e.click(); e.focus();" style="cursor:default"> 
+                  <span>Case sensitive search</span></span><br />
+                  <input id="fr_replaceall" type="checkbox" onClick="
+                  if(document.getElementById('fr_replacement').value == '') {
+                  alert(_lc('Inform a replacement word'));
+                  return false;
+                  }
+                  clearDoc();">
+                <span onClick="e = document.getElementById('fr_replaceall'); 
+                e.click(); e.focus();" style="cursor:default"> 
+                  <span>Substitute all occurrences</span></span>
+                </FIELDSET></td>
+<td width="22%" style="vertical-align: bottom; text-align: right; padding: 4px"> 
+<button type="button" id="fr_clear" onClick="clearMarks()">Clear</button>
+<div class="space"></div>
+<button type="button" id="fr_hiliteall" onClick="hiliteAll()">Highlight</button>
+<div class="space"></div>
+<button type="button" id="fr_undo" onClick="resetContents();">Undo</button>
+</td>
+            </tr>
+          </table></td>
+      </tr>
+    </tbody>
+  </table>
+<div style="border-top: 1px solid #999; padding: 2px; padding: 5px; text-align: right; height: 20px"><button type="button" id="fr_go" onclick="return onOK();">Next</button>
+<button type="button" name="cancel" onclick="return onCancel();">Done</button>
+</div>
+</form>
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FormOperations/default_form.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FormOperations/default_form.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,36 @@
+<form>
+  <table class="contact_form">
+    <caption>Contact Us</caption>
+    <tbody>
+      <tr>
+        <th>Your name:</th>
+        <td><input type="text" name="Name" value="" /></td>
+      </tr>
+      <tr>
+        <th>Your email:</th>
+        <td><input type="text" name="Email" value="" /></td>
+      </tr>
+      <tr>
+        <th>Message Subject:</th>
+        <td><input type="text" name="Subject" value="" /></td>
+      </tr>
+      <tr>
+        <th>What are your hobbies?</th>
+        <td>
+          <input type="checkbox" value="Marbles" name="Hobbies[]" /> Marbles <br />
+          <input type="checkbox" value="Conkers" name="Hobbies[]" /> Conkers <br />
+          <input type="checkbox" value="Jacks" name="Hobbies[]" /> Jacks
+        </td>
+      </tr>
+      <tr>
+        <th>Message Body:</th>
+      </tr>
+      <tr>
+        <td colspan="2">
+          <textarea name="Message"> </textarea>
+        </td>
+      </tr>
+    </tbody>
+  </table>
+  <input type="submit" value="Send" /> &nbsp;&nbsp; <input type="reset" value="Reset" />
+</form>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FormOperations/form-operations.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FormOperations/form-operations.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,435 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/FormOperations/form-operations.js */
+Xinha.Config.prototype.FormOperations={"multiple_field_format":"php","allow_edit_form":false,"default_form_action":Xinha.getPluginDir("FormOperations")+"/formmail.php","default_form_html":Xinha._geturlcontent(Xinha.getPluginDir("FormOperations")+"/default_form.html")};
+FormOperations._pluginInfo={name:"FormOperations",version:"1.0",developer:"James Sleeman",developer_url:"http://www.gogo.co.nz/",c_owner:"Gogo Internet Services",license:"htmlArea",sponsor:"Gogo Internet Services",sponsor_url:"http://www.gogo.co.nz/"};
+function FormOperations(_1){
+this.editor=_1;
+this.panel=false;
+this.html=false;
+this.ready=false;
+this.activeElement=null;
+this._preparePanel();
+_1.config.pageStyleSheets.push(Xinha.getPluginDir("FormOperations")+"/iframe.css");
+var _2=["separator","insert_form","insert_text_field","insert_textarea_field","insert_select_field","insert_cb_field","insert_rb_field","insert_button"];
+this.editor.config.toolbar.push(_2);
+function pasteAndSelect(_3){
+var id=Xinha.uniq("fo");
+_3=_3.replace(/^<([^ \/>]+)/i,"<$1 id=\""+id+"\"");
+_1.insertHTML(_3);
+var el=_1._doc.getElementById(id);
+el.setAttribute("id","");
+_1.selectNodeContents(el);
+_1.updateToolbar();
+return el;
+}
+var _6=_1.imgURL("buttons.gif","FormOperations");
+FormOperations.prototype._lc=function(_7){
+return Xinha._lc(_7,"FormOperations");
+};
+this.editor.config.btnList.insert_form=[this._lc("Insert a Form."),[_6,0,0],false,function(){
+var _8=null;
+if(_1.config.FormOperations.default_form_html){
+_8=pasteAndSelect(_1.config.FormOperations.default_form_html);
+}else{
+_8=pasteAndSelect("<form>&nbsp;</form>");
+}
+if(_1.config.FormOperations.default_form_action&&!_8.action){
+_8.action=_1.config.FormOperations.default_form_action;
+}
+}];
+this.editor.config.btnList.insert_text_field=[this._lc("Insert a text, password or hidden field."),[_6,1,0],false,function(){
+pasteAndSelect("<input type=\"text\" />");
+},"form"];
+this.editor.config.btnList.insert_textarea_field=[this._lc("Insert a multi-line text field."),[_6,2,0],false,function(){
+pasteAndSelect("<textarea> </textarea>");
+},"form"];
+this.editor.config.btnList.insert_select_field=[this._lc("Insert a select field."),[_6,3,0],false,function(){
+pasteAndSelect("<select> <option value=\"\">Please Select...</option> </select>");
+},"form"];
+this.editor.config.btnList.insert_cb_field=[this._lc("Insert a check box."),[_6,4,0],false,function(){
+pasteAndSelect("<input type=\"checkbox\" />");
+},"form"];
+this.editor.config.btnList.insert_rb_field=[this._lc("Insert a radio button."),[_6,5,0],false,function(){
+pasteAndSelect("<input type=\"radio\" />");
+},"form"];
+this.editor.config.btnList.insert_button=[this._lc("Insert a submit/reset button."),[_6,6,0],false,function(){
+pasteAndSelect("<input type=\"submit\" value=\"Send\" />");
+},"form"];
+}
+FormOperations.prototype.onGenerate=function(){
+if(Xinha.is_gecko){
+var _9=this.editor;
+var _a=this.editor._doc;
+Xinha._addEvents(_a,["mousemove"],function(_b){
+return _9._editorEvent(_b);
+});
+}
+};
+FormOperations.prototype._preparePanel=function(){
+var fo=this;
+if(this.html==false){
+Xinha._getback(Xinha.getPluginDir("FormOperations")+"/panel.html",function(_d){
+fo.html=_d;
+fo._preparePanel();
+});
+return false;
+}
+if(typeof Xinha.Dialog=="undefined"){
+Xinha._loadback(_editor_url+"modules/Dialogs/inline-dialog.js",function(){
+fo._preparePanel();
+});
+return false;
+}
+if(typeof Xinha.PanelDialog=="undefined"){
+Xinha._loadback(_editor_url+"modules/Dialogs/panel-dialog.js",function(){
+fo._preparePanel();
+});
+return false;
+}
+this.panel=new Xinha.PanelDialog(this.editor,"bottom",this.html,"FormOperations");
+this.panel.hide();
+this.ready=true;
+};
+FormOperations.prototype.onUpdateToolbar=function(){
+if(!this.ready){
+return true;
+}
+var _e=this.editor._activeElement(this.editor._getSelection());
+if(_e!=null){
+if(_e==this.activeElement){
+return true;
+}
+var _f=_e.tagName.toLowerCase();
+this.hideAll();
+if(_f==="form"){
+if(this.editor.config.FormOperations.allow_edit_form){
+this.showForm(_e);
+}else{
+this.panel.hide();
+this.activeElement=null;
+this.panel.hide();
+return true;
+}
+}else{
+if(this.editor.config.FormOperations.allow_edit_form&&typeof _e.form!="undefined"&&_e.form){
+this.showForm(_e.form);
+}
+switch(_f){
+case "form":
+this.showForm(_e);
+break;
+case "input":
+switch(_e.getAttribute("type").toLowerCase()){
+case "text":
+case "password":
+case "hidden":
+this.showText(_e);
+break;
+case "radio":
+case "checkbox":
+this.showCbRd(_e);
+break;
+case "submit":
+case "reset":
+case "button":
+this.showButton(_e);
+break;
+}
+break;
+case "textarea":
+this.showTextarea(_e);
+break;
+case "select":
+this.showSelect(_e);
+break;
+default:
+this.activeElement=null;
+this.panel.hide();
+return true;
+}
+}
+this.panel.show();
+this.activeElement=_e;
+return true;
+}else{
+this.activeElement=null;
+this.panel.hide();
+return true;
+}
+};
+FormOperations.prototype.hideAll=function(){
+this.panel.getElementById("fs_form").style.display="none";
+this.panel.getElementById("fs_text").style.display="none";
+this.panel.getElementById("fs_textarea").style.display="none";
+this.panel.getElementById("fs_select").style.display="none";
+this.panel.getElementById("fs_cbrd").style.display="none";
+this.panel.getElementById("fs_button").style.display="none";
+};
+FormOperations.prototype.showForm=function(_10){
+this.panel.getElementById("fs_form").style.display="";
+var _11={"action":_10.action,"method":_10.method.toUpperCase()};
+this.panel.setValues(_11);
+var f=_10;
+this.panel.getElementById("action").onkeyup=function(){
+f.action=this.value;
+};
+this.panel.getElementById("method").onchange=function(){
+f.method=this.options[this.selectedIndex].value;
+};
+};
+FormOperations.prototype.showText=function(_13){
+this.panel.getElementById("fs_text").style.display="";
+var _14={"text_name":this.deformatName(_13,_13.name),"text_value":_13.value,"text_type":_13.type.toLowerCase(),"text_width":_13.style.width?parseFloat(_13.style.width.replace(/[^0-9.]/,"")):"","text_width_units":_13.style.width?_13.style.width.replace(/[0-9.]/,"").toLowerCase():"ex","text_maxlength":_13.maxlength?_13.maxlength:""};
+this.panel.setValues(_14);
+var i=_13;
+var fo=this;
+this.panel.getElementById("text_name").onkeyup=function(){
+i.name=fo.formatName(i,this.value);
+};
+this.panel.getElementById("text_value").onkeyup=function(){
+i.value=this.value;
+};
+this.panel.getElementById("text_type").onchange=function(){
+if(!Xinha.is_ie){
+i.type=this.options[this.selectedIndex].value;
+}else{
+var _17=fo.editor._doc.createElement("div");
+if(!/type=/.test(i.outerHTML)){
+_17.innerHTML=i.outerHTML.replace(/<INPUT/i,"<input type=\""+this.options[this.selectedIndex].value+"\"");
+}else{
+_17.innerHTML=i.outerHTML.replace(/type="?[a-z]+"?/i,"type=\""+this.options[this.selectedIndex].value+"\"");
+}
+var _18=Xinha.removeFromParent(_17.childNodes[0]);
+i.parentNode.insertBefore(_18,i);
+Xinha.removeFromParent(i);
+_13=i=_18;
+}
+};
+var w=this.panel.getElementById("text_width");
+var wu=this.panel.getElementById("text_width_units");
+this.panel.getElementById("text_width").onkeyup=this.panel.getElementById("text_width_units").onchange=function(){
+if(!w.value||isNaN(parseFloat(w.value))){
+i.style.width="";
+}
+i.style.width=parseFloat(w.value)+wu.options[wu.selectedIndex].value;
+};
+this.panel.getElementById("text_maxlength").onkeyup=function(){
+i.maxlength=this.value;
+};
+};
+FormOperations.prototype.showCbRd=function(_1b){
+this.panel.getElementById("fs_cbrd").style.display="";
+var _1c={"cbrd_name":this.deformatName(_1b,_1b.name),"cbrd_value":_1b.value,"cbrd_checked":_1b.checked?1:0,"cbrd_type":_1b.type.toLowerCase()};
+this.panel.setValues(_1c);
+var i=_1b;
+var fo=this;
+this.panel.getElementById("cbrd_name").onkeyup=function(){
+i.name=fo.formatName(i,this.value);
+};
+this.panel.getElementById("cbrd_value").onkeyup=function(){
+i.value=this.value;
+};
+this.panel.getElementById("cbrd_type").onchange=function(){
+if(!Xinha.is_ie){
+i.type=this.options[this.selectedIndex].value;
+}else{
+var _1f=fo.editor._doc.createElement("div");
+if(!/type=/.test(i.outerHTML)){
+_1f.innerHTML=i.outerHTML.replace(/<INPUT/i,"<input type=\""+this.options[this.selectedIndex].value+"\"");
+}else{
+_1f.innerHTML=i.outerHTML.replace(/type="?[a-z]+"?/i,"type=\""+this.options[this.selectedIndex].value+"\"");
+}
+var _20=Xinha.removeFromParent(_1f.childNodes[0]);
+i.parentNode.insertBefore(_20,i);
+Xinha.removeFromParent(i);
+_1b=i=_20;
+}
+};
+this.panel.getElementById("cbrd_checked").onclick=function(){
+i.checked=this.checked;
+};
+};
+FormOperations.prototype.showButton=function(_21){
+this.panel.getElementById("fs_button").style.display="";
+var _22={"button_name":this.deformatName(_21,_21.name),"button_value":_21.value,"button_type":_21.type.toLowerCase()};
+this.panel.setValues(_22);
+var i=_21;
+var fo=this;
+this.panel.getElementById("button_name").onkeyup=function(){
+i.name=fo.formatName(i,this.value);
+};
+this.panel.getElementById("button_value").onkeyup=function(){
+i.value=this.value;
+};
+this.panel.getElementById("button_type").onchange=function(){
+if(!Xinha.is_ie){
+i.type=this.options[this.selectedIndex].value;
+}else{
+var _25=fo.editor._doc.createElement("div");
+if(!/type=/.test(i.outerHTML)){
+_25.innerHTML=i.outerHTML.replace(/<INPUT/i,"<input type=\""+this.options[this.selectedIndex].value+"\"");
+}else{
+_25.innerHTML=i.outerHTML.replace(/type="?[a-z]+"?/i,"type=\""+this.options[this.selectedIndex].value+"\"");
+}
+var _26=Xinha.removeFromParent(_25.childNodes[0]);
+i.parentNode.insertBefore(_26,i);
+Xinha.removeFromParent(i);
+_21=i=_26;
+}
+};
+};
+FormOperations.prototype.showTextarea=function(_27){
+this.panel.getElementById("fs_textarea").style.display="";
+var _28={"textarea_name":this.deformatName(_27,_27.name),"textarea_value":_27.value,"textarea_width":_27.style.width?parseFloat(_27.style.width.replace(/[^0-9.]/,"")):"","textarea_width_units":_27.style.width?_27.style.width.replace(/[0-9.]/,"").toLowerCase():"ex","textarea_height":_27.style.height?parseFloat(_27.style.height.replace(/[^0-9.]/,"")):"","textarea_height_units":_27.style.height?_27.style.height.replace(/[0-9.]/,"").toLowerCase():"ex"};
+this.panel.setValues(_28);
+var i=_27;
+var fo=this;
+this.panel.getElementById("textarea_name").onkeyup=function(){
+i.name=fo.formatName(i,this.value);
+};
+this.panel.getElementById("textarea_value").onkeyup=function(){
+i.value=i.innerHTML=this.value;
+};
+var w=this.panel.getElementById("textarea_width");
+var wu=this.panel.getElementById("textarea_width_units");
+this.panel.getElementById("textarea_width").onkeyup=this.panel.getElementById("textarea_width_units").onchange=function(){
+if(!w.value||isNaN(parseFloat(w.value))){
+i.style.width="";
+}
+i.style.width=parseFloat(w.value)+wu.options[wu.selectedIndex].value;
+};
+var h=this.panel.getElementById("textarea_height");
+var hu=this.panel.getElementById("textarea_height_units");
+this.panel.getElementById("textarea_height").onkeyup=this.panel.getElementById("textarea_height_units").onchange=function(){
+if(!h.value||isNaN(parseFloat(h.value))){
+i.style.height="";
+}
+i.style.height=parseFloat(h.value)+hu.options[hu.selectedIndex].value;
+};
+};
+FormOperations.prototype.showSelect=function(_2f){
+this.panel.getElementById("fs_select").style.display="";
+var _30={"select_name":this.deformatName(_2f,_2f.name),"select_multiple":_2f.multiple?1:0,"select_width":_2f.style.width?parseFloat(_2f.style.width.replace(/[^0-9.]/,"")):"","select_width_units":_2f.style.width?_2f.style.width.replace(/[0-9.]/,"").toLowerCase():"ex","select_height":_2f.style.height?parseFloat(_2f.style.height.replace(/[^0-9.]/,"")):(_2f.size&&_2f.size>0?_2f.size:1),"select_height_units":_2f.style.height?_2f.style.height.replace(/[0-9.]/,"").toLowerCase():"items"};
+this.panel.setValues(_30);
+var i=_2f;
+var fo=this;
+this.panel.getElementById("select_name").onkeyup=function(){
+i.name=fo.formatName(i,this.value);
+};
+this.panel.getElementById("select_multiple").onclick=function(){
+i.multiple=this.checked;
+};
+var w=this.panel.getElementById("select_width");
+var wu=this.panel.getElementById("select_width_units");
+this.panel.getElementById("select_width").onkeyup=this.panel.getElementById("select_width_units").onchange=function(){
+if(!w.value||isNaN(parseFloat(w.value))){
+i.style.width="";
+}
+i.style.width=parseFloat(w.value)+wu.options[wu.selectedIndex].value;
+};
+var h=this.panel.getElementById("select_height");
+var hu=this.panel.getElementById("select_height_units");
+this.panel.getElementById("select_height").onkeyup=this.panel.getElementById("select_height_units").onchange=function(){
+if(!h.value||isNaN(parseFloat(h.value))){
+i.style.height="";
+return;
+}
+if(hu.selectedIndex==0){
+i.style.height="";
+i.size=parseInt(h.value);
+}else{
+i.style.height=parseFloat(h.value)+hu.options[hu.selectedIndex].value;
+}
+};
+var _37=this.panel.getElementById("select_options");
+this.arrayToOpts(this.optsToArray(_2f.options),_37.options);
+this.panel.getElementById("add_option").onclick=function(){
+var txt=prompt(Xinha._lc("Enter the name for new option.","FormOperations"));
+if(txt==null){
+return;
+}
+var _39=new Option(txt);
+var _3a=fo.optsToArray(_37.options);
+if(_37.selectedIndex>=0){
+_3a.splice(_37.selectedIndex,0,_39);
+}else{
+_3a.push(_39);
+}
+fo.arrayToOpts(_3a,_2f.options);
+fo.arrayToOpts(_3a,_37.options);
+};
+this.panel.getElementById("del_option").onclick=function(){
+var _3b=fo.optsToArray(_37.options);
+var _3c=[];
+for(var i=0;i<_3b.length;i++){
+if(_3b[i].selected){
+continue;
+}
+_3c.push(_3b[i]);
+}
+fo.arrayToOpts(_3c,_2f.options);
+fo.arrayToOpts(_3c,_37.options);
+};
+this.panel.getElementById("up_option").onclick=function(){
+if(!(_37.selectedIndex>0)){
+return;
+}
+var _3e=fo.optsToArray(_37.options);
+var _3f=_3e.splice(_37.selectedIndex,1).pop();
+_3e.splice(_37.selectedIndex-1,0,_3f);
+fo.arrayToOpts(_3e,_2f.options);
+fo.arrayToOpts(_3e,_37.options);
+};
+this.panel.getElementById("down_option").onclick=function(){
+if(_37.selectedIndex==_37.options.length-1){
+return;
+}
+var _40=fo.optsToArray(_37.options);
+var _41=_40.splice(_37.selectedIndex,1).pop();
+_40.splice(_37.selectedIndex+1,0,_41);
+fo.arrayToOpts(_40,_2f.options);
+fo.arrayToOpts(_40,_37.options);
+};
+this.panel.getElementById("select_options").onchange=function(){
+fo.arrayToOpts(fo.optsToArray(_37.options),_2f.options);
+};
+};
+FormOperations.prototype.optsToArray=function(o){
+var a=[];
+for(var i=0;i<o.length;i++){
+a.push({"text":o[i].text,"value":o[i].value,"defaultSelected":o[i].defaultSelected,"selected":o[i].selected});
+}
+return a;
+};
+FormOperations.prototype.arrayToOpts=function(a,o){
+for(var i=o.length-1;i>=0;i--){
+o[i]=null;
+}
+for(var i=0;i<a.length;i++){
+o[i]=new Option(a[i].text,a[i].value,a[i].defaultSelected,a[i].selected);
+}
+};
+FormOperations.prototype.formatName=function(_48,_49){
+var _4a=_49;
+switch(this.editor.config.FormOperations.multiple_field_format){
+case "php":
+_4a+="[]";
+break;
+case "unmodified":
+break;
+default:
+throw ("Unknown multiple field format "+this.editor.config.FormOperations.multiple_field_format);
+}
+if((_48.tagName.toLowerCase()=="select"&&_48.multiple)||(_48.tagName.toLowerCase()=="input"&&_48.type.toLowerCase()=="checkbox")){
+_49=_4a;
+}
+return _49;
+};
+FormOperations.prototype.deformatName=function(_4b,_4c){
+if(this.editor.config.FormOperations.multiple_field_format=="php"){
+_4c=_4c.replace(/\[\]$/,"");
+}
+return _4c;
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FormOperations/formmail.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FormOperations/formmail.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,95 @@
+<?php
+
+  $send_to      = 'Website Enquiries <enquiries@' . preg_replace('/^www./', '', $_SERVER['HTTP_HOST']) . '>';
+
+  $emailfield   = NULL;
+  $subjectfield = NULL;
+  $namefield    = NULL;
+
+  $when_done_goto    = isset($_REQUEST['when_done_goto']) ? $_REQUEST['when_done_goto'] : NULL;
+
+  if($_POST)
+  {
+    unset($_POST['when_done_goto']);
+    $message    = '';
+    $longestKey = 0;
+    foreach(array_keys($_POST) as $key)
+    {
+      $longestKey = max(strlen($key), $longestKey);
+    }
+    $longestKey = max($longestKey, 15);
+
+    foreach($_POST as $Var => $Val)
+    {
+      if(!$emailfield)
+      {
+        if(preg_match('/(^|\s)e-?mail(\s|$)/i', $Var))
+        {
+          $emailfield = $Var;
+        }
+      }
+
+      if(!$subjectfield)
+      {
+        if(preg_match('/(^|\s)subject(\s|$)/i', $Var))
+        {
+          $subjectfield = $Var;
+        }
+      }
+
+      if(!$namefield)
+      {
+        if(preg_match('/(^|\s)from(\s|$)/i', $Var) || preg_match('/(^|\s)name(\s|$)/i', $Var))
+        {
+          $namefield = $Var;
+        }
+      }
+
+      if(is_array($Val))
+      {
+        $Val = implode(', ', $Val);
+      }
+
+      $message .= $Var;
+      if(strlen($Var) < $longestKey)
+      {
+        $message .= str_repeat('.', $longestKey - strlen($Var));
+      }
+      $message .= ':';
+      if((64 - max(strlen($Var), $longestKey) < strlen($Val)) || preg_match('/\r?\n/', $Val))
+      {
+        $message .= "\r\n  ";
+        $message .= preg_replace('/\r?\n/', "\r\n  ", wordwrap($Val, 62));
+      }
+      else
+      {
+        $message .= ' ' . $Val . "\r\n";
+      }
+    }
+
+    $subject = $subjectfield ? $_POST[$subjectfield] : 'Enquiry';
+    $email   = $emailfield   ? $_POST[$emailfield]   :  $send_to;
+    if($namefield)
+    {
+      $from = $_POST[$namefield] . ' <' . $email . '>';
+    }
+    else
+    {
+      $from = 'Website Visitor' . ' <' . $email . '>';
+    }
+
+    mail($send_to, $subject, $message, "From: $from");
+
+    if(!$when_done_goto)
+    {
+      ?>
+      <html><head><title>Message Sent</title></head><body><h1>Message Sent</h1></body></html>
+      <?php
+    }
+    else
+    {
+      header("location: $when_done_goto");
+      exit;
+    }
+  }
+?>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FormOperations/iframe.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FormOperations/iframe.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,1 @@
+form { border: 1px red dotted; }
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FormOperations/img/buttons.gif
Binary file Xinha_0.95/plugins/FormOperations/img/buttons.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FormOperations/lang/de.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FormOperations/lang/de.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,12 @@
+// I18N constants
+// LANG: "de", ENCODING: UTF-8
+// translated: Udo Schmal (gocher), http://www.schaffrath-neuemedien.de/, udo.schmal@t-online.de
+{
+  "Insert a Form.": "Email Form einfgen.",
+  "Insert a text, password or hidden field.": "Passwort oder unsichtbares Feld einfgen.",
+  "Insert a multi-line text field.": "Mehrzeiliges Textfeld einfgen.",
+  "Insert a select field.": "Auswahlfeld einfgen.",
+  "Insert a check box.": "Hkchenfeld einfgen",
+  "Insert a radio button.": "Optionsfeld einfgen",
+  "Insert a submit/reset button.": "Senden/zurcksetzen Schaltflche"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FormOperations/lang/fr.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FormOperations/lang/fr.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,11 @@
+// I18N constants
+// LANG: "fr", ENCODING: UTF-8
+{
+  "Insert a Form.": "Insrer un formulaire",
+  "Insert a text, password or hidden field.": "Insrer un texte, un mot de passe ou un champ invisible",
+  "Insert a multi-line text field.": "Insrer un champ texte  lignes multiples",
+  "Insert a select field.": "Insrer une boite de slection",
+  "Insert a check box.": "Insrer une case  cocher",
+  "Insert a radio button.": "Insrer un bouton radio",
+  "Insert a submit/reset button.": "Insrer un bouton de soumission/annulation"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FormOperations/lang/ja.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FormOperations/lang/ja.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,51 @@
+// I18N constants
+// LANG: "ja", ENCODING: UTF-8
+{
+  "Insert a Form.": "",
+  "Insert a text, password or hidden field.": "//",
+  "Insert a multi-line text field.": "",
+  "Insert a select field.": "",
+  "Insert a check box.": "",
+  "Insert a radio button.": "",
+  "Insert a submit/reset button.": "/",
+  "Form Editor": "",
+  "Form": "",
+  "Text Field": "",
+  "Check Box/Radio Button": "/",
+  "Button": "",
+  "Multi-line Field": "",
+  "Drop-Down/List Field": "/",
+  "Action:": ":",
+  "Method:": ":",
+  "Name:": ":",
+  "Type:": ":",
+  "Label:": ":",
+  "Value:": ":",
+  "Width:": ":",
+  "Height:": ":",
+  "Initial Value:": ":",
+  "Initial Value": "",
+  "Max Length:": ":",
+  "Selected by default:": ":",
+  "May Choose Multiple:": ":",
+  "Options": "",
+  "POST": "POST",
+  "GET": "GET",
+  'Check Box ("Select Many")': "()",
+  'Radio Button ("Select One")': "()",
+  "normal text field": "",
+  "password": "",
+  "hidden field": "",
+  "Submit": "",
+  "Reset": "",
+  "chars": "",
+  "px": "",
+  "%": "%",
+  "items": "",
+  "Add": "",
+  "Delete": "",
+  "Move Up": "",
+  "Move Down": "",
+  "Tip: Check boxes (select many) and radio buttons (select one only) that are choices for a single question should have the same Name to work correctly.": ":()()",
+  "Enter the name for new option.": ""
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FormOperations/lang/nb.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FormOperations/lang/nb.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,12 @@
+// I18N constants
+// LANG: "nb", ENCODING: UTF-8
+// translated: Kim Steinhaug, http://www.steinhaug.com/, kim@steinhaug.com
+{
+  "Insert a Form.": "Sett inn skjema",
+  "Insert a text, password or hidden field.": "Sett inn formfelt",
+  "Insert a multi-line text field.": "Sett inn tekstfelt med flere linjer",
+  "Insert a select field.": "Sett inn valgboks/ netrekksboks",
+  "Insert a check box.": "Hakeboks",
+  "Insert a radio button.": "Sett inn en radioknapp",
+  "Insert a submit/reset button.": "Sett inn send-/nullstill knapp for skjemaet"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FormOperations/lang/nl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FormOperations/lang/nl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,12 @@
+// I18N constants
+// LANG: "nl", ENCODING: UTF-8
+// Author: Maarten Molenschot, maarten@nrgmm.nl
+{
+  "Insert a Form.": "Formulier invoegen",
+  "Insert a text, password or hidden field.": "Tekst, wachtwoord of verborgen veld invoegen",
+  "Insert a multi-line text field.": "Een tekstveld met meerdere lijnen invoegen",
+  "Insert a select field.": "Een selectielijst invoegen",
+  "Insert a check box.": "Een checkbox invoegen",
+  "Insert a radio button.": "Een radio knop invoegen",
+  "Insert a submit/reset button.": "Een verzend/wis knop invoegen"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FormOperations/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FormOperations/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,26 @@
+// I18N constants
+
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+
+// Last revision: 05 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "Enter the name for new option.": "Entre com o nome para nova opo",
+  "Form Editor": "Editor de Formulrios",
+  "Insert a Form.": "Inserir um Formulrio.",
+  "Insert a check box.": "Inserir uma caixa de opo",
+  "Insert a multi-line text field.": "Inserir um texto multi-linha.",
+  "Insert a radio button.": "Inserir um campo de escolha",
+  "Insert a select field.": "Inserir seleo.",
+  "Insert a submit/reset button.": "Inserir um boto de envio/reset",
+  "Insert a text, password or hidden field.": "Inserir um texto, senha ou campo escondido."
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FormOperations/panel.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FormOperations/panel.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,213 @@
+<div>
+<h1 id="[h1]"><l10n>Form Editor</l10n></h1>
+  <fieldset id="[fs_form]">
+    <legend>Form</legend>
+    <table>
+      <tr>
+        <th><label>Action:</label></th>
+        <td><input type="text" size="25" name="[action]" id="[action]" /></td>
+
+        <th><label>Method:</label></th>
+        <td><select name="[method]" id="[method]"><option value="POST">POST</option><option value="GET">GET</option></select></td>
+      </tr>
+    </table>
+  </fieldset>
+
+  <fieldset id="[fs_text]">
+    <legend>Text Field</legend>
+
+    <table>
+      <tr>
+        <th>Name:</th>
+        <td>
+          <input type="text" name="[text_name]" id="[text_name]" size="25" />
+        </td>
+        <th>&nbsp;</th>
+        <td>&nbsp;</td>
+      </tr>
+      <tr>
+        <th>Type:</th>
+        <td>
+          <select name="[text_type]" id="[text_type]">
+            <option value="text">normal text field</option>
+            <option value="password">password</option>
+            <option value="hidden">hidden field</option>
+          </select>
+        </td>
+        <th>Initial Value:</th>
+        <td>
+          <input type="text" name="[text_value]" id="[text_value]" size="25" />
+        </td>
+      </tr>
+      <tr>
+        <th>Width:</th>
+        <td>
+          <input type="text" name="[text_width]" id="[text_width]" size="5" />
+          <select name="[text_width_units]" id="[text_width_units]">
+            <option value="em">chars</option>
+            <option value="px">px</option
+                >
+            <option value="%">%</option>
+          </select>
+        </td>
+        <th>Max Length:</th>
+        <td>
+          <input type="text" name="[text_maxlength]" id="[text_maxlength]"   size="5" />
+        </td>
+      </tr>
+    </table>
+  </fieldset>
+
+  <fieldset  id="[fs_cbrd]">
+    <legend>Check Box/Radio Button</legend>
+    <table>
+      <tr>
+        <th>Name:</th>
+        <td>
+          <input type="text" name="[cbrd_name]" id="[cbrd_name]" size="25" />
+        </td>
+        <th>Value:</th>
+        <td>
+          <input type="text" name="[cbrd_value]" id="[cbrd_value]" size="25" />
+        </td>
+      </tr>
+      <tr>
+        <th>Type:</th>
+        <td>
+          <select name="[cbrd_type]" id="[cbrd_type]">
+            <option value="checkbox">Check Box ("Select Many")</option>
+            <option value="radio">Radio Button ("Select One")</option>
+          </select>
+        </td>
+        <th>Selected by default:</th>
+        <td><input type="checkbox" name="[cbrd_checked]" id="[cbrd_checked]" value="1" /></td>
+      </tr>
+      <tr>
+        <td colspan="4">
+          <p class="help">
+            Tip: Check boxes (select many) and radio buttons (select one only) that are choices for a single question should have the same Name to work correctly.
+          </p>
+        </td>
+      </tr>
+    </table>
+  </fieldset>
+
+  <fieldset  id="[fs_button]">
+    <legend>Button</legend>
+    <table>
+      <tr>
+        <th>Name:</th>
+        <td>
+          <input type="text" name="[button_name]" id="[button_name]" size="25" />
+        </td>
+        <th>Label:</th>
+        <td>
+          <input type="text" name="[button_value]" id="[button_value]" size="25" />
+        </td>
+      </tr>
+      <tr>
+        <th>Type:</th>
+        <td>
+          <select name="[button_type]" id="[button_type]">
+            <option value="submit">Submit</option>
+            <option value="reset">Reset</option>
+          </select>
+        </td>
+        <td>&nbsp;</td>
+        <td>&nbsp;</td>
+      </tr>
+    </table>
+  </fieldset>
+
+
+  <fieldset  id="[fs_textarea]">
+    <legend>Multi-line Field</legend>
+    <table>
+      <tr>
+        <th>Name:</th>
+        <td><input type="text" name="[textarea_name]" id="[textarea_name]" size="25" /></td>
+
+    <th>Initial Value</th>
+      </tr>
+
+      <tr>
+        <th>Width:</th>
+        <td>
+          <input type="text" name="[textarea_width]" id="[textarea_width]" size="5" />
+          <select name="[textarea_width_units]" id="[textarea_width_units]">
+            <option value="em">chars</option>
+            <option value="px">px</option>
+            <option value="%">%</option>
+          </select>
+        </td>
+        <td rowspan="2"><textarea name="[textarea_value]" cols="40" rows="4" id="[textarea_value]"></textarea></td>
+      </tr>
+
+      <tr>
+        <th>Height:</th>
+        <td>
+          <input type="text" name="[textarea_height]" id="[textarea_height]" size="5" />
+          <select name="[textarea_height_units]" id="[textarea_height_units]">
+            <option value="em">chars</option>
+            <option value="px">px</option>
+          </select>
+        </td>
+      </tr>
+
+    </table>
+  </fieldset>
+
+  <fieldset  id="[fs_select]">
+    <legend>Drop-Down/List Field</legend>
+
+<table>
+  <tr>
+    <th>Name:</th>
+    <td>
+      <input type="text" name="[select_name]" id="[select_name]" size="25" />
+    </td>
+    <th colspan="2">Options</th>
+  </tr>
+  <tr>
+    <th>May Choose Multiple:</th>
+    <td>
+      <input type="checkbox" name="[select_multiple]" id="[select_multiple]" size="25" value="1" />
+    </td>
+    <td rowspan="3">
+      <select name="[select_options]" size="5" id="[select_options]" >
+      </select>
+    </td>
+    <td rowspan="3">
+      <input name="button" type="button" id="[add_option]" value="Add"       />
+      <br>
+      <input name="button2" type="button" id="[del_option]" value="Delete"    />
+      <br>
+      <input name="button2"  type="button" id="[up_option]" value="Move Up"   />
+      <br>
+      <input name="button2"  type="button" id="[down_option]" value="Move Down" />
+    </td>
+  </tr>
+  <tr>
+    <th>Width:</th>
+    <td>
+      <input type="text" name="[select_width]" id="[select_width]" size="5" />
+      <select name="[select_width_units]" id="[select_width_units]">
+        <option value="em">chars</option>
+        <option value="px">px</option>
+        <option value="%">%</option>
+      </select>
+    </td>
+  </tr>
+  <tr>
+    <th>Height:</th>
+    <td>
+      <input type="text" name="[select_height]" id="[select_height]" size="5" />
+      <select name="[select_height_units]" id="[select_height_units]">
+        <option value="items">items</option>
+        <option value="px">px</option>
+      </select>
+    </td>
+  </tr>
+</table>
+  </fieldset>
+</div>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FormOperations/readme
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FormOperations/readme	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,32 @@
+Form Operations Plugin
+----------------------
+
+Usage:
+  1. Follow the standard procedure for loading a plugin.
+  2. You may configure the plugin by setting the following configuration variables, or leave them as the defaults.
+
+      xinha_config.FormOperations.multiple_field_format
+        = 'php'
+              this will cause checkbox and "multiple" select fields to have []
+              appended to thier field names silently
+        = 'unmodified'
+              field names will not be silently modified
+
+      xinha_config.FormOperations.allow_edit_form
+        = true
+              the user will be able to edit the action, and method of forms
+        = false
+              neither action, nor method is editable
+
+      xinha_config.FormOperations.default_form_action
+        = 'whatever you want'
+              the default form action to set when inserting a form.  The standard one is a php file in the Form Operations directory which will email the form post to enquiries@<server hostname here>
+
+      xinha_config.FormOperations.default_form_html
+        = '<form>whatever you want here</form>'
+              the default html to insert when inserting a form.  The standard one is a basic contact form.  If you would like to specify an external file which contains the HTML for the form, you may do so via
+              = HTMLArea._geturlcontent('http://absolute/url/to/file.html')
+              see default_form.html for a suitable example, pay attention to the form tag.
+
+
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/forms.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Forms/forms.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,3 @@
+form {
+  border: 1px dotted red;
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/forms.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Forms/forms.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,349 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/Forms/forms.js */
+function Forms(_1){
+this.editor=_1;
+var _2=_1.config;
+var bl=Forms.btnList;
+var _4=this;
+var _5=["linebreak"];
+for(var i=0;i<bl.length;++i){
+var _7=bl[i];
+if(!_7){
+_5.push("separator");
+}else{
+var id=_7[0];
+if(i<3){
+_2.registerButton(id,this._lc(_7[1]),_1.imgURL("ed_"+_7[0]+".gif","Forms"),false,function(_9,id){
+_4.buttonPress(_9,id);
+});
+}else{
+_2.registerButton(id,this._lc(_7[1]),_1.imgURL("ed_"+_7[0]+".gif","Forms"),false,function(_b,id){
+_4.buttonPress(_b,id);
+},"form");
+}
+_5.push(id);
+}
+}
+_2.toolbar.push(_5);
+}
+Forms._pluginInfo={name:"Forms",origin:"version: 1.0, by Nelson Bright, BrightWork, Inc., http://www.brightworkweb.com",version:"2.0",developer:"Udo Schmal",developer_url:"",sponsor:"L.N.Schaffrath NeueMedien",sponsor_url:"http://www.schaffrath-neuemedien.de/",c_owner:"Udo Schmal & Schaffrath-NeueMedien",license:"htmlArea"};
+Forms.btnList=[null,["form","Form"],null,["textarea","Textarea"],["select","Selection Field"],["checkbox","Checkbox"],["radio","Radio Button"],["text","Text Field"],["password","Password Field"],["file","File Field"],["button","Button"],["submit","Submit Button"],["reset","Reset Button"],["image","Image Button"],["hidden","Hidden Field"],["label","Label"],["fieldset","Field Set"]];
+Forms.prototype._lc=function(_d){
+return Xinha._lc(_d,"Forms");
+};
+Forms.prototype.onGenerate=function(){
+this.editor.addEditorStylesheet(Xinha.getPluginDir("Forms")+"/forms.css");
+};
+Forms.prototype.buttonPress=function(_e,_f,_10){
+function optionValues(_11,_12){
+this.text=_11;
+this.value=_12;
+}
+var _13=new Object();
+var _14=_f;
+var sel=_e._getSelection();
+var _16=_e._createRange(sel);
+if(_f=="form"){
+var pe=_e.getParentElement();
+var frm=null;
+while(pe&&(pe.nodeType==1)&&(pe.tagName.toLowerCase()!="body")){
+if(pe.tagName.toLowerCase()=="form"){
+frm=pe;
+break;
+}else{
+pe=pe.parentNode;
+}
+}
+if(frm){
+_13.f_name=frm.name;
+_13.f_action=frm.action;
+_13.f_method=frm.method;
+_13.f_enctype=frm.enctype;
+_13.f_target=frm.target;
+}else{
+_13.f_name="";
+_13.f_action="";
+_13.f_method="";
+_13.f_enctype="";
+_13.f_target="";
+}
+_e._popupDialog("plugin://Forms/form",function(_19){
+if(_19){
+if(frm){
+frm.name=_19["f_name"];
+frm.setAttribute("action",_19["f_action"]);
+frm.setAttribute("method",_19["f_method"]);
+frm.setAttribute("enctype",_19["f_enctype"]);
+frm.setAttribute("target",_19["f_target"]);
+}else{
+frm="<form name=\""+_19["f_name"]+"\"";
+if(_19["f_action"]!=""){
+frm+=" action=\""+_19["f_action"]+"\"";
+}
+if(_19["f_method"]!=""){
+frm+=" method=\""+_19["f_method"]+"\"";
+}
+if(_19["f_enctype"]!=""){
+frm+=" enctype=\""+_19["f_enctype"]+"\"";
+}
+if(_19["f_target"]!=""){
+frm+=" target=\""+_19["f_target"]+"\"";
+}
+frm+=">";
+_e.surroundHTML(frm,"&nbsp;</form>");
+}
+}
+},_13);
+}else{
+var _1a="";
+if(typeof _10=="undefined"){
+_10=_e.getParentElement();
+var tag=_10.tagName.toLowerCase();
+if(_10&&(tag=="legend")){
+_10=_10.parentElement;
+tag=_10.tagName.toLowerCase();
+}
+if(_10&&!(tag=="textarea"||tag=="select"||tag=="input"||tag=="label"||tag=="fieldset")){
+_10=null;
+}
+}
+if(_10){
+_14=_10.tagName.toLowerCase();
+_13.f_name=_10.name;
+_1a=_10.tagName;
+if(_14=="input"){
+_13.f_type=_10.type;
+_14=_10.type;
+}
+switch(_14){
+case "textarea":
+_13.f_cols=_10.cols;
+_13.f_rows=_10.rows;
+_13.f_text=_10.innerHTML;
+_13.f_wrap=_10.getAttribute("wrap");
+_13.f_readOnly=_10.getAttribute("readOnly");
+_13.f_disabled=_10.getAttribute("disabled");
+_13.f_tabindex=_10.getAttribute("tabindex");
+_13.f_accesskey=_10.getAttribute("accesskey");
+break;
+case "select":
+_13.f_size=parseInt(_10.size);
+_13.f_multiple=_10.getAttribute("multiple");
+_13.f_disabled=_10.getAttribute("disabled");
+_13.f_tabindex=_10.getAttribute("tabindex");
+var _1c=new Array();
+for(var i=0;i<=_10.options.length-1;i++){
+_1c[i]=new optionValues(_10.options[i].text,_10.options[i].value);
+}
+_13.f_options=_1c;
+break;
+case "text":
+case "password":
+_13.f_value=_10.value;
+_13.f_size=_10.size;
+_13.f_maxLength=_10.maxLength;
+_13.f_readOnly=_10.getAttribute("readOnly");
+_13.f_disabled=_10.getAttribute("disabled");
+_13.f_tabindex=_10.getAttribute("tabindex");
+_13.f_accesskey=_10.getAttribute("accesskey");
+break;
+case "hidden":
+_13.f_value=_10.value;
+break;
+case "submit":
+case "reset":
+_13.f_value=_10.value;
+_13.f_disabled=_10.getAttribute("disabled");
+_13.f_tabindex=_10.getAttribute("tabindex");
+_13.f_accesskey=_10.getAttribute("accesskey");
+break;
+case "checkbox":
+case "radio":
+_13.f_value=_10.value;
+_13.f_checked=_10.checked;
+_13.f_disabled=_10.getAttribute("disabled");
+_13.f_tabindex=_10.getAttribute("tabindex");
+_13.f_accesskey=_10.getAttribute("accesskey");
+break;
+case "button":
+_13.f_value=_10.value;
+_13.f_onclick=_10.getAttribute("onclick");
+_13.f_disabled=_10.getAttribute("disabled");
+_13.f_tabindex=_10.getAttribute("tabindex");
+_13.f_accesskey=_10.getAttribute("accesskey");
+break;
+case "image":
+_13.f_value=_10.value;
+_13.f_src=_10.src;
+_13.f_disabled=_10.getAttribute("disabled");
+_13.f_tabindex=_10.getAttribute("tabindex");
+_13.f_accesskey=_10.getAttribute("accesskey");
+break;
+case "file":
+_13.f_disabled=_10.getAttribute("disabled");
+_13.f_tabindex=_10.getAttribute("tabindex");
+_13.f_accesskey=_10.getAttribute("accesskey");
+break;
+case "label":
+_13.f_text=_10.innerHTML;
+_13.f_for=_10.getAttribute("for");
+_13.f_accesskey=_10.getAttribute("accesskey");
+break;
+case "fieldset":
+if(_10.firstChild.tagName.toLowerCase()=="legend"){
+_13.f_text=_10.firstChild.innerHTML;
+}else{
+_13.f_text="";
+}
+break;
+}
+}else{
+_13.f_name="";
+switch(_f){
+case "textarea":
+case "select":
+case "label":
+case "fieldset":
+_1a=_f;
+break;
+default:
+_1a="input";
+_13.f_type=_f;
+break;
+}
+_13.f_options="";
+_13.f_cols="20";
+_13.f_rows="4";
+_13.f_multiple="false";
+_13.f_value="";
+_13.f_size="";
+_13.f_maxLength="";
+_13.f_checked="";
+_13.f_src="";
+_13.f_onclick="";
+_13.f_wrap="";
+_13.f_readOnly="false";
+_13.f_disabled="false";
+_13.f_tabindex="";
+_13.f_accesskey="";
+_13.f_for="";
+_13.f_text="";
+_13.f_legend="";
+}
+_e._popupDialog("plugin://Forms/"+_1a+".html",function(_1e){
+if(_1e){
+if(_1e["f_cols"]){
+if(isNaN(parseInt(_1e["f_cols"],10))||parseInt(_1e["f_cols"],10)<=0){
+_1e["f_cols"]="";
+}
+}
+if(_1e["f_rows"]){
+if(isNaN(parseInt(_1e["f_rows"],10))||parseInt(_1e["f_rows"],10)<=0){
+_1e["f_rows"]="";
+}
+}
+if(_1e["f_size"]){
+if(isNaN(parseInt(_1e["f_size"],10))||parseInt(_1e["f_size"],10)<=0){
+_1e["f_size"]="";
+}
+}
+if(_1e["f_maxlength"]){
+if(isNaN(parseInt(_1e["f_maxLength"],10))||parseInt(_1e["f_maxLength"],10)<=0){
+_1e["f_maxLength"]="";
+}
+}
+if(_10){
+for(field in _1e){
+if((field=="f_text")||(field=="f_options")||(field=="f_onclick")||(field=="f_checked")){
+continue;
+}
+if(_1e[field]!=""){
+_10.setAttribute(field.substring(2,20),_1e[field]);
+}else{
+_10.removeAttribute(field.substring(2,20));
+}
+}
+if(_14=="textarea"){
+_10.innerHTML=_1e["f_text"];
+}else{
+if(_14=="select"){
+_10.options.length=0;
+var _1f=_1e["f_options"];
+for(i=0;i<=_1f.length-1;i++){
+_10.options[i]=new Option(_1f[i].text,_1f[i].value);
+}
+}else{
+if(_14=="label"){
+_10.innerHTML=_1e["f_text"];
+}else{
+if(_14=="fieldset"){
+if(_13.f_text!=""){
+if(_10.firstChild.tagName.toLowerCase()=="legend"){
+_10.firstChild.innerHTML=_1e["f_text"];
+}
+}else{
+}
+}else{
+if((_14=="checkbox")||(_14=="radio")){
+if(_1e["f_checked"]!=""){
+_10.checked=true;
+}else{
+_10.checked=false;
+}
+}else{
+if(_1e["f_onclick"]){
+_10.onclick="";
+if(_1e["f_onclick"]!=""){
+_10.onclick=_1e["f_onclick"];
+}
+}
+}
+}
+}
+}
+}
+}else{
+var _20="";
+for(field in _1e){
+if(!_1e[field]){
+continue;
+}
+if((_1e[field]=="")||(field=="f_text")||(field=="f_options")){
+continue;
+}
+_20+=" "+field.substring(2,20)+"=\""+_1e[field]+"\"";
+}
+if(_14=="textarea"){
+_20="<textarea"+_20+">"+_1e["f_text"]+"</textarea>";
+}else{
+if(_14=="select"){
+_20="<select"+_20+">";
+var _1f=_1e["f_options"];
+for(i=0;i<=_1f.length-1;i++){
+_20+="<option value=\""+_1f[i].value+"\">"+_1f[i].text+"</option>";
+}
+_20+="</select>";
+}else{
+if(_14=="label"){
+_20="<label"+_20+">"+_1e["f_text"]+"</label>";
+}else{
+if(_14=="fieldset"){
+_20="<fieldset"+_20+">";
+if(_1e["f_legend"]!=""){
+_20+="<legend>"+_1e["f_text"]+"</legend>";
+}
+_20+="</fieldset>";
+}else{
+_20="<input type=\""+_14+"\""+_20+">";
+}
+}
+}
+}
+_e.insertHTML(_20);
+}
+}
+},_13);
+}
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/img/ed_button.gif
Binary file Xinha_0.95/plugins/Forms/img/ed_button.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/img/ed_checkbox.gif
Binary file Xinha_0.95/plugins/Forms/img/ed_checkbox.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/img/ed_fieldset.gif
Binary file Xinha_0.95/plugins/Forms/img/ed_fieldset.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/img/ed_file.gif
Binary file Xinha_0.95/plugins/Forms/img/ed_file.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/img/ed_form.gif
Binary file Xinha_0.95/plugins/Forms/img/ed_form.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/img/ed_hidden.gif
Binary file Xinha_0.95/plugins/Forms/img/ed_hidden.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/img/ed_image.gif
Binary file Xinha_0.95/plugins/Forms/img/ed_image.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/img/ed_label.gif
Binary file Xinha_0.95/plugins/Forms/img/ed_label.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/img/ed_password.gif
Binary file Xinha_0.95/plugins/Forms/img/ed_password.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/img/ed_radio.gif
Binary file Xinha_0.95/plugins/Forms/img/ed_radio.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/img/ed_reset.gif
Binary file Xinha_0.95/plugins/Forms/img/ed_reset.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/img/ed_select.gif
Binary file Xinha_0.95/plugins/Forms/img/ed_select.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/img/ed_submit.gif
Binary file Xinha_0.95/plugins/Forms/img/ed_submit.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/img/ed_text.gif
Binary file Xinha_0.95/plugins/Forms/img/ed_text.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/img/ed_textarea.gif
Binary file Xinha_0.95/plugins/Forms/img/ed_textarea.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/lang/ja.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Forms/lang/ja.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,86 @@
+// I18N constants
+// LANG: "ja", ENCODING: UTF-8
+{
+  "Form": "",
+  "Textarea": "",
+  "Selection Field": "",
+  "Checkbox": "",
+  "Radio Button": "",
+  "Text Field": "",
+  "Password Field": "",
+  "File Field": "",
+  "Submit Button": "",
+  "Reset Button": "",
+  "Image Button": "",
+  "Button": "",
+  "Hidden Field": "",
+  "Label": "",
+  "Field Set": "",
+  "Form Element: INPUT": ": INPUT",
+  "Form Element: SELECT": ": SELECT",
+  "Form Element: TEXTAREA": ": TEXTAREA",
+  "Form Element: LABEL": ": LABEL",
+  "Form Element: FIELDSET": ": FIELDSET",
+  "Form Name:": ":",
+  "Form handler script": "",
+  "Action URL:": "URL:",
+  "Method:": ":",
+  "Post": "POST",
+  "Get": "GET",
+  "Encoding:": ":",
+  "HTML-Form to CGI (default)": "HTMLCGI()",
+  "multipart Form Data (File-Upload)": "()",
+  "Target Frame:": ":",
+  "Name/ID:": "/ID:",
+  "Value:": ":",
+  "Disabled": "",
+  "Checked": "",
+  "Tab Index:": ":",
+  "Access Key:": ":",
+  "Read Only": "",
+  "Dimensions": "",
+  "Size:": ":",
+  "Max length:": ":",
+  "Button Script": "",
+  "'onClick'=": "'onClick'=",
+  "Image source": "",
+  "Image URL:": "URL:",
+  "Multiple Select": "",
+  "Options": "",
+  "Lable:": ":",
+  "Move Up": "",
+  "Move Down": "",
+  "Delete": "",
+  "Add": "",
+  "Columns:": ":",
+  "Rows:": ":",
+  "Wrap Mode:": ":",
+  "Off": "",
+  "Soft": "",
+  "Hard": "",
+  "Physical": "",
+  "Virtual": "",
+  "normal": "",
+  "nowrap": "",
+  "pre": "",
+  "Initial Text:": ":",
+  "Text:": ":",
+  "For Control:": ":",
+  "Legend:": ":",
+  "Cancel": "",
+  "Name": "",
+  "Name of the form input": "",
+  "Value of the form input": "",
+  "Size of text box in characters": "",
+  "Maximum number of characters accepted": "",
+  "Javascript for button click": "JavaScritp",
+  "URL of image": "URL",
+  "Name of the form select": "",
+  "name of the textarea": "",
+  "Width in number of characters": "",
+  "Height in number of rows": "",
+  "Default text (optional)": "()",
+  "You must enter the form name": "",
+  "You must enter a Name": "",
+  "Please enter a Label": ""
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/lang/nl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Forms/lang/nl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,87 @@
+// I18N constants
+// LANG: "nl", ENCODING: UTF-8
+// Author: Maarten Molenschot, maarten@nrgmm.nl
+{
+  "Form": "Formulier",
+  "Textarea": "Tekstgebied",
+  "Selection Field": "Selectielijst",
+  "Checkbox": "Checkbox",
+  "Radio Button": "Radio knop",
+  "Text Field": "Tekstveld",
+  "Password Field": "Wachtwoordveld",
+  "File Field": "Bestandsveld",
+  "Submit Button": "Verzend knop",
+  "Reset Button": "Wis knop",
+  "Image Button": "Afbeelding knop",
+  "Button": "Knop",
+  "Hidden Field": "Verborgen veld",
+  "Label": "Label",
+  "Field Set": "Veldset",
+  "Form Element: INPUT": "Formulier element: INPUT",
+  "Form Element: SELECT": "Formulier element: SELECT",
+  "Form Element: TEXTAREA": "Formulier element: TEXTAREA",
+  "Form Element: LABEL": "Formulier element: LABEL",
+  "Form Element: FIELDSET": "Formulier element: FIELDSET",
+  "Form Name:": "Formulier naame:",
+  "Form handler script": "Formulier script",
+  "Action URL:": "Actie URL:",
+  "Method:": "Methode:",
+  "Post": "POST",
+  "Get": "GET",
+  "Encoding:": "Encodering:",
+  "HTML-Form to CGI (default)": "HTML formulier naar CGI (standaard)",
+  "multipart Form Data (File-Upload)": "Multipart formulier data(Bestands upload)",
+  "Target Frame:": "Doel venster:",
+  "Name/ID:": "Naam/ID:",
+  "Value:": "Waarde:",
+  "Disabled": "Uitgeschakeld",
+  "Checked": "Checked",
+  "Tab Index:": "Tab volgorde:",
+  "Access Key:": "Toegangs toets:",
+  "Read Only": "Alleen lezen",
+  "Dimensions": "Dimenties",
+  "Size:": "Grootte:",
+  "Max length:": "Maximale lengte:",
+  "Button Script": "Knop script",
+  "'onClick'=": "'onClick'=",
+  "Image source": "Afbeelding bron",
+  "Image URL:": "Afbeelding URL:",
+  "Multiple Select": "Meerdere selectie mogelijkheden",
+  "Options": "Opties",
+  "Lable:": "Label:",
+  "Move Up": "Omhoog",
+  "Move Down": "Omlaag",
+  "Delete": "Verwijderen",
+  "Add": "Toevoegen",
+  "Columns:": "Kolommen:",
+  "Rows:": "Rijen:",
+  "Wrap Mode:": "Terugloop:",
+  "Off": "Uit",
+  "Soft": "Zacht",
+  "Hard": "Hard",
+  "Physical": "Fysiek",
+  "Virtual": "Virtueel",
+  "normal": "normaal",
+  "nowrap": "geen terugloop",
+  "pre": "pre",
+  "Initial Text:": "Start tekst:",
+  "Text:": "Tekst:",
+  "For Control:": "Voor controle:",
+  "Legend:": "Legend:",
+  "Cancel": "Annuleren",
+  "Name": "Naame",
+  "Name of the form input": "Naam van formulier invoer",
+  "Value of the form input": "Waarde van formulier invoer",
+  "Size of text box in characters": "Grootte van tekstveld in tekens",
+  "Maximum number of characters accepted": "Maximaal aantal tekens toegestaan",
+  "Javascript for button click": "Knop klik met JavaScript",
+  "URL of image": "Afbeelding URL",
+  "Name of the form select": "Naam van formulier select",
+  "name of the textarea": "Naam van tekst gebied",
+  "Width in number of characters": "Breedte in aantal tekens",
+  "Height in number of rows": "Hoogte in aantal tekens",
+  "Default text (optional)": "Standaard tekst (optioneel)",
+  "You must enter the form name": "Voer een formulier Naam in",
+  "You must enter a Name": "Voer een Naam in",
+  "Please enter a Label": "Voer een Label in"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Forms/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,83 @@
+// I18N constants
+
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+
+// Last revision: 05 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "Access Key:": "Tecla de Acesso:",
+  "Action URL:": "Ao - URL:",
+  "Button Script": "Script de Boto",
+  "Cancel": "Cancelar",
+  "Checked": "Definido",
+  "Columns:": "Colunas:",
+  "Default text (optional)": "Texto padro (opcional)",
+  "Dimensions": "Dimenses",
+  "Disabled": "Desativado",
+  "Encoding:": "Codificao:",
+  "For Control:": "Para Controle:",
+  "Form": "Formulrio",
+  "Form Element: FIELDSET": "Elemento do formulrio: FIELDSET",
+  "Form Element: INPUT": "Elemento do formulrio: INPUT",
+  "Form Element: LABEL": "Elemento do formulrio: LABEL",
+  "Form Element: SELECT": "Elemento do formulrio: SELECT",
+	"Form Element: TEXTAREA": "Elemento do formulrio: TEXTAREA",
+  "Form Name:": "Nome do Formulrio:",
+  "Form handler script": "Script do Formulrio",
+  "HTML-Form to CGI (default)": "Formulrio para CGI (padro)",
+  "Hard": "Difcil",
+  "Height in number of rows": "Altura em nmero de linhas",
+  "Image URL:": "URL da imagem:",
+  "Image source": "Imagem de Origem",
+  "Initial Text:": "Texto Inicial:",
+  "Insert/Edit Form": "Inserir/Editar Formulrio",
+  "Insert/Edit Form Element FIELDSET": "Inserir/Editar Elemento FIELDSET",
+  "Insert/Edit Form Element INPUT": "Inserir/Editar Elemento INPUT",
+  "Insert/Edit Form Element LABEL": "Inserir/Editar Elemento LABEL",
+  "Insert/Edit Form Element SELECT": "Inserir/Editar Elemento SELECT",
+  "Insert/Edit Form Element TEXTAREA": "Inserir/Editar Elemento TEXTAREA",
+  "Javascript for button click": "Javascript para boto de clicar",
+  "Label:": "Etiqueta:",
+  "Legend:": "Legenda:",
+  "Max length:": "Comprimento Mx.:",
+  "Maximum number of characters accepted": "Mximo nmero de caracteres aceitos",
+  "Method:": "Mtodo:",
+  "Name": "Nome",
+  "Name of the form input": "Nome do formulrio de entrada",
+  "Name of the form select": "Nome do formulrio de seleo",
+  "Name/ID:": "Nome/ID:",
+  "OK": "OK",
+  "Off": "Desligado",
+  "Options": "Opes",
+  "Physical": "Fsico",
+  "Please enter a Label": "Por favor, entre uma Etiqueta",
+  "Post": "Post",
+  "Read Only": "Somente Leitura",
+  "Rows:": "Linhas:",
+  "Size of text box in characters": "Tamanho da caixa de texto em caracteres",
+  "Size:": "Tamanho:",
+  "Soft": "Fcil",
+  "Tab Index:": "Ordem de Tabulao:",
+  "Target Frame:": "Frame de destino:",
+  "Text:": "Texto:",
+  "URL of image": "URL da imagem",
+  "Value of the form input": "Valor do formulrio de entrada",
+  "Value:": "Valor:",
+  "Virtual": "Virtual",
+  "Width in number of characters": "Largura em nmero de caracteres",
+  "Wrap Mode:": "Modo de quebras:",
+  "You must enter a Name": "Voc precisa entrar com um Nome",
+  "multipart Form Data (File-Upload)": "Formulrio de dados multipart (Enviar arquivo)",
+  "name of the textarea": "nome da rea de texto",
+  "normal": "normal",
+  "nowrap": "sem quebras"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/popups/fieldset.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Forms/popups/fieldset.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,45 @@
+<html>
+
+<head>
+  <title>Insert/Edit Form Element FIELDSET</title>
+  <link rel="stylesheet" type="text/css" href="../../../popups/popup.css" />
+  <script type="text/javascript" src="../../../popups/popup.js"></script>
+
+<script type="text/javascript">
+function Init() {
+  __dlg_translate("Forms");
+  __dlg_init(null,{width:260, height:150});
+  var param = window.dialogArguments;
+  document.getElementById("f_text").value = param["f_text"];
+  document.getElementById("f_text").focus();
+}
+
+function onOK() {
+  // pass data back to the calling window
+  var param = new Object();
+  param["f_text"] = document.getElementById("f_text").value;
+  __dlg_close(param);
+  return false;
+}
+
+function onCancel() {
+  __dlg_close(null);
+  return false;
+}
+
+</script>
+</head>
+
+<body class="dialog" onload="Init()">
+  <div id="f_type" class="title">Form Element: FIELDSET</div>
+  <form action="" method="get">
+    <div class="fr">Legend:</div>
+    <input type="text" name="text" id="f_text" />
+    <p />
+    <div id="buttons">
+      <button type="button" name="ok" onclick="return onOK();">OK</button>
+      <button type="button" name="cancel" onclick="return onCancel();">Cancel</button>
+    </div>
+  </form>
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/popups/form.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Forms/popups/form.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,89 @@
+<html>
+
+<head>
+  <title>Insert/Edit Form</title>
+  <link rel="stylesheet" type="text/css" href="../../../popups/popup.css" />
+  <script type="text/javascript" src="../../../popups/popup.js"></script>
+
+<script type="text/javascript">
+
+var fields = ["f_name", "f_action", "f_method", "f_enctype", "f_target"];
+
+function Init() {
+  __dlg_translate("Forms");
+  __dlg_init(null,{width:360, height:280});
+  var param = window.dialogArguments;
+  for (var i in fields) {
+    document.getElementById(fields[i]).value = param[fields[i]];
+  }
+  document.getElementById("f_name").focus();
+}
+
+function onOK() {
+  var required = {
+    "f_name": "You must enter the form name"
+  };
+  for (var i in required) {
+    var el = document.getElementById(i);
+    if (!el.value) {
+      alert(Xinha._lc(required[i],"Forms"));
+      el.focus();
+      return false;
+    }
+  }
+  // pass data back to the calling window
+  var param = new Object();
+  for (var i in fields) {
+    param[fields[i]] = document.getElementById(fields[i]).value;
+  }
+  __dlg_close(param);
+  return false;
+}
+
+function onCancel() {
+  __dlg_close(null);
+  return false;
+}
+</script>
+</head>
+
+<body class="dialog" onload="Init()">
+<div class="title">Form</div>
+<form action="" method="get">
+  <div class="fr">Form Name:</div>
+  <input type="text" name="name" id="f_name" size="20" title="Name" />
+  <p />
+
+  <fieldset>
+  <legend>Form handler script</legend>
+  <div class="space"></div>
+  <div class="fr">Action URL:</div>
+  <input name="action" id="f_action" type="text" size="30">
+  <p />
+  <div class="fr">Method:</div>
+  <select name="f_method" id="f_method">
+    <option value=""></option>
+    <option value="post">Post</option>
+    <option value="get">Get</option>
+  </select>
+  <div class="space"></div>
+  <div class="fr">Encoding:</div>
+  <select name="enctype" id="f_enctype">
+    <option value=""></option>
+    <option value="application/x-www-form-urlencoded">HTML-Form to CGI (default)</option>
+    <option value="multipart/form-data">multipart Form Data (File-Upload)</option>
+  </select>
+  <p />
+  <div class="fr">Target Frame:</div>
+  <input name="target" id="f_target" type="text" size="30">
+  <p />
+  </fieldset>
+
+<div id="buttons">
+  <button type="button" name="ok" onclick="return onOK();">OK</button>
+  <button type="button" name="cancel" onclick="return onCancel();">Cancel</button>
+</div>
+</form>
+
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/popups/input.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Forms/popups/input.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,179 @@
+<html>
+
+<head>
+  <title>Insert/Edit Form Element INPUT</title>
+  <link rel="stylesheet" type="text/css" href="../../../popups/popup.css" />
+  <script type="text/javascript" src="../../../popups/popup.js"></script>
+
+<script type="text/javascript">
+var fields = null;
+var type;
+function Init() {
+  __dlg_translate("Forms");
+  __dlg_init();
+  var param = window.dialogArguments;
+  type = param.f_type;
+  document.getElementById("f_type").innerHTML = Xinha._lc('Form Element: INPUT', "Forms") + '(' + type + ')';
+  document.getElementById("txt").style.display = "none";
+  document.getElementById("chk").style.display = "none";
+  document.getElementById("btn").style.display = "none";
+  document.getElementById("img").style.display = "none";
+  switch (type) {
+    case "text":
+    case "password":
+      fields = ["f_name", "f_value", "f_readOnly", "f_disabled", "f_tabindex", "f_accesskey", "f_size", "f_maxLength"];
+      height = 350;
+      document.getElementById("txt").style.display = "block";
+      break;
+    case "checkbox":
+    case "radio":
+      fields = ["f_name", "f_value", "f_checked", "f_disabled", "f_tabindex", "f_accesskey"];
+      document.getElementById("chk").style.display = "block";
+      height = 280;
+      break;
+    case "button":
+      fields = ["f_name", "f_value", "f_disabled", "f_onclick", "f_tabindex", "f_accesskey"];
+      document.getElementById("btn").style.display = "block";
+      height = 300;
+      break;
+    case "file":
+      fields = ["f_name", "f_disabled", "f_tabindex", "f_accesskey"];
+      document.getElementById("f_value").disabled = true;
+      height = 280;
+      break;
+    case "image":
+      fields = ["f_name", "f_disabled", "f_tabindex", "f_accesskey", "f_src"];
+      document.getElementById("img").style.display = "block";
+      document.getElementById("f_value").disabled = true;
+      height = 300;
+      break;
+    case "reset":
+    case "submit":
+      fields = ["f_name", "f_value", "f_disabled", "f_tabindex", "f_accesskey"];
+      height =260;
+      break;
+    case "hidden":
+      fields = ["f_name", "f_value"];
+      document.getElementById("f_disabled").disabled = true;
+      document.getElementById("f_tabindex").disabled = true;
+      document.getElementById("f_accesskey").disabled = true;
+      height =260;
+      break;
+  }
+  for (var i in fields) {
+    switch (fields[i]) {
+    case "f_readOnly":
+    case "f_disabled":
+    case "f_checked":
+      document.getElementById(fields[i]).checked = (param[fields[i]]==fields[i].substring(2,20)) || (param[fields[i]] == true); break;
+    default:
+      document.getElementById(fields[i]).value = param[fields[i]]; break;
+    }
+  }
+  window.resizeTo(320,height);
+  document.getElementById("f_name").focus();
+}
+
+function onOK() {
+  var el = document.getElementById("f_name");
+  if (!el.value) {
+    alert(Xinha._lc("You must enter a Name","Forms"));
+    el.focus();
+    return false;
+  }
+  // pass data back to the calling window
+  var param = new Object();
+  for (var i in fields) {
+    switch (fields[i]) {
+    case "f_readOnly":
+    case "f_disabled":
+    case "f_checked":
+      if(Xinha.is_ie)
+        param[fields[i]] = (document.getElementById(fields[i]).checked)?true:"";
+      else
+        param[fields[i]] = (document.getElementById(fields[i]).checked)?fields[i].substring(2,20):"";
+      break;
+    default:
+      param[fields[i]] = document.getElementById(fields[i]).value; break;
+    }
+  }
+  __dlg_close(param);
+  return false;
+}
+
+function onCancel() {
+  __dlg_close(null);
+  return false;
+}
+</script>
+
+</head>
+
+<body class="dialog" onload="Init()">
+  <div id="f_type" class="title"></div>
+  <form action="" method="get">
+    <div class="fr">Name/ID:</div>
+    <input type="text" name="name" id="f_name" title="Name of the form input" />
+    <p />
+    <div class="fr">Value:</div>
+    <input type="text" name="value" id="f_value" title="Value of the form input" />
+    <p />
+    <div class="fr">Disabled</div>
+    <input type="checkbox" name="disabled" id="f_disabled" value="disabled" />
+    <p />
+
+  <div id="chk">
+    <div class="fr">Checked</div>
+      <input name="checked" id="f_checked" type="checkbox" />
+    <p />
+  </div>
+
+    <div class="fr">Tab Index:</div>
+    <input type="text" name="tabindex" id="f_tabindex" />
+    <p />
+    <div class="fr">Access Key:</div>
+    <input type="text" name="accesskey" id="f_accesskey" />
+    <p />
+
+  <div id="txt">
+    <div class="fr">Read Only</div>
+    <input type="checkbox" name="readOnly" id="f_readOnly" value="readOnly" />
+    <p />
+
+    <fieldset>
+    <legend>Dimensions</legend>
+      <div class="space"></div>
+      <div class="fr">Size:</div>
+      <input type="text" name="size" id="f_size" size="5" title="Size of text box in characters" />
+      <div class="space"></div>
+      <div class="fr">Max length:</div>
+      <input type="text" name="maxLength" id="f_maxLength" size="5"	title="Maximum number of characters accepted" />
+      <div class="space"></div>
+    </fieldset>
+  </div>
+  <div id="btn">
+    <fieldset>
+    <legend> Button Script</legend>
+      <div class="space"></div>
+      <div class="fr">'onClick'=</div>
+      <input type="text" name="onClick" id="f_onclick" title="Javascript for button click" />
+      <div class="space"></div>
+    </fieldset>
+  </div>
+  <div id="img">
+    <fieldset>
+    <legend>Image source</legend>
+      <div class="space"></div>
+      <div class="fr">Image URL:</div>
+      <input type="text" name="src" id="f_src" title="URL of image" />
+      <div class="space"></div>
+    </fieldset>
+  </div>
+  <div id="buttons">
+    <button type="button" name="ok" onclick="return onOK();">OK</button>
+    <button type="button" name="cancel" onclick="return onCancel();">Cancel</button>
+  </div>
+</form>
+
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/popups/label.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Forms/popups/label.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,58 @@
+<html>
+
+<head>
+  <title>Insert/Edit Form Element LABEL</title>
+  <link rel="stylesheet" type="text/css" href="../../../popups/popup.css" />
+  <script type="text/javascript" src="../../../popups/popup.js"></script>
+
+<script type="text/javascript">
+var fields = ["f_text","f_for","f_accesskey"];
+
+function Init() {
+  __dlg_translate("Forms");
+  __dlg_init(null,{width:260, height:220});
+  var param = window.dialogArguments;
+  for (var i in fields) {
+    document.getElementById(fields[i]).value = param[fields[i]];
+  }
+  document.getElementById("f_text").focus();
+}
+
+function onOK() {
+  // pass data back to the calling window
+    // pass data back to the calling window
+  var param = new Object();
+  for (var i in fields) {
+    param[fields[i]] = document.getElementById(fields[i]).value;
+  }
+  __dlg_close(param);
+  return false;
+}
+
+function onCancel() {
+  __dlg_close(null);
+  return false;
+}
+
+</script>
+</head>
+
+<body class="dialog" onload="Init()">
+  <div id="f_type" class="title">Form Element: LABEL</div>
+  <form action="" method="get">
+    <div class="fr">Text:</div>
+    <input type="text" name="text" id="f_text" />
+    <p />
+    <div class="fr">For Control:</div>
+    <input type="text" name="for" id="f_for" />
+    <p />
+    <div class="fr">Access Key:</div>
+    <input type="text" name="accesskey" id="f_accesskey" />
+    <p />
+    <div id="buttons">
+      <button type="button" name="ok" onclick="return onOK();">OK</button>
+      <button type="button" name="cancel" onclick="return onCancel();">Cancel</button>
+    </div>
+  </form>
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/popups/select.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Forms/popups/select.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,208 @@
+<html>
+
+<head>
+  <title>Insert/Edit Form Element SELECT</title>
+  <link rel="stylesheet" type="text/css" href="../../../popups/popup.css" />
+  <script type="text/javascript" src="../../../popups/popup.js"></script>
+
+<script type="text/javascript">
+var fields = ["f_name", "f_size", "f_tabindex", "f_multiple", "f_disabled"];
+
+function Init() {
+  __dlg_translate("Forms");
+  __dlg_init(null,{width:360, height:400});
+  var param = window.dialogArguments;
+  for (var i in fields) {
+    switch (fields[i]) {
+    case "f_multiple":
+    case "f_disabled":
+      document.getElementById(fields[i]).checked = (param[fields[i]]==fields[i].substring(2,20)) || (param[fields[i]] == true); break;
+    case "f_size":
+      document.getElementById(fields[i]).value = (param[fields[i]]<=0)?"":param[fields[i]]; break;
+    default:
+      document.getElementById(fields[i]).value = param[fields[i]]; break;
+    }
+  }
+  for (var i=0; i<=param.f_options.length-1; i++) {
+    document.getElementById("f_select").options[i] = new Option(param.f_options[i].text, param.f_options[i].value);
+  }
+  document.getElementById("f_name").focus();
+}
+
+function onOK() {
+  var el = document.getElementById("f_name");
+  if (!el.value) {
+    alert(Xinha._lc("You must enter a Name","Forms"));
+    el.focus();
+    return false;
+  }
+  // pass data back to the calling window
+  var param = new Object();
+  for (var i in fields) {
+    switch (fields[i]) {
+    case "f_multiple":
+      if (document.getElementById("f_size").value=="1")
+        param["f_multiple"] = "";
+      else
+        param["f_multiple"] = (document.getElementById(fields[i]).checked)?"multiple":"";
+      break;
+    case "f_disabled":
+      param[fields[i]] = (document.getElementById(fields[i]).checked)?"disabled":""; break;
+    default:
+      param[fields[i]] = document.getElementById(fields[i]).value; break;
+    }
+  }
+  function optionValues(text,value) {
+    this.text = text;
+    this.value = value;
+  }
+  optionNodes = new Array(); // for option text/value pairs
+  for (var i=0; i<= document.getElementById("f_select").options.length-1; i++) {
+    optionNodes[i] = new optionValues(document.getElementById("f_select").options[i].text, document.getElementById("f_select").options[i].value);
+  }
+  param["f_options"] = optionNodes;
+  __dlg_close(param);
+  return false;
+}
+
+function onCancel() {
+  __dlg_close(null);
+  return false;
+}
+
+
+//functions to build select options list
+//Populates Label and Value fields with selected option values
+function getValues(){
+  var d = document;
+  d.getElementById("f_optionvalue").value = d.getElementById("f_select").options[d.getElementById("f_select").selectedIndex].value;
+  d.getElementById("f_optiontext").value = d.getElementById("f_select").options[d.getElementById("f_select").selectedIndex].text;
+  d.getElementById("f_update").value ="Update Option";
+}
+
+//Add or update options to the select box
+function addItem(item) {
+  var d = document;
+  if (item.f_optiontext.value =="") {alert(Xinha._lc("Please enter a Label","Forms"));}
+  else {
+    if (d.getElementById("f_select").options.selectedIndex != -1) { //update item
+      var indx = d.getElementById("f_select").options.selectedIndex;
+      d.getElementById("f_select").options[indx].text=d.getElementById("f_optiontext").value;
+      d.getElementById("f_select").options[indx].value=d.getElementById("f_optionvalue").value;
+    } else { //add new item
+      var newItem = d.getElementById("f_select").options.length++;
+      d.getElementById("f_select").options[newItem].text=d.getElementById("f_optiontext").value;
+      d.getElementById("f_select").options[newItem].value=d.getElementById("f_optionvalue").value;
+    }
+    d.getElementById("f_select").selectedIndex = -1; //deselect
+    d.getElementById("f_optiontext").value="";//clean up
+    d.getElementById("f_optionvalue").value="";
+    d.getElementById("f_update").value ="Add Option";
+    d.getElementById("f_optiontext").focus();
+  }
+}
+//Clears selected option
+function deleteItem() {
+  var d = document;
+  for (var i = d.getElementById("f_select").options.length - 1; i>=0; i--) {
+    var opt = d.getElementById("f_select").options[i];
+    if (opt.selected) {
+      d.getElementById("f_select").options[i] = null;
+    }
+  }
+  d.getElementById("f_select").selectedIndex = -1;
+  d.getElementById("f_optiontext").value="";
+  d.getElementById("f_optionvalue").value="";
+  d.getElementById("f_optiontext").focus();
+}
+//Moves selected option up
+function moveOptionUp() {
+  var d = document;
+  for (i=0; i<d.getElementById("f_select").options.length; i++) {
+    if (d.getElementById("f_select").options[i].selected) {
+      if (i != 0 && !d.getElementById("f_select").options[i-1].selected) {
+        swapOptions(d.getElementById("f_select"),i,i-1);
+        d.getElementById("f_select").options[i-1].selected = true;
+      }
+    }
+  }
+}
+//Moves selected option down
+function moveOptionDown() {
+  var d = document;
+  for (i=d.getElementById("f_select").options.length-1; i>=0; i--) {
+    if (d.getElementById("f_select").options[i].selected) {
+      if (i != (d.getElementById("f_select").options.length-1) && ! d.getElementById("f_select").options[i+1].selected) {
+        swapOptions(d.getElementById("f_select"),i,i+1);
+        d.getElementById("f_select").options[i+1].selected = true;
+      }
+    }
+  }
+}
+
+function swapOptions(obj,i,j) {
+  var o = obj.options;
+  var i_selected = o[i].selected;
+  var j_selected = o[j].selected;
+  var temp = new Option(o[i].text, o[i].value);
+  var temp2= new Option(o[j].text, o[j].value);
+  o[i] = temp2;
+  o[j] = temp;
+  o[i].selected = j_selected;
+  o[j].selected = i_selected;
+}
+</script>
+</head>
+
+<body class="dialog" onload="Init()">
+  <div id="f_type" class="title">Form Element: SELECT</div>
+  <form action="" method="get">
+    <div class="fr">Name/ID:</div>
+    <input type="text" name="name" id="f_name" title="Name of the form select" />
+    <p />
+    <div class="fr">Size:</div>
+    <input name="size" id="f_size" type="text" value="" size="15" />
+    <p />
+    <div class="fr"><nobr>Multiple Select</nobr></div>
+    <input name="multiple" id="f_multiple" type="checkbox" value="multiple" />
+    <p />
+    <div class="fr">Disabled</div>
+    <input type="checkbox" name="disabled" id="f_disabled" value="disabled" />
+    <p />
+    <div class="fr">Tab Index:</div>
+    <input type="text" name="tabindex" id="f_tabindex" />
+    <p />
+    <div class="space"></div>
+    <fieldset id="fldLayout">
+    <legend>Options</legend>
+      <table border="0" cellspacing="0">
+      <tr>
+      <td style="text-align: right;">
+        <select name="select" id="f_select" Size="6" onchange="getValues();"  style="width:16em">
+        </select>
+      </td>
+      <td style="text-align: center;">
+        <input type="button" name="up" value="Move Up" style="width:6em" onClick="moveOptionUp()"><br />
+        <input type="button" name="down" value="Move Down" style="width:6em" onClick="moveOptionDown()"><br />
+        <input type="button" name="delete" value="Delete" style="width:6em" onClick="deleteItem();">
+      </td>
+      </tr>
+      </table>
+      <div class="space"></div>
+      <table border="0" cellspacing="0">
+      <tr>
+        <td style="text-align: right;">Label:</td>
+        <td><input type="text" id="f_optiontext" name="optionText" value="" size="15"></td>
+        <td style="text-align: right;">Value:</td>
+        <td><input name="optionValue" id="f_optionvalue" type="text" value="" size="15"></td>
+        <td><input type="button" name="update" id="f_update" value="Add" onclick="addItem(document.forms[0])"></td>
+      </tr>
+      </table>
+    </fieldset>
+    <div id="buttons">
+      <button type="button" name="ok" onclick="return onOK();">OK</button>
+      <button type="button" name="cancel" onclick="return onCancel();">Cancel</button>
+    </div>
+  </form>
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/Forms/popups/textarea.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/Forms/popups/textarea.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,112 @@
+<html>
+
+<head>
+  <title>Insert/Edit Form Element TEXTAREA</title>
+  <link rel="stylesheet" type="text/css" href="../../../popups/popup.css" />
+  <script type="text/javascript" src="../../../popups/popup.js"></script>
+
+<script type="text/javascript">
+
+var fields = ["f_name", "f_text", "f_cols", "f_rows", "f_wrap", "f_tabindex", "f_accesskey", "f_readOnly", "f_disabled"];
+
+function Init() {
+  __dlg_translate("Forms");
+  __dlg_init(null,{width:260, height:380});
+  var param = window.dialogArguments;
+  for (var i in fields) {
+    switch (fields[i]) {
+    case "f_readOnly":
+    case "f_disabled":
+      document.getElementById(fields[i]).checked = (param[fields[i]]==fields[i].substring(2,20)) || (param[fields[i]] == true);  break;
+    default:
+      document.getElementById(fields[i]).value = param[fields[i]]; break;
+    }
+  }
+  document.getElementById("f_name").focus();
+}
+
+function onOK() {
+  var el = document.getElementById("f_name");
+  if (!el.value) {
+    alert(Xinha._lc("You must enter a Name","Forms"));
+    el.focus();
+    return false;
+  }
+  // pass data back to the calling window
+  var param = new Object();
+  for (var i in fields) {
+    switch (fields[i]) {
+    case "f_readOnly":
+    case "f_disabled":
+      if(Xinha.is_ie)
+        param[fields[i]] = (document.getElementById(fields[i]).checked)?true:"";
+      else
+        param[fields[i]] = (document.getElementById(fields[i]).checked)?fields[i].substring(2,20):"";
+      break;
+    default:
+      param[fields[i]] = document.getElementById(fields[i]).value; break;
+    }
+  }
+  __dlg_close(param);
+  return false;
+}
+
+function onCancel() {
+  __dlg_close(null);
+  return false;
+}
+</script>
+</head>
+
+<body class="dialog" onload="Init()">
+<div id="f_type" class="title">Form Element: TEXTAREA</div>
+<form action="" method="get">
+  <div class="fr">Name/ID:</div>
+  <input type="text" name="name" id="f_name" title="name of the textarea" />
+  <p />
+  <fieldset>
+  <legend>Dimensions</legend>
+    <div class="fr">Columns:</div>
+    <input type="text" name="cols" id="f_cols" size="5" title="Width in number of characters" />
+    <p />
+    <div class="fr">Rows:</div>
+    <input type="text" name="rows" id="f_rows" size="5" title="Height in number of rows" />
+    <p />
+  </fieldset>
+  <div class="space"></div>
+  <div class="fr">Wrap Mode:</div>
+  <select name="wrap" id="f_wrap">
+    <option value=""></option>
+    <option value="off">Off</option>
+    <option value="soft">Soft</option>
+    <option value="hard">Hard</option>
+    <option value="physical">Physical</option>
+    <option value="virtual">Virtual</option>
+    <option value="normal">normal</option>
+    <option value="nowrap">nowrap</option>
+    <option value="pre">pre</option>
+  </select>
+  <p />
+  <div class="fr">Read Only</div>
+  <input type="checkbox" name="readOnly" id="f_readOnly" value="readOnly" />
+  <p />
+  <div class="fr">Disabled</div>
+  <input type="checkbox" name="disabled" id="f_disabled" value="disabled" />
+  <p />
+  <div class="fr">Tab Index:</div>
+  <input type="text" name="tabindex" id="f_tabindex" />
+  <p />
+  <div class="fr">Access Key:</div>
+  <input type="text" name="accesskey" id="f_accesskey" />
+  <p />
+
+  <div class="fr">Initial Text:</div>
+  <input type="text" name="text" id="f_text" title="Default text (optional)" />
+  <div id="buttons">
+    <button type="button" name="ok" onclick="return onOK();">OK</button>
+    <button type="button" name="cancel" onclick="return onCancel();">Cancel</button>
+  </div>
+</form>
+
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FullPage/full-page.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FullPage/full-page.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,203 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/FullPage/full-page.js */
+function FullPage(_1){
+this.editor=_1;
+var _2=_1.config;
+_2.fullPage=true;
+var _3=this;
+_2.registerButton("FP-docprop",this._lc("Document properties"),_1.imgURL("docprop.gif","FullPage"),false,function(_4,id){
+_3.buttonPress(_4,id);
+});
+_2.addToolbarElement(["separator","FP-docprop"],"separator",-1);
+}
+FullPage._pluginInfo={name:"FullPage",version:"1.0",developer:"Mihai Bazon",developer_url:"http://dynarch.com/mishoo/",c_owner:"Mihai Bazon",sponsor:"Thycotic Software Ltd.",sponsor_url:"http://thycotic.com",license:"htmlArea"};
+FullPage.prototype._lc=function(_6){
+return Xinha._lc(_6,"FullPage");
+};
+FullPage.prototype.buttonPress=function(_7,id){
+var _9=this;
+switch(id){
+case "FP-docprop":
+var _a=_7._doc;
+var _b=_a.getElementsByTagName("link");
+var _c="";
+var _d="";
+var _e="";
+var _f="";
+var _10="";
+for(var i=_b.length;--i>=0;){
+var _12=_b[i];
+if(/stylesheet/i.test(_12.rel)){
+if(/alternate/i.test(_12.rel)){
+_d=_12.href;
+}else{
+_c=_12.href;
+}
+}
+}
+var _13=_a.getElementsByTagName("meta");
+for(var i=_13.length;--i>=0;){
+var _14=_13[i];
+if(/content-type/i.test(_14.httpEquiv)){
+r=/^text\/html; *charset=(.*)$/i.exec(_14.content);
+_10=r[1];
+}else{
+if((/keywords/i.test(_14.name))||(/keywords/i.test(_14.id))){
+_e=_14.content;
+}else{
+if((/description/i.test(_14.name))||(/description/i.test(_14.id))){
+_f=_14.content;
+}
+}
+}
+}
+var _15=_a.getElementsByTagName("title")[0];
+_15=_15?_15.innerHTML:"";
+var _16={f_doctype:_7.doctype,f_title:_15,f_body_bgcolor:Xinha._colorToRgb(_a.body.style.backgroundColor),f_body_fgcolor:Xinha._colorToRgb(_a.body.style.color),f_base_style:_c,f_alt_style:_d,f_charset:_10,f_keywords:_e,f_description:_f,editor:_7};
+_7._popupDialog("plugin://FullPage/docprop",function(_17){
+_9.setDocProp(_17);
+},_16);
+break;
+}
+};
+FullPage.prototype.setDocProp=function(_18){
+var txt="";
+var doc=this.editor._doc;
+var _1b=doc.getElementsByTagName("head")[0];
+var _1c=doc.getElementsByTagName("link");
+var _1d=doc.getElementsByTagName("meta");
+var _1e=null;
+var _1f=null;
+var _20=null;
+var _21=null;
+var _22=null;
+var _23=null;
+for(var i=_1c.length;--i>=0;){
+var _25=_1c[i];
+if(/stylesheet/i.test(_25.rel)){
+if(/alternate/i.test(_25.rel)){
+_1f=_25;
+}else{
+_1e=_25;
+}
+}
+}
+for(var i=_1d.length;--i>=0;){
+var _26=_1d[i];
+if(/content-type/i.test(_26.httpEquiv)){
+r=/^text\/html; *charset=(.*)$/i.exec(_26.content);
+_20=r[1];
+_21=_26;
+}else{
+if((/keywords/i.test(_26.name))||(/keywords/i.test(_26.id))){
+_22=_26;
+}else{
+if((/description/i.test(_26.name))||(/description/i.test(_26.id))){
+_23=_26;
+}
+}
+}
+}
+function createLink(alt){
+var _28=doc.createElement("link");
+_28.rel=alt?"alternate stylesheet":"stylesheet";
+_1b.appendChild(_28);
+return _28;
+}
+function createMeta(_29,_2a,_2b){
+var _2c=doc.createElement("meta");
+if(_29!=""){
+_2c.httpEquiv=_29;
+}
+if(_2a!=""){
+_2c.name=_2a;
+}
+if(_2a!=""){
+_2c.id=_2a;
+}
+_2c.content=_2b;
+_1b.appendChild(_2c);
+return _2c;
+}
+if(!_1e&&_18.f_base_style){
+_1e=createLink(false);
+}
+if(_18.f_base_style){
+_1e.href=_18.f_base_style;
+}else{
+if(_1e){
+_1b.removeChild(_1e);
+}
+}
+if(!_1f&&_18.f_alt_style){
+_1f=createLink(true);
+}
+if(_18.f_alt_style){
+_1f.href=_18.f_alt_style;
+}else{
+if(_1f){
+_1b.removeChild(_1f);
+}
+}
+if(_21){
+_1b.removeChild(_21);
+_21=null;
+}
+if(!_21&&_18.f_charset){
+_21=createMeta("Content-Type","","text/html; charset="+_18.f_charset);
+}
+if(!_22&&_18.f_keywords){
+_22=createMeta("","keywords",_18.f_keywords);
+}else{
+if(_18.f_keywords){
+_22.content=_18.f_keywords;
+}else{
+if(_22){
+_1b.removeChild(_22);
+}
+}
+}
+if(!_23&&_18.f_description){
+_23=createMeta("","description",_18.f_description);
+}else{
+if(_18.f_description){
+_23.content=_18.f_description;
+}else{
+if(_23){
+_1b.removeChild(_23);
+}
+}
+}
+for(var i in _18){
+var val=_18[i];
+switch(i){
+case "f_title":
+var _2e=doc.getElementsByTagName("title")[0];
+if(!_2e){
+_2e=doc.createElement("title");
+_1b.appendChild(_2e);
+}else{
+while(node=_2e.lastChild){
+_2e.removeChild(node);
+}
+}
+if(!Xinha.is_ie){
+_2e.appendChild(doc.createTextNode(val));
+}else{
+doc.title=val;
+}
+break;
+case "f_doctype":
+this.editor.setDoctype(val);
+break;
+case "f_body_bgcolor":
+doc.body.style.backgroundColor=val;
+break;
+case "f_body_fgcolor":
+doc.body.style.color=val;
+break;
+}
+}
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FullPage/img/docprop.gif
Binary file Xinha_0.95/plugins/FullPage/img/docprop.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FullPage/lang/de.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FullPage/lang/de.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,18 @@
+// I18N for the FullPage plugin
+// LANG: "de", ENCODING: UTF-8
+// Author: Holger Hees, http://www.systemconcept.de
+{
+  "Alternate style-sheet:": "Alternativer Stylesheet:",
+  "Background color:": "Hintergrundfarbe:",
+  "Cancel": "Abbrechen",
+  "DOCTYPE:": "DOCTYPE:",
+  "Document properties": "Dokumenteigenschaften",
+  "Document title:": "Dokumenttitel:",
+  "OK": "OK",
+  "Primary style-sheet:": "Stylesheet:",
+  "Text color:": "Textfarbe:",
+  "Character set:": "Zeichensatz",
+  "Description:": "Beschreibung",
+  "Keywords:": "Schlsselworte",
+  "UTF-8 (recommended)": "UTF-8 (empfohlen)"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FullPage/lang/fr.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FullPage/lang/fr.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,17 @@
+// I18N for the FullPage plugin
+// LANG: "fr", ENCODING: UTF-8
+{
+  "Alternate style-sheet:": "Feuille CSS alternative",
+  "Background color:": "Couleur d'arrire plan",
+  "Cancel": "Annuler",
+  "DOCTYPE:": "DOCTYPE",
+  "Document properties": "Proprits du document",
+  "Document title:": "Titre du document",
+  "OK": "OK",
+  "Primary style-sheet:": "Feuille CSS primaire",
+  "Text color:": "Couleur de texte",
+  "Character set:": "Jeu de caractres",
+  "Description:": "Description",
+  "Keywords:": "Mots cls",
+  "UTF-8 (recommended)": "UTF-8 (recommand)"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FullPage/lang/he.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FullPage/lang/he.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,14 @@
+// I18N for the FullPage plugin
+// LANG: "he", ENCODING: UTF-8
+// Author: Liron Newman, http://www.eesh.net, <plastish at ultinet dot org>
+{
+  "Alternate style-sheet:": "  :",
+  "Background color:": " :",
+  "Cancel": "",
+  "DOCTYPE:": "DOCTYPE:",
+  "Document properties": " ",
+  "Document title:": " :",
+  "OK": "",
+  "Primary style-sheet:": "  :",
+  "Text color:": " :"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FullPage/lang/ja.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FullPage/lang/ja.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,17 @@
+// I18N constants
+// LANG: "ja", ENCODING: UTF-8
+{
+  "Alternate style-sheet:": ":",
+  "Background color:": ":",
+  "Cancel": "",
+  "DOCTYPE:": "DOCTYPE:",
+  "Document properties": "",
+  "Document title:": ":",
+  "OK": "OK",
+  "Primary style-sheet:": ":",
+  "Text color:": ":",
+  "Character set:": ":",
+  "Description:": ":",
+  "Keywords:": ":",
+  "UTF-8 (recommended)": "UTF-8 ()"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FullPage/lang/nb.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FullPage/lang/nb.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,17 @@
+// I18N constants
+// LANG: "nb", ENCODING: UTF-8
+// translated: Kim Steinhaug, http://www.steinhaug.com/, kim@steinhaug.com
+{
+  "Alternate style-sheet:": "Alternativt stilsett:",
+  "Background color:": "Bakgrunnsfarge:",
+  "Cancel": "Avbryt",
+  "DOCTYPE:": "DOCTYPE:",
+  "Keywords:": "Nkkelord",
+  "Description:": "Beskrivelse",
+  "Character set:": "Tegnsett",
+  "Document properties": "Egenskaper for dokument",
+  "Document title:": "Tittel p dokument:",
+  "OK": "OK",
+  "Primary style-sheet:": "Stilsett:",
+  "Text color:": "Tekstfarge:"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FullPage/lang/nl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FullPage/lang/nl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,13 @@
+// I18N for the FullPage plugin
+// LANG: "nl", ENCODING: UTF-8
+{
+  "Alternate style-sheet:": "Wisselen van style-sheet:",
+  "Background color:": "Achtergrondkleur:",
+  "Cancel": "Annuleren",
+  "DOCTYPE:": "DOCTYPE:",
+  "Document properties": "Documenteigenschappen",
+  "Document title:": "Documenttitel:",
+  "OK": "OK",
+  "Primary style-sheet:": "Primaire style-sheet:",
+  "Text color:": "Tekstkleur:"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FullPage/lang/pl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FullPage/lang/pl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,18 @@
+// I18N for the FullPage plugin
+// LANG: "pl", ENCODING: UTF-8
+// translated: Krzysztof Kotowicz, koto1sa@o2.pl, http://www.eskot.krakow.pl/portfolio
+{
+  "Alternate style-sheet:": "Alternatywny arkusz stylw:",
+  "Background color:": "Kolor ta:",
+  "Cancel": "Anuluj",
+  "DOCTYPE:": "DOCTYPE:",
+  "Document properties": "Waciwoci dokumentu",
+  "Document title:": "Tytu dokumentu:",
+  "OK": "OK",
+  "Primary style-sheet:": "Arkusz stylw:",
+  "Text color:": "Kolor tekstu:",
+  "Character set:": "Zestaw znakw",
+  "Description:": "Opis",
+  "Keywords:": "Sowa kluczowe",
+  "UTF-8 (recommended)": "UTF-8 (zalecany)"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FullPage/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FullPage/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,35 @@
+// I18N constants
+
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+
+// Last revision: 05 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "Alternate style-sheet:": "Estilo alternativo:",
+  "Background color:": "Cr de Fundo:",
+  "Cancel": "Cancelar",
+  "Character set:": "Conjunto de Caracteres:",
+  "DOCTYPE:": "DOCTYPE:",
+  "Description:": "Descrio:",
+  "Document properties": "Propriedades do Documento",
+  "Document title:": "Ttulo do Documento:",
+  "Keywords:": "Palavras chave:",
+  "OK": "OK",
+  "Primary style-sheet:": "Estilo Primrio:",
+  "Test of FullPage plugin": "Teste do Plugin FullPage",
+  "Text color:": "Cr do Texto:",
+  "UTF-8 (recommended)": "UTF-8 (recomendado)",
+  "cyrillic (ISO-8859-5)": "Cirlico (ISO-8859-5)",
+  "cyrillic (KOI8-R)": "Cirlico (KOI8-R)",
+  "cyrillic (WINDOWS-1251)": "Crilico (WINDOWS-1251)",
+  "western (ISO-8859-1)": "Ocidental (ISO-8859-1)"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FullPage/lang/ro.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FullPage/lang/ro.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,14 @@
+// I18N for the FullPage plugin
+// LANG: "en", ENCODING: UTF-8
+// Author: Mihai Bazon, http://dynarch.com/mishoo
+{
+  "Alternate style-sheet:": "Template CSS alternativ:",
+  "Background color:": "Culoare de fundal:",
+  "Cancel": "Renun",
+  "DOCTYPE:": "DOCTYPE:",
+  "Document properties": "Proprietile documentului",
+  "Document title:": "Titlul documentului:",
+  "OK": "Accept",
+  "Primary style-sheet:": "Template CSS principal:",
+  "Text color:": "Culoare text:"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/FullPage/popups/docprop.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/FullPage/popups/docprop.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,142 @@
+<html>
+<head>
+<title>Document properties</title>
+<script type="text/javascript" src="../../../popups/popup.js"></script>
+<script type="text/javascript" src="../../../modules/ColorPicker/ColorPicker.js"></script>
+<link rel="stylesheet" type="text/css" href="../../../popups/popup.css" />
+<script type="text/javascript">
+FullPage = window.opener.FullPage; // load the FullPage plugin and lang file ;-)
+window.resizeTo(400, 130);
+var accepted = {
+  f_doctype       : true,
+  f_title         : true,
+  f_body_bgcolor  : true,
+  f_body_fgcolor  : true,
+  f_base_style    : true,
+  f_alt_style     : true,
+  f_charset       : true,
+  f_keywords      : true,
+  f_description   : true
+};
+
+var editor = null;
+function Init() {
+  __dlg_translate('FullPage');
+  __dlg_init();
+  var params = window.dialogArguments;
+  for (var i in params) {
+    if (i in accepted) {
+      var el = document.getElementById(i);
+      el.value = params[i];
+    }
+  }
+  editor = params.editor;
+
+  var bgCol_pick = document.getElementById('bgCol_pick');
+  var f_body_bgcolor = document.getElementById('f_body_bgcolor');
+  var bgColPicker = new Xinha.colorPicker({cellsize:'5px',callback:function(color){f_body_bgcolor.value=color;}});
+  bgCol_pick.onclick = function() { bgColPicker.open('top,right', f_body_bgcolor ); }
+
+  var fgCol_pick = document.getElementById('fgCol_pick');
+  var f_body_fgcolor = document.getElementById('f_body_fgcolor');
+  var fgColPicker = new Xinha.colorPicker({cellsize:'5px',callback:function(color){f_body_fgcolor.value=color;}});
+  fgCol_pick.onclick = function() { fgColPicker.open('top,right', f_body_fgcolor ); }
+
+  document.getElementById("f_title").focus();
+  document.getElementById("f_title").select();
+}
+
+function onOK() {
+  var required = {
+  };
+  for (var i in required) {
+    var el = document.getElementById(i);
+    if (!el.value) {
+      alert(required[i]);
+      el.focus();
+      return false;
+    }
+  }
+
+  var param = {};
+  for (var i in accepted) {
+    var el = document.getElementById(i);
+    param[i] = el.value;
+  }
+  __dlg_close(param);
+  return false;
+}
+
+function onCancel() {
+  __dlg_close(null);
+  return false;
+}
+</script>
+<style type="text/css">
+.fr { width: 11em; float: left; padding: 2px 5px; text-align: right; }
+.txt { width:200px; }
+div { clear:both; }
+.picker { width:30px; }
+</style>
+</head>
+
+<body class="dialog" onload="Init()">
+
+<div class="title">Document properties</div>
+
+<div>
+  <label class="fr" for="f_title">Document title:</label>
+  <input type="text" id="f_title" class="txt" />
+</div>
+<div>
+  <label class="fr" for="f_doctype">DOCTYPE:</label>
+  <input type="text" id="f_doctype" class="txt" />
+</div>
+<div>
+  <label class="fr" for="f_keywords">Keywords:</label>
+
+  <input type="text" id="f_keywords" class="txt" />
+</div>
+<div>
+  <label class="fr" for="f_description">Description:</label>
+  <input type="text" id="f_description" class="txt" />
+</div>
+<div>
+  <label class="fr" for="f_charset">Character set:</label>
+  <select id="f_charset" class="txt">
+    <option value=""></option>
+    <option value="utf-8">UTF-8 (recommended)</option>
+    <option value="windows-1251">cyrillic (WINDOWS-1251)</option>
+
+    <option value="koi8-r">cyrillic (KOI8-R)</option>
+    <option value="iso-8859-5">cyrillic (ISO-8859-5)</option>
+    <option value="iso-8859-1">western (ISO-8859-1)</option>
+  </select>
+</div>
+<div>
+  <label class="fr" for="f_base_style">Primary style-sheet:</label>
+  <input type="text" id="f_base_style" class="txt" />
+</div>
+<div>
+  <label class="fr" for="f_alt_style">Alternate style-sheet:</label>
+  <input type="text" id="f_alt_style" class="txt" />
+</div>
+<div>
+  <label class="fr" for="f_body_bgcolor">Background color:</label>
+  <input name="f_body_bgcolor" type="text" id="f_body_bgcolor" size="7" />
+  <button type="button" id="bgCol_pick" class="picker">...</button>
+</div>
+<div>
+  <label class="fr" for="f_body_fgcolor">Text color:</label>
+  <input name="f_body_fgcolor" type="text" id="f_body_fgcolor" size="7" />
+  <button type="button" id="fgCol_pick" class="picker">...</button>
+</div>
+
+<div id="buttons">
+  <button type="button" name="ok" onclick="return onOK();"><span>OK</span></button>
+
+  <button type="button" name="cancel" onclick="return onCancel();"><span>Cancel</span></button>
+</div>
+
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/GenericPlugin/generic-plugin.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/GenericPlugin/generic-plugin.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,51 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/GenericPlugin/generic-plugin.js */
+GenericPlugin._pluginInfo={name:"GenericPlugin",version:"1.0",developer:"Xinha Developer Team",developer_url:"http://xinha.org",sponsor:"",sponsor_url:"",license:"htmlArea"};
+function GenericPlugin(_1){
+this.editor=_1;
+}
+GenericPlugin.prototype.onGenerate=function(){
+};
+GenericPlugin.prototype.onGenerateOnce=function(){
+};
+GenericPlugin.prototype.inwardHtml=function(_2){
+return _2;
+};
+GenericPlugin.prototype.outwardHtml=function(_3){
+return _3;
+};
+GenericPlugin.prototype.onUpdateToolbar=function(){
+return false;
+};
+GenericPlugin.prototype.onExecCommand=function(_4,UI,_6){
+return false;
+};
+GenericPlugin.prototype.onKeyPress=function(_7){
+return false;
+};
+GenericPlugin.prototype.onMouseDown=function(_8){
+return false;
+};
+GenericPlugin.prototype.onBeforeSubmit=function(){
+return false;
+};
+GenericPlugin.prototype.onBeforeUnload=function(){
+return false;
+};
+GenericPlugin.prototype.onBeforeResize=function(_9,_a){
+return false;
+};
+GenericPlugin.prototype.onResize=function(_b,_c){
+return false;
+};
+GenericPlugin.prototype.onPanelChange=function(_d,_e){
+return false;
+};
+GenericPlugin.prototype.onMode=function(_f){
+return false;
+};
+GenericPlugin.prototype.onBeforeMode=function(_10){
+return false;
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/GetHtml/get-html.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/GetHtml/get-html.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,8 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/GetHtml/get-html.js */
+function GetHtml(_1){
+_1.config.getHtmlMethod="TransformInnerHTML";
+}
+GetHtml._pluginInfo={name:"GetHtml",version:"1.0",developer:"Nelson Bright",developer_url:"http://www.brightworkweb.com/",sponsor:"",sponsor_url:"",license:"htmlArea"};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/HorizontalRule/horizontal-rule.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/HorizontalRule/horizontal-rule.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,130 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/HorizontalRule/horizontal-rule.js */
+HorizontalRule._pluginInfo={name:"HorizontalRule",version:"1.0",developer:"Nelson Bright",developer_url:"http://www.brightworkweb.com/",c_owner:"Nelson Bright",sponsor:"BrightWork, Inc.",sponsor_url:"http://www.brightworkweb.com/",license:"htmlArea"};
+function HorizontalRule(_1){
+this.editor=_1;
+var _2=_1.config;
+var _3=_2.toolbar;
+var _4=this;
+_2.registerButton({id:"edithorizontalrule",tooltip:this._lc("Insert/edit horizontal rule"),image:[_editor_url+"images/ed_buttons_main.gif",6,0],textMode:false,action:function(_5){
+_4.buttonPress(_5);
+}});
+_2.addToolbarElement("edithorizontalrule","inserthorizontalrule",0);
+}
+HorizontalRule.prototype._lc=function(_6){
+return Xinha._lc(_6,"HorizontalRule");
+};
+HorizontalRule.prototype.buttonPress=function(_7){
+this.editor=_7;
+this._editHorizontalRule();
+};
+HorizontalRule.prototype._editHorizontalRule=function(_8){
+editor=this.editor;
+var _9=editor._getSelection();
+var _a=editor._createRange(_9);
+var _b=null;
+if(typeof _8=="undefined"){
+_8=editor.getParentElement();
+if(_8&&!/^hr$/i.test(_8.tagName)){
+_8=null;
+}
+}
+if(_8){
+var _c=_8.style.width||_8.width;
+_b={f_size:parseInt(_8.style.height,10)||_8.size,f_widthUnit:(/(%|px)$/.test(_c))?RegExp.$1:"px",f_width:parseInt(_c,10),f_color:Xinha._colorToRgb(_8.style.backgroundColor)||_8.color,f_align:_8.style.textAlign||_8.align,f_noshade:(parseInt(_8.style.borderWidth,10)==0)||_8.noShade};
+}
+editor._popupDialog("plugin://HorizontalRule/edit_horizontal_rule.html",function(_d){
+if(!_d){
+return false;
+}
+var hr=_8;
+if(!hr){
+var _f=editor._doc.createElement("hr");
+for(var _10 in _d){
+var _11=_d[_10];
+if(_11==""){
+continue;
+}
+switch(_10){
+case "f_width":
+if(_d["f_widthUnit"]=="%"){
+_f.style.width=_11+"%";
+}else{
+_f.style.width=_11+"px";
+}
+break;
+case "f_size":
+_f.style.height=_11+"px";
+break;
+case "f_align":
+_f.style.textAlign=_11;
+switch(_11){
+case "left":
+_f.style.marginLeft="0";
+break;
+case "right":
+_f.style.marginRight="0";
+break;
+case "center":
+_f.style.marginLeft="auto";
+_f.style.marginRight="auto";
+break;
+}
+break;
+case "f_color":
+_f.style.backgroundColor=_11;
+break;
+case "f_noshade":
+_f.style.border="0";
+break;
+}
+}
+if(Xinha.is_gecko){
+editor.execCommand("inserthtml",false,Xinha.getOuterHTML(_f));
+}else{
+editor.insertNodeAtSelection(_f);
+}
+}else{
+for(var _10 in _d){
+var _11=_d[_10];
+switch(_10){
+case "f_width":
+if(_d["f_widthUnit"]=="%"){
+hr.style.width=_11+"%";
+}else{
+hr.style.width=_11+"px";
+}
+break;
+case "f_size":
+hr.style.height=_11+"px";
+break;
+case "f_align":
+hr.style.textAlign=_11;
+switch(_11){
+case "left":
+hr.style.marginLeft="0";
+hr.style.marginRight=null;
+break;
+case "right":
+hr.style.marginRight="0";
+hr.style.marginLeft=null;
+break;
+case "center":
+hr.style.marginLeft="auto";
+hr.style.marginRight="auto";
+break;
+}
+break;
+case "f_color":
+hr.style.backgroundColor=_11;
+break;
+case "f_noshade":
+break;
+}
+hr.style.border=(_d["f_noshade"])?"0":null;
+}
+}
+},_b);
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/HorizontalRule/lang/de.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/HorizontalRule/lang/de.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,21 @@
+// I18N constants
+// LANG: "de", ENCODING: UTF-8
+// translated: Udo Schmal (gocher), http://www.schaffrath-neuemedien.de/, udo.schmal@t-online.de
+{
+  "Insert/edit horizontal rule": "horizontale Linie einfgen/bearbeiten",
+  "Horizontal Rule": "Horizontale Linie",
+  "Layout": "Gestaltung",
+  "Width:": "Breite:",
+  "percent": "Prozent",
+  "pixels": "Pixel",
+  "Height:": "Hhe:",
+  "Alignment:": "Ausrichtung:",
+  "Left": "links",
+  "Center": "zentriert",
+  "Right": "rechts",
+  "Style": "Stil",
+  "Color:": "Farbe",
+  "No shading": "keine Schattierung",
+  "Note:": "Anmerkung",
+  "To select an existing horizontal rule, a double-click may be needed.": "Um eine horizontale Linie auszuwhlen kann ein Doppelklick erforderlich sein."
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/HorizontalRule/lang/fr.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/HorizontalRule/lang/fr.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,20 @@
+// I18N constants
+// LANG: "fr", ENCODING: UTF-8
+{
+  "Insert/edit horizontal rule": "Insrer une rgle horizontale",
+  "Horizontal Rule": "Rgle horizontale",
+  "Layout": "Layout",
+  "Width:": "Largeur",
+  "percent": "pourcent",
+  "pixels": "pixels",
+  "Height:": "Hauteur",
+  "Alignment:": "Alignement",
+  "Left": "Gauche",
+  "Center": "Centre",
+  "Right": "Droite",
+  "Style": "Style",
+  "Color:": "Couleur",
+  "No shading": "Pas d'ombre",
+  "Note:": "Note",
+  "To select an existing horizontal rule, a double-click may be needed.": "Pour slectionner une rgle horizontale, un double-clic peut tre ncessaire."
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/HorizontalRule/lang/ja.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/HorizontalRule/lang/ja.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,21 @@
+// I18N constants
+// LANG: "ja", ENCODING: UTF-8
+// This string is for auto detection of multi-encoding editor : 
+{
+  "Insert/edit horizontal rule": "/",
+  "Horizontal Rule": "",
+  "Layout": "",
+  "Width:": ":",
+  "percent": "",
+  "pixels": "",
+  "Height:": ":",
+  "Alignment:": ":",
+  "Left": "",
+  "Center": "",
+  "Right": "",
+  "Style": "",
+  "Color:": ":",
+  "No shading": "",
+  "Note:": "",
+  "To select an existing horizontal rule, a double-click may be needed.":"DoubleClick"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/HorizontalRule/lang/nb.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/HorizontalRule/lang/nb.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,21 @@
+// I18N constants
+// LANG: "nb", ENCODING: UTF-8
+// translated: Kim Steinhaug, http://www.steinhaug.com/, kim@steinhaug.com
+{
+  "Insert/edit horizontal rule": "Sett inn/ rediger horisontal linje",
+  "Horizontal Rule": "Horisontal linje",
+  "Layout": "Oppsett",
+  "Width:": "Bredde:",
+  "percent": "prosent",
+  "pixels": "Piksel",
+  "Height:": "Hyde:",
+  "Alignment:": "Justering:",
+  "Left": "Venstre",
+  "Center": "Sentrert",
+  "Right": "Hyre",
+  "Style": "Stil",
+  "Color:": "Farge",
+  "No shading": "Ingen skygge",
+  "Note:": "Notat",
+  "To select an existing horizontal rule, a double-click may be needed.": "For  velge en horisontal linje kan det hende du m dobbeltklikke."
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/HorizontalRule/lang/nl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/HorizontalRule/lang/nl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,21 @@
+// I18N constants
+// LANG: "nl", ENCODING: UTF-8
+// Author: Maarten Molenschot, maarten@nrgmm.nl
+{
+  "Insert/edit horizontal rule": "Horizontale lijn invoegen/bewerken",
+  "Horizontal Rule": "Horizontale lijn",
+  "Layout": "Weergave",
+  "Width:": "Breedte:",
+  "percent": "procent",
+  "pixels": "pixels",
+  "Height:": "Hoogte:",
+  "Alignment:": "Uitvulling:",
+  "Left": "Links",
+  "Center": "Midden",
+  "Right": "Rechts",
+  "Style": "Style",
+  "Color:": "kleur",
+  "No shading": "Geen schaduw",
+  "Note:": "Notitie",
+  "To select an existing horizontal rule, a double-click may be needed.": "Om een bestaande horizontale lijn te selecteren moet je mogelijk dubbel klikken."
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/HorizontalRule/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/HorizontalRule/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,34 @@
+// I18N constants
+
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+
+// Last revision: 05 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "Alignment:": "Alinhamento:",
+  "Cancel": "Cancelar",
+  "Center": "Centralizar",
+  "Color:": "Cr:",
+  "Height:": "Alturar:",
+  "Horizontal Rule": "Linha Horizontal",
+  "Insert/Edit Horizontal Rule": "Inserir/Editar Linha Horizontal",
+  "Insert/edit horizontal rule": "Inserir/editar linha horizontal",
+  "Layout": "Esquema",
+  "Left": "Esquerda",
+  "No shading": "Sem sombra",
+  "OK": "OK",
+  "Right": "Direita",
+  "Style": "Estilo",
+  "Width:": "Largura:",
+  "percent": "porcentagem",
+  "pixels": "pixels"
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/HorizontalRule/popups/edit_horizontal_rule.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/HorizontalRule/popups/edit_horizontal_rule.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,141 @@
+<!DOCTYPE html
+     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
+    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
+
+<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
+<head>
+  <title>Insert/Edit Horizontal Rule</title>
+  <link rel="stylesheet" type="text/css" href="../../../popups/popup.css" />
+  <script type="text/javascript" src="../../../popups/popup.js"></script>
+  <script type="text/javascript" src="../../../modules/ColorPicker/ColorPicker.js"></script>
+<script type="text/javascript">
+editor = window.opener.editor;
+
+function Init() {
+	__dlg_translate("HorizontalRule");
+	__dlg_init(null,{width:320,height:290});
+	var params = window.dialogArguments;
+	if(params) {
+		document.getElementById("f_size").value = params.f_size;
+		document.getElementById("f_width").value = params.f_width;
+		document.getElementById("f_widthUnit").value = params.f_widthUnit;
+		document.getElementById("f_align").value = params.f_align;
+		document.getElementById("f_color").value = params.f_color;
+		document.getElementById("hrpv").style.backgroundColor = params.f_color;
+		document.getElementById("f_noshade").checked = params.f_noshade;
+	}
+	
+	var colpick = document.getElementById('hrpv');
+	var f_color = document.getElementById('f_color');
+	var colPicker = new Xinha.colorPicker({cellsize:'5px',callback:selectColor});
+	colpick.onclick = function() { colPicker.open('top,left',colpick, f_color.value ); }
+	
+	document.getElementById("f_width").focus();
+}
+
+function onOK() {
+  var fields = ["f_size", "f_width", "f_widthUnit", "f_align", "f_color", "f_noshade"];
+  var param = {};
+  for (var i in fields) {
+    var id = fields[i];
+	var el = document.getElementById(id);
+    param[id] = (el.type == "checkbox") ? el.checked : el.value;
+  }
+  __dlg_close(param);
+  return false;
+}
+
+function onCancel() {
+  __dlg_close(null);
+  return false;
+}
+
+function selectColor(color) {
+	document.getElementById('hrpv').style.backgroundColor = color;
+	document.getElementById('f_color').value = color;
+}
+window.onload = Init;
+</script>
+
+<style type="text/css">
+.buttonColor {
+  padding: 1px;
+  cursor: default;
+  border: 1px solid;
+  border-color: ButtonHighlight ButtonShadow ButtonShadow ButtonHighlight;
+}
+
+.buttonColor-hilite {
+  border-color: #000;
+}
+
+.buttonColor .chooser {
+  height: 0.6em;
+  border: 1px solid;
+  padding: 0px 1em;
+  border-color: ButtonShadow ButtonHighlight ButtonHighlight ButtonShadow;
+}
+
+.buttonColor .nocolor {
+  padding: 0px;
+  height: 0.6em;
+  border: 1px solid;
+  border-color: ButtonShadow ButtonHighlight ButtonHighlight ButtonShadow;
+}
+.buttonColor .nocolor-hilite { background-color: #fff; color: #f00; }
+</style>
+
+</head>
+
+<body class="dialog">
+<div class="title">Horizontal Rule</div>
+<form action="" method="get">
+  <fieldset>
+  <legend>Layout</legend>
+    <div class="fr">Width:</div>
+    <input style="margin-right: 0.5em;" name="f_width" id="f_width" size="5" type="text" />
+    <select style="margin-right: 0.5em;" name="f_widthUnit" id="f_widthUnit">
+      <option value="%">percent</option>
+      <option value="px">pixels</option>
+    </select>
+	<br />
+    <div class="fr">Height:</div>
+    <input style="margin-right: 0.5em;" name="f_size" id="f_size" size="5" type="text" /> <span>pixels</span>
+	<br />
+    <div class="fr">Alignment:</div>
+    <select name="f_align" id="f_align">
+      <option value="left">Left</option>
+      <option value="center">Center</option>
+      <option value="right">Right</option>
+    </select>
+
+  </fieldset>
+  <fieldset>
+  <legend>Style</legend>
+    <div class="fr">Color:</div>
+    <table cellpadding="2" cellspacing="0" id="hrbtn" class="buttonColor">
+    <tr>
+      <td class="chooser" id="hrpv"
+          onmouseover="document.getElementById('hrbtn').style.borderColor='black'"
+          onmouseout="document.getElementById('hrbtn').style.borderColor='ButtonHighlight ButtonShadow ButtonShadow ButtonHighlight'"
+          >&nbsp;</td>
+      <td class="nocolor" id="hrclr"
+          onmouseover="document.getElementById('hrclr').style.color='#f00'"
+          onmouseout="document.getElementById('hrclr').style.color='#000'"
+          onclick="document.getElementById('f_color').value='';	document.getElementById('hrpv').style.backgroundColor=''">&#x00d7;</td>
+    </tr>
+    </table>
+    <br />
+    <div class="fr"> </div>
+    <input type="hidden" name="f_color" id="f_color" />
+    <input type="checkbox" name="f_noshade" id="f_noshade" value="noshade" />
+    <span>No shading</span>
+    <br />
+  </fieldset>
+<div id="buttons">
+  <button type="submit" name="ok" onclick="return onOK();">OK</button>
+  <button type="button" name="cancel" onclick="return onCancel();">Cancel</button>
+</div>
+</form>
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/HtmlEntities/Entities.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/HtmlEntities/Entities.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,204 @@
+{
+"&iexcl;" : "",
+"&cent;" : "",
+"&pound;" : "",
+"&curren;" : "",
+"&yen;" : "",
+"&brvbar;" : "",
+"&sect;" : "",
+"&uml;" : "",
+"&copy;" : "",
+"&ordf;" : "",
+"&laquo;" : "",
+"&not;" : "",
+"&reg;" : "",
+"&macr;" : "",
+"&deg;" : "",
+"&plusmn;" : "",
+"&sup2;" : "",
+"&sup3;" : "",
+"&acute;" : "",
+"&micro;" : "",
+"&para;" : "",
+"&middot;" : "",
+"&cedil;" : "",
+"&sup1;" : "",
+"&ordm;" : "",
+"&raquo;" : "",
+"&frac14;" : "",
+"&frac12;" : "",
+"&frac34;" : "",
+"&iquest;" : "",
+"&Agrave;" : "",
+"&Aacute;" : "",
+"&Acirc;" : "",
+"&Atilde;" : "",
+"&Auml;" : "",
+"&Aring;" : "",
+"&AElig;" : "",
+"&Ccedil;" : "",
+"&Egrave;" : "",
+"&Eacute;" : "",
+"&Ecirc;" : "",
+"&Euml;" : "",
+"&Igrave;" : "",
+"&Iacute;" : "",
+"&Icirc;" : "",
+"&Iuml;" : "",
+"&ETH;" : "",
+"&Ntilde;" : "",
+"&Ograve;" : "",
+"&Oacute;" : "",
+"&Ocirc;" : "",
+"&Otilde;" : "",
+"&Ouml;" : "",
+"&times;" : "",
+"&Oslash;" : "",
+"&Ugrave;" : "",
+"&Uacute;" : "",
+"&Ucirc;" : "",
+"&Uuml;" : "",
+"&Yacute;" : "",
+"&THORN;" : "",
+"&szlig;" : "",
+"&agrave;" : "",
+"&aacute;" : "",
+"&acirc;" : "",
+"&atilde;" : "",
+"&auml;" : "",
+"&aring;" : "",
+"&aelig;" : "",
+"&ccedil;" : "",
+"&egrave;" : "",
+"&eacute;" : "",
+"&ecirc;" : "",
+"&euml;" : "",
+"&igrave;" : "",
+"&iacute;" : "",
+"&icirc;" : "",
+"&iuml;" : "",
+"&eth;" : "",
+"&ntilde;" : "",
+"&ograve;" : "",
+"&oacute;" : "",
+"&oacute;" : "",
+"&ocirc;" : "",
+"&otilde;" : "",
+"&ouml;" : "",
+"&divide;" : "",
+"&oslash;" : "",
+"&ugrave;" : "",
+"&uacute;" : "",
+"&ucirc;" : "",
+"&uuml;" : "",
+"&yacute;" : "",
+"&thorn;" : "",
+"&yuml;" : "",
+"&fnof;" : "",
+"&Alpha;" : "",
+"&Beta;" : "",
+"&Gamma;" : "",
+"&Delta;" : "",
+"&Epsilon;" : "",
+"&Zeta;" : "",
+"&Eta;" : "",
+"&Theta;" : "",
+"&Iota;" : "",
+"&Kappa;" : "",
+"&Lambda;" : "",
+"&Mu;" : "",
+"&Nu;" : "",
+"&Xi;" : "",
+"&Omicron;" : " ",
+"&Pi;" : "",
+"&Rho;" : "",
+"&Sigma;" : "",
+"&Tau;" : "",
+"&Upsilon;" : "",
+"&Phi;" : "",
+"&Chi;" : "",
+"&Psi;" : "",
+"&Omega;" : "",
+"&alpha;" : "",
+"&beta;" : "",
+"&gamma;" : "",
+"&delta;" : "",
+"&epsilon;" : "",
+"&zeta;" : "",
+"&eta;" : "",
+"&theta;" : "",
+"&iota;" : "",
+"&kappa;" : "",
+"&lambda;" : "",
+"&mu;" : "",
+"&nu;" : "",
+"&xi;" : "",
+"&omicron;" : "",
+"&pi;" : "",
+"&rho;" : "",
+"&sigmaf;" : "",
+"&sigma;" : "",
+"&tau;" : "",
+"&upsilon;" : "",
+"&phi;" : "",
+"&omega;" : "",
+"&bull;" : "",
+"&hellip;" : "",
+"&prime;" : "",
+"&Prime;" : "",
+"&oline;" : "",
+"&frasl;" : "",
+"&trade;" : "",
+"&larr;" : "",
+"&uarr;" : "",
+"&rarr;" : "",
+"&darr;" : "",
+"&harr;" : "",
+"&rArr;" : "",
+"&part;" : "",
+"&prod;" : "",
+"&sum;" : "",
+"&minus;" : "",
+"&radic;" : "",
+"&infin;" : "",
+"&cap;" : "",
+"&int;" : "",
+"&asymp;" : "",
+"&ne;" : "",
+"&equiv;" : "",
+"&le;" : "",
+"&ge;" : "",
+"&loz;" : "",
+"&spades;" : "",
+"&clubs;" : "",
+"&hearts;" : "",
+"&diams;" : "",
+"&OElig;" : "",
+"&oelig;" : "",
+"&Scaron;" : "",
+"&scaron;" : "",
+"&Yuml;" : "",
+"&circ;" : "",
+"&tilde;" : "",
+"&ndash;" : "",
+"&mdash;" : "",
+"&lsquo;" : "",
+"&rsquo;" : "",
+"&sbquo;" : "",
+"&ldquo;" : "",
+"&rdquo;" : "",
+"&bdquo;" : "",
+"&dagger;" : "",
+"&Dagger;" : "",
+"&permil;" : "",
+"&lsaquo;" : "",
+"&rsaquo;" : "",
+"&euro;" : "",
+
+	// \x22 means '"' -- we use hex reprezentation so that we don't disturb
+	// JS compressors (well, at least mine fails.. ;)
+	
+	"&nbsp;" : "\xA0",
+	"&#8804;" : String.fromCharCode(0x2264), 
+	"&#8805;" : String.fromCharCode(0x2265)
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/HtmlEntities/html-entities.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/HtmlEntities/html-entities.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,21 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/HtmlEntities/html-entities.js */
+function HtmlEntities(_1){
+this.editor=_1;
+}
+HtmlEntities._pluginInfo={name:"HtmlEntities",version:"1.0",developer:"Raimund Meyer",developer_url:"http://rheinauf.de",c_owner:"Xinha community",sponsor:"",sponsor_url:"",license:"Creative Commons Attribution-ShareAlike License"};
+Xinha.Config.prototype.HtmlEntities={Encoding:"iso-8859-1",EntitiesFile:Xinha.getPluginDir("HtmlEntities")+"/Entities.js"};
+HtmlEntities.prototype.onGenerate=function(){
+var e=this.editor;
+var _3=(e.config.HtmlEntities.Encoding)?Xinha.getPluginDir("HtmlEntities")+"/"+e.config.HtmlEntities.Encoding+".js":e.config.HtmlEntities.EntitiesFile;
+var _4=function(_5){
+var _6=e.config.specialReplacements;
+eval("var replacements ="+_5);
+for(var i in replacements){
+_6[i]=replacements[i];
+}
+};
+Xinha._getback(_3,_4);
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/HtmlEntities/iso-8859-1.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/HtmlEntities/iso-8859-1.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,109 @@
+{
+"&fnof;" : "",
+"&Alpha;" : "",
+"&Beta;" : "",
+"&Gamma;" : "",
+"&Delta;" : "",
+"&Epsilon;" : "",
+"&Zeta;" : "",
+"&Eta;" : "",
+"&Theta;" : "",
+"&Iota;" : "",
+"&Kappa;" : "",
+"&Lambda;" : "",
+"&Mu;" : "",
+"&Nu;" : "",
+"&Xi;" : "",
+"&Omicron;" : " ",
+"&Pi;" : "",
+"&Rho;" : "",
+"&Sigma;" : "",
+"&Tau;" : "",
+"&Upsilon;" : "",
+"&Phi;" : "",
+"&Chi;" : "",
+"&Psi;" : "",
+"&Omega;" : "",
+"&alpha;" : "",
+"&beta;" : "",
+"&gamma;" : "",
+"&delta;" : "",
+"&epsilon;" : "",
+"&zeta;" : "",
+"&eta;" : "",
+"&theta;" : "",
+"&iota;" : "",
+"&kappa;" : "",
+"&lambda;" : "",
+"&mu;" : "",
+"&nu;" : "",
+"&xi;" : "",
+"&omicron;" : "",
+"&pi;" : "",
+"&rho;" : "",
+"&sigmaf;" : "",
+"&sigma;" : "",
+"&tau;" : "",
+"&upsilon;" : "",
+"&phi;" : "",
+"&omega;" : "",
+"&bull;" : "",
+"&hellip;" : "",
+"&prime;" : "",
+"&Prime;" : "",
+"&oline;" : "",
+"&frasl;" : "",
+"&trade;" : "",
+"&larr;" : "",
+"&uarr;" : "",
+"&rarr;" : "",
+"&darr;" : "",
+"&harr;" : "",
+"&rArr;" : "",
+"&part;" : "",
+"&prod;" : "",
+"&sum;" : "",
+"&minus;" : "",
+"&radic;" : "",
+"&infin;" : "",
+"&cap;" : "",
+"&int;" : "",
+"&asymp;" : "",
+"&ne;" : "",
+"&equiv;" : "",
+"&le;" : "",
+"&ge;" : "",
+"&loz;" : "",
+"&spades;" : "",
+"&clubs;" : "",
+"&hearts;" : "",
+"&diams;" : "",
+"&OElig;" : "",
+"&oelig;" : "",
+"&Scaron;" : "",
+"&scaron;" : "",
+"&Yuml;" : "",
+"&circ;" : "",
+"&tilde;" : "",
+"&ndash;" : "",
+"&mdash;" : "",
+"&lsquo;" : "",
+"&rsquo;" : "",
+"&sbquo;" : "",
+"&ldquo;" : "",
+"&rdquo;" : "",
+"&bdquo;" : "",
+"&dagger;" : "",
+"&Dagger;" : "",
+"&permil;" : "",
+"&lsaquo;" : "",
+"&rsaquo;" : "",
+"&euro;" : "",
+
+	// \x22 means '"' -- we use hex reprezentation so that we don't disturb
+	// JS compressors (well, at least mine fails.. ;)
+	
+	"&nbsp;" : "\xA0",
+	"&#8804;" : String.fromCharCode(0x2264), 
+	"&#8805;" : String.fromCharCode(0x2265)
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/HtmlTidy/html-tidy-config.cfg
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/HtmlTidy/html-tidy-config.cfg	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,29 @@
+// Default configuration file for the htmlArea, HtmlTidy plugin
+// By Adam Wright, for The University of Western Australia
+//
+// Evertything you always wanted to know about HTML Tidy *
+// can be found at http://tidy.sourceforge.net/, and a
+// quick reference to the configuration options exists at
+// http://tidy.sourceforge.net/docs/quickref.html
+//
+// * But were afraid to ask
+//
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+
+word-2000: yes
+clean: yes
+drop-font-tags: no
+doctype: auto
+drop-empty-paras: yes
+drop-proprietary-attributes: yes
+enclose-block-text: yes
+enclose-text: yes
+escape-cdata: yes
+logical-emphasis: yes
+indent: auto
+indent-spaces: 2
+break-before-br: yes
+output-xhtml: yes
+
+force-output: yes
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/HtmlTidy/html-tidy-logic.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/HtmlTidy/html-tidy-logic.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,79 @@
+<?php 
+##
+##  Plugin for htmlArea, to run code through the server's HTML Tidy
+##   By Adam Wright, for The University of Western Australia
+##    This is the server-side script, which dirty code is run through.
+##
+##  Distributed under the same terms as HTMLArea itself.
+##  This notice MUST stay intact for use (see license.txt).
+##
+
+	// Get the original source
+	$source = $_POST['htisource_name'];
+	$source = stripslashes($source);
+  $cwd = str_replace("\\","/",getcwd())."/";
+  
+	// Open a tidy process - I hope it's installed!
+	$descriptorspec = array(
+		0 => array("pipe", "r"),
+		1 => array("pipe", "w")
+	);
+	$process = @proc_open("tidy -utf8 -config {$cwd}html-tidy-config.cfg", $descriptorspec, $pipes);
+
+
+	// Make sure the program started and we got the hooks...
+	// Either way, get some source code into $source
+	if (is_resource($process)) {
+
+		// Feed untidy source into the stdin
+		fwrite($pipes[0], $source);
+		fclose($pipes[0]);
+
+		// Read clean source out to the browser
+		while (!feof($pipes[1])) {
+			//echo fgets($pipes[1], 1024);
+			$newsrc .= fgets($pipes[1], 1024);
+		}
+		fclose($pipes[1]);
+
+		// Clean up after ourselves
+		proc_close($process);
+
+	} else {
+    /* Use tidy if it's available from PECL */
+    if( function_exists('tidy_parse_string') )
+    {
+      $tempsrc = tidy_parse_string($source);
+      tidy_clean_repair();
+      $newsrc = tidy_get_output();
+    }
+    else
+    {
+      // Better give them back what they came with, so they don't lose it all...
+      $newsrc = "<body>\n" .$source. "\n</body>";
+    }
+	}
+
+	// Split our source into an array by lines
+	$srcLines = preg_split("/\n/",$newsrc,-1,PREG_SPLIT_NO_EMPTY);
+
+	// Get only the lines between the body tags
+	$startLn = 0;
+	while ( strpos( $srcLines[$startLn++], '<body' ) === false && $startLn < sizeof($srcLines) );
+	$endLn = $startLn;
+	while ( strpos( $srcLines[$endLn++], '</body' ) === false && $endLn < sizeof($srcLines) );
+
+	$srcLines = array_slice( $srcLines, $startLn, ($endLn - $startLn - 1) );
+
+	// Create a set of javascript code to compile a new source string
+	foreach ($srcLines as $line) {
+		$jsMakeSrc .= "\tns += '" . str_replace("'","\'",$line) . "\\n';\n";
+	}
+if(!sizeof($srcLines)) {
+    echo "alert(HTMLArea._lc('Tidy failed.  Check your HTML for syntax errors.', 'HtmlTidy'));\n";
+} else {
+?>
+var ns="";
+<?php echo $jsMakeSrc; ?>
+editor.setHTML(ns);
+<? } ?>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/HtmlTidy/img/html-tidy.gif
Binary file Xinha_0.95/plugins/HtmlTidy/img/html-tidy.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/HtmlTidy/lang/de.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/HtmlTidy/lang/de.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,7 @@
+// I18N constants
+// LANG: "de", ENCODING: UTF-8
+// Author: Raimund Meyer ray@ray-of-light.org
+{
+  "HTML Tidy": "HTML Tidy",
+	"Tidy failed.  Check your HTML for syntax errors.": "Tidy fehlgeschlagen. Prfen Sie den HTML Code nach Syntax-Fehlern."  
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/HtmlTidy/lang/fr.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/HtmlTidy/lang/fr.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,8 @@
+// I18N constants
+// LANG: "fr", ENCODING: UTF-8
+{
+  "HTML Tidy": "HTML Tidy",
+  "Auto-Tidy": "Tidy automatique",
+  "Don't Tidy": "Tidy non utilis",
+  "Tidy failed.  Check your HTML for syntax errors.": "Tidy a chou. Vrifiez votre HTML for des erreurs de syntaxe"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/HtmlTidy/lang/ja.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/HtmlTidy/lang/ja.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,8 @@
+// I18N constants
+// LANG: "ja", ENCODING: UTF-8
+{
+  "HTML Tidy": "HTML Tidy",
+  "Auto-Tidy": "",
+  "Don't Tidy": "",
+  "Tidy failed.  Check your HTML for syntax errors.":"HTML"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/HtmlTidy/lang/nb.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/HtmlTidy/lang/nb.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,7 @@
+// I18N constants
+// LANG: "nb", ENCODING: UTF-8
+// translated: Kim Steinhaug, http://www.steinhaug.com/, kim@steinhaug.com
+{
+  "HTML Tidy": "HTML Tidy",
+  "Tidy failed.  Check your HTML for syntax errors.": "Tidy feilet. Sjekk HTML koden for syntaksfeil."
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/HtmlTidy/lang/nl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/HtmlTidy/lang/nl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,5 @@
+// I18N constants
+// LANG: "nl", ENCODING: UTF-8
+{
+  "HT-html-tidy": "HTML opschonen"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/HtmlTidy/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/HtmlTidy/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,21 @@
+// I18N constants
+
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+
+// Last revision: 05 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+{
+  "Auto-Tidy": "Auto-Tidy",
+  "Don't Tidy": "Sem Tidy",
+  "HTML Tidy": "HTML Tidy",
+  "Tidy failed.  Check your HTML for syntax errors.": "Tidy falhou. Verifique erros de sintaxe em seu HTML."
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/Classes/Files.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/Classes/Files.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,333 @@
+<?php
+/**
+ * File Utilities.
+ * @author $Author:koto $
+ * @version $Id:Files.php 841 2007-05-27 13:31:51Z koto $
+ * @package ImageManager
+ */
+
+define('FILE_ERROR_NO_SOURCE', 100);
+define('FILE_ERROR_COPY_FAILED', 101);
+define('FILE_ERROR_DST_DIR_FAILED', 102);
+define('FILE_COPY_OK', 103);
+define('FILE_ERROR_DST_DIR_EXIST', 104);
+
+/**
+ * File Utilities
+ * @author $Author:koto $
+ * @version $Id:Files.php 841 2007-05-27 13:31:51Z koto $
+ * @package ImageManager
+ * @subpackage files
+ */
+class Files 
+{
+	
+	/**
+	 * Copy a file from source to destination. If unique == true, then if
+	 * the destination exists, it will be renamed by appending an increamenting 
+	 * counting number.
+	 * @param string $source where the file is from, full path to the files required
+	 * @param string $destination_file name of the new file, just the filename
+	 * @param string $destination_dir where the files, just the destination dir,
+	 * e.g., /www/html/gallery/
+	 * @param boolean $unique create unique destination file if true.
+	 * @return string the new copied filename, else error if anything goes bad.
+	 */
+	function copyFile($source, $destination_dir, $destination_file, $unique=true) 
+	{
+		if(!(file_exists($source) && is_file($source))) 
+			return FILE_ERROR_NO_SOURCE;
+
+		$destination_dir = Files::fixPath($destination_dir);
+
+		if(!is_dir($destination_dir)) 
+			Return FILE_ERROR_DST_DIR_FAILED;
+
+		$filename = Files::escape($destination_file);
+
+		if($unique) 
+		{
+			$dotIndex = strrpos($destination_file, '.');
+			$ext = '';
+			if(is_int($dotIndex)) 
+			{
+				$ext = substr($destination_file, $dotIndex);
+				$base = substr($destination_file, 0, $dotIndex);
+			}
+			$counter = 0;
+			while(is_file($destination_dir.$filename)) 
+			{
+				$counter++;
+				$filename = $base.'_'.$counter.$ext;
+			}
+		}
+
+		if (!copy($source, $destination_dir.$filename))
+			return FILE_ERROR_COPY_FAILED;
+		
+		//verify that it copied, new file must exists
+		if (is_file($destination_dir.$filename))
+			Return $filename;
+		else
+			return FILE_ERROR_COPY_FAILED;
+	}
+
+	/**
+	 * Create a new folder.
+	 * @param string $newFolder specifiy the full path of the new folder.
+	 * @return boolean true if the new folder is created, false otherwise.
+	 */
+	function createFolder($newFolder) 
+	{
+		mkdir ($newFolder, 0777);
+		return chmod($newFolder, 0777);
+	}
+
+
+	/**
+	 * Escape the filenames, any non-word characters will be
+	 * replaced by an underscore.
+	 * @param string $filename the orginal filename
+	 * @return string the escaped safe filename
+	 */
+	function escape($filename)
+	{
+		Return preg_replace('/[^\w\._]/', '_', $filename);
+	}
+
+	/**
+	 * Delete a file.
+	 * @param string $file file to be deleted
+	 * @return boolean true if deleted, false otherwise.
+	 */
+	function delFile($file) 
+	{
+		if(is_file($file)) 
+			Return unlink($file);
+		else
+			Return false;
+	}
+
+	/**
+	 * Delete folder(s), can delete recursively.
+	 * @param string $folder the folder to be deleted.
+	 * @param boolean $recursive if true, all files and sub-directories
+	 * are delete. If false, tries to delete the folder, can throw
+	 * error if the directory is not empty.
+	 * @return boolean true if deleted.
+	 */
+	function delFolder($folder, $recursive=false) 
+	{
+		$deleted = true;
+		if($recursive) 
+		{
+			$d = dir($folder);
+			while (false !== ($entry = $d->read())) 
+			{
+				if ($entry != '.' && $entry != '..')
+				{
+					$obj = Files::fixPath($folder).$entry;
+					//var_dump($obj);
+					if (is_file($obj))
+					{
+						$deleted &= Files::delFile($obj);					
+					}
+					else if(is_dir($obj))
+					{
+						$deleted &= Files::delFolder($obj, $recursive);
+					}
+					
+				}
+			}
+			$d->close();
+
+		}
+
+		//$folder= $folder.'/thumbs';
+		//var_dump($folder);
+		if(is_dir($folder)) 
+			$deleted &= rmdir($folder);
+		else
+			$deleted &= false;
+
+		Return $deleted;
+	}
+
+	/**
+	 * Append a / to the path if required.
+	 * @param string $path the path
+	 * @return string path with trailing /
+	 */
+	function fixPath($path) 
+	{
+		//append a slash to the path if it doesn't exists.
+		if(!(substr($path,-1) == '/'))
+			$path .= '/';
+		Return $path;
+	}
+
+	/**
+	 * Concat two paths together. Basically $pathA+$pathB
+	 * @param string $pathA path one
+	 * @param string $pathB path two
+	 * @return string a trailing slash combinded path.
+	 */
+	function makePath($pathA, $pathB) 
+	{
+		$pathA = Files::fixPath($pathA);
+		if(substr($pathB,0,1)=='/')
+			$pathB = substr($pathB,1);
+		Return Files::fixPath($pathA.$pathB);
+	}
+
+	/**
+	 * Similar to makePath, but the second parameter
+	 * is not only a path, it may contain say a file ending.
+	 * @param string $pathA the leading path
+	 * @param string $pathB the ending path with file
+	 * @return string combined file path.
+	 */
+	function makeFile($pathA, $pathB) 
+	{		
+		$pathA = Files::fixPath($pathA);
+		if(substr($pathB,0,1)=='/')
+			$pathB = substr($pathB,1);
+		
+		Return $pathA.$pathB;
+	}
+
+	
+	/**
+	 * Format the file size, limits to Mb.
+	 * @param int $size the raw filesize
+	 * @return string formated file size.
+	 */
+	function formatSize($size) 
+	{
+		if($size < 1024) 
+			return $size.' bytes';	
+		else if($size >= 1024 && $size < 1024*1024) 
+			return sprintf('%01.2f',$size/1024.0).' KB';
+		else
+			return sprintf('%01.2f',$size/(1024.0*1024)).' MB';
+	}
+
+	/**
+	 * Returns size of a directory, with all file & subdirectory
+	 * sizes added up
+	 * @param string dir path
+	 * @return int
+	 */
+	function dirSize($dirName = '.')
+	{
+		$dir  = dir($dirName);
+		$size = 0;
+
+		while ($file = $dir->read()) {
+			if ($file != '.' && $file != '..')
+			{
+				if (is_dir("$dirName$file"))
+				{
+					$size += Files::dirSize($dirName . '/' . $file);
+				}
+				else
+				{
+					$size += filesize($dirName . '/' . $file);
+				}
+			}
+		}
+		$dir->close();
+		return $size;
+	}
+	
+	/**
+	 * Renames file, preserving its directory and extension
+	 * @param string $oldPath path to the old existing file
+	 * @param string new filename (just the name, without path or extension)
+	 * @author Krzysztof Kotowicz <koto@webworkers.pl>
+	 */
+	function renameFile($oldPath, $newName) {
+
+		if(!(file_exists($oldPath) && is_file($oldPath)))
+			return FILE_ERROR_NO_SOURCE;
+
+		$oldFileParts = pathinfo($oldPath);
+
+		$newPath = $oldFileParts['dirname'] . '/'
+				   . $newName
+				   . (!empty($oldFileParts['extension']) ? '.' . $oldFileParts['extension'] : '');
+
+		if (file_exists($newPath))
+			return false;
+
+		if (!rename($oldPath, $newPath))
+			return FILE_ERROR_COPY_FAILED;
+
+	}
+	
+	function rename ($oldPath,$newPath)
+	{
+		if(!(is_dir($oldPath) || is_file($oldPath)))
+			return FILE_ERROR_NO_SOURCE;
+		
+		if (file_exists($newPath))
+			return FILE_ERROR_DST_DIR_EXIST;
+
+		$ret = rename($oldPath, $newPath);
+		if (!$ret)
+			return FILE_ERROR_COPY_FAILED;
+		else return FILE_COPY_OK;
+	}
+	
+	/**
+	 * copy a directory and all subdirectories and files (recursive)
+	 * @author SBoisvert at Don'tSpamMe dot Bryxal dot ca (adapted from php.net)
+	 * @author Raimund Meyer
+	 * @param string base path
+	 * @param string source directory
+	 * @param string destination directory
+	 * @param bool   overwrite existing files
+	 *  
+	 * @return mixed bool true on pass, number on fail
+	 */
+  	function copyDir($basePath, $source, $dest, $overwrite = false)
+	{
+		if(!is_dir($basePath . $dest))
+		{
+			if (!@mkdir($basePath . $dest)) return FILE_ERROR_DST_DIR_FAILED;	
+		}
+		if($handle = opendir($basePath . $source))
+		{        // if the folder exploration is sucsessful, continue
+			while( ($file = readdir($handle)) !== false)
+			{ // as long as storing the next file to $file is successful, continue
+				if($file != '.' && $file != '..')
+				{
+					$path = $source . '/' . $file;
+					if(is_file($basePath . $path))
+					{
+						/*if(!is_file($basePath . $dest . '/' . $file) || $overwrite)
+						{
+							if(!@copy($basePath . $path, $basePath . $dest . '/' . $file))
+							{
+							  return FILE_ERROR_COPY_FAILED;
+							}
+						}*/
+						Files::copyFile($basePath . $path, $basePath . $dest . '/', $file, true);
+					} 
+					elseif(is_dir($basePath . $path))
+					{
+						if(!is_dir($basePath . $dest . '/' . $file))
+						{
+							mkdir($basePath . $dest . '/' . $file); // make subdirectory before subdirectory is copied
+							Files::copyDir($basePath, $path, $dest . '/' . $file, $overwrite); //recurse!
+						}
+					}
+				}
+			}
+			closedir($handle);
+		}
+		return true;
+	}
+}
+
+?>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/Classes/ImageEditor.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/Classes/ImageEditor.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,495 @@
+<?php
+/**
+ * Image Editor. Editing tools, crop, rotate, scale and save.
+ * @author $Author:ray $
+ * @version $Id:ImageEditor.php 938 2008-01-22 20:13:47Z ray $
+ * @package ImageManager
+ */
+
+require_once('../ImageManager/Classes/Transform.php');
+
+/**
+ * Handles the basic image editing capbabilities.
+ * @author $Author:ray $
+ * @version $Id:ImageEditor.php 938 2008-01-22 20:13:47Z ray $
+ * @package ImageManager
+ * @subpackage Editor
+ */
+class ImageEditor 
+{
+	/**
+	 * ImageManager instance.
+	 */
+	var $manager;
+
+	/**
+	 * user based on IP address
+	 */
+	var $_uid;
+
+	/**
+	 * tmp file storage time.
+	 */
+	var $lapse_time =900; //15 mins
+
+	var $filesaved = 0;
+
+	/**
+	 * Create a new ImageEditor instance. Editing requires a 
+	 * tmp file, which is saved in the current directory where the
+	 * image is edited. The tmp file is assigned by md5 hash of the
+	 * user IP address. This hashed is used as an ID for cleaning up
+	 * the tmp files. In addition, any tmp files older than the
+	 * the specified period will be deleted.
+	 * @param ImageManager $manager the image manager, we need this
+	 * for some file and path handling functions.
+	 */
+	function ImageEditor($manager) 
+	{
+		$this->manager = $manager;
+		$this->_uid = md5($_SERVER['REMOTE_ADDR']);
+	}
+	
+	/**
+	 * Did we save a file?
+	 * @return int 1 if the file was saved sucessfully, 
+	 * 0 no save operation, -1 file save error.
+	 */
+	function isFileSaved() 
+	{
+		Return $this->filesaved;
+	}
+
+	/**
+	 * Process the image, if not action, just display the image.
+	 * @return array with image information, empty array if not an image.
+	 * <code>array('src'=>'url of the image', 'dimensions'=>'width="xx" height="yy"',
+	 * 'file'=>'image file, relative', 'fullpath'=>'full path to the image');</code>
+	 */
+	function processImage() 
+	{
+		if(isset($_GET['img']))
+			$relative = rawurldecode($_GET['img']);
+		else
+			Return array();
+		
+		//$relative = '/Series2004NoteFront.jpg';
+
+		$imgURL = $this->manager->getFileURL($relative);
+		$fullpath = $this->manager->getFullPath($relative);
+		
+		$imgInfo = @getImageSize($fullpath);
+		if(!is_array($imgInfo))
+			Return array();
+
+		$action = $this->getAction();
+
+		if(!is_null($action))
+		{
+			$image = $this->processAction($action, $relative, $fullpath);
+		}
+		else
+		{
+			$image['src'] = $imgURL;
+			$image['dimensions'] = $imgInfo[3];
+			$image['file'] = $relative;
+			$image['fullpath'] = $fullpath;
+			$image['filesize'] = @filesize($fullpath);
+		}
+
+		Return $image;
+	}
+
+	/**
+	 * Process the actions, crop, scale(resize), rotate, flip, and save.
+	 * When ever an action is performed, the result is save into a
+	 * temporary image file, see createUnique on the filename specs.
+	 * It does not return the saved file, alway returning the tmp file.
+	 * @param string $action, should be 'crop', 'scale', 'rotate','flip', or 'save'
+	 * @param string $relative the relative image filename
+	 * @param string $fullpath the fullpath to the image file
+	 * @return array with image information
+	 * <code>array('src'=>'url of the image', 'dimensions'=>'width="xx" height="yy"',
+	 * 'file'=>'image file, relative', 'fullpath'=>'full path to the image');</code>
+	 */
+	function processAction($action, $relative, $fullpath) 
+	{
+		$params = '';
+		
+		if(isset($_GET['params']))
+			$params = $_GET['params'];
+
+		$values =  explode(',',$params);
+		$saveFile = $this->getSaveFileName($values[0]);
+
+		$img = Image_Transform::factory(IMAGE_CLASS);
+		$img->load($fullpath);
+		
+		if ( is_callable( array($img,'paletteToTrueColorWithTransparency')) && !imageistruecolor($img->imageHandle))
+		{
+			$img->paletteToTrueColorWithTransparency();
+		}
+		switch ($action) 
+		{
+			case 'crop':
+				$img->crop(intval($values[0]),intval($values[1]),
+							intval($values[2]),intval($values[3]));
+			break;
+			case 'scale':
+				$img->resize(intval($values[0]),intval($values[1]));
+				break;
+			case 'rotate':
+				$img->rotate(floatval($values[0]));
+				break;
+			case 'flip':
+				if ($values[0] == 'hoz')
+					$img->flip(true);
+				else if($values[0] == 'ver') 
+					$img->flip(false);
+				break;
+			case 'save':
+				if(!is_null($saveFile))
+				{
+					$quality = intval($values[1]);
+		            if($quality <0) $quality = 85;
+					$newSaveFile = $this->makeRelative($relative, $saveFile);
+					$newSaveFile = $this->getUniqueFilename($newSaveFile);
+					
+					//get unique filename just returns the filename, so
+					//we need to make the relative path once more.
+					$newSaveFile = $this->makeRelative($relative, $newSaveFile);
+          			$image['saveFile'] = $newSaveFile;
+					$newSaveFullpath = $this->manager->getFullPath($newSaveFile);
+					if ( $values[0] == 'gif' && is_callable(array($img, 'preserveTransparencyForPalette')))
+					{
+						$img->preserveTransparencyForPalette();
+					}
+					$img->save($newSaveFullpath, $values[0], $quality);
+					if(is_file($newSaveFullpath))
+						$this->filesaved = 1;
+					else
+						$this->filesaved = -1;
+				}
+				break;
+				case 'preview':
+					$quality = intval($values[1]);
+					
+					
+					$image['file'] = $relative;
+					$image['fullpath'] = $fullpath;
+					
+					//create the tmp image file
+					$filename = $this->createUnique($fullpath);
+					$newRelative = $this->makeRelative($relative, $filename);
+					$newFullpath = $this->manager->getFullPath($newRelative);
+					$newURL = $this->manager->getFileURL($newRelative);
+					
+					
+					if ( $values[0] == 'gif' && is_callable(array($img, 'preserveTransparencyForPalette')))
+					{
+						$img->preserveTransparencyForPalette();
+					}
+					$img->save($newFullpath, $values[0] );
+					$img->free();
+			
+					//get the image information
+					$imgInfo = @getimagesize($newFullpath);
+				
+					$image['src'] = $newURL;
+			    	$image['width'] = $imgInfo[0];
+			   		$image['height'] = $imgInfo[1];
+					$image['dimensions'] = $imgInfo[3];
+					$image['file'] = $relative;
+					$image['fullpath'] = $fullpath;
+					$image['filesize'] = @filesize($newFullpath);
+
+					Return $image;
+	
+				break;
+		}
+		
+		//create the tmp image file
+		$filename = $this->createUnique($fullpath);
+		$newRelative = $this->makeRelative($relative, $filename);
+		$newFullpath = $this->manager->getFullPath($newRelative);
+		$newURL = $this->manager->getFileURL($newRelative);
+
+		//save the file.
+		$img->save($newFullpath, 'png' );
+		$img->free();
+
+		//get the image information
+		$imgInfo = @getimagesize($newFullpath);
+
+		$image['src'] = $newURL;
+    	$image['width'] = $imgInfo[0];
+   		$image['height'] = $imgInfo[1];
+		$image['dimensions'] = $imgInfo[3];
+		$image['file'] = $newRelative;
+		$image['fullpath'] = $newFullpath;
+		$image['filesize'] = @filesize($newFullpath);
+		$image['type'] = image_type_to_mime_type($imgInfo[2]);
+		
+		Return $image;
+	
+	}
+
+	/**
+	 * Get the file name base on the save name
+	 * and the save type.
+	 * @param string $type image type, 'jpeg', 'png', or 'gif'
+	 * @return string the filename according to save type
+	 */
+	function getSaveFileName($type) 
+	{
+		if(!isset($_GET['file']))
+			Return null;
+
+		$filename = Files::escape(rawurldecode($_GET['file']));
+		$index = strrpos($filename,'.');
+		$base = substr($filename,0,$index);
+		$ext = strtolower(substr($filename,$index+1,strlen($filename)));
+
+		if($type == 'jpeg' && !($ext=='jpeg' || $ext=='jpg'))
+		{
+			Return $base.'.jpeg';
+		}
+		if($type=='png' && $ext != 'png')
+			Return $base.'.png';
+		if($type=='gif' && $ext != 'gif')
+			Return $base.'.gif';
+
+		Return $filename;
+	}
+
+	/**
+	 * Get the default save file name, used by editor.php.
+	 * @return string a suggestive filename, this should be unique
+	 */
+	function getDefaultSaveFile() 
+	{
+		if(isset($_GET['img']))
+			$relative = rawurldecode($_GET['img']);
+		else
+			Return null;
+
+		Return $this->getUniqueFilename($relative);
+	}
+
+	/**
+	 * Get a unique filename. If the file exists, the filename
+	 * base is appended with an increasing integer.
+	 * @param string $relative the relative filename to the base_dir
+	 * @return string a unique filename in the current path
+	 */
+	function getUniqueFilename($relative) 
+	{
+		$fullpath = $this->manager->getFullPath($relative);
+		
+		$pathinfo = pathinfo($fullpath);
+
+		$path = Files::fixPath($pathinfo['dirname']);
+		$file = Files::escape($pathinfo['basename']);
+		
+		$filename = $file;
+
+		$dotIndex = strrpos($file, '.');
+		$ext = '';
+
+		if(is_int($dotIndex)) 
+		{
+			$ext = substr($file, $dotIndex);
+			$base = substr($file, 0, $dotIndex);
+		}
+
+		$counter = 0;
+		while(is_file($path.$filename)) 
+		{
+			$counter++;
+			$filename = $base.'_'.$counter.$ext;
+		}
+		
+		Return $filename;
+		
+	}
+
+	/**
+	 * Specifiy the original relative path, a new filename
+	 * and return the new filename with relative path.
+	 * i.e. $pathA (-filename) + $file
+	 * @param string $pathA the relative file
+	 * @param string $file the new filename
+	 * @return string relative path with the new filename
+	 */
+	function makeRelative($pathA, $file) 
+	{
+		$index = strrpos($pathA,'/');
+		if(!is_int($index))
+			Return $file;
+
+		$path = substr($pathA, 0, $index);
+		Return Files::fixPath($path).$file;
+	}
+
+	/**
+	 * Get the action GET parameter
+	 * @return string action parameter
+	 */
+	function getAction() 
+	{
+		$action = null;
+		if(isset($_GET['action']))
+			$action = $_GET['action'];
+		Return $action;
+	}
+
+	/**
+	 * Generate a unique string based on md5(microtime()).
+	 * Well not so uniqe, as it is limited to 6 characters
+	 * @return string unique string.
+	 */
+    function uniqueStr()
+    {
+      return substr(md5(microtime()),0,6);
+    }
+
+	/**
+	 * Create unique tmp image file name.
+	 * The filename is based on the tmp file prefix
+	 * specified in config.inc.php plus 
+	 * the UID (basically a md5 of the remote IP)
+	 * and some random 6 character string.
+	 * This function also calls to clean up the tmp files.
+	 * @param string $file the fullpath to a file
+	 * @return string a unique filename for that path
+	 * NOTE: it only returns the filename, path no included.
+	 */
+	function createUnique($file) 
+	{
+		$pathinfo = pathinfo($file);
+		$path = Files::fixPath($pathinfo['dirname']);
+		$imgType = $this->getImageType($file);
+
+		$unique_str = $this->manager->getTmpPrefix().$this->_uid.'_'.$this->uniqueStr().".".$imgType;
+
+	   //make sure the the unique temp file does not exists
+        while (file_exists($path.$unique_str))
+        {
+            $unique_str = $this->manager->getTmpPrefix().$this->_uid.'_'.$this->uniqueStr().".".$imgType;
+        }
+
+		$this->cleanUp($path,$pathinfo['basename']);
+
+		Return $unique_str;
+	}
+
+	/**
+	 * Delete any tmp image files.
+	 * @param string $path the full path 
+	 * where the clean should take place.
+	 */
+	function cleanUp($path,$file) 
+	{
+		$path = Files::fixPath($path);
+
+		if(!is_dir($path))
+			Return false;
+
+		$d = @dir($path);
+		
+		$tmp = $this->manager->getTmpPrefix();
+		$tmpLen = strlen($tmp);
+
+		$prefix = $tmp.$this->_uid;
+		$len = strlen($prefix);
+
+		while (false !== ($entry = $d->read())) 
+		{
+			//echo $entry."<br>";
+			if(is_file($path.$entry) && $this->manager->isTmpFile($entry))
+			{
+				if(substr($entry,0,$len)==$prefix && $entry != $file)
+					Files::delFile($path.$entry);
+				else if(substr($entry,0,$tmpLen)==$tmp && $entry != $file)
+				{
+					if(filemtime($path.$entry)+$this->lapse_time < time())
+						Files::delFile($path.$entry);
+				}
+			}
+		}
+		$d->close();
+	}
+
+	/**
+	 * Get the image type base on an image file.
+	 * @param string $file the full path to the image file.
+	 * @return string of either 'gif', 'jpeg', 'png' or 'bmp'
+	 * otherwise it will return null.
+	 */
+	function getImageType($file) 
+	{
+		$imageInfo = @getImageSize($file);
+
+		if(!is_array($imageInfo))
+			Return null;
+
+		switch($imageInfo[2]) 
+		{
+			case 1:
+				Return 'gif';
+			case 2:
+				Return 'jpeg';
+			case 3:
+				Return 'png';
+			case 6:
+				Return 'bmp';
+		}
+
+		Return null;
+	}
+
+	/**
+	 * Check if the specified image can be edit by GD
+	 * mainly to check that GD can read and save GIFs
+	 * @return int 0 if it is not a GIF file, 1 is GIF is editable, -1 if not editable.
+	 */
+	function isGDEditable() 
+	{
+		if(isset($_GET['img']))
+			$relative = rawurldecode($_GET['img']);
+		else
+			Return 0;
+		if(IMAGE_CLASS != 'GD')
+			Return 0;
+
+		$fullpath = $this->manager->getFullPath($relative);
+ 
+		$type = $this->getImageType($fullpath);
+		if($type != 'gif')
+			Return 0;
+
+		if(function_exists('ImageCreateFrom'.$type)
+			&& function_exists('image'.$type))
+			Return 1;
+		else
+			Return -1;
+	}
+
+	/**
+	 * Check if GIF can be edit by GD.
+	 * @return int 0 if it is not using the GD library, 1 is GIF is editable, -1 if not editable.
+	 */
+	function isGDGIFAble() 
+	{
+		if(IMAGE_CLASS != 'GD')
+			Return 0;
+
+		if(function_exists('ImageCreateFromGif')
+			&& function_exists('imagegif'))
+			Return 1;
+		else
+			Return -1;
+	}
+}
+
+?>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/Classes/ImageManager.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/Classes/ImageManager.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,664 @@
+<?php
+/**
+ * ImageManager, list images, directories, and thumbnails.
+ * @author $Author:ray $
+ * @version $Id:ImageManager.php 709 2007-01-30 23:22:04Z ray $
+ * @package ImageManager
+ */
+
+require_once('../ImageManager/Classes/Files.php');
+
+// uncomment to turn on debugging
+
+// _ddtOn();
+
+/**
+ * ImageManager Class.
+ * @author $Author:ray $
+ * @version $Id:ImageManager.php 709 2007-01-30 23:22:04Z ray $
+ */
+class ImageManager 
+{
+	/**
+	 * Configuration array.
+	 */
+	var $config;
+
+	/**
+	 * Array of directory information.
+	 */
+	var $dirs;
+
+	/**
+	 * Constructor. Create a new Image Manager instance.
+	 * @param array $config configuration array, see config.inc.php
+	 */
+	function ImageManager($config) 
+	{
+		$this->config = $config;
+	}
+
+	/**
+	 * Get the images base directory.
+	 * @return string base dir, see config.inc.php
+	 */
+	function getImagesDir() 
+	{
+		Return $this->config['images_dir'];
+	}
+
+	/**
+	 * Get the images base URL.
+	 * @return string base url, see config.inc.php
+	 */
+	function getImagesURL() 
+	{
+		Return $this->config['images_url'];
+	}
+
+	function isValidBase()
+	{
+		return is_dir($this->getImagesDir());
+	}
+
+	/**
+	 * Get the tmp file prefix.
+	 * @return string tmp file prefix.
+	 */
+	function getTmpPrefix() 
+	{
+		Return $this->config['tmp_prefix'];
+	}
+
+	/**
+	 * Get the sub directories in the base dir.
+	 * Each array element contain
+	 * the relative path (relative to the base dir) as key and the 
+	 * full path as value.
+	 * @return array of sub directries
+	 * <code>array('path name' => 'full directory path', ...)</code>
+	 */
+	function getDirs() 
+	{
+		if(is_null($this->dirs))
+		{
+			$dirs = $this->_dirs($this->getImagesDir(),'/');
+			ksort($dirs);
+			$this->dirs = $dirs;
+		}
+		return $this->dirs;
+	}
+
+	/**
+	 * Recursively travese the directories to get a list
+	 * of accessable directories.
+	 * @param string $base the full path to the current directory
+	 * @param string $path the relative path name
+	 * @return array of accessiable sub-directories
+	 * <code>array('path name' => 'full directory path', ...)</code>
+	 */
+	function _dirs($base, $path) 
+	{
+		$base = Files::fixPath($base);
+		$dirs = array();
+
+		if($this->isValidBase() == false)
+			return $dirs;
+
+		$d = @dir($base);
+		
+		while (false !== ($entry = $d->read())) 
+		{
+			//If it is a directory, and it doesn't start with
+			// a dot, and if is it not the thumbnail directory
+			if(is_dir($base.$entry) 
+				&& substr($entry,0,1) != '.'
+				&& $this->isThumbDir($entry) == false) 
+			{
+				$relative = Files::fixPath($path.$entry);
+				$fullpath = Files::fixPath($base.$entry);
+				$dirs[$relative] = $fullpath;
+				$dirs = array_merge($dirs, $this->_dirs($fullpath, $relative));
+			}
+		}
+		$d->close();
+
+		Return $dirs;
+	}
+
+	/**
+	 * Get all the files and directories of a relative path.
+	 * @param string $path relative path to be base path.
+	 * @return array of file and path information.
+	 * <code>array(0=>array('relative'=>'fullpath',...), 1=>array('filename'=>fileinfo array(),...)</code>
+	 * fileinfo array: <code>array('url'=>'full url', 
+	 *                       'relative'=>'relative to base', 
+	 *                        'fullpath'=>'full file path', 
+	 *                        'image'=>imageInfo array() false if not image,
+	 *                        'stat' => filestat)</code>
+	 */
+	function getFiles($path) 
+	{
+		$files = array();
+		$dirs = array();
+
+		if($this->isValidBase() == false)
+			return array($files,$dirs);
+
+		$path = Files::fixPath($path);
+		$base = Files::fixPath($this->getImagesDir());
+		$fullpath = Files::makePath($base,$path);
+
+
+		$d = @dir($fullpath);
+		
+		while (false !== ($entry = $d->read())) 
+		{
+			//not a dot file or directory
+			if(substr($entry,0,1) != '.')
+			{
+				if(is_dir($fullpath.$entry)
+					&& $this->isThumbDir($entry) == false)
+				{
+					$relative = Files::fixPath($path.$entry);
+					$full = Files::fixPath($fullpath.$entry);
+					$count = $this->countFiles($full);
+					$dirs[$relative] = array('fullpath'=>$full,'entry'=>$entry,'count'=>$count);
+				}
+				else if(is_file($fullpath.$entry) && $this->isThumb($entry)==false && $this->isTmpFile($entry) == false) 
+				{
+					$img = $this->getImageInfo($fullpath.$entry);
+
+					if(!(!is_array($img)&&$this->config['validate_images']))
+					{
+						$file['url'] = Files::makePath($this->config['base_url'],$path).$entry;
+						$file['relative'] = $path.$entry;
+						$file['fullpath'] = $fullpath.$entry;
+						$file['image'] = $img;
+						$file['stat'] = stat($fullpath.$entry);
+						$files[$entry] = $file;
+					}
+				}
+			}
+		}
+		$d->close();
+		ksort($dirs);
+		ksort($files);
+		
+		Return array($dirs, $files);
+	}	
+
+	/**
+	 * Count the number of files and directories in a given folder
+	 * minus the thumbnail folders and thumbnails.
+	 */
+	function countFiles($path) 
+	{
+		$total = 0;
+
+		if(is_dir($path)) 
+		{
+			$d = @dir($path);
+
+			while (false !== ($entry = $d->read())) 
+			{
+				//echo $entry."<br>";
+				if(substr($entry,0,1) != '.'
+					&& $this->isThumbDir($entry) == false
+					&& $this->isTmpFile($entry) == false
+					&& $this->isThumb($entry) == false) 
+				{
+					$total++;
+				}
+			}
+			$d->close();
+		}
+		return $total;
+	}
+
+	/**
+	 * Get image size information.
+	 * @param string $file the image file
+	 * @return array of getImageSize information, 
+	 *  false if the file is not an image.
+	 */
+	function getImageInfo($file) 
+	{
+		Return @getImageSize($file);
+	}
+
+	/**
+	 * Check if the file contains the thumbnail prefix.
+	 * @param string $file filename to be checked
+	 * @return true if the file contains the thumbnail prefix, false otherwise.
+	 */
+	function isThumb($file) 
+	{
+		$len = strlen($this->config['thumbnail_prefix']);
+		if(substr($file,0,$len)==$this->config['thumbnail_prefix'])
+			Return true;
+		else
+			Return false;
+	}
+
+	/**
+	 * Check if the given directory is a thumbnail directory.
+	 * @param string $entry directory name
+	 * @return true if it is a thumbnail directory, false otherwise
+	 */
+	function isThumbDir($entry) 
+	{
+		if($this->config['thumbnail_dir'] == false
+			|| strlen(trim($this->config['thumbnail_dir'])) == 0)
+			Return false;		
+		else
+			Return ($entry == $this->config['thumbnail_dir']);
+	}
+
+	/**
+	 * Check if the given file is a tmp file.
+	 * @param string $file file name
+	 * @return boolean true if it is a tmp file, false otherwise
+	 */
+	function isTmpFile($file) 
+	{
+		$len = strlen($this->config['tmp_prefix']);
+		if(substr($file,0,$len)==$this->config['tmp_prefix'])
+			Return true;
+		else
+			Return false;	 	
+	}
+
+	/**
+	 * For a given image file, get the respective thumbnail filename
+	 * no file existence check is done.
+	 * @param string $fullpathfile the full path to the image file
+	 * @return string of the thumbnail file
+	 */
+	function getThumbName($fullpathfile) 
+	{
+		$path_parts = pathinfo($fullpathfile);
+		
+		$thumbnail = $this->config['thumbnail_prefix'].$path_parts['basename'];
+
+		if( strlen(trim($this->config['thumbnail_dir'])) == 0 || $this->config['safe_mode'] == true)
+		{
+			Return Files::makeFile($path_parts['dirname'],$thumbnail);
+		}
+		else
+		{
+				$path = Files::makePath($path_parts['dirname'],$this->config['thumbnail_dir']);
+				if(!is_dir($path))
+					Files::createFolder($path);
+				Return Files::makeFile($path,$thumbnail);
+		}
+	}
+	
+	/**
+	 * Similar to getThumbName, but returns the URL, base on the
+	 * given base_url in config.inc.php
+	 * @param string $relative the relative image file name, 
+	 * relative to the base_dir path
+	 * @return string the url of the thumbnail
+	 */
+	function getThumbURL($relative) 
+	{
+
+		_ddt( __FILE__, __LINE__, "getThumbURL(): relative is '$relative'" );
+
+		$path_parts = pathinfo($relative);
+		$thumbnail = $this->config['thumbnail_prefix'].$path_parts['basename'];
+		if($path_parts['dirname']=='\\') $path_parts['dirname']='/';
+
+		if($this->config['safe_mode'] == true
+			|| strlen(trim($this->config['thumbnail_dir'])) == 0)
+		{
+			Return Files::makeFile($this->getImagesURL(),$thumbnail);
+		}
+		else
+		{
+			if(strlen(trim($this->config['thumbnail_dir'])) > 0)
+			{
+				$path = Files::makePath($path_parts['dirname'],$this->config['thumbnail_dir']);
+				$url_path = Files::makePath($this->getImagesURL(), $path);
+
+				_ddt( __FILE__, __LINE__, "getThumbURL(): url_path is '$url_path'" );
+
+				Return Files::makeFile($url_path,$thumbnail);
+			}
+			else //should this ever happen?
+			{
+				//error_log('ImageManager: Error in creating thumbnail url');
+			}
+
+		}
+	}
+
+
+	/**
+	 * For a given image file, get the respective resized filename
+	 * no file existence check is done.
+	 * @param string $fullpathfile the full path to the image file
+	 * @param integer $width the intended width
+	 * @param integer $height the intended height
+	 * @param boolean $mkDir whether to attempt to make the resized_dir if it doesn't exist
+	 * @return string of the resized filename
+	 */
+	function getResizedName($fullpathfile, $width, $height, $mkDir = TRUE)
+	{
+		$path_parts = pathinfo($fullpathfile);
+
+		$thumbnail = $this->config['resized_prefix']."_{$width}x{$height}_{$path_parts['basename']}";
+
+		if( strlen(trim($this->config['resized_dir'])) == 0 || $this->config['safe_mode'] == true )
+		{
+			Return Files::makeFile($path_parts['dirname'],$thumbnail);
+		}
+		else
+		{
+			$path = Files::makePath($path_parts['dirname'],$this->config['resized_dir']);
+			if($mkDir && !is_dir($path))
+				Files::createFolder($path);
+			Return Files::makeFile($path,$thumbnail);
+		}
+	}
+
+	/**
+	 * Check if the given path is part of the subdirectories
+	 * under the base_dir.
+	 * @param string $path the relative path to be checked
+	 * @return boolean true if the path exists, false otherwise
+	 */
+	function validRelativePath($path) 
+	{
+		$dirs = $this->getDirs();
+		if($path == '/')
+			Return true;
+		//check the path given in the url against the 
+		//list of paths in the system.
+		for($i = 0; $i < count($dirs); $i++)
+		{
+			$key = key($dirs);
+			//we found the path
+			if($key == $path)
+				Return true;
+		
+			next($dirs);
+		}		
+		Return false;
+	}
+
+	/**
+	 * Process uploaded files, assumes the file is in 
+	 * $_FILES['upload'] and $_POST['dir'] is set.
+	 * The dir must be relative to the base_dir and exists.
+	 * If 'validate_images' is set to true, only file with
+	 * image dimensions will be accepted.
+	 * @return null
+	 */
+	function processUploads() 
+	{
+		if($this->isValidBase() == false)
+			return;
+
+		$relative = null;
+
+		if(isset($_POST['dir'])) 
+			$relative = rawurldecode($_POST['dir']);
+		else
+			return;
+
+		//check for the file, and must have valid relative path
+		if(isset($_FILES['upload']) && $this->validRelativePath($relative))
+		{
+			$this->_processFiles($relative, $_FILES['upload']);
+		}
+	}
+
+	/**
+	 * Process upload files. The file must be an 
+	 * uploaded file. If 'validate_images' is set to
+	 * true, only images will be processed. Any duplicate
+	 * file will be renamed. See Files::copyFile for details
+	 * on renaming.
+	 * @param string $relative the relative path where the file
+	 * should be copied to.
+	 * @param array $file the uploaded file from $_FILES
+	 * @return boolean true if the file was processed successfully, 
+	 * false otherwise
+	 */
+	function _processFiles($relative, $file)
+	{
+		
+		if($file['error']!=0)
+		{
+			Return false;
+		}
+
+		if(!is_file($file['tmp_name']))
+		{
+			Return false;
+		}
+
+		if(!is_uploaded_file($file['tmp_name']))
+		{
+			Files::delFile($file['tmp_name']);
+			Return false;
+		}
+		
+
+		if($this->config['validate_images'] == true)
+		{
+			$imgInfo = @getImageSize($file['tmp_name']);
+			if(!is_array($imgInfo))
+			{
+				Files::delFile($file['tmp_name']);
+				Return false;
+			}
+		}
+
+		//now copy the file
+		$path = Files::makePath($this->getImagesDir(),$relative);
+		$result = Files::copyFile($file['tmp_name'], $path, $file['name']);
+
+		//no copy error
+		if(!is_int($result))
+		{
+			Files::delFile($file['tmp_name']);
+			Return true;
+		}
+
+		//delete tmp files.
+		Files::delFile($file['tmp_name']);
+		Return false;
+	}
+
+	/**
+	 * Get the URL of the relative file.
+	 * basically appends the relative file to the 
+	 * base_url given in config.inc.php
+	 * @param string $relative a file the relative to the base_dir
+	 * @return string the URL of the relative file.
+	 */
+	function getFileURL($relative) 
+	{
+		Return Files::makeFile($this->getImagesURL(),$relative);
+	}
+
+	/**
+	 * Get the fullpath to a relative file.
+	 * @param string $relative the relative file.
+	 * @return string the full path, .ie. the base_dir + relative.
+	 */
+	function getFullPath($relative) 
+	{
+		Return Files::makeFile($this->getImagesDir(),$relative);;
+	}
+
+	/**
+	 * Get the default thumbnail.
+	 * @return string default thumbnail, empty string if 
+	 * the thumbnail doesn't exist.
+	 */
+	function getDefaultThumb() 
+	{
+
+		// FIXME: hack
+
+		Return $this->config['default_thumbnail'];
+
+		if(is_file($this->config['default_thumbnail']))
+			{
+			Return $this->config['default_thumbnail'];
+			}
+		else 
+			Return '';
+	}
+
+
+	/**
+	 * Get the thumbnail url to be displayed. 
+	 * If the thumbnail exists, and it is up-to-date
+	 * the thumbnail url will be returns. If the 
+	 * file is not an image, a default image will be returned.
+	 * If it is an image file, and no thumbnail exists or 
+	 * the thumbnail is out-of-date (i.e. the thumbnail 
+	 * modified time is less than the original file)
+	 * then a thumbs.php?img=filename.jpg is returned.
+	 * The thumbs.php url will generate a new thumbnail
+	 * on the fly. If the image is less than the dimensions
+	 * of the thumbnails, the image will be display instead.
+	 * @param string $relative the relative image file.
+	 * @return string the url of the thumbnail, be it
+	 * actually thumbnail or a script to generate the
+	 * thumbnail on the fly.
+	 */
+	function getThumbnail($relative) 
+	{
+
+		global $IMConfig;
+
+		_ddt( __FILE__, __LINE__, "getThumbnail(): top with '$relative'" );
+
+		$fullpath = Files::makeFile($this->getImagesDir(),$relative);
+
+		//not a file???
+		if(!is_file($fullpath))
+			Return $this->getDefaultThumb();
+
+		$imgInfo = @getImageSize($fullpath);
+		
+		//not an image
+		if(!is_array($imgInfo))
+			Return $this->getDefaultThumb();
+
+		//the original image is smaller than thumbnails,
+		//so just return the url to the original image.
+		if ($imgInfo[0] <= $this->config['thumbnail_width']
+		 && $imgInfo[1] <= $this->config['thumbnail_height'])
+			Return $this->getFileURL($relative);
+
+		$thumbnail = $this->getThumbName($fullpath);
+		
+		//check for thumbnails, if exists and
+		// it is up-to-date, return the thumbnail url
+		if(is_file($thumbnail))
+		{
+			if(filemtime($thumbnail) >= filemtime($fullpath))
+				{
+				_ddt( __FILE__, __LINE__, "getThumbnail(): returning url '" . $this->getThumbURL($relative) . "'" );
+
+				Return $this->getThumbURL($relative);
+				}
+		}
+
+		//well, no thumbnail was found, so ask the thumbs.php
+		//to generate the thumbnail on the fly.
+		Return $IMConfig['backend_url'] . '__function=thumbs&img='.rawurlencode($relative);
+	}
+
+	/**
+	 * Delete and specified files.
+	 * @return boolean true if delete, false otherwise
+	 */
+	function deleteFiles() 
+	{
+		if(isset($_GET['delf']))
+			$this->_delFile(rawurldecode($_GET['delf']));
+	}
+
+	/**
+	 * Delete and specified directories.
+	 * @return boolean true if delete, false otherwise
+	 */
+	function deleteDirs() 
+	{
+		 if(isset($_GET['deld']))
+			return $this->_delDir(rawurldecode($_GET['deld']));		
+		 else
+			 Return false;
+	}
+
+	/**
+	 * Delete the relative file, and any thumbnails.
+	 * @param string $relative the relative file.
+	 * @return boolean true if deleted, false otherwise.
+	 */
+	function _delFile($relative) 
+	{
+		$fullpath = Files::makeFile($this->getImagesDir(),$relative);
+		
+		//check that the file is an image
+		if($this->config['validate_images'] == true)
+		{
+			if(!is_array($this->getImageInfo($fullpath)))
+				return false; //hmmm not an Image!!???
+		}
+
+		$thumbnail = $this->getThumbName($fullpath);
+
+		if(Files::delFile($fullpath))
+			Return Files::delFile($thumbnail);
+		else
+			Return false;
+	}
+
+	/**
+	 * Delete directories recursively.
+	 * @param string $relative the relative path to be deleted.
+	 * @return boolean true if deleted, false otherwise.
+	 */
+	function _delDir($relative) 
+	{
+		$fullpath = Files::makePath($this->getImagesDir(),$relative);
+		if($this->countFiles($fullpath) <= 0)
+			return Files::delFolder($fullpath,true); //delete recursively.
+		else
+			Return false;
+	}
+
+	/**
+	 * Create new directories.
+	 * If in safe_mode, nothing happens.
+	 * @return boolean true if created, false otherwise.
+	 */
+	function processNewDir() 
+	{
+		if($this->config['safe_mode'] == true)
+			Return false;
+
+		if(isset($_GET['newDir']) && isset($_GET['dir']))
+		{
+			$newDir = rawurldecode($_GET['newDir']);
+			$dir = rawurldecode($_GET['dir']);
+			$path = Files::makePath($this->getImagesDir(),$dir);
+			$fullpath = Files::makePath($path, Files::escape($newDir));
+			if(is_dir($fullpath))
+				Return false;
+
+			Return Files::createFolder($fullpath);
+		}
+	}
+}
+
+?>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/Classes/NetPBM.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/Classes/NetPBM.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,257 @@
+<?php
+/***********************************************************************
+** Title.........:  NetPBM Driver
+** Version.......:  1.0
+** Author........:  Xiang Wei ZHUO <wei@zhuo.org>
+** Filename......:  NetPBM.php
+** Last changed..:  30 Aug 2003 
+** Notes.........:  Orginal is from PEAR
+**/
+
+// +----------------------------------------------------------------------+
+// | PHP Version 4                                                        |
+// +----------------------------------------------------------------------+
+// | Copyright (c) 1997-2002 The PHP Group                                |
+// +----------------------------------------------------------------------+
+// | This source file is subject to version 2.02 of the PHP license,      |
+// | that is bundled with this package in the file LICENSE, and is        |
+// | available at through the world-wide-web at                           |
+// | http://www.php.net/license/2_02.txt.                                 |
+// | If you did not receive a copy of the PHP license and are unable to   |
+// | obtain it through the world-wide-web, please send a note to          |
+// | license@php.net so we can mail you a copy immediately.               |
+// +----------------------------------------------------------------------+
+// | Authors: Peter Bowyer <peter@mapledesign.co.uk>                      |
+// +----------------------------------------------------------------------+
+//
+// $Id:NetPBM.php 709 2007-01-30 23:22:04Z ray $
+//
+// Image Transformation interface using command line NetPBM
+
+require_once "../ImageManager/Classes/Transform.php";
+
+Class Image_Transform_Driver_NetPBM extends Image_Transform
+{
+
+    /**
+     * associative array commands to be executed
+     * @var array
+     */
+    var $command = array();
+
+    /**
+     * Class Constructor
+     */
+    function Image_Transform_Driver_NetPBM()
+    {
+        $this->uid = md5($_SERVER['REMOTE_ADDR']);
+            
+        return true;
+    } // End function Image_NetPBM
+
+    /**
+     * Load image
+     *
+     * @param string filename
+     *
+     * @return mixed none or a PEAR error object on error
+     * @see PEAR::isError()
+     */
+    function load($image)
+    {
+        //echo $image;
+        $this->image = $image;
+        $this->_get_image_details($image);
+    } // End load
+
+    /**
+     * Resizes the image
+     *
+     * @return none
+     * @see PEAR::isError()
+     */
+    function _resize($new_x, $new_y)
+    {
+        // there's no technical reason why resize can't be called multiple
+        // times...it's just silly to do so
+
+        $this->command[] = IMAGE_TRANSFORM_LIB_PATH .
+                           "pnmscale -width $new_x -height $new_y";
+
+        $this->_set_new_x($new_x);
+        $this->_set_new_y($new_y);
+    } // End resize
+
+    /**
+     * Crop the image
+     *
+     * @param int $crop_x left column of the image
+     * @param int $crop_y top row of the image
+     * @param int $crop_width new cropped image width
+     * @param int $crop_height new cropped image height
+     */
+    function crop($crop_x, $crop_y, $crop_width, $crop_height) 
+    {
+        $this->command[] = IMAGE_TRANSFORM_LIB_PATH .
+                            "pnmcut -left $crop_x -top $crop_y -width $crop_width -height $crop_height";
+    }
+
+    /**
+     * Rotates the image
+     *
+     * @param int $angle The angle to rotate the image through
+     */
+    function rotate($angle)
+    {
+        $angle = -1*floatval($angle);
+
+        if($angle > 90)
+        {   
+            $this->command[] = IMAGE_TRANSFORM_LIB_PATH . "pnmrotate -noantialias 90";
+            $this->rotate(-1*($angle-90));
+        }
+        else if ($angle < -90)
+        {
+            $this->command[] = IMAGE_TRANSFORM_LIB_PATH . "pnmrotate -noantialias -90";
+            $this->rotate(-1*($angle+90));
+        }
+        else
+            $this->command[] = IMAGE_TRANSFORM_LIB_PATH . "pnmrotate -noantialias $angle";
+    } // End rotate
+
+    /**
+     * Flip the image horizontally or vertically
+     *
+     * @param boolean $horizontal true if horizontal flip, vertical otherwise
+     */
+    function flip($horizontal) 
+    {
+        if($horizontal) 
+            $this->command[] = IMAGE_TRANSFORM_LIB_PATH . "pnmflip -lr";
+        else
+            $this->command[] = IMAGE_TRANSFORM_LIB_PATH . "pnmflip -tb";
+    }
+
+    /**
+     * Adjust the image gamma
+     *
+     * @param float $outputgamma
+     *
+     * @return none
+     */
+    function gamma($outputgamma = 1.0) {
+        $this->command[13] = IMAGE_TRANSFORM_LIB_PATH . "pnmgamma $outputgamma";
+    }
+
+    /**
+     * adds text to an image
+     *
+     * @param   array   options     Array contains options
+     *             array(
+     *                  'text'          // The string to draw
+     *                  'x'             // Horizontal position
+     *                  'y'             // Vertical Position
+     *                  'Color'         // Font color
+     *                  'font'          // Font to be used
+     *                  'size'          // Size of the fonts in pixel
+     *                  'resize_first'  // Tell if the image has to be resized
+     *                                  // before drawing the text
+     *                   )
+     *
+     * @return none
+     */
+    function addText($params)
+    {
+        $default_params = array('text' => 'This is Text',
+                                'x' => 10,
+                                'y' => 20,
+                                'color' => 'red',
+                                'font' => 'Arial.ttf',
+                                'size' => '12',
+                                'angle' => 0,
+                                'resize_first' => false);
+        // we ignore 'resize_first' since the more logical approach would be
+        // for the user to just call $this->_resize() _first_ ;)
+        extract(array_merge($default_params, $params));
+        $this->command[] = "ppmlabel -angle $angle -colour $color -size "
+                           ."$size -x $x -y ".$y+$size." -text \"$text\"";
+    } // End addText
+
+    function _postProcess($type, $quality, $save_type)
+    {
+        $type = is_null($type) || $type==''? $this->type : $type;
+        $save_type = is_null($save_type) || $save_type==''? $this->type : $save_type;
+        //echo "TYPE:". $this->type;
+        array_unshift($this->command, IMAGE_TRANSFORM_LIB_PATH
+                      . $type.'topnm '. $this->image);
+        $arg = '';
+        switch(strtolower($save_type)){
+            case 'gif':
+                $this->command[] = IMAGE_TRANSFORM_LIB_PATH . "ppmquant 256";
+                $this->command[] = IMAGE_TRANSFORM_LIB_PATH . "ppmto$save_type";
+                break;
+            case 'jpg':
+            case 'jpeg':
+                $arg = "--quality=$quality";
+                $this->command[] = IMAGE_TRANSFORM_LIB_PATH . "ppmto$save_type $arg";
+                break;
+            default:
+                $this->command[] = IMAGE_TRANSFORM_LIB_PATH . "pnmto$save_type $arg";
+                break;
+        } // switch
+        return implode('|', $this->command);
+    } 
+
+    /**
+     * Save the image file
+     *
+     * @param string $filename the name of the file to write to
+     * @param string $type (jpeg,png...);
+     * @param int $quality 75
+     * @return none
+     */
+    function save($filename, $type=null, $quality = 85)
+    {
+        $cmd = $this->_postProcess('', $quality, $type) . ">$filename";
+            
+		//if we have windows server
+        if(isset($_ENV['OS']) && eregi('window',$_ENV['OS']))
+			$cmd = ereg_replace('/','\\',$cmd);
+        //echo $cmd."##";
+        $output = system($cmd);
+		error_log('NETPBM: '.$cmd);
+		//error_log($output);
+        $this->command = array();
+    } // End save
+
+
+    /**
+     * Display image without saving and lose changes
+     *
+     * @param string $type (jpeg,png...);
+     * @param int $quality 75
+     * @return none
+     */
+    function display($type = null, $quality = 75)
+    {
+        header('Content-type: image/' . $type);
+        $cmd = $this->_postProcess($type, $quality);
+        
+        passthru($cmd);
+        $this->command = array();
+    }
+
+    /**
+     * Destroy image handle
+     *
+     * @return none
+     */
+    function free()
+    {
+        // there is no image handle here
+        return true;
+    }
+
+
+} // End class NetPBM
+?>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/Classes/Thumbnail.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/Classes/Thumbnail.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,125 @@
+<?php
+/**
+ * Create thumbnails.
+ * @author $Author:ray $
+ * @version $Id:Thumbnail.php 709 2007-01-30 23:22:04Z ray $
+ * @package ImageManager
+ */
+
+
+require_once('../ImageManager/Classes/Transform.php');
+
+/**
+ * Thumbnail creation
+ * @author $Author:ray $
+ * @version $Id:Thumbnail.php 709 2007-01-30 23:22:04Z ray $
+ * @package ImageManager
+ * @subpackage Images
+ */
+class Thumbnail 
+{
+	/**
+	 * Graphics driver, GD, NetPBM or ImageMagick.
+	 */
+	var $driver;
+
+	/**
+	 * Thumbnail default width.
+	 */
+	var $width = 96;
+
+	/**
+	 * Thumbnail default height.
+	 */
+	var $height = 96;
+
+	/**
+	 * Thumbnail default JPEG quality.
+	 */
+	var $quality = 85;
+
+	/**
+	 * Thumbnail is proportional
+	 */
+	var $proportional = true;
+
+	/**
+	 * Default image type is JPEG.
+	 */
+	var $type = 'jpeg';
+
+	/**
+	 * Create a new Thumbnail instance.
+	 * @param int $width thumbnail width
+	 * @param int $height thumbnail height
+	 */
+	function Thumbnail($width=96, $height=96) 
+	{
+		$this->driver = Image_Transform::factory(IMAGE_CLASS);
+		$this->width = $width;
+		$this->height = $height;
+	}
+
+	/**
+	 * Create a thumbnail.
+	 * @param string $file the image for the thumbnail
+	 * @param string $thumbnail if not null, the thumbnail will be saved
+	 * as this parameter value.
+	 * @return boolean true if thumbnail is created, false otherwise
+	 */
+	function createThumbnail($file, $thumbnail=null) 
+	{
+		if(!is_file($file)) 
+			Return false;
+
+		//error_log('Creating Thumbs: '.$file);
+
+		$this->driver->load($file);
+
+		if($this->proportional) 
+		{
+			$width = $this->driver->img_x;
+			$height = $this->driver->img_y;
+
+			if ($width > $height)
+				$this->height = intval($this->width/$width*$height);
+			else if ($height > $width)
+				$this->width = intval($this->height/$height*$width);
+		}
+
+		$this->driver->resize($this->width, $this->height);
+
+		if(is_null($thumbnail)) 
+			$this->save($file);
+		else
+			$this->save($thumbnail);
+
+
+		$this->free();
+
+		if(is_file($thumbnail)) 
+			Return true;
+		else
+			Return false;
+	}
+
+	/**
+	 * Save the thumbnail file.
+	 * @param string $file file name to be saved as.
+	 */
+	function save($file) 
+	{
+		$this->driver->save($file);
+	}
+
+	/**
+	 * Free up the graphic driver resources.
+	 */
+	function free() 
+	{
+		$this->driver->free();
+	}
+}
+
+
+?>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/Classes/Transform.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/Classes/Transform.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,569 @@
+<?php
+/***********************************************************************
+** Title.........:  Image Transformation Interface
+** Version.......:  1.0
+** Author........:  Xiang Wei ZHUO <wei@zhuo.org>
+** Filename......:  Transform.php
+** Last changed..:  30 Aug 2003 
+** Notes.........:  Orginal is from PEAR
+                    
+                    Added a few extra,
+                        - create unique filename in a particular directory,
+                          used for temp image files.
+                        - added cropping to GD, NetPBM, ImageMagick
+**/
+
+// +----------------------------------------------------------------------+
+// | PHP Version 4                                                        |
+// +----------------------------------------------------------------------+
+// | Copyright (c) 1997-2002 The PHP Group                                |
+// +----------------------------------------------------------------------+
+// | This source file is subject to version 2.02 of the PHP license,      |
+// | that is bundled with this package in the file LICENSE, and is        |
+// | available at through the world-wide-web at                           |
+// | http://www.php.net/license/2_02.txt.                                 |
+// | If you did not receive a copy of the PHP license and are unable to   |
+// | obtain it through the world-wide-web, please send a note to          |
+// | license@php.net so we can mail you a copy immediately.               |
+// +----------------------------------------------------------------------+
+// | Authors: Peter Bowyer <peter@mapledesign.co.uk>                      |
+// |          Alan Knowles <alan@akbkhome.com>                            |
+// |          Vincent Oostindie <vincent@sunlight.tmfweb.nl>              |
+// +----------------------------------------------------------------------+
+//
+// $Id:Transform.php 709 2007-01-30 23:22:04Z ray $
+//
+// Image Transformation interface
+//
+
+
+/**
+ * The main "Image_Resize" class is a container and base class which
+ * provides the static methods for creating Image objects as well as
+ * some utility functions (maths) common to all parts of Image Resize.
+ *
+ * The object model of DB is as follows (indentation means inheritance):
+ *
+ * Image_Resize The base for each Image implementation.  Provides default
+ * |            implementations (in OO lingo virtual methods) for
+ * |            the actual Image implementations as well as a bunch of
+ * |            maths methods.
+ * |
+ * +-Image_GD   The Image implementation for the PHP GD extension .  Inherits
+ *              Image_Resize
+ *              When calling DB::setup for GD images the object returned is an
+ *              instance of this class.
+ *
+ * @package  Image Resize
+ * @version  1.00
+ * @author   Peter Bowyer <peter@mapledesign.co.uk>
+ * @since    PHP 4.0
+ */
+Class Image_Transform
+{
+    /**
+     * Name of the image file
+     * @var string
+     */
+    var $image = '';
+    /**
+     * Type of the image file (eg. jpg, gif png ...)
+     * @var string
+     */
+    var $type = '';
+    /**
+     * Original image width in x direction
+     * @var int
+     */
+    var $img_x = '';
+    /**
+     * Original image width in y direction
+     * @var int
+     */
+    var $img_y = '';
+    /**
+     * New image width in x direction
+     * @var int
+     */
+    var $new_x = '';
+    /**
+     * New image width in y direction
+     * @var int
+     */
+    var $new_y = '';
+    /**
+     * Path the the library used
+     * e.g. /usr/local/ImageMagick/bin/ or
+     * /usr/local/netpbm/
+     */
+    var $lib_path = '';
+    /**
+     * Flag to warn if image has been resized more than once before displaying
+     * or saving.
+     */
+     var $resized = false;
+
+
+     var $uid = '';
+
+     var $lapse_time =900; //15 mins
+
+    /**
+     * Create a new Image_resize object
+     *
+     * @param string $driver name of driver class to initialize
+     *
+     * @return mixed a newly created Image_Transform object, or a PEAR
+     * error object on error
+     *
+     * @see PEAR::isError()
+     * @see Image_Transform::setOption()
+     */
+    function &factory($driver)
+    {
+        if ('' == $driver) {
+            die("No image library specified... aborting.  You must call ::factory() with one parameter, the library to load.");
+
+        }
+        $this->uid = md5($_SERVER['REMOTE_ADDR']);
+
+        include_once "../ImageManager/Classes/$driver.php";
+
+        $classname = "Image_Transform_Driver_{$driver}";
+        $obj =& new $classname;
+        return $obj;
+    }
+
+
+    /**
+     * Resize the Image in the X and/or Y direction
+     * If either is 0 it will be scaled proportionally
+     *
+     * @access public
+     *
+     * @param mixed $new_x (0, number, percentage 10% or 0.1)
+     * @param mixed $new_y (0, number, percentage 10% or 0.1)
+     *
+     * @return mixed none or PEAR_error
+     */
+    function resize($new_x = 0, $new_y = 0)
+    {
+        // 0 means keep original size
+        $new_x = (0 == $new_x) ? $this->img_x : $this->_parse_size($new_x, $this->img_x);
+        $new_y = (0 == $new_y) ? $this->img_y : $this->_parse_size($new_y, $this->img_y);
+        // Now do the library specific resizing.
+        return $this->_resize($new_x, $new_y);
+    } // End resize
+
+
+    /**
+     * Scale the image to have the max x dimension specified.
+     *
+     * @param int $new_x Size to scale X-dimension to
+     * @return none
+     */
+    function scaleMaxX($new_x)
+    {
+        $new_y = round(($new_x / $this->img_x) * $this->img_y, 0);
+        return $this->_resize($new_x, $new_y);
+    } // End resizeX
+
+    /**
+     * Scale the image to have the max y dimension specified.
+     *
+     * @access public
+     * @param int $new_y Size to scale Y-dimension to
+     * @return none
+     */
+    function scaleMaxY($new_y)
+    {
+        $new_x = round(($new_y / $this->img_y) * $this->img_x, 0);
+        return $this->_resize($new_x, $new_y);
+    } // End resizeY
+
+    /**
+     * Scale Image to a maximum or percentage
+     *
+     * @access public
+     * @param mixed (number, percentage 10% or 0.1)
+     * @return mixed none or PEAR_error
+     */
+    function scale($size)
+    {
+        if ((strlen($size) > 1) && (substr($size,-1) == '%')) {
+            return $this->scaleByPercentage(substr($size, 0, -1));
+        } elseif ($size < 1) {
+            return $this->scaleByFactor($size);
+        } else {
+            return $this->scaleByLength($size);
+        }
+    } // End scale
+
+    /**
+     * Scales an image to a percentage of its original size.  For example, if
+     * my image was 640x480 and I called scaleByPercentage(10) then the image
+     * would be resized to 64x48
+     *
+     * @access public
+     * @param int $size Percentage of original size to scale to
+     * @return none
+     */
+    function scaleByPercentage($size)
+    {
+        return $this->scaleByFactor($size / 100);
+    } // End scaleByPercentage
+
+    /**
+     * Scales an image to a factor of its original size.  For example, if
+     * my image was 640x480 and I called scaleByFactor(0.5) then the image
+     * would be resized to 320x240.
+     *
+     * @access public
+     * @param float $size Factor of original size to scale to
+     * @return none
+     */
+    function scaleByFactor($size)
+    {
+        $new_x = round($size * $this->img_x, 0);
+        $new_y = round($size * $this->img_y, 0);
+        return $this->_resize($new_x, $new_y);
+    } // End scaleByFactor
+
+    /**
+     * Scales an image so that the longest side has this dimension.
+     *
+     * @access public
+     * @param int $size Max dimension in pixels
+     * @return none
+     */
+    function scaleByLength($size)
+    {
+         if ($this->img_x >= $this->img_y) {
+            $new_x = $size;
+            $new_y = round(($new_x / $this->img_x) * $this->img_y, 0);
+        } else {
+            $new_y = $size;
+            $new_x = round(($new_y / $this->img_y) * $this->img_x, 0);
+        }
+        return $this->_resize($new_x, $new_y);
+    } // End scaleByLength
+
+
+    /**
+     *
+     * @access public
+     * @return void
+     */
+    function _get_image_details($image)
+    {
+        //echo $image;
+        $data = @GetImageSize($image);
+        #1 = GIF, 2 = JPG, 3 = PNG, 4 = SWF, 5 = PSD, 6 = BMP, 7 = TIFF(intel byte order), 8 = TIFF(motorola byte order,
+        # 9 = JPC, 10 = JP2, 11 = JPX, 12 = JB2, 13 = SWC
+        if (is_array($data)){
+            switch($data[2]){
+                case 1:
+                    $type = 'gif';
+                    break;
+                case 2:
+                    $type = 'jpeg';
+                    break;
+                case 3:
+                    $type = 'png';
+                    break;
+                case 4:
+                    $type = 'swf';
+                    break;
+                case 5:
+                    $type = 'psd';
+                case 6:
+                    $type = 'bmp';
+                case 7:
+                case 8:
+                    $type = 'tiff';
+                default:
+                    echo("We do not recognize this image format");
+            }
+            $this->img_x = $data[0];
+            $this->img_y = $data[1];
+            $this->type = $type;
+
+            return true;
+        } else {
+            echo("Cannot fetch image or images details.");
+            return null;
+        }
+        /*
+        $output = array(
+                        'width' => $data[0],
+                        'height' => $data[1],
+                        'type' => $type
+                        );
+        return $output;
+        */
+    }
+
+
+    /**
+     * Parse input and convert
+     * If either is 0 it will be scaled proportionally
+     *
+     * @access private
+     *
+     * @param mixed $new_size (0, number, percentage 10% or 0.1)
+     * @param int $old_size
+     *
+     * @return mixed none or PEAR_error
+     */
+    function _parse_size($new_size, $old_size)
+    {
+        if ('%' == $new_size) {
+            $new_size = str_replace('%','',$new_size);
+            $new_size = $new_size / 100;
+        }
+        if ($new_size > 1) {
+            return (int) $new_size;
+        } elseif ($new_size == 0) {
+            return (int) $old_size;
+        } else {
+            return (int) round($new_size * $old_size, 0);
+        }
+    }
+
+
+    function uniqueStr()
+    {
+      return substr(md5(microtime()),0,6);
+    }
+
+    //delete old tmp files, and allow only 1 file per remote host.
+    function cleanUp($id, $dir)
+    {
+        $d = dir($dir);
+        $id_length = strlen($id);
+
+        while (false !== ($entry = $d->read())) {
+            if (is_file($dir.'/'.$entry) && substr($entry,0,1) == '.' && !ereg($entry, $this->image))
+            {
+                //echo filemtime($this->directory.'/'.$entry)."<br>"; 
+                //echo time();
+
+                if (filemtime($dir.'/'.$entry) + $this->lapse_time < time())
+                    unlink($dir.'/'.$entry);
+
+                if (substr($entry, 1, $id_length) == $id)
+                {
+                    if (is_file($dir.'/'.$entry))
+                        unlink($dir.'/'.$entry);
+                }
+            }
+        }
+        $d->close();
+    }
+
+
+    function createUnique($dir)
+    {
+       $unique_str = '.'.$this->uid.'_'.$this->uniqueStr().".".$this->type;
+        
+       //make sure the the unique temp file does not exists
+        while (file_exists($dir.$unique_str))
+        {
+            $unique_str = '.'.$this->uid.'_'.$this->uniqueStr().".".$this->type;
+        }
+        
+      $this->cleanUp($this->uid, $dir);
+
+       return $unique_str;
+    }
+
+
+    /**
+     * Set the image width
+     * @param int $size dimension to set
+     * @since 29/05/02 13:36:31
+     * @return
+     */
+    function _set_img_x($size)
+    {
+        $this->img_x = $size;
+    }
+
+    /**
+     * Set the image height
+     * @param int $size dimension to set
+     * @since 29/05/02 13:36:31
+     * @return
+     */
+    function _set_img_y($size)
+    {
+        $this->img_y = $size;
+    }
+
+    /**
+     * Set the image width
+     * @param int $size dimension to set
+     * @since 29/05/02 13:36:31
+     * @return
+     */
+    function _set_new_x($size)
+    {
+        $this->new_x = $size;
+    }
+
+    /**
+     * Set the image height
+     * @param int $size dimension to set
+     * @since 29/05/02 13:36:31
+     * @return
+     */
+    function _set_new_y($size)
+    {
+        $this->new_y = $size;
+    }
+
+    /**
+     * Get the type of the image being manipulated
+     *
+     * @return string $this->type the image type
+     */
+    function getImageType()
+    {
+        return $this->type;
+    }
+
+    /**
+     *
+     * @access public
+     * @return string web-safe image type
+     */
+    function getWebSafeFormat()
+    {
+        switch($this->type){
+            case 'gif':
+            case 'png':
+                return 'png';
+                break;
+            default:
+                return 'jpeg';
+        } // switch
+    }
+
+    /**
+     * Place holder for the real resize method
+     * used by extended methods to do the resizing
+     *
+     * @access private
+     * @return PEAR_error
+     */
+    function _resize() {
+        return null; //PEAR::raiseError("No Resize method exists", true);
+    }
+
+    /**
+     * Place holder for the real load method
+     * used by extended methods to do the resizing
+     *
+     * @access public
+     * @return PEAR_error
+     */
+    function load($filename) {
+        return null; //PEAR::raiseError("No Load method exists", true);
+    }
+
+    /**
+     * Place holder for the real display method
+     * used by extended methods to do the resizing
+     *
+     * @access public
+     * @param string filename
+     * @return PEAR_error
+     */
+    function display($type, $quality) {
+        return null; //PEAR::raiseError("No Display method exists", true);
+    }
+
+    /**
+     * Place holder for the real save method
+     * used by extended methods to do the resizing
+     *
+     * @access public
+     * @param string filename
+     * @return PEAR_error
+     */
+    function save($filename, $type, $quality) {
+        return null; //PEAR::raiseError("No Save method exists", true);
+    }
+
+    /**
+     * Place holder for the real free method
+     * used by extended methods to do the resizing
+     *
+     * @access public
+     * @return PEAR_error
+     */
+    function free() {
+        return null; //PEAR::raiseError("No Free method exists", true);
+    }
+
+    /**
+     * Reverse of rgb2colorname.
+     *
+     * @access public
+     * @return PEAR_error
+     *
+     * @see rgb2colorname
+     */
+    function colorhex2colorarray($colorhex) {
+        $r = hexdec(substr($colorhex, 1, 2));
+        $g = hexdec(substr($colorhex, 3, 2));
+        $b = hexdec(substr($colorhex, 4, 2));
+        return array($r,$g,$b);
+    }
+
+    /**
+     * Reverse of rgb2colorname.
+     *
+     * @access public
+     * @return PEAR_error
+     *
+     * @see rgb2colorname
+     */
+    function colorarray2colorhex($color) {
+        $color = '#'.dechex($color[0]).dechex($color[1]).dechex($color[2]);
+        return strlen($color)>6?false:$color;
+    }
+
+
+    /* Methods to add to the driver classes in the future */
+    function addText()
+    {
+        return null; //PEAR::raiseError("No addText method exists", true);
+    }
+
+    function addDropShadow()
+    {
+        return null; //PEAR::raiseError("No AddDropShadow method exists", true);
+    }
+
+    function addBorder()
+    {
+        return null; //PEAR::raiseError("No addBorder method exists", true);
+    }
+
+    function crop()
+    {
+        return null; //PEAR::raiseError("No crop method exists", true);
+    }
+
+    function flip() 
+    {
+        return null;
+    }
+
+    function gamma()
+    {
+        return null; //PEAR::raiseError("No gamma method exists", true);
+    }
+}
+?>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/Classes/gd.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/Classes/gd.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,597 @@
+<?php
+/***********************************************************************
+** Title.........:  GD Driver
+** Version.......:  1.0
+** Author........:  Xiang Wei ZHUO <wei@zhuo.org>
+** Filename......:  GD.php
+** Last changed..:  30 Aug 2003 
+** Notes.........:  Orginal is from PEAR
+**/
+// +----------------------------------------------------------------------+
+// | PHP Version 4                                                        |
+// +----------------------------------------------------------------------+
+// | Copyright (c) 1997-2002 The PHP Group                                |
+// +----------------------------------------------------------------------+
+// | This source file is subject to version 2.02 of the PHP license,      |
+// | that is bundled with this package in the file LICENSE, and is        |
+// | available at through the world-wide-web at                           |
+// | http://www.php.net/license/2_02.txt.                                 |
+// | If you did not receive a copy of the PHP license and are unable to   |
+// | obtain it through the world-wide-web, please send a note to          |
+// | license@php.net so we can mail you a copy immediately.               |
+// +----------------------------------------------------------------------+
+// | Authors: Peter Bowyer <peter@mapledesign.co.uk>                      |
+// |          Alan Knowles <alan@akbkhome.com>                            |
+// +----------------------------------------------------------------------+
+//
+//    Usage :
+//    $img    = new Image_Transform_GD();
+//    $angle  = -78;
+//    $img->load('magick.png');
+//
+//    if($img->rotate($angle,array('autoresize'=>true,'color_mask'=>array(255,0,0)))){
+//        $img->addText(array('text'=>"Rotation $angle",'x'=>0,'y'=>100,'font'=>'/usr/share/fonts/default/TrueType/cogb____.ttf'));
+//        $img->display();
+//    } else {
+//        echo "Error";
+//    }
+//
+//
+// $Id:GD.php 938 2008-01-22 20:13:47Z ray $
+//
+// Image Transformation interface using the GD library
+//
+
+require_once "../ImageManager/Classes/Transform.php";
+
+Class Image_Transform_Driver_GD extends Image_Transform
+{
+    /**
+     * Holds the image file for manipulation
+     */
+    var $imageHandle = '';
+
+    /**
+     * Holds the original image file
+     */
+    var $old_image = '';
+
+    /**
+     * Check settings
+     *
+     * @return mixed true or  or a PEAR error object on error
+     *
+     * @see PEAR::isError()
+     */
+    function Image_Transform_GD()
+    {
+        return;
+    } // End function Image
+
+    /**
+     * Load image
+     *
+     * @param string filename
+     *
+     * @return mixed none or a PEAR error object on error
+     * @see PEAR::isError()
+     */
+    function load($image)
+    {
+        $this->uid = md5($_SERVER['REMOTE_ADDR']);
+        $this->image = $image;
+        $this->_get_image_details($image);
+        $functionName = 'ImageCreateFrom' . $this->type;
+		
+		if(function_exists($functionName))
+		{
+			$this->imageHandle = $functionName($this->image);
+			if ( $this->type == 'png')
+			{
+				imageAlphaBlending($this->imageHandle, false);
+				imageSaveAlpha($this->imageHandle, true);
+			}
+		}
+    } // End load
+
+    /**
+     * addText
+     *
+     * @param   array   options     Array contains options
+     *                              array(
+     *                                  'text'  The string to draw
+     *                                  'x'     Horizontal position
+     *                                  'y'     Vertical Position
+     *                                  'Color' Font color
+     *                                  'font'  Font to be used
+     *                                  'size'  Size of the fonts in pixel
+     *                                  'resize_first'  Tell if the image has to be resized
+     *                                                  before drawing the text
+     *                              )
+     *
+     * @return none
+     * @see PEAR::isError()
+     */
+    function addText($params)
+    {
+        $default_params = array(
+                                'text' => 'This is Text',
+                                'x' => 10,
+                                'y' => 20,
+                                'color' => array(255,0,0),
+                                'font' => 'Arial.ttf',
+                                'size' => '12',
+                                'angle' => 0,
+                                'resize_first' => false // Carry out the scaling of the image before annotation?  Not used for GD
+                                );
+        $params = array_merge($default_params, $params);
+        extract($params);
+
+        if( !is_array($color) ){
+            if ($color[0]=='#'){
+                $this->colorhex2colorarray( $color );
+            } else {
+                include_once('Image/Transform/Driver/ColorsDefs.php');
+                $color = isset($colornames[$color])?$colornames[$color]:false;
+            }
+        }
+
+        $c = imagecolorresolve ($this->imageHandle, $color[0], $color[1], $color[2]);
+
+        if ('ttf' == substr($font, -3)) {
+            ImageTTFText($this->imageHandle, $size, $angle, $x, $y, $c, $font, $text);
+        } else {
+            ImagePSText($this->imageHandle, $size, $angle, $x, $y, $c, $font, $text);
+        }
+        return true;
+    } // End addText
+
+
+    /**
+     * Rotate image by the given angle
+     * Uses a fast rotation algorythm for custom angles
+     * or lines copy for multiple of 90 degrees
+     *
+     * @param int       $angle      Rotation angle
+     * @param array     $options    array(  'autoresize'=>true|false,
+     *                                      'color_mask'=>array(r,g,b), named color or #rrggbb
+     *                                   )
+     * @author Pierre-Alain Joye
+     * @return mixed none or a PEAR error object on error
+     * @see PEAR::isError()
+     */
+    function rotate($angle, $options=null)
+    {
+        if(function_exists('imagerotate')) {
+            $white = imagecolorallocatealpha ($this->imageHandle, 255, 255, 255, 127);
+			$this->imageHandle = imagerotate($this->imageHandle, $angle, $white);
+            return true;
+        }
+
+        if ( $options==null ){
+            $autoresize = true;
+            $color_mask = array(105,255,255);
+        } else {
+            extract( $options );
+        }
+
+        while ($angle <= -45) {
+            $angle  += 360;
+        }
+        while ($angle > 270) {
+            $angle  -= 360;
+        }
+
+        $t      = deg2rad($angle);
+
+        if( !is_array($color_mask) ){
+            if ($color[0]=='#'){
+                $this->colorhex2colorarray( $color_mask );
+            } else {
+                include_once('Image/Transform/Driver/ColorDefs.php');
+                $color = isset($colornames[$color_mask])?$colornames[$color_mask]:false;
+            }
+        }
+
+        // Do not round it, too much lost of quality
+        $cosT   = cos($t);
+        $sinT   = sin($t);
+
+        $img    =& $this->imageHandle;
+
+        $width  = $max_x  = $this->img_x;
+        $height = $max_y  = $this->img_y;
+        $min_y  = 0;
+        $min_x  = 0;
+
+        $x1     = round($max_x/2,0);
+        $y1     = round($max_y/2,0);
+
+        if ( $autoresize ){
+            $t      = abs($t);
+            $a      = round($angle,0);
+            switch((int)($angle)){
+                case 0:
+                        $width2     = $width;
+                        $height2    = $height;
+                    break;
+                case 90:
+                        $width2     = $height;
+                        $height2    = $width;
+                    break;
+                case 180:
+                        $width2     = $width;
+                        $height2    = $height;
+                    break;
+                case 270:
+                        $width2     = $height;
+                        $height2    = $width;
+                    break;
+                default:
+                    $width2     = (int)(abs(sin($t) * $height + cos($t) * $width));
+                    $height2    = (int)(abs(cos($t) * $height+sin($t) * $width));
+            }
+
+            $width2     -= $width2%2;
+            $height2    -= $height2%2;
+
+            $d_width    = abs($width - $width2);
+            $d_height   = abs($height - $height2);
+            $x_offset   = $d_width/2;
+            $y_offset   = $d_height/2;
+            $min_x2     = -abs($x_offset);
+            $min_y2     = -abs($y_offset);
+            $max_x2     = $width2;
+            $max_y2     = $height2;
+        }
+
+        $img2   = @$this->newImgPreserveAlpha( imagecreateTrueColor($width2,$height2) );
+
+        if ( !is_resource($img2) ){
+            return false;/*PEAR::raiseError('Cannot create buffer for the rotataion.',
+                                null, PEAR_ERROR_TRIGGER, E_USER_NOTICE);*/
+        }
+
+        $this->img_x = $width2;
+        $this->img_y = $height2;
+
+
+        imagepalettecopy($img2,$img);
+
+       $mask = imagecolorallocatealpha ($img2,$color_mask[0],$color_mask[1],$color_mask[2],127);
+        // use simple lines copy for axes angles
+        switch((int)($angle)){
+            case 0:
+                imagefill ($img2, 0, 0,$mask);
+                for ($y=0; $y < $max_y; $y++) {
+                    for ($x = $min_x; $x < $max_x; $x++){
+                        $c  = @imagecolorat ( $img, $x, $y);
+                        imagesetpixel($img2,$x+$x_offset,$y+$y_offset,$c);
+                    }
+                }
+                break;
+            case 90:
+                imagefill ($img2, 0, 0,$mask);
+                for ($x = $min_x; $x < $max_x; $x++){
+                    for ($y=$min_y; $y < $max_y; $y++) {
+                        $c  = imagecolorat ( $img, $x, $y);
+                        imagesetpixel($img2,$max_y-$y-1,$x,$c);
+                    }
+                }
+                break;
+            case 180:
+                imagefill ($img2, 0, 0,$mask);
+                for ($y=0; $y < $max_y; $y++) {
+                    for ($x = $min_x; $x < $max_x; $x++){
+                        $c  = @imagecolorat ( $img, $x, $y);
+                        imagesetpixel($img2, $max_x2-$x-1, $max_y2-$y-1, $c);
+                    }
+                }
+                break;
+            case 270:
+                imagefill ($img2, 0, 0,$mask);
+                for ($y=0; $y < $max_y; $y++) {
+                    for ($x = $max_x; $x >= $min_x; $x--){
+                        $c  = @imagecolorat ( $img, $x, $y);
+                        imagesetpixel($img2,$y,$max_x-$x-1,$c);
+                    }
+                }
+                break;
+            // simple reverse rotation algo
+            default:
+                $i=0;
+                for ($y = $min_y2; $y < $max_y2; $y++){
+
+                    // Algebra :)
+                    $x2 = round((($min_x2-$x1) * $cosT) + (($y-$y1) * $sinT + $x1),0);
+                    $y2 = round((($y-$y1) * $cosT - ($min_x2-$x1) * $sinT + $y1),0);
+
+                    for ($x = $min_x2; $x < $max_x2; $x++){
+
+                        // Check if we are out of original bounces, if we are
+                        // use the default color mask
+                        if ( $x2>=0 && $x2<$max_x && $y2>=0 && $y2<$max_y ){
+                            $c  = imagecolorat ( $img, $x2, $y2);
+                        } else {
+                            $c  = $mask;
+                        }
+                        imagesetpixel($img2,$x+$x_offset,$y+$y_offset,$c);
+
+                        // round verboten!
+                        $x2  += $cosT;
+                        $y2  -= $sinT;
+                    }
+                }
+                break;
+        }
+        $this->old_image    = $this->imageHandle;
+        $this->imageHandle  =  $img2;
+        return true;
+    }
+
+
+   /**
+    * Resize Action
+    *
+    * For GD 2.01+ the new copyresampled function is used
+    * It uses a bicubic interpolation algorithm to get far
+    * better result.
+    *
+    * @param int  $new_x new width
+    * @param int  $new_y new height
+    *
+    * @return true on success or pear error
+    * @see PEAR::isError()
+    */
+    function _resize($new_x, $new_y) {
+        if ($this->resized === true) {
+            return false; /*PEAR::raiseError('You have already resized the image without saving it.  Your previous resizing will be overwritten', null, PEAR_ERROR_TRIGGER, E_USER_NOTICE);*/
+        }
+        if(function_exists('ImageCreateTrueColor')){
+           $new_img = $this->newImgPreserveAlpha( ImageCreateTrueColor($new_x,$new_y) );
+        } else {
+            $new_img =ImageCreate($new_x,$new_y);
+        }
+
+        if(function_exists('ImageCopyResampled')){
+            ImageCopyResampled($new_img, $this->imageHandle, 0, 0, 0, 0, $new_x, $new_y, $this->img_x, $this->img_y);
+        } else {
+            ImageCopyResized($new_img, $this->imageHandle, 0, 0, 0, 0, $new_x, $new_y, $this->img_x, $this->img_y);
+        }
+
+        $this->old_image = $this->imageHandle;
+        $this->imageHandle = $new_img;
+        $this->resized = true;
+
+        $this->new_x = $new_x;
+        $this->new_y = $new_y;
+        return true;
+    }
+
+    /**
+     * Crop the image
+     *
+     * @param int $crop_x left column of the image
+     * @param int $crop_y top row of the image
+     * @param int $crop_width new cropped image width
+     * @param int $crop_height new cropped image height
+     */
+    function crop($new_x, $new_y, $new_width, $new_height) 
+    {
+        if(function_exists('ImageCreateTrueColor')){
+            $new_img =  $this->newImgPreserveAlpha(ImageCreateTrueColor($new_width,$new_height));
+        } else {
+            $new_img =ImageCreate($new_width,$new_height);
+        }
+        if(function_exists('ImageCopyResampled')){
+            ImageCopyResampled($new_img, $this->imageHandle, 0, 0, $new_x, $new_y,$new_width,$new_height,$new_width,$new_height);
+        } else {
+            ImageCopyResized($new_img, $this->imageHandle, 0, 0, $new_x, $new_y, $new_width,$new_height,$new_width,$new_height);
+        }
+        $this->old_image = $this->imageHandle;
+        $this->imageHandle = $new_img;
+        $this->resized = true;
+
+        $this->new_x = $new_x;
+        $this->new_y = $new_y;
+        return true;
+    }
+   
+    /**
+     * Flip the image horizontally or vertically
+     *
+     * @param boolean $horizontal true if horizontal flip, vertical otherwise
+     */
+    function flip($horizontal)
+    {
+        if(!$horizontal) {
+            $this->rotate(180);
+        }
+
+        $width = imagesx($this->imageHandle); 
+        $height = imagesy($this->imageHandle); 
+
+        for ($j = 0; $j < $height; $j++) { 
+                $left = 0; 
+                $right = $width-1; 
+
+
+                while ($left < $right) { 
+                    //echo " j:".$j." l:".$left." r:".$right."\n<br>";
+                    $t = imagecolorat($this->imageHandle, $left, $j); 
+                    imagesetpixel($this->imageHandle, $left, $j, imagecolorat($this->imageHandle, $right, $j)); 
+                    imagesetpixel($this->imageHandle, $right, $j, $t); 
+                    $left++; $right--; 
+                } 
+            
+        }
+
+        return true;
+    }
+
+
+    /**
+     * Adjust the image gamma
+     *
+     * @param float $outputgamma
+     *
+     * @return none
+     */
+    function gamma($outputgamma=1.0) {
+        ImageGammaCorrect($this->imageHandle, 1.0, $outputgamma);
+    }
+	function paletteToTrueColorWithTransparency()
+	{
+		$oldImg = $this->imageHandle;
+		$newImg = $this->newImgPreserveAlpha( imagecreatetruecolor($this->img_x,$this->img_y) );
+		imagecopy($newImg,$oldImg,0,0,0,0,$this->img_x,$this->img_y);
+
+		$this->imageHandle = $newImg;
+	}
+	
+	function newImgPreserveAlpha($newImg)
+	{
+		if ( $this->type == 'jpeg') return $newImg;
+		
+		// Turn off transparency blending (temporarily)
+		imagealphablending($newImg, false);
+		
+		// Create a new transparent color for image
+		if ( $transparent = imagecolortransparent($this->imageHandle) >= 0 )
+		{
+			if (imageistruecolor($this->imageHandle))
+			{
+				$red = ($transparent & 0xFF0000) >> 16;
+				$green = ($transparent & 0x00FF00) >> 8;
+				$blue = ($transparent & 0x0000FF);
+				$color_values = array('red' => $red, 'green' => $green, 'blue' => $blue);
+			}
+			else
+			{
+				$color_values = imagecolorsforindex($this->imageHandle,$transparent);
+
+			}
+			$color_values = imagecolorsforindex($this->imageHandle,$transparent);
+			$color = imagecolorallocatealpha($newImg, $color_values['red'],$color_values['green'],$color_values['blue'], 127);
+			$colort = imagecolorallocate($newImg, $color_values['red'],$color_values['green'],$color_values['blue']);
+		}
+		else
+		{
+			$color = imagecolorallocatealpha($newImg, 252, 2, 252, 127);
+			$colort = imagecolorallocate($newImg, 252, 2, 252);
+		}
+		imagecolortransparent($newImg,$colort);
+		
+		// Completely fill the background of the new image with allocated color.
+		imagefill($newImg, 0, 0, $color);
+		
+		// Restore transparency blending
+		imagesavealpha($newImg, true);
+		
+		return $newImg;
+	}
+	
+	function preserveTransparencyForPalette()
+	{
+		$new_img = imagecreatetruecolor($this->img_x,$this->img_y);
+		$truecolor = imageistruecolor($this->imageHandle);
+		$transparent = imagecolorallocate($new_img, 252,2,252); // nasty pinkish purple that hopefully doesn't exist in the image
+
+		imagecolortransparent($new_img, $transparent);
+		for ($i=0;$i<$this->img_y;$i++)
+		{
+			for ($j=0;$j<$this->img_x;$j++)
+			{
+				$c = imagecolorat($this->imageHandle,$j, $i);
+				if ($truecolor)
+				{
+					$a = ($c >> 24) & 0xFF;
+					$r = ($c >> 16) & 0xFF;
+					$g = ($c >> 8) & 0xFF;
+					$b = $c & 0xFF;
+					$color_values = array('red' => $r, 'green' => $g, 'blue' => $b, 'alpha' => $a);
+				}
+				else
+				{
+					$color_values = imagecolorsforindex($this->imageHandle,$c);
+				}
+				if ($color_values['alpha'] >= 126)
+				{
+					imagesetpixel($new_img, $j, $i, $transparent);
+				}
+				else
+				{
+					imagesetpixel($new_img, $j, $i, $c);
+				}
+			}
+		}
+		$this->imageHandle = $new_img;
+	}
+
+    /**
+     * Save the image file
+     *
+     * @param string  $filename the name of the file to write to
+     * @param int     $quality  output DPI, default is 85
+     * @param string  $types    define the output format, default
+     *                          is the current used format
+     *
+     * @return none
+     */
+    function save($filename, $type = '', $quality = 85)
+    {
+		$type           = $type==''? $this->type : $type;
+		$functionName   = 'image' . $type;
+
+		if(function_exists($functionName))
+		{
+			$this->old_image = $this->imageHandle;
+			if($type=='jpeg')
+				$functionName($this->imageHandle, $filename, $quality);
+			else
+				$functionName($this->imageHandle, $filename);
+			$this->imageHandle = $this->old_image;
+			$this->resized = false;
+		}
+    } // End save
+
+
+    /**
+     * Display image without saving and lose changes
+     *
+     * @param string type (JPG,PNG...);
+     * @param int quality 75
+     *
+     * @return none
+     */
+    function display($type = '', $quality = 75)
+    {
+        if ($type != '') {
+            $this->type = $type;
+        }
+        $functionName = 'Image' . $this->type;
+		if(function_exists($functionName))
+		{
+			header('Content-type: image/' . strtolower($this->type));
+			$functionName($this->imageHandle, '', $quality);
+			$this->imageHandle = $this->old_image;
+			$this->resized = false;
+			ImageDestroy($this->old_image);
+			$this->free();
+		}
+    }
+
+    /**
+     * Destroy image handle
+     *
+     * @return none
+     */
+    function free()
+    {
+        if ($this->imageHandle){
+            ImageDestroy($this->imageHandle);
+        }
+    }
+
+} // End class ImageGD
+?>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/Classes/im.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/Classes/im.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,239 @@
+<?php
+
+/***********************************************************************
+** Title.........:  ImageMagick Driver
+** Version.......:  1.0
+** Author........:  Xiang Wei ZHUO <wei@zhuo.org>
+** Filename......:  IM.php
+** Last changed..:  30 Aug 2003 
+** Notes.........:  Orginal is from PEAR
+**/
+
+// +----------------------------------------------------------------------+
+// | PHP Version 4                                                        |
+// +----------------------------------------------------------------------+
+// | Copyright (c) 1997-2002 The PHP Group                                |
+// +----------------------------------------------------------------------+
+// | This source file is subject to version 2.02 of the PHP license,      |
+// | that is bundled with this package in the file LICENSE, and is        |
+// | available at through the world-wide-web at                           |
+// | http://www.php.net/license/2_02.txt.                                 |
+// | If you did not receive a copy of the PHP license and are unable to   |
+// | obtain it through the world-wide-web, please send a note to          |
+// | license@php.net so we can mail you a copy immediately.               |
+// +----------------------------------------------------------------------+
+// | Authors: Peter Bowyer <peter@mapledesign.co.uk>                      |
+// +----------------------------------------------------------------------+
+//
+// $Id:IM.php 937 2008-01-20 23:13:25Z ray $
+//
+// Image Transformation interface using command line ImageMagick
+//
+
+require_once "../ImageManager/Classes/Transform.php";
+
+Class Image_Transform_Driver_IM extends Image_Transform
+{
+    /**
+     * associative array commands to be executed
+     * @var array
+     */
+    var $command = array();
+
+    /**
+     *
+     *
+     */
+    function Image_Transform_Driver_IM()
+    {
+        return true;
+    } // End Image_IM
+
+    /**
+     * Load image
+     *
+     * @param string filename
+     *
+     * @return mixed none or a PEAR error object on error
+     * @see PEAR::isError()
+     */
+    function load($image)
+    {
+
+        $this->uid = md5($_SERVER['REMOTE_ADDR']);
+        /*if (!file_exists($image)) {
+            return PEAR::raiseError('The image file ' . $image . ' does\'t exist', true);
+        }*/
+        $this->image = $image;
+        $this->_get_image_details($image);
+    } // End load
+
+    /**
+     * Resize Action
+     *
+     * @param int   new_x   new width
+     * @param int   new_y   new height
+     *
+     * @return none
+     * @see PEAR::isError()
+     */
+    function _resize($new_x, $new_y)
+    {
+        /*if (isset($this->command['resize'])) {
+            return PEAR::raiseError("You cannot scale or resize an image more than once without calling save or display", true);
+        }*/
+        $this->command['resize'] = "-geometry ${new_x}x${new_y}!";
+
+        $this->new_x = $new_x;
+        $this->new_y = $new_y;
+    } // End resize
+
+    /**
+     * Crop the image
+     *
+     * @param int $crop_x left column of the image
+     * @param int $crop_y top row of the image
+     * @param int $crop_width new cropped image width
+     * @param int $crop_height new cropped image height
+     */
+    function crop($crop_x, $crop_y, $crop_width, $crop_height) 
+    {
+        $this->command['crop'] = "-crop {$crop_width}x{$crop_height}+{$crop_x}+{$crop_y}";
+    }
+
+    /**
+     * Flip the image horizontally or vertically
+     *
+     * @param boolean $horizontal true if horizontal flip, vertical otherwise
+     */
+    function flip($horizontal) 
+    {
+        if($horizontal)
+            $this->command['flop'] = "-flop";
+        else
+            $this->command['flip'] = "-flip";
+    }
+    /**
+     * rotate
+     *
+     * @param   int     angle   rotation angle
+     * @param   array   options no option allowed
+     *
+     */
+    function rotate($angle, $options=null)
+    {
+        if ('-' == $angle{0}) {
+            $angle = 360 - substr($angle, 1);
+        }
+         $this->command['rotate'] = "-rotate $angle";
+    } // End rotate
+
+    /**
+     * addText
+     *
+     * @param   array   options     Array contains options
+     *                              array(
+     *                                  'text'  The string to draw
+     *                                  'x'     Horizontal position
+     *                                  'y'     Vertical Position
+     *                                  'Color' Font color
+     *                                  'font'  Font to be used
+     *                                  'size'  Size of the fonts in pixel
+     *                                  'resize_first'  Tell if the image has to be resized
+     *                                                  before drawing the text
+     *                              )
+     *
+     * @return none
+     * @see PEAR::isError()
+     */
+    function addText($params)
+    {
+        $default_params = array(
+                                'text' => 'This is Text',
+                                'x' => 10,
+                                'y' => 20,
+                                'color' => 'red',
+                                'font' => 'Arial.ttf',
+                                'resize_first' => false // Carry out the scaling of the image before annotation?
+                                );
+         $params = array_merge($default_params, $params);
+         extract($params);
+         if (true === $resize_first) {
+             // Set the key so that this will be the last item in the array
+            $key = 'ztext';
+         } else {
+            $key = 'text';
+         }
+         $this->command[$key] = "-font $font -fill $color -draw 'text $x,$y \"$text\"'";
+         // Producing error: gs: not found gs: not found convert: Postscript delegate failed [No such file or directory].
+    } // End addText
+
+    /**
+     * Adjust the image gamma
+     *
+     * @param float $outputgamma
+     *
+     * @return none
+     */
+    function gamma($outputgamma=1.0) {
+        $this->command['gamma'] = "-gamma $outputgamma";
+    }
+	
+	function reduce_colors($number = 256)
+	{
+		 $this->command['colors'] = "-colors $number";
+	}
+    /**
+     * Save the image file
+     *
+     * @param string  $filename the name of the file to write to
+     * @param quality $quality  image dpi, default=75
+     * @param string  $type     (JPG,PNG...)
+     *
+     * @return none
+     */
+    function save($filename, $type='', $quality = 85)
+    {
+        $type == '' ? $this->type : $type;
+        $cmd = '' . IMAGE_TRANSFORM_LIB_PATH . 'convert ';
+		$cmd .= implode(' ', $this->command) . " -quality $quality ";
+		$cmd .= '"'.($this->image) . '" "' . ($filename) . '"';
+        
+        //$cmd = str_replace('/', '\\', $cmd);
+		//echo($cmd.'<br>');
+        exec($cmd,$retval);
+		//error_log('IM '.print_r($retval,true));
+    } // End save
+
+    /**
+     * Display image without saving and lose changes
+     *
+     * @param string type (JPG,PNG...);
+     * @param int quality 75
+     *
+     * @return none
+     */
+    function display($type = '', $quality = 75)
+    {
+        if ($type == '') {
+            header('Content-type: image/' . $this->type);
+            passthru(IMAGE_TRANSFORM_LIB_PATH . '  ' . implode(' ', $this->command) . " -quality $quality "  . escapeshellarg($this->image) . ' ' . strtoupper($this->type) . ":-");
+        } else {
+            header('Content-type: image/' . $type);
+            passthru(IMAGE_TRANSFORM_LIB_PATH . 'convert ' . implode(' ', $this->command) . " -quality $quality "  . escapeshellarg($this->image) . ' ' . strtoupper($type) . ":-");
+        }
+    }
+
+
+    /**
+     * Destroy image handle
+     *
+     * @return none
+     */
+    function free()
+    {
+        return true;
+    }
+
+} // End class ImageIM
+?>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/assets/EditorContent.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/assets/EditorContent.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,660 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/ImageManager/assets/EditorContent.js */
+function MM_findObj(n,d){
+var p,i,x;
+if(!d){
+d=document;
+}
+if((p=n.indexOf("?"))>0&&parent.frames.length){
+d=parent.frames[n.substring(p+1)].document;
+n=n.substring(0,p);
+}
+if(!(x=d[n])&&d.all){
+x=d.all[n];
+}
+for(i=0;!x&&i<d.forms.length;i++){
+x=d.forms[i][n];
+}
+for(i=0;!x&&d.layers&&i<d.layers.length;i++){
+x=MM_findObj(n,d.layers[i].document);
+}
+if(!x&&d.getElementById){
+x=d.getElementById(n);
+}
+return x;
+}
+var pic_x,pic_y;
+function P7_Snap(){
+var x,y,ox,bx,oy,p,tx,a,b,k,d,da,e,el,args=P7_Snap.arguments;
+a=parseInt(a);
+for(k=0;k<(args.length-3);k+=4){
+if((g=MM_findObj(args[k]))!=null){
+el=eval(MM_findObj(args[k+1]));
+a=parseInt(args[k+2]);
+b=parseInt(args[k+3]);
+x=0;
+y=0;
+ox=0;
+oy=0;
+p="";
+tx=1;
+da="document.all['"+args[k]+"']";
+if(document.getElementById){
+d="document.getElementsByName('"+args[k]+"')[0]";
+if(!eval(d)){
+d="document.getElementById('"+args[k]+"')";
+if(!eval(d)){
+d=da;
+}
+}
+}else{
+if(document.all){
+d=da;
+}
+}
+if(document.all||document.getElementById){
+while(tx==1){
+p+=".offsetParent";
+if(eval(d+p)){
+x+=parseInt(eval(d+p+".offsetLeft"));
+y+=parseInt(eval(d+p+".offsetTop"));
+}else{
+tx=0;
+}
+}
+ox=parseInt(g.offsetLeft);
+oy=parseInt(g.offsetTop);
+var tw=x+ox+y+oy;
+if(tw==0||(navigator.appVersion.indexOf("MSIE 4")>-1&&navigator.appVersion.indexOf("Mac")>-1)){
+ox=0;
+oy=0;
+if(g.style.left){
+x=parseInt(g.style.left);
+y=parseInt(g.style.top);
+}else{
+var w1=parseInt(el.style.width);
+bx=(a<0)?-5-w1:-10;
+a=(Math.abs(a)<1000)?0:a;
+b=(Math.abs(b)<1000)?0:b;
+if(event==null){
+x=document.body.scrollLeft+bx;
+}else{
+x=document.body.scrollLeft+event.clientX+bx;
+}
+if(event==null){
+y=document.body.scrollTop;
+}else{
+y=document.body.scrollTop+event.clientY;
+}
+}
+}
+}else{
+if(document.layers){
+x=g.x;
+y=g.y;
+var q0=document.layers,dd="";
+for(var s=0;s<q0.length;s++){
+dd="document."+q0[s].name;
+if(eval(dd+".document."+args[k])){
+x+=eval(dd+".left");
+y+=eval(dd+".top");
+break;
+}
+}
+}
+}
+if(el){
+e=(document.layers)?el:el.style;
+var xx=parseInt(x+ox+a),yy=parseInt(y+oy+b);
+if(navigator.appName=="Netscape"&&parseInt(navigator.appVersion)>4){
+xx+="px";
+yy+="px";
+}
+if(navigator.appVersion.indexOf("MSIE 5")>-1&&navigator.appVersion.indexOf("Mac")>-1){
+xx+=parseInt(document.body.leftMargin);
+yy+=parseInt(document.body.topMargin);
+xx+="px";
+yy+="px";
+}
+e.left=xx;
+e.top=yy;
+}
+pic_x=parseInt(xx);
+pic_y=parseInt(yy);
+}
+}
+}
+var ie=document.all;
+var ns6=document.getElementById&&!document.all;
+var dragapproved=false;
+var z,x,y,status,ant,canvas,content,pic_width,pic_height,image,resizeHandle,oa_w,oa_h,oa_x,oa_y,mx2,my2;
+function init_resize(){
+if(mode=="scale"){
+P7_Snap("theImage","ant",0,0);
+if(canvas==null){
+canvas=MM_findObj("imgCanvas");
+}
+if(pic_width==null||pic_height==null){
+image=MM_findObj("theImage");
+pic_width=image.width;
+pic_height=image.height;
+}
+if(ant==null){
+ant=MM_findObj("ant");
+}
+ant.style.left=pic_x;
+ant.style.top=pic_y;
+ant.style.width=pic_width;
+ant.style.height=pic_height;
+ant.style.visibility="visible";
+drawBoundHandle();
+jg_doc.paint();
+}
+}
+initEditor=function(){
+init_crop();
+init_resize();
+var _a=MM_findObj("markerImg",window.top.document);
+if(_a.src.indexOf("img/t_white.gif")>0){
+toggleMarker();
+}
+};
+function init_crop(){
+P7_Snap("theImage","ant",0,0);
+}
+function setMode(_b){
+mode=_b;
+reset();
+}
+function reset(){
+if(ant==null){
+ant=MM_findObj("ant");
+}
+ant.style.visibility="hidden";
+ant.style.left=0;
+ant.style.top=0;
+ant.style.width=0;
+ant.style.height=0;
+mx2=null;
+my2=null;
+jg_doc.clear();
+if(mode!="measure"){
+showStatus();
+}
+if(mode=="scale"){
+init_resize();
+}
+P7_Snap("theImage","ant",0,0);
+}
+function toggleMarker(){
+if(ant==null){
+ant=MM_findObj("ant");
+}
+if(ant.className=="selection"){
+ant.className="selectionWhite";
+}else{
+ant.className="selection";
+}
+if(jg_doc.getColor()=="#000000"){
+jg_doc.setColor("#FFFFFF");
+}else{
+jg_doc.setColor("#000000");
+}
+drawBoundHandle;
+jg_doc.paint();
+}
+function move(e){
+if(dragapproved){
+var w=ns6?temp1+e.clientX-x:temp1+event.clientX-x;
+var h=ns6?temp2+e.clientY-y:temp2+event.clientY-y;
+if(ant!=null){
+if(w>=0){
+ant.style.left=x;
+ant.style.width=w;
+}else{
+ant.style.left=x+w;
+ant.style.width=-1*w;
+}
+if(h>=0){
+ant.style.top=y;
+ant.style.height=h;
+}else{
+ant.style.top=y+h;
+ant.style.height=-1*h;
+}
+}
+showStatus();
+return false;
+}
+}
+function moveContent(e){
+if(dragapproved){
+var dx=ns6?oa_x+e.clientX-x:oa_x+event.clientX-x;
+var dy=ns6?oa_y+e.clientY-y:oa_y+event.clientY-y;
+ant.style.left=dx;
+ant.style.top=dy;
+showStatus();
+return false;
+}
+}
+function moveHandle(e){
+if(dragapproved){
+var w=ns6?e.clientX-x:event.clientX-x;
+var h=ns6?e.clientY-y:event.clientY-y;
+var _15=MM_findObj("constProp",window.top.document);
+var _16=document.theImage.height;
+var _17=document.theImage.width;
+rapp=_17/_16;
+rapp_inv=_16/_17;
+switch(resizeHandle){
+case "s-resize":
+if(oa_h+h>=0){
+ant.style.height=oa_h+h;
+if(_15.checked){
+ant.style.width=rapp*(oa_h+h);
+ant.style.left=oa_x-rapp*h/2;
+}
+}
+break;
+case "e-resize":
+if(oa_w+w>=0){
+ant.style.width=oa_w+w;
+if(_15.checked){
+ant.style.height=rapp_inv*(oa_w+w);
+ant.style.top=oa_y-rapp_inv*w/2;
+}
+}
+break;
+case "n-resize":
+if(oa_h-h>=0){
+ant.style.top=oa_y+h;
+ant.style.height=oa_h-h;
+if(_15.checked){
+ant.style.width=rapp*(oa_h-h);
+ant.style.left=oa_x+rapp*h/2;
+}
+}
+break;
+case "w-resize":
+if(oa_w-w>=0){
+ant.style.left=oa_x+w;
+ant.style.width=oa_w-w;
+if(_15.checked){
+ant.style.height=rapp_inv*(oa_w-w);
+ant.style.top=oa_y+rapp_inv*w/2;
+}
+}
+break;
+case "nw-resize":
+if(oa_h-h>=0&&oa_w-w>=0){
+ant.style.left=oa_x+w;
+ant.style.width=oa_w-w;
+ant.style.top=oa_y+h;
+if(_15.checked){
+ant.style.height=rapp_inv*(oa_w-w);
+}else{
+ant.style.height=oa_h-h;
+}
+}
+break;
+case "ne-resize":
+if(oa_h-h>=0&&oa_w+w>=0){
+ant.style.top=oa_y+h;
+ant.style.width=oa_w+w;
+if(_15.checked){
+ant.style.height=rapp_inv*(oa_w+w);
+}else{
+ant.style.height=oa_h-h;
+}
+}
+break;
+case "se-resize":
+if(oa_h+h>=0&&oa_w+w>=0){
+ant.style.width=oa_w+w;
+if(_15.checked){
+ant.style.height=rapp_inv*(oa_w+w);
+}else{
+ant.style.height=oa_h+h;
+}
+}
+break;
+case "sw-resize":
+if(oa_h+h>=0&&oa_w-w>=0){
+ant.style.left=oa_x+w;
+ant.style.width=oa_w-w;
+if(_15.checked){
+ant.style.height=rapp_inv*(oa_w-w);
+}else{
+ant.style.height=oa_h+h;
+}
+}
+}
+showStatus();
+return false;
+}
+}
+function drags(e){
+if(!ie&&!ns6){
+return;
+}
+var _19=ns6?e.target:event.srcElement;
+var _1a=ns6?"HTML":"BODY";
+while(_19.tagName!=_1a&&!(_19.className=="crop"||_19.className=="handleBox"||_19.className=="selection"||_19.className=="selectionWhite")){
+_19=ns6?_19.parentNode:_19.parentElement;
+}
+if(_19.className=="handleBox"){
+if(content!=null){
+if(content.width!=null&&content.height!=null){
+content.width=0;
+content.height=0;
+}
+}
+resizeHandle=_19.id;
+x=ns6?e.clientX:event.clientX;
+y=ns6?e.clientY:event.clientY;
+oa_w=parseInt(ant.style.width);
+oa_h=parseInt(ant.style.height);
+oa_x=parseInt(ant.style.left);
+oa_y=parseInt(ant.style.top);
+dragapproved=true;
+document.onmousemove=moveHandle;
+return false;
+}else{
+if((_19.className=="selection"||_19.className=="selectionWhite")&&mode=="crop"){
+x=ns6?e.clientX:event.clientX;
+y=ns6?e.clientY:event.clientY;
+oa_x=parseInt(ant.style.left);
+oa_y=parseInt(ant.style.top);
+dragapproved=true;
+document.onmousemove=moveContent;
+return false;
+}else{
+if(_19.className=="crop"&&mode=="crop"){
+if(content!=null){
+if(content.width!=null&&content.height!=null){
+content.width=0;
+content.height=0;
+}
+}
+if(status==null){
+status=MM_findObj("status");
+}
+if(ant==null){
+ant=MM_findObj("ant");
+}
+if(canvas==null){
+canvas=MM_findObj("imgCanvas");
+}
+if(content==null){
+content=MM_findObj("cropContent");
+}
+if(pic_width==null||pic_height==null){
+image=MM_findObj("theImage");
+pic_width=image.width;
+pic_height=image.height;
+}
+ant.style.visibility="visible";
+obj=_19;
+dragapproved=true;
+z=_19;
+temp1=parseInt(z.style.left+0);
+temp2=parseInt(z.style.top+0);
+x=ns6?e.clientX:event.clientX;
+y=ns6?e.clientY:event.clientY;
+document.onmousemove=move;
+return false;
+}else{
+if(_19.className=="crop"&&mode=="measure"){
+if(ant==null){
+ant=MM_findObj("ant");
+}
+if(canvas==null){
+canvas=MM_findObj("imgCanvas");
+}
+x=ns6?e.clientX:event.clientX;
+y=ns6?e.clientY:event.clientY;
+dragapproved=true;
+document.onmousemove=measure;
+return false;
+}
+}
+}
+}
+}
+function measure(e){
+if(dragapproved){
+mx2=ns6?e.clientX:event.clientX;
+my2=ns6?e.clientY:event.clientY;
+jg_doc.clear();
+jg_doc.setStroke(Stroke.DOTTED);
+jg_doc.drawLine(x,y,mx2,my2);
+jg_doc.paint();
+showStatus();
+return false;
+}
+}
+function setMarker(nx,ny,nw,nh){
+if(isNaN(nx)){
+nx=0;
+}
+if(isNaN(ny)){
+ny=0;
+}
+if(isNaN(nw)){
+nw=0;
+}
+if(isNaN(nh)){
+nh=0;
+}
+if(ant==null){
+ant=MM_findObj("ant");
+}
+if(canvas==null){
+canvas=MM_findObj("imgCanvas");
+}
+if(content==null){
+content=MM_findObj("cropContent");
+}
+if(pic_width==null||pic_height==null){
+image=MM_findObj("theImage");
+pic_width=image.width;
+pic_height=image.height;
+}
+ant.style.visibility="visible";
+nx=pic_x+nx;
+ny=pic_y+ny;
+if(nw>=0){
+ant.style.left=nx;
+ant.style.width=nw;
+}else{
+ant.style.left=nx+nw;
+ant.style.width=-1*nw;
+}
+if(nh>=0){
+ant.style.top=ny;
+ant.style.height=nh;
+}else{
+ant.style.top=ny+nh;
+ant.style.height=-1*nh;
+}
+}
+function max(x,y){
+if(y>x){
+return x;
+}else{
+return y;
+}
+}
+function drawBoundHandle(){
+if(ant==null||ant.style==null){
+return false;
+}
+var ah=parseInt(ant.style.height);
+var aw=parseInt(ant.style.width);
+var ax=parseInt(ant.style.left);
+var ay=parseInt(ant.style.top);
+jg_doc.drawHandle(ax-15,ay-15,30,30,"nw-resize");
+jg_doc.drawHandle(ax-15,ay+ah-15,30,30,"sw-resize");
+jg_doc.drawHandle(ax+aw-15,ay-15,30,30,"ne-resize");
+jg_doc.drawHandle(ax+aw-15,ay+ah-15,30,30,"se-resize");
+jg_doc.drawHandle(ax+max(15,aw/10),ay-8,aw-2*max(15,aw/10),8,"n-resize");
+jg_doc.drawHandle(ax+max(15,aw/10),ay+ah,aw-2*max(15,aw/10),8,"s-resize");
+jg_doc.drawHandle(ax-8,ay+max(15,ah/10),8,ah-2*max(15,ah/10),"w-resize");
+jg_doc.drawHandle(ax+aw,ay+max(15,ah/10),8,ah-2*max(15,ah/10),"e-resize");
+jg_doc.drawHandleBox(ax-4,ay-4,8,8,"nw-resize");
+jg_doc.drawHandleBox(ax-4,ay+ah-4,8,8,"sw-resize");
+jg_doc.drawHandleBox(ax+aw-4,ay-4,8,8,"ne-resize");
+jg_doc.drawHandleBox(ax+aw-4,ay+ah-4,8,8,"se-resize");
+jg_doc.drawHandleBox(ax+aw/2-4,ay-4,8,8,"n-resize");
+jg_doc.drawHandleBox(ax+aw/2-4,ay+ah-4,8,8,"s-resize");
+jg_doc.drawHandleBox(ax-4,ay+ah/2-4,8,8,"w-resize");
+jg_doc.drawHandleBox(ax+aw-4,ay+ah/2-4,8,8,"e-resize");
+}
+function showStatus(){
+if(ant==null||ant.style==null){
+return false;
+}
+if(mode=="measure"){
+mx1=x-pic_x;
+my1=y-pic_y;
+mw=mx2-x;
+mh=my2-y;
+md=parseInt(Math.sqrt(mw*mw+mh*mh)*100)/100;
+ma=(Math.atan(-1*mh/mw)/Math.PI)*180;
+if(mw<0&&mh<0){
+ma=ma+180;
+}
+if(mw<0&&mh>0){
+ma=ma-180;
+}
+ma=parseInt(ma*100)/100;
+if(m_sx!=null&&!isNaN(mx1)){
+m_sx.value=mx1+"px";
+}
+if(m_sy!=null&&!isNaN(my1)){
+m_sy.value=my1+"px";
+}
+if(m_w!=null&&!isNaN(mw)){
+m_w.value=mw+"px";
+}
+if(m_h!=null&&!isNaN(mh)){
+m_h.value=mh+"px";
+}
+if(m_d!=null&&!isNaN(md)){
+m_d.value=md+"px";
+}
+if(m_a!=null&&!isNaN(ma)){
+m_a.value=ma+"";
+}
+if(r_ra!=null&&!isNaN(ma)){
+r_ra.value=ma;
+}
+return false;
+}
+var ah=parseInt(ant.style.height);
+var aw=parseInt(ant.style.width);
+var ax=parseInt(ant.style.left);
+var ay=parseInt(ant.style.top);
+var cx=ax-pic_x<0?0:ax-pic_x;
+var cy=ay-pic_y<0?0:ay-pic_y;
+cx=cx>pic_width?pic_width:cx;
+cy=cy>pic_height?pic_height:cy;
+var cw=ax-pic_x>0?aw:aw-(pic_x-ax);
+var ch=ay-pic_y>0?ah:ah-(pic_y-ay);
+ch=ay+ah<pic_y+pic_height?ch:ch-(ay+ah-pic_y-pic_height);
+cw=ax+aw<pic_x+pic_width?cw:cw-(ax+aw-pic_x-pic_width);
+ch=ch<0?0:ch;
+cw=cw<0?0:cw;
+if(ant.style.visibility=="hidden"){
+cx="";
+cy="";
+cw="";
+ch="";
+}
+if(mode=="crop"){
+if(t_cx!=null){
+t_cx.value=cx;
+}
+if(t_cy!=null){
+t_cy.value=cy;
+}
+if(t_cw!=null){
+t_cw.value=cw;
+}
+if(t_ch!=null){
+t_ch.value=ch;
+}
+}else{
+if(mode=="scale"){
+var sw=aw,sh=ah;
+if(s_sw.value.indexOf("%")>0&&s_sh.value.indexOf("%")>0){
+sw=cw/pic_width;
+sh=ch/pic_height;
+}
+if(s_sw!=null){
+s_sw.value=sw;
+}
+if(s_sh!=null){
+s_sh.value=sh;
+}
+}
+}
+}
+function dragStopped(){
+dragapproved=false;
+if(ant==null||ant.style==null){
+return false;
+}
+if(mode=="measure"){
+jg_doc.drawLine(x-4,y,x+4,y);
+jg_doc.drawLine(x,y-4,x,y+4);
+jg_doc.drawLine(mx2-4,my2,mx2+4,my2);
+jg_doc.drawLine(mx2,my2-4,mx2,my2+4);
+jg_doc.paint();
+showStatus();
+return false;
+}
+var ah=parseInt(ant.style.height);
+var aw=parseInt(ant.style.width);
+var ax=parseInt(ant.style.left);
+var ay=parseInt(ant.style.top);
+jg_doc.clear();
+if(content!=null){
+if(content.width!=null&&content.height!=null){
+content.width=aw-1;
+content.height=ah-1;
+}
+}
+if(mode=="crop"){
+jg_doc.fillRectPattern(pic_x,pic_y,pic_width,ay-pic_y,pattern);
+var h1=ah;
+var y1=ay;
+if(ah+ay>=pic_height+pic_y){
+h1=pic_height+pic_y-ay;
+}else{
+if(ay<=pic_y){
+h1=ay+ah-pic_y;
+y1=pic_y;
+}
+}
+jg_doc.fillRectPattern(pic_x,y1,ax-pic_x,h1,pattern);
+jg_doc.fillRectPattern(ax+aw,y1,pic_x+pic_width-ax-aw,h1,pattern);
+jg_doc.fillRectPattern(pic_x,ay+ah,pic_width,pic_height+pic_y-ay-ah,pattern);
+}else{
+if(mode=="scale"){
+document.theImage.height=ah;
+document.theImage.width=aw;
+document.theImage.style.height=ah+" px";
+document.theImage.style.width=aw+" px";
+P7_Snap("theImage","ant",0,0);
+}
+}
+drawBoundHandle();
+jg_doc.paint();
+showStatus();
+return false;
+}
+document.onmousedown=drags;
+document.onmouseup=dragStopped;
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/assets/ImageEditor.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/assets/ImageEditor.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,76 @@
+.icons {
+    font: 11px Tahoma,Verdana,sans-serif;
+    color: #666699;
+    text-align: center;
+    text-decoration: none;
+    border: 1px solid #EEEEFF;
+    -Moz-Border-Radius: 6px 6px 6px 6px;
+}
+
+body, td, p {
+    font: 11px Tahoma,Verdana,sans-serif;
+}
+.iconsOver {
+    font: 11px Tahoma,Verdana,sans-serif;
+    color: #666699;
+    text-align: center;
+    text-decoration: none;
+    background-color: #F9F9FF;
+    border: 1px solid #666699;
+    -Moz-Border-Radius: 6px 6px 6px 6px;
+}
+.topBar {
+    font: 11px Tahoma,Verdana,sans-serif;
+    color: #666699;
+}
+.iconsSel {
+    font: 11px Tahoma,Verdana,sans-serif;
+    color: #666699;
+    text-align: center;
+    text-decoration: none;
+    border: 1px solid #666699;
+    -Moz-Border-Radius: 6px 6px 6px 6px;
+}
+.iconText {
+    font: 11px Tahoma,Verdana,sans-serif;
+    color: #666699;
+    text-decoration: none;
+    text-align: center;
+}
+.measureStats{
+    width: 50px;
+}
+
+#slidercasing {
+    /*border:1px solid #CCCCCC;
+    background-color:#FFFFFF;*/
+    width:100px;
+    height:5px;
+    position:relative;
+    z-index:4;
+    padding:10px;
+}
+
+
+#slidertrack {
+    position:relative;
+    border:1px solid #CCCCCC;
+    background-color:#FFFFCC;
+    z-index:5;
+    height:5px;
+}
+
+
+#sliderbar {
+    position:absolute;
+    z-index:6;
+    border:1px solid #CCCCCC;
+    background-color:#DDDDDD;
+    width:15px;     
+    padding:0px;
+    height:20px; 
+    cursor: pointer;
+    top:2px;
+}
+
+select, input, button { font: 11px Tahoma,Verdana,sans-serif; }
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/assets/dialog.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/assets/dialog.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,83 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/ImageManager/assets/dialog.js */
+function Dialog(_1,_2,_3){
+if(typeof _3=="undefined"){
+_3=window;
+}
+if(typeof window.showModalDialog=="function"){
+Dialog._return=_2;
+var r=window.showModalDialog(_1,_3,"dialogheight=10;dialogwidth=10;resizable=yes");
+}else{
+Dialog._geckoOpenModal(_1,_2,_3);
+}
+}
+Dialog._parentEvent=function(ev){
+setTimeout(function(){
+if(Dialog._modal&&!Dialog._modal.closed){
+Dialog._modal.focus();
+}
+},50);
+if(Dialog._modal&&!Dialog._modal.closed){
+Dialog._stopEvent(ev);
+}
+};
+Dialog._return=null;
+Dialog._modal=null;
+Dialog._arguments=null;
+Dialog._geckoOpenModal=function(_6,_7,_8){
+var _9="hadialog"+_6;
+var _a=/\W/g;
+_9=_9.replace(_a,"_");
+var _b=window.open(_6,_9,"toolbar=no,menubar=no,personalbar=no,width=10,height=10,"+"scrollbars=no,resizable=yes,modal=yes,dependable=yes");
+Dialog._modal=_b;
+Dialog._arguments=_8;
+function capwin(w){
+Dialog._addEvent(w,"click",Dialog._parentEvent);
+Dialog._addEvent(w,"mousedown",Dialog._parentEvent);
+Dialog._addEvent(w,"focus",Dialog._parentEvent);
+}
+function relwin(w){
+Dialog._removeEvent(w,"click",Dialog._parentEvent);
+Dialog._removeEvent(w,"mousedown",Dialog._parentEvent);
+Dialog._removeEvent(w,"focus",Dialog._parentEvent);
+}
+capwin(window);
+for(var i=0;i<window.frames.length;capwin(window.frames[i++])){
+}
+Dialog._return=function(_f){
+if(_f&&_7){
+_7(_f);
+}
+relwin(window);
+for(var i=0;i<window.frames.length;relwin(window.frames[i++])){
+}
+Dialog._modal=null;
+};
+};
+Dialog._addEvent=function(el,_12,_13){
+if(Dialog.is_ie){
+el.attachEvent("on"+_12,_13);
+}else{
+el.addEventListener(_12,_13,true);
+}
+};
+Dialog._removeEvent=function(el,_15,_16){
+if(Dialog.is_ie){
+el.detachEvent("on"+_15,_16);
+}else{
+el.removeEventListener(_15,_16,true);
+}
+};
+Dialog._stopEvent=function(ev){
+if(Dialog.is_ie){
+ev.cancelBubble=true;
+ev.returnValue=false;
+}else{
+ev.preventDefault();
+ev.stopPropagation();
+}
+};
+Dialog.agt=navigator.userAgent.toLowerCase();
+Dialog.is_ie=((Dialog.agt.indexOf("msie")!=-1)&&(Dialog.agt.indexOf("opera")==-1));
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/assets/editor.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/assets/editor.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,194 @@
+		body
+		{
+			margin: 0; padding: 0;
+			font: 11px Tahoma,Verdana,sans-serif;
+		}
+		select, input, button { font: 11px Tahoma,Verdana,sans-serif; }
+
+		#indicator
+		{
+			width: 25px;
+			height: 20px;
+			background-color: #eef;			
+			padding: 15px 20px;
+			position: absolute;
+			left: 0; top: 0;
+		}
+		* html #indicator
+		{
+			padding: 14px 22px;
+		}
+		#tools
+		{
+			width: 600px;
+			height: 50px;
+			background-color: #eef;
+			padding: 0;
+			position: absolute;
+			left: 63px;
+			border-left: 1px solid white;
+			border-bottom: 1px solid white;
+		}
+		#toolbar
+		{
+			width: 53px;
+			height: 435px;
+			background-color: #eef;
+			float: left;
+			text-align: center;
+			padding: 5px;
+			position: absolute;
+			top: 50px;
+			border-top: 1px solid white;
+			border-right: 1px solid white;
+		}
+		
+		#contents
+		{
+			width: 600px;
+			height: 445px;
+			position: absolute;
+			left: 64px; top: 51px;
+		}
+		
+		#editor
+		{
+			width: 600px;
+			height: 445px;
+		}
+
+		#toolbar a 
+		{
+			padding: 5px;
+			width: 40px;
+			display: block;
+			border: 1px solid #eef;
+			text-align: center;
+			text-decoration: none;
+			color: #669;
+			margin: 5px 0;
+		}
+		#toolbar a:hover
+		{
+			background-color: #F9F9FF;
+			border-color: #669;
+		}
+		
+		#toolbar a.iconActive
+		{
+			border-color: #669;
+		}
+
+		#toolbar a span
+		{
+			display: block;
+			text-decoration: none;
+			
+		}
+		#toolbar a img
+		{
+			border: 0 none;
+		}
+		
+		#tools .textInput
+		{
+			width: 3em;
+			vertical-align: 0px;
+
+		}
+		* html #tools .textInput
+		{
+			vertical-align: middle;
+		}
+		#tools .measureStats
+		{
+			width: 4.5em;
+			border: 0 none;
+			background-color: #eef;
+			vertical-align: 0px;
+		}
+		* html #tools .measureStats
+		{
+			vertical-align: middle;
+		}
+		#tools label
+		{
+			margin: 0 2px 0 5px;
+		}
+		#tools input
+		{
+			vertical-align: middle;
+		}
+		#tools #tool_inputs
+		{
+			padding-top: 10px;
+			float: left;			
+		}
+		#tools .div
+		{
+			vertical-align: middle;
+			margin: 0 5px;
+		}
+		#tools img
+		{
+			border: 0 none;
+		}
+		#tools a.buttons
+		{
+			margin-top: 10px;
+			border: 1px solid #eef;
+			display: block;
+			float: left;
+		}
+		#tools a.buttons:hover
+		{
+			background-color: #F9F9FF;
+			border-color: #669;
+		}
+		#slidercasing {
+    /*border:1px solid #CCCCCC;
+    background-color:#FFFFFF;*/
+    width:100px;
+    height:5px;
+    position:relative;
+    z-index:4;
+    padding:10px;
+	 top: 6px;
+	 margin: 0 -5px 0 -10px;
+
+	
+}
+
+
+#slidertrack {
+    position:relative;
+    border:1px solid #CCCCCC;
+    background-color:#FFFFCC;
+    z-index:5;
+    height:5px;
+}
+
+
+#sliderbar {
+    position:absolute;
+    z-index:6;
+    border:1px solid #CCCCCC;
+    background-color:#DDDDDD;
+    width:15px;     
+    padding:0px;
+    height:20px; 
+    cursor: pointer;
+    top:2px;
+}
+
+* html #slidercasing
+{
+	top:0;
+}
+
+
+#bottom
+{
+	position: relative;
+	top: 490px;
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/assets/editor.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/assets/editor.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,130 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/ImageManager/assets/editor.js */
+var current_action=null;
+var actions=["crop","scale","rotate","measure","save"];
+var orginal_width=null,orginal_height=null;
+function toggle(_1){
+if(current_action!=_1){
+for(var i in actions){
+if(actions[i]!=_1){
+var _3=document.getElementById("tools_"+actions[i]);
+_3.style.display="none";
+var _4=document.getElementById("icon_"+actions[i]);
+_4.className="";
+}
+}
+current_action=_1;
+var _3=document.getElementById("tools_"+_1);
+_3.style.display="block";
+var _4=document.getElementById("icon_"+_1);
+_4.className="iconActive";
+var _5=document.getElementById("indicator_image");
+_5.src="img/"+_1+".gif";
+editor.setMode(current_action);
+if(_1=="scale"){
+var _6=editor.window.document.getElementById("theImage");
+orginal_width=_6.width;
+orginal_height=_6.height;
+var w=document.getElementById("sw");
+w.value=orginal_width;
+var h=document.getElementById("sh");
+h.value=orginal_height;
+}
+}
+}
+function toggleMarker(){
+var _9=document.getElementById("markerImg");
+if(_9!=null&&_9.src!=null){
+if(_9.src.indexOf("t_black.gif")>=0){
+_9.src="img/t_white.gif";
+}else{
+_9.src="img/t_black.gif";
+}
+editor.toggleMarker();
+}
+}
+function toggleConstraints(){
+var _a=document.getElementById("scaleConstImg");
+var _b=document.getElementById("constProp");
+if(_a!=null&&_a.src!=null){
+if(_a.src.indexOf("unlocked2.gif")>=0){
+_a.src="img/islocked2.gif";
+_b.checked=true;
+checkConstrains("width");
+}else{
+_a.src="img/unlocked2.gif";
+_b.checked=false;
+}
+}
+}
+function checkConstrains(_c){
+var _d=document.getElementById("constProp");
+if(_d.checked){
+var w=document.getElementById("sw");
+var _f=w.value;
+var h=document.getElementById("sh");
+var _11=h.value;
+if(orginal_width>0&&orginal_height>0){
+if(_c=="width"&&_f>0){
+h.value=parseInt((_f/orginal_width)*orginal_height);
+}else{
+if(_c=="height"&&_11>0){
+w.value=parseInt((_11/orginal_height)*orginal_width);
+}
+}
+}
+}
+updateMarker("scale");
+}
+function updateMarker(_12){
+if(_12=="crop"){
+var _13=document.getElementById("cx");
+var _14=document.getElementById("cy");
+var _15=document.getElementById("cw");
+var _16=document.getElementById("ch");
+editor.setMarker(parseInt(_13.value),parseInt(_14.value),parseInt(_15.value),parseInt(_16.value));
+}else{
+if(_12=="scale"){
+var _17=document.getElementById("sw");
+var _18=document.getElementById("sh");
+editor.setMarker(0,0,parseInt(_17.value),parseInt(_18.value));
+}
+}
+}
+function rotatePreset(_19){
+var _1a=_19.options[_19.selectedIndex].value;
+if(_1a.length>0&&parseInt(_1a)!=0){
+var ra=document.getElementById("ra");
+ra.value=parseInt(_1a);
+}
+}
+function updateFormat(_1c){
+var _1d=_1c.options[_1c.selectedIndex].value;
+var _1e=_1d.split(",");
+if(_1e.length>1){
+updateSlider(parseInt(_1e[1]));
+}
+}
+function addEvent(obj,_20,fn){
+if(obj.addEventListener){
+obj.addEventListener(_20,fn,true);
+return true;
+}else{
+if(obj.attachEvent){
+var r=obj.attachEvent("on"+_20,fn);
+return r;
+}else{
+return false;
+}
+}
+}
+init=function(){
+var _23=document.getElementById("bottom");
+if(window.opener){
+__dlg_init(_23);
+__dlg_translate("ImageManager");
+}
+};
+addEvent(window,"load",init);
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/assets/editorFrame.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/assets/editorFrame.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,8 @@
+body { margin: 0; padding: 0;  background-color: #eee; }
+table { width: 100%; }
+table td { text-align: center; }
+.crop{cursor:crosshair;}
+.selection { border: dotted 1px #000000; position:absolute; width: 0px; height: 1px; z-index:5; }
+.selectionWhite{ border: dotted 1px #FFFFFF; position:absolute; width: 0px; height: 1px; z-index:5; }
+.handleBox{ z-index:105; }
+.error { font-size:large; font-weight:bold; color:#c00; font-family: Helvetica, sans-serif; } 
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/assets/editorFrame.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/assets/editorFrame.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,76 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/ImageManager/assets/editorFrame.js */
+var topDoc=window.top.document;
+var t_cx=topDoc.getElementById("cx");
+var t_cy=topDoc.getElementById("cy");
+var t_cw=topDoc.getElementById("cw");
+var t_ch=topDoc.getElementById("ch");
+var m_sx=topDoc.getElementById("sx");
+var m_sy=topDoc.getElementById("sy");
+var m_w=topDoc.getElementById("mw");
+var m_h=topDoc.getElementById("mh");
+var m_a=topDoc.getElementById("ma");
+var m_d=topDoc.getElementById("md");
+var s_sw=topDoc.getElementById("sw");
+var s_sh=topDoc.getElementById("sh");
+var r_ra=topDoc.getElementById("ra");
+var pattern="img/2x2.gif";
+function doSubmit(_1){
+if(_1=="crop"){
+var _2=_backend_url+"__function=editorFrame&img="+currentImageFile+"&action=crop&params="+parseInt(t_cx.value)+","+parseInt(t_cy.value)+","+parseInt(t_cw.value)+","+parseInt(t_ch.value);
+location.href=_2;
+}else{
+if(_1=="scale"){
+var _2=_backend_url+"__function=editorFrame&img="+currentImageFile+"&action=scale&params="+parseInt(s_sw.value)+","+parseInt(s_sh.value);
+location.href=_2;
+}else{
+if(_1=="rotate"){
+var _3=topDoc.getElementById("flip");
+if(_3.value=="hoz"||_3.value=="ver"){
+location.href=_backend_url+"__function=editorFrame&img="+currentImageFile+"&action=flip&params="+_3.value;
+}else{
+if(isNaN(parseFloat(r_ra.value))==false){
+location.href=_backend_url+"__function=editorFrame&img="+currentImageFile+"&action=rotate&params="+parseFloat(r_ra.value);
+}
+}
+}else{
+if(_1=="save"){
+var _4=topDoc.getElementById("save_filename");
+var _5=topDoc.getElementById("save_format");
+var _6=topDoc.getElementById("quality");
+var _7=_5.value.split(",");
+if(_4.value.length<=0){
+alert(i18n("Please enter a filename to save."));
+}else{
+var _8=encodeURI(_4.value);
+var _9=parseInt(_6.value);
+var _2=_backend_url+"__function=editorFrame&img="+currentImageFile+"&action=save&params="+_7[0]+","+_9+"&file="+_8;
+location.href=_2;
+}
+}
+}
+}
+}
+}
+function addEvent(_a,_b,fn){
+if(_a.addEventListener){
+_a.addEventListener(_b,fn,true);
+return true;
+}else{
+if(_a.attachEvent){
+var r=_a.attachEvent("on"+_b,fn);
+return r;
+}else{
+return false;
+}
+}
+}
+var jg_doc;
+init=function(){
+jg_doc=new jsGraphics("imgCanvas");
+jg_doc.setColor("#000000");
+initEditor();
+};
+addEvent(window,"load",init);
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/assets/hover.htc
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/assets/hover.htc	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,34 @@
+<attach event="onmouseover" handler="hoverRollOver" />
+<attach event="onmouseout" handler="hoverRollOff" />
+<script type="text/javascript">
+//
+//	Simple behaviour for IE5+ to emulate :hover CSS pseudo-class.
+//  Experimental ver 0.1
+//
+//	This is an experimental version! Handle with care!
+//	Manual at: http://www.hszk.bme.hu/~hj130/css/list_menu/hover/
+//
+
+function hoverRollOver() {
+	
+	element.origClassName = element.className;	// backup origonal className
+	
+	var tempClassStr = element.className;		
+	
+	tempClassStr += "Hover";					// convert name+'Hover' the last class name	to emulate tag.class:hover
+	
+	tempClassStr = tempClassStr.replace(/\s/g,"Hover ");	//convert name+'Hover' the others to emulate tag.class:hover
+	
+	tempClassStr += " hover";				// add simple 'hover' class name to emulate tag:hover
+	
+	element.className = element.className + " " + tempClassStr; 
+	
+	//alert(element.className);
+	//window.status = element.className;		// only for TEST
+}
+function hoverRollOff() {
+	element.className = element.origClassName;
+}
+
+</script>
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/assets/imagelist.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/assets/imagelist.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,46 @@
+body { margin: 0; padding: 0; }
+.edit   { font-size: small; font-family: small-caption, sans-serif; padding-top: 3px;}
+.edit a { border: none; padding: 3px; text-decoration:none; }
+.edit a:hover { background-color: ButtonHighlight; }
+.edit a img { border: none; vertical-align: bottom; }
+.noResult { font-size:large; font-weight:bold; color:#ccc; font-family: Helvetica, sans-serif;  text-align: center;  padding-top: 60px;   }
+.error { color:#c00; font-weight:bold; font-size: medium; font-family: Helvetica, sans-serif; text-align: center;  padding-top: 65px;}
+
+.dir_holder, .thumb_holder
+{
+  width:110px; height:132px;
+  float:left;
+  margin:6px;
+  background-color:ButtonFace;
+  border: 1px outset;
+}
+
+.thumb_holder.active
+{
+  background:Highlight;
+  color:HighlightText;
+  border:1px dashed Highlight;
+}
+
+.dir_holder a.dir, .thumb_holder a.thumb
+{
+  height:100px;
+  display:block;
+  text-align:center;
+  padding:5px;
+  text-decoration:none;
+}
+
+.thumb_holder a.thumb img
+{
+  border:1px solid black;
+}
+
+.dir_holder a.dir img
+{
+  border:none;
+}
+.listview { width:100% }
+.listview td, .listview th { text-align:left; font-size:small; }
+.listview td.actions { text-align:right; }
+.listview td.actions img { border:0px; }
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/assets/images.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/assets/images.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,119 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/ImageManager/assets/images.js */
+function i18n(_1){
+return Xinha._lc(_1,"ImageManager");
+}
+function changeDir(_2){
+showMessage("Loading");
+location.href=_backend_url+"__function=images&dir="+encodeURIComponent(_2);
+}
+function newFolder(_3,_4){
+location.href=_backend_url+"__function=images&dir="+encodeURIComponent(_3)+"&newDir="+encodeURIComponent(_4);
+}
+function updateDir(_5){
+var _6=window.top.document.getElementById("dirPath");
+if(_6){
+for(var i=0;i<_6.length;i++){
+var _8=_6.options[i].text;
+if(_8==_5){
+_6.selectedIndex=i;
+showMessage("Loading");
+break;
+}
+}
+}
+}
+function selectImage(_9,_a,_b,_c){
+var _d=window.top.document;
+var _e=_d.getElementById("f_url");
+_e.value=_9;
+var _e=_d.getElementById("f_width");
+_e.value=_b;
+var _e=_d.getElementById("f_width");
+_e.value=_b;
+var _e=_d.getElementById("f_height");
+_e.value=_c;
+var _e=_d.getElementById("f_alt");
+_e.value=_a;
+var _e=_d.getElementById("orginal_width");
+_e.value=_b;
+var _e=_d.getElementById("orginal_height");
+_e.value=_c;
+_d.getElementById("f_preview").src=window.parent._backend_url+"__function=thumbs&img="+_9;
+update_selected();
+}
+var _current_selected=null;
+function update_selected(){
+var _f=window.top.document;
+if(_current_selected){
+_current_selected.className=_current_selected.className.replace(/(^| )active( |$)/,"$1$2");
+_current_selected=null;
+}
+var _10=_f.getElementById("f_url").value;
+var _11=_f.getElementById("dirPath");
+var _12=_11.options[_11.selectedIndex].text;
+var dRe=new RegExp("^("+_12.replace(/([\/\^$*+?.()|{}[\]])/g,"\\$1")+")([^/]*)$");
+if(dRe.test(_10)){
+var _14=document.getElementById("holder_"+asc2hex(RegExp.$2));
+if(_14){
+_current_selected=_14;
+_14.className+=" active";
+}
+}
+}
+function asc2hex(str){
+var _16="";
+for(var i=0;i<str.length;i++){
+var hex=(str.charCodeAt(i)).toString(16);
+if(hex.length==1){
+hex="0"+hex;
+}
+_16+=hex;
+}
+return _16;
+}
+function showMessage(_19){
+var _1a=window.top.document;
+var _1b=_1a.getElementById("message");
+var _1c=_1a.getElementById("messages");
+if(_1b&&_1c){
+if(_1b.firstChild){
+_1b.removeChild(_1b.firstChild);
+}
+_1b.appendChild(_1a.createTextNode(i18n(_19)));
+_1c.style.display="block";
+}
+}
+function addEvent(obj,_1e,fn){
+if(obj.addEventListener){
+obj.addEventListener(_1e,fn,true);
+return true;
+}else{
+if(obj.attachEvent){
+var r=obj.attachEvent("on"+_1e,fn);
+return r;
+}else{
+return false;
+}
+}
+}
+function confirmDeleteFile(_21){
+if(confirm(i18n("Delete file?"))){
+return true;
+}
+return false;
+}
+function confirmDeleteDir(dir,_23){
+if(_23>0){
+alert(i18n("Please delete all files/folders inside the folder you wish to delete first."));
+return;
+}
+if(confirm(i18n("Delete folder?"))){
+return true;
+}
+return false;
+}
+addEvent(window,"load",init);
+Xinha=window.parent.Xinha;
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/assets/manager.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/assets/manager.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,46 @@
+html, body, .dialog {  background-color: ButtonFace;  color: ButtonText; font: 11px Tahoma,Verdana,sans-serif; margin: 0; padding: 0;}
+body { padding: 5px; }
+fieldset { padding: 0;}
+.title { background-color: #ddf; color: #000; font-weight: bold; font-size: 120%; padding: 3px 10px; margin-bottom: 10px; border-bottom: 1px  solid black; letter-spacing: 2px;}
+form { padding: 0px;  margin: 0 auto; width: 550px;}
+
+a { padding: 5px; border: 1px solid ButtonFace;	}	
+a img	{ border: 0; }	
+a:hover { border-color: ButtonHighlight ButtonShadow ButtonShadow ButtonHighlight; }
+.dirs {	padding: 1em; 	}
+.imageFrame { width: 100%; height: 145px; margin: 0 auto; margin-top: 1em; background-color: White;}
+.smallWidth{ width: 4em; }
+.largelWidth{ width: 22em; }
+.inputTable { margin: 1em auto; }
+select, input, button { font: 11px Tahoma,Verdana,sans-serif; }
+.buttons { width: 70px; text-align: center; }
+.clearboth{ clear: both; }
+#messages { position: relative; left: 175px; top: 115px; background-color: white; width:200px;  float: left; margin-top: -52px; border: 1px solid #ccc; text-align: center; padding: 15px; }
+#message  { font-size: 15px; font-weight: bold; color: #69c; }
+iframe { border:1px inset; border-right:none; border-left:none; border-bottom:none; }
+
+table { margin-top:10px; }
+th, td { padding-right:3px; text-align:left; font-family:small-caption,helvetica,sans-serif; }
+
+.buttonColor {
+  width :1em;
+  margin-left: 2px;
+  cursor: default;
+}
+
+.buttonColor .chooser, .buttonColor .nocolor {
+  height: 0.6em;
+  border: 1px solid;
+  padding: 0px 1em;
+  border-color: ButtonHighlight ButtonShadow ButtonShadow ButtonHighlight;
+}
+
+.buttonColor .buttonClick {
+  border-color: ButtonShadow ButtonHighlight ButtonHighlight ButtonShadow;
+}
+.buttonColor .buttonColor-hilite {
+  border-color: ButtonShadow ButtonHighlight ButtonHighlight ButtonShadow;
+}
+
+.buttonColor .nocolor { padding: 0px; }
+.buttonColor .nocolor-hilite { background-color: #fff; color: #f00; }
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/assets/manager.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/assets/manager.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,233 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/ImageManager/assets/manager.js */
+function i18n(_1){
+return Xinha._lc(_1,"ImageManager");
+}
+function setAlign(_2){
+var _3=document.getElementById("f_align");
+for(var i=0;i<_3.length;i++){
+if(_3.options[i].value==_2){
+_3.selectedIndex=i;
+break;
+}
+}
+}
+doneinit=0;
+init=function(){
+if(doneinit++){
+return;
+}
+__dlg_init(null,{width:600,height:460});
+__dlg_translate("ImageManager");
+document.getElementById("f_align").selectedIndex=1;
+document.getElementById("f_align").selectedIndex=0;
+var _5=document.getElementById("uploadForm");
+if(_5){
+_5.target="imgManager";
+}
+var _6=window.dialogArguments;
+if(_6){
+var _7=new RegExp("(https?://[^/]*)?"+base_url.replace(/\/$/,""));
+_6.f_url=_6.f_url.replace(_7,"");
+var rd=(_resized_dir)?_resized_dir.replace(Xinha.RE_Specials,"\\$1")+"/":"";
+var rp=_resized_prefix.replace(Xinha.RE_Specials,"\\$1");
+var _a=new RegExp("^(.*/)"+rd+rp+"_([0-9]+)x([0-9]+)_([^/]+)$");
+if(_a.test(_6.f_url)){
+_6.f_url=RegExp.$1+RegExp.$4;
+_6.f_width=RegExp.$2;
+_6.f_height=RegExp.$3;
+}
+for(var id in _6){
+if(id=="f_align"){
+continue;
+}
+if(document.getElementById(id)){
+document.getElementById(id).value=_6[id];
+}
+}
+document.getElementById("orginal_width").value=_6["f_width"];
+document.getElementById("orginal_height").value=_6["f_height"];
+setAlign(_6["f_align"]);
+var _a=new RegExp("^(.*/)([^/]+)$");
+if(_a.test(_6["f_url"])&&!(new RegExp("^https?://","i")).test(_6["f_url"])){
+changeDir(RegExp.$1);
+var _c=document.getElementById("dirPath");
+for(var i=0;i<_c.options.length;i++){
+if(_c.options[i].value==encodeURIComponent(RegExp.$1)){
+_c.options[i].selected=true;
+break;
+}
+}
+}
+document.getElementById("f_preview").src=_backend_url+"__function=thumbs&img="+_6.f_url;
+}
+new Xinha.colorPicker.InputBinding(document.getElementById("f_backgroundColor"));
+new Xinha.colorPicker.InputBinding(document.getElementById("f_borderColor"));
+document.getElementById("f_alt").focus();
+};
+function onCancel(){
+__dlg_close(null);
+return false;
+}
+function onOK(){
+var _e=["f_url","f_alt","f_align","f_width","f_height","f_padding","f_margin","f_border","f_borderColor","f_backgroundColor"];
+var _f=new Object();
+for(var i in _e){
+var id=_e[i];
+var el=document.getElementById(id);
+if(id=="f_url"&&el.value.indexOf("://")<0){
+if(el.value==""){
+alert(i18n("No Image selected."));
+return (false);
+}
+_f[id]=makeURL(base_url,el.value);
+}else{
+if(el){
+_f[id]=el.value;
+}else{
+alert("Missing "+_e[i]);
+}
+}
+}
+var _13={w:document.getElementById("orginal_width").value,h:document.getElementById("orginal_height").value};
+if((_13.w!=_f.f_width)||(_13.h!=_f.f_height)){
+var _14=Xinha._geturlcontent(_backend_url+"&__function=resizer&img="+encodeURIComponent(document.getElementById("f_url").value)+"&width="+_f.f_width+"&height="+_f.f_height);
+_14=eval(_14);
+if(_14){
+_f.f_url=makeURL(base_url,_14);
+}
+}
+__dlg_close(_f);
+return false;
+}
+function makeURL(_15,_16){
+if(_15.substring(_15.length-1)!="/"){
+_15+="/";
+}
+if(_16.charAt(0)=="/"){
+}
+_16=_16.substring(1);
+return _15+_16;
+}
+function updateDir(_17){
+var _18=_17.options[_17.selectedIndex].value;
+changeDir(_18);
+}
+function goUpDir(){
+var _19=document.getElementById("dirPath");
+var _1a=_19.options[_19.selectedIndex].text;
+if(_1a.length<2){
+return false;
+}
+var _1b=_1a.split("/");
+var _1c="";
+for(var i=0;i<_1b.length-2;i++){
+_1c+=_1b[i]+"/";
+}
+for(var i=0;i<_19.length;i++){
+var _1e=_19.options[i].text;
+if(_1e==_1c){
+_19.selectedIndex=i;
+var _1f=_19.options[i].value;
+changeDir(_1f);
+break;
+}
+}
+}
+function changeDir(_20){
+if(typeof imgManager!="undefined"){
+imgManager.changeDir(_20);
+}
+}
+function toggleConstrains(_21){
+var _22=document.getElementById("imgLock");
+var _21=document.getElementById("constrain_prop");
+if(_21.checked){
+_22.src="img/locked.gif";
+checkConstrains("width");
+}else{
+_22.src="img/unlocked.gif";
+}
+}
+function checkConstrains(_23){
+var _24=document.getElementById("constrain_prop");
+if(_24.checked){
+var obj=document.getElementById("orginal_width");
+var _26=parseInt(obj.value);
+var obj=document.getElementById("orginal_height");
+var _27=parseInt(obj.value);
+var _28=document.getElementById("f_width");
+var _29=document.getElementById("f_height");
+var _2a=parseInt(_28.value);
+var _2b=parseInt(_29.value);
+if(_26>0&&_27>0){
+if(_23=="width"&&_2a>0){
+_29.value=parseInt((_2a/_26)*_27);
+}
+if(_23=="height"&&_2b>0){
+_28.value=parseInt((_2b/_27)*_26);
+}
+}
+}
+}
+function showMessage(_2c){
+var _2d=document.getElementById("message");
+var _2e=document.getElementById("messages");
+if(_2d.firstChild){
+_2d.removeChild(_2d.firstChild);
+}
+_2d.appendChild(document.createTextNode(i18n(_2c)));
+_2e.style.display="";
+}
+function addEvent(obj,_30,fn){
+if(obj.addEventListener){
+obj.addEventListener(_30,fn,true);
+return true;
+}else{
+if(obj.attachEvent){
+var r=obj.attachEvent("on"+_30,fn);
+return r;
+}else{
+return false;
+}
+}
+}
+function doUpload(){
+var _33=document.getElementById("uploadForm");
+if(_33){
+showMessage("Uploading");
+}
+}
+function refresh(){
+var _34=document.getElementById("dirPath");
+updateDir(_34);
+}
+function newFolder(){
+function createFolder(_35){
+var _36=document.getElementById("dirPath");
+var dir=_36.options[_36.selectedIndex].value;
+if(_35==thumbdir){
+alert(i18n("Invalid folder name, please choose another folder name."));
+return false;
+}
+if(_35&&_35!=""&&typeof imgManager!="undefined"){
+imgManager.newFolder(dir,encodeURI(_35));
+}
+}
+if(Xinha.ie_version>6){
+Dialog("newFolder.html",function(_38){
+if(!_38){
+return false;
+}else{
+var _39=_38["f_foldername"];
+createFolder(_39);
+}
+},null);
+}else{
+var _3a=prompt(i18n("Please enter name for new folder..."),i18n("Untitled"));
+createFolder(_3a);
+}
+}
+addEvent(window,"load",init);
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/assets/popup.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/assets/popup.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,32 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/ImageManager/assets/popup.js */
+function __dlg_translate(_1){
+var _2=["span","option","td","th","button","div","label","a","img","legend"];
+for(var _3=0;_3<_2.length;++_3){
+var _4=document.getElementsByTagName(_2[_3]);
+for(var i=_4.length;--i>=0;){
+var _6=_4[i];
+if(_6.firstChild&&_6.firstChild.data){
+var _7=Xinha._lc(_6.firstChild.data,_1);
+if(_7){
+_6.firstChild.data=_7;
+}
+}
+if(_6.title){
+var _7=Xinha._lc(_6.title,_1);
+if(_7){
+_6.title=_7;
+}
+}
+if(_6.alt){
+var _7=Xinha._lc(_6.alt,_1);
+if(_7){
+_6.alt=_7;
+}
+}
+}
+}
+document.title=Xinha._lc(document.title,_1);
+}
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/assets/slider.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/assets/slider.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,87 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/ImageManager/assets/slider.js */
+var ie=document.all;
+var ns6=document.getElementById&&!document.all;
+document.onmouseup=captureStop;
+var currentSlider=null,sliderField=null;
+var rangeMin=null,rangeMax=null,sx=-1,sy=-1,initX=0;
+function getMouseXY(e){
+x=ns6?e.clientX:event.clientX;
+y=ns6?e.clientY:event.clientY;
+if(sx<0){
+sx=x;
+}
+if(sy<0){
+sy=y;
+}
+var dx=initX+(x-sx);
+if(dx<=rangeMin){
+dx=rangeMin;
+}else{
+if(dx>=rangeMax){
+dx=rangeMax;
+}
+}
+var _3=(dx-rangeMin)/(rangeMax-rangeMin)*100;
+if(currentSlider!=null){
+currentSlider.style.left=dx+"px";
+}
+if(sliderField!=null){
+sliderField.value=parseInt(_3);
+}
+return false;
+}
+function initSlider(){
+if(currentSlider==null){
+currentSlider=document.getElementById("sliderbar");
+}
+if(sliderField==null){
+sliderField=document.getElementById("quality");
+}
+if(rangeMin==null){
+rangeMin=3;
+}
+if(rangeMax==null){
+var _4=document.getElementById("slidertrack");
+rangeMax=parseInt(_4.style.width);
+}
+}
+function updateSlider(_5){
+initSlider();
+var _6=parseInt(_5)/100*(rangeMax-rangeMin);
+if(_6<=rangeMin){
+_6=rangeMin;
+}else{
+if(_6>=rangeMax){
+_6=rangeMax;
+}
+}
+if(currentSlider!=null){
+currentSlider.style.left=_6+"px";
+}
+var _7=_6/(rangeMax-rangeMin)*100;
+if(sliderField!=null){
+sliderField.value=parseInt(_7);
+}
+}
+function captureStart(){
+initSlider();
+initX=parseInt(currentSlider.style.left);
+if(initX>rangeMax){
+initX=rangeMax;
+}else{
+if(initX<rangeMin){
+initX=rangeMin;
+}
+}
+document.onmousemove=getMouseXY;
+return false;
+}
+function captureStop(){
+sx=-1;
+sy=-1;
+document.onmousemove=null;
+return false;
+}
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/assets/wz_jsgraphics.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/ImageManager/assets/wz_jsgraphics.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,505 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/ImageManager/assets/wz_jsgraphics.js */
+var jg_ihtm,jg_ie,jg_dom,jg_n4=(document.layers&&typeof document.classes!="undefined");
+function chkDHTM(x,i){
+x=document.body||null;
+jg_ie=(x&&typeof x.insertAdjacentHTML!="undefined");
+jg_dom=(x&&!jg_ie&&typeof x.appendChild!="undefined"&&typeof document.createRange!="undefined"&&typeof (i=document.createRange()).setStartBefore!="undefined"&&typeof i.createContextualFragment!="undefined");
+jg_ihtm=(!jg_ie&&!jg_dom&&x&&typeof x.innerHTML!="undefined");
+}
+function pntDoc(){
+this.wnd.document.write(this.htm);
+this.htm="";
+}
+function pntCnvDom(){
+var x=document.createRange();
+x.setStartBefore(this.cnv);
+x=x.createContextualFragment(this.htm);
+this.cnv.appendChild(x);
+this.htm="";
+}
+function pntCnvIe(){
+this.cnv.insertAdjacentHTML("BeforeEnd",this.htm);
+this.htm="";
+}
+function pntCnvIhtm(){
+this.cnv.innerHTML+=this.htm;
+this.htm="";
+}
+function pntCnv(){
+this.htm="";
+}
+function mkDiv(x,y,w,h){
+this.htm+="<div style=\"position:absolute;"+"left:"+x+"px;"+"top:"+y+"px;"+"width:"+w+"px;"+"height:"+h+"px;"+"clip:rect(0,"+w+"px,"+h+"px,0);"+"overflow:hidden;background-color:"+this.color+";"+"\"></div>";
+}
+function mkDivPrint(x,y,w,h){
+this.htm+="<div style=\"position:absolute;"+"border-left:"+w+"px solid "+this.color+";"+"left:"+x+"px;"+"top:"+y+"px;"+"width:"+w+"px;"+"height:"+h+"px;"+"clip:rect(0,"+w+"px,"+h+"px,0);"+"overflow:hidden;background-color:"+this.color+";"+"\"></div>";
+}
+function mkLyr(x,y,w,h){
+this.htm+="<layer "+"left=\""+x+"\" "+"top=\""+y+"\" "+"width=\""+w+"\" "+"height=\""+h+"\" "+"bgcolor=\""+this.color+"\"></layer>\n";
+}
+function mkLbl(txt,x,y){
+this.htm+="<div style=\"position:absolute;white-space:nowrap;"+"left:"+x+"px;"+"top:"+y+"px;"+"font-family:"+this.ftFam+";"+"font-size:"+this.ftSz+";"+"color:"+this.color+";"+this.ftSty+"\">"+txt+"</div>";
+}
+function mkLin(x1,y1,x2,y2){
+if(x1>x2){
+var _x2=x2;
+var _y2=y2;
+x2=x1;
+y2=y1;
+x1=_x2;
+y1=_y2;
+}
+var dx=x2-x1,dy=Math.abs(y2-y1),x=x1,y=y1,yIncr=(y1>y2)?-1:1;
+if(dx>=dy){
+var pr=dy<<1,pru=pr-(dx<<1),p=pr-dx,ox=x;
+while((dx--)>0){
+++x;
+if(p>0){
+this.mkDiv(ox,y,x-ox,1);
+y+=yIncr;
+p+=pru;
+ox=x;
+}else{
+p+=pr;
+}
+}
+this.mkDiv(ox,y,x2-ox+1,1);
+}else{
+var pr=dx<<1,pru=pr-(dy<<1),p=pr-dy,oy=y;
+if(y2<=y1){
+while((dy--)>0){
+if(p>0){
+this.mkDiv(x++,y,1,oy-y+1);
+y+=yIncr;
+p+=pru;
+oy=y;
+}else{
+y+=yIncr;
+p+=pr;
+}
+}
+this.mkDiv(x2,y2,1,oy-y2+1);
+}else{
+while((dy--)>0){
+y+=yIncr;
+if(p>0){
+this.mkDiv(x++,oy,1,y-oy);
+p+=pru;
+oy=y;
+}else{
+p+=pr;
+}
+}
+this.mkDiv(x2,oy,1,y2-oy+1);
+}
+}
+}
+function mkLin2D(x1,y1,x2,y2){
+if(x1>x2){
+var _x2=x2;
+var _y2=y2;
+x2=x1;
+y2=y1;
+x1=_x2;
+y1=_y2;
+}
+var dx=x2-x1,dy=Math.abs(y2-y1),x=x1,y=y1,yIncr=(y1>y2)?-1:1;
+var s=this.stroke;
+if(dx>=dy){
+if(s-3>0){
+var _s=(s*dx*Math.sqrt(1+dy*dy/(dx*dx))-dx-(s>>1)*dy)/dx;
+_s=(!(s-4)?Math.ceil(_s):Math.round(_s))+1;
+}else{
+var _s=s;
+}
+var ad=Math.ceil(s/2);
+var pr=dy<<1,pru=pr-(dx<<1),p=pr-dx,ox=x;
+while((dx--)>0){
+++x;
+if(p>0){
+this.mkDiv(ox,y,x-ox+ad,_s);
+y+=yIncr;
+p+=pru;
+ox=x;
+}else{
+p+=pr;
+}
+}
+this.mkDiv(ox,y,x2-ox+ad+1,_s);
+}else{
+if(s-3>0){
+var _s=(s*dy*Math.sqrt(1+dx*dx/(dy*dy))-(s>>1)*dx-dy)/dy;
+_s=(!(s-4)?Math.ceil(_s):Math.round(_s))+1;
+}else{
+var _s=s;
+}
+var ad=Math.round(s/2);
+var pr=dx<<1,pru=pr-(dy<<1),p=pr-dy,oy=y;
+if(y2<=y1){
+++ad;
+while((dy--)>0){
+if(p>0){
+this.mkDiv(x++,y,_s,oy-y+ad);
+y+=yIncr;
+p+=pru;
+oy=y;
+}else{
+y+=yIncr;
+p+=pr;
+}
+}
+this.mkDiv(x2,y2,_s,oy-y2+ad);
+}else{
+while((dy--)>0){
+y+=yIncr;
+if(p>0){
+this.mkDiv(x++,oy,_s,y-oy+ad);
+p+=pru;
+oy=y;
+}else{
+p+=pr;
+}
+}
+this.mkDiv(x2,oy,_s,y2-oy+ad+1);
+}
+}
+}
+function mkLinDott(x1,y1,x2,y2){
+if(x1>x2){
+var _x2=x2;
+var _y2=y2;
+x2=x1;
+y2=y1;
+x1=_x2;
+y1=_y2;
+}
+var dx=x2-x1,dy=Math.abs(y2-y1),x=x1,y=y1,yIncr=(y1>y2)?-1:1,drw=true;
+if(dx>=dy){
+var pr=dy<<1,pru=pr-(dx<<1),p=pr-dx;
+while((dx--)>0){
+if(drw){
+this.mkDiv(x,y,1,1);
+}
+drw=!drw;
+if(p>0){
+y+=yIncr;
+p+=pru;
+}else{
+p+=pr;
+}
+++x;
+}
+if(drw){
+this.mkDiv(x,y,1,1);
+}
+}else{
+var pr=dx<<1,pru=pr-(dy<<1),p=pr-dy;
+while((dy--)>0){
+if(drw){
+this.mkDiv(x,y,1,1);
+}
+drw=!drw;
+y+=yIncr;
+if(p>0){
+++x;
+p+=pru;
+}else{
+p+=pr;
+}
+}
+if(drw){
+this.mkDiv(x,y,1,1);
+}
+}
+}
+function mkOv(_2e,top,_30,_31){
+var a=_30>>1,b=_31>>1,wod=_30&1,hod=(_31&1)+1,cx=_2e+a,cy=top+b,x=0,y=b,ox=0,oy=b,aa=(a*a)<<1,bb=(b*b)<<1,st=(aa>>1)*(1-(b<<1))+bb,tt=(bb>>1)-aa*((b<<1)-1),w,h;
+while(y>0){
+if(st<0){
+st+=bb*((x<<1)+3);
+tt+=(bb<<1)*(++x);
+}else{
+if(tt<0){
+st+=bb*((x<<1)+3)-(aa<<1)*(y-1);
+tt+=(bb<<1)*(++x)-aa*(((y--)<<1)-3);
+w=x-ox;
+h=oy-y;
+if(w&2&&h&2){
+this.mkOvQds(cx,cy,-x+2,ox+wod,-oy,oy-1+hod,1,1);
+this.mkOvQds(cx,cy,-x+1,x-1+wod,-y-1,y+hod,1,1);
+}else{
+this.mkOvQds(cx,cy,-x+1,ox+wod,-oy,oy-h+hod,w,h);
+}
+ox=x;
+oy=y;
+}else{
+tt-=aa*((y<<1)-3);
+st-=(aa<<1)*(--y);
+}
+}
+}
+this.mkDiv(cx-a,cy-oy,a-ox+1,(oy<<1)+hod);
+this.mkDiv(cx+ox+wod,cy-oy,a-ox+1,(oy<<1)+hod);
+}
+function mkOv2D(_33,top,_35,_36){
+var s=this.stroke;
+_35+=s-1;
+_36+=s-1;
+var a=_35>>1,b=_36>>1,wod=_35&1,hod=(_36&1)+1,cx=_33+a,cy=top+b,x=0,y=b,aa=(a*a)<<1,bb=(b*b)<<1,st=(aa>>1)*(1-(b<<1))+bb,tt=(bb>>1)-aa*((b<<1)-1);
+if(s-4<0&&(!(s-2)||_35-51>0&&_36-51>0)){
+var ox=0,oy=b,w,h,pxl,pxr,pxt,pxb,pxw;
+while(y>0){
+if(st<0){
+st+=bb*((x<<1)+3);
+tt+=(bb<<1)*(++x);
+}else{
+if(tt<0){
+st+=bb*((x<<1)+3)-(aa<<1)*(y-1);
+tt+=(bb<<1)*(++x)-aa*(((y--)<<1)-3);
+w=x-ox;
+h=oy-y;
+if(w-1){
+pxw=w+1+(s&1);
+h=s;
+}else{
+if(h-1){
+pxw=s;
+h+=1+(s&1);
+}else{
+pxw=h=s;
+}
+}
+this.mkOvQds(cx,cy,-x+1,ox-pxw+w+wod,-oy,-h+oy+hod,pxw,h);
+ox=x;
+oy=y;
+}else{
+tt-=aa*((y<<1)-3);
+st-=(aa<<1)*(--y);
+}
+}
+}
+this.mkDiv(cx-a,cy-oy,s,(oy<<1)+hod);
+this.mkDiv(cx+a+wod-s+1,cy-oy,s,(oy<<1)+hod);
+}else{
+var _a=(_35-((s-1)<<1))>>1,_b=(_36-((s-1)<<1))>>1,_x=0,_y=_b,_aa=(_a*_a)<<1,_bb=(_b*_b)<<1,_st=(_aa>>1)*(1-(_b<<1))+_bb,_tt=(_bb>>1)-_aa*((_b<<1)-1),pxl=new Array(),pxt=new Array(),_pxb=new Array();
+pxl[0]=0;
+pxt[0]=b;
+_pxb[0]=_b-1;
+while(y>0){
+if(st<0){
+st+=bb*((x<<1)+3);
+tt+=(bb<<1)*(++x);
+pxl[pxl.length]=x;
+pxt[pxt.length]=y;
+}else{
+if(tt<0){
+st+=bb*((x<<1)+3)-(aa<<1)*(y-1);
+tt+=(bb<<1)*(++x)-aa*(((y--)<<1)-3);
+pxl[pxl.length]=x;
+pxt[pxt.length]=y;
+}else{
+tt-=aa*((y<<1)-3);
+st-=(aa<<1)*(--y);
+}
+}
+if(_y>0){
+if(_st<0){
+_st+=_bb*((_x<<1)+3);
+_tt+=(_bb<<1)*(++_x);
+_pxb[_pxb.length]=_y-1;
+}else{
+if(_tt<0){
+_st+=_bb*((_x<<1)+3)-(_aa<<1)*(_y-1);
+_tt+=(_bb<<1)*(++_x)-_aa*(((_y--)<<1)-3);
+_pxb[_pxb.length]=_y-1;
+}else{
+_tt-=_aa*((_y<<1)-3);
+_st-=(_aa<<1)*(--_y);
+_pxb[_pxb.length-1]--;
+}
+}
+}
+}
+var ox=0,oy=b,_oy=_pxb[0],l=pxl.length,w,h;
+for(var i=0;i<l;i++){
+if(typeof _pxb[i]!="undefined"){
+if(_pxb[i]<_oy||pxt[i]<oy){
+x=pxl[i];
+this.mkOvQds(cx,cy,-x+1,ox+wod,-oy,_oy+hod,x-ox,oy-_oy);
+ox=x;
+oy=pxt[i];
+_oy=_pxb[i];
+}
+}else{
+x=pxl[i];
+this.mkDiv(cx-x+1,cy-oy,1,(oy<<1)+hod);
+this.mkDiv(cx+ox+wod,cy-oy,1,(oy<<1)+hod);
+ox=x;
+oy=pxt[i];
+}
+}
+this.mkDiv(cx-a,cy-oy,1,(oy<<1)+hod);
+this.mkDiv(cx+ox+wod,cy-oy,1,(oy<<1)+hod);
+}
+}
+function mkOvDott(_3c,top,_3e,_3f){
+var a=_3e>>1,b=_3f>>1,wod=_3e&1,hod=_3f&1,cx=_3c+a,cy=top+b,x=0,y=b,aa2=(a*a)<<1,aa4=aa2<<1,bb=(b*b)<<1,st=(aa2>>1)*(1-(b<<1))+bb,tt=(bb>>1)-aa2*((b<<1)-1),drw=true;
+while(y>0){
+if(st<0){
+st+=bb*((x<<1)+3);
+tt+=(bb<<1)*(++x);
+}else{
+if(tt<0){
+st+=bb*((x<<1)+3)-aa4*(y-1);
+tt+=(bb<<1)*(++x)-aa2*(((y--)<<1)-3);
+}else{
+tt-=aa2*((y<<1)-3);
+st-=aa4*(--y);
+}
+}
+if(drw){
+this.mkOvQds(cx,cy,-x,x+wod,-y,y+hod,1,1);
+}
+drw=!drw;
+}
+}
+function mkRect(x,y,w,h){
+var s=this.stroke;
+this.mkDiv(x,y,w,s);
+this.mkDiv(x+w,y,s,h);
+this.mkDiv(x,y+h,w+s,s);
+this.mkDiv(x,y+s,s,h-s);
+}
+function mkRectDott(x,y,w,h){
+this.drawLine(x,y,x+w,y);
+this.drawLine(x+w,y,x+w,y+h);
+this.drawLine(x,y+h,x+w,y+h);
+this.drawLine(x,y,x,y+h);
+}
+function jsgFont(){
+this.PLAIN="font-weight:normal;";
+this.BOLD="font-weight:bold;";
+this.ITALIC="font-style:italic;";
+this.ITALIC_BOLD=this.ITALIC+this.BOLD;
+this.BOLD_ITALIC=this.ITALIC_BOLD;
+}
+var Font=new jsgFont();
+function jsgStroke(){
+this.DOTTED=-1;
+}
+var Stroke=new jsgStroke();
+function jsGraphics(id,wnd){
+this.setColor=new Function("arg","this.color = arg;");
+this.getColor=new Function("return this.color");
+this.setStroke=function(x){
+this.stroke=x;
+if(!(x+1)){
+this.drawLine=mkLinDott;
+this.mkOv=mkOvDott;
+this.drawRect=mkRectDott;
+}else{
+if(x-1>0){
+this.drawLine=mkLin2D;
+this.mkOv=mkOv2D;
+this.drawRect=mkRect;
+}else{
+this.drawLine=mkLin;
+this.mkOv=mkOv;
+this.drawRect=mkRect;
+}
+}
+};
+this.setPrintable=function(arg){
+this.printable=arg;
+this.mkDiv=jg_n4?mkLyr:arg?mkDivPrint:mkDiv;
+};
+this.setFont=function(fam,sz,sty){
+this.ftFam=fam;
+this.ftSz=sz;
+this.ftSty=sty||Font.PLAIN;
+};
+this.drawPolyline=this.drawPolyLine=function(x,y,s){
+var i=x.length-1;
+while(i>=0){
+this.drawLine(x[i],y[i],x[--i],y[i]);
+}
+};
+this.fillRect=function(x,y,w,h){
+this.mkDiv(x,y,w,h);
+};
+this.fillRectPattern=function(x,y,w,h,url){
+this.htm+="<div style=\"position:absolute;"+"left:"+x+"px;"+"top:"+y+"px;"+"width:"+w+"px;"+"height:"+h+"px;"+"clip:rect(0,"+w+"px,"+h+"px,0);"+"overflow:hidden;"+"background-image: url('"+url+"');"+"layer-background-image: url('"+url+"');"+"z-index:100;\"></div>";
+};
+this.drawHandle=function(x,y,w,h,_62){
+this.htm+="<div style=\"position:absolute;"+"left:"+x+"px;"+"top:"+y+"px;"+"width:"+w+"px;"+"height:"+h+"px;"+"clip:rect(0,"+w+"px,"+h+"px,0);"+"padding: 2px;overflow:hidden;"+"cursor: '"+_62+"';"+"\" class=\"handleBox\" id=\""+_62+"\" ></div>";
+};
+this.drawHandleBox=function(x,y,w,h,_67){
+this.htm+="<div style=\"position:absolute;"+"left:"+x+"px;"+"top:"+y+"px;"+"width:"+w+"px;"+"height:"+h+"px;"+"clip:rect(0,"+(w+2)+"px,"+(h+2)+"px,0);"+"overflow:hidden; border: solid 1px "+this.color+";"+"cursor: '"+_67+"';"+"\" class=\"handleBox\" id=\""+_67+"\" ></div>";
+};
+this.drawPolygon=function(x,y){
+this.drawPolyline(x,y);
+this.drawLine(x[x.length-1],y[x.length-1],x[0],y[0]);
+};
+this.drawEllipse=this.drawOval=function(x,y,w,h){
+this.mkOv(x,y,w,h);
+};
+this.fillEllipse=this.fillOval=function(_6e,top,w,h){
+var a=(w-=1)>>1,b=(h-=1)>>1,wod=(w&1)+1,hod=(h&1)+1,cx=_6e+a,cy=top+b,x=0,y=b,ox=0,oy=b,aa2=(a*a)<<1,aa4=aa2<<1,bb=(b*b)<<1,st=(aa2>>1)*(1-(b<<1))+bb,tt=(bb>>1)-aa2*((b<<1)-1),pxl,dw,dh;
+if(w+1){
+while(y>0){
+if(st<0){
+st+=bb*((x<<1)+3);
+tt+=(bb<<1)*(++x);
+}else{
+if(tt<0){
+st+=bb*((x<<1)+3)-aa4*(y-1);
+pxl=cx-x;
+dw=(x<<1)+wod;
+tt+=(bb<<1)*(++x)-aa2*(((y--)<<1)-3);
+dh=oy-y;
+this.mkDiv(pxl,cy-oy,dw,dh);
+this.mkDiv(pxl,cy+oy-dh+hod,dw,dh);
+ox=x;
+oy=y;
+}else{
+tt-=aa2*((y<<1)-3);
+st-=aa4*(--y);
+}
+}
+}
+}
+this.mkDiv(cx-a,cy-oy,w+1,(oy<<1)+hod);
+};
+this.drawString=mkLbl;
+this.clear=function(){
+this.htm="";
+if(this.cnv){
+this.cnv.innerHTML=this.defhtm;
+}
+};
+this.mkOvQds=function(cx,cy,xl,xr,yt,yb,w,h){
+this.mkDiv(xr+cx,yt+cy,w,h);
+this.mkDiv(xr+cx,yb+cy,w,h);
+this.mkDiv(xl+cx,yb+cy,w,h);
+this.mkDiv(xl+cx,yt+cy,w,h);
+};
+this.setStroke(1);
+this.setPrintable(false);
+this.setFont("verdana,geneva,helvetica,sans-serif",String.fromCharCode(49,50,112,120),Font.PLAIN);
+this.color="#000000";
+this.htm="";
+this.wnd=wnd||window;
+if(!(jg_ie||jg_dom||jg_ihtm)){
+chkDHTM();
+}
+if(typeof id!="string"||!id){
+this.paint=pntDoc;
+}else{
+this.cnv=document.all?(this.wnd.document.all[id]||null):document.getElementById?(this.wnd.document.getElementById(id)||null):null;
+this.defhtm=(this.cnv&&this.cnv.innerHTML)?this.cnv.innerHTML:"";
+this.paint=jg_dom?pntCnvDom:jg_ie?pntCnvIe:jg_ihtm?pntCnvIhtm:pntCnv;
+}
+}
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/demo_images/bikerpeep.jpg
Binary file Xinha_0.95/plugins/ImageManager/demo_images/bikerpeep.jpg has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/demo_images/linux/linux.gif
Binary file Xinha_0.95/plugins/ImageManager/demo_images/linux/linux.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/demo_images/wesnoth078.jpg
Binary file Xinha_0.95/plugins/ImageManager/demo_images/wesnoth078.jpg has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/img/2x2.gif
Binary file Xinha_0.95/plugins/ImageManager/img/2x2.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/img/2x2_w.gif
Binary file Xinha_0.95/plugins/ImageManager/img/2x2_w.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/img/btnFolderNew.gif
Binary file Xinha_0.95/plugins/ImageManager/img/btnFolderNew.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/img/btnFolderUp.gif
Binary file Xinha_0.95/plugins/ImageManager/img/btnFolderUp.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/img/btn_cancel.gif
Binary file Xinha_0.95/plugins/ImageManager/img/btn_cancel.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/img/btn_ok.gif
Binary file Xinha_0.95/plugins/ImageManager/img/btn_ok.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/img/crop.gif
Binary file Xinha_0.95/plugins/ImageManager/img/crop.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/img/default.gif
Binary file Xinha_0.95/plugins/ImageManager/img/default.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/img/div.gif
Binary file Xinha_0.95/plugins/ImageManager/img/div.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/img/dots.gif
Binary file Xinha_0.95/plugins/ImageManager/img/dots.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/img/edit_active.gif
Binary file Xinha_0.95/plugins/ImageManager/img/edit_active.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/ImageManager/img/edit_pencil.gif
Binary file Xinha_0.95/plugins/ImageManager/img/edit_pencil.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/aspell_setup.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/SpellChecker/aspell_setup.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,123 @@
+<?php
+// REVISION HISTORY:
+//
+// 2005-08-17 YmL:
+//	.	security fix on unchecked variables. Original author missed quite a few
+//		holes.
+
+  umask(000);
+  $temptext = tempnam('/tmp', 'spell_');
+  if ((!isset($_POST['dictionary'])) || (strlen(trim($_POST['dictionary'])) < 1))
+  {
+      $lang = 'en_GB';
+  }
+  else
+  {
+      $lang = $_POST['dictionary'];
+  }  
+  $lang = preg_replace('/[^a-z0-9_]/i', '', $lang);
+  
+  $aspell      = 'aspell';
+  $aspell_args = '-a --lang=' . $lang;
+
+  if(DIRECTORY_SEPARATOR == '\\') //windows
+  {
+    $aspell         = 'C:\Progra~1\Aspell\bin\aspell.exe';
+  }
+  else //linux
+  {
+    // See if there is a local install of aspell here
+    if(file_exists(dirname(__FILE__) . '/aspell/bin/aspell'))
+    {
+      putenv('PATH=' . dirname(__FILE__) . '/aspell/bin:' . getenv('PATH'));
+      putenv('LD_LIBRARY_PATH=' . dirname(__FILE__) . '/aspell/lib:' . getenv('LD_LIBRARY_PATH'));
+      $dicfil = dirname(__FILE__) .'/aspell/lib/' . preg_replace('/^.*\/lib\/(aspell\S*)\n.*/s', '$1', `aspell config dict-dir`);
+      $aspell_args .= ' --dict-dir=' . $dicfil . ' --add-filter-path=' . $dicfil ;
+    }
+  }
+
+
+  // Old aspell doesn't know about encoding, which means that unicode will be broke, but
+  // we should at least let it try.
+  preg_match('/really aspell ([0-9]+)\.([0-9]+)(?:\.([0-9]+))?/i', `$aspell version`, $aVer);
+
+  $aVer = array('major' => (int)$aVer[1], 'minor' => (int)$aVer[2], 'release' => (int)@$aVer[3]);
+  if($aVer['major'] >= 0 && $aVer['minor'] >= 60)
+  {
+    $aspell_args   .= ' -H --encoding=utf-8';
+  }
+  elseif(preg_match('/--encoding/', shell_exec('aspell 2>&1')))
+  {
+    $aspell_args   .= ' --mode=none --add-filter=sgml --encoding=utf-8';
+  }
+  else
+  {
+    $aspell_args   .= ' --mode=none --add-filter=sgml';
+  }
+
+  // Personal dictionaries
+  $p_dicts_path = dirname(__FILE__) . DIRECTORY_SEPARATOR . 'personal_dicts';
+
+  if(isset($_REQUEST['p_dicts_path']) && file_exists($_REQUEST['p_dicts_path']) && is_writable($_REQUEST['p_dicts_path']))
+  {
+    if(!isset($_REQUEST['p_dicts_name']))
+    {
+      if(isset($_COOKIE['SpellChecker_p_dicts_name']))
+      {
+        $_REQUEST['p_dicts_name'] = $_COOKIE['SpellChecker_p_dicts_name'];
+      }
+      else
+      {
+        $_REQUEST['p_dicts_name'] = uniqid('dict');
+        setcookie('SpellChecker_p_dicts_name', $_REQUEST['p_dicts_name'], time() + 60*60*24*365*10);
+      }
+    }    
+    $p_dict_path = $_REQUEST['p_dicts_path'] . DIRECTORY_SEPARATOR . preg_replace('/[^a-z0-9_]/i', '', $_REQUEST['p_dicts_name']);
+
+    if(!file_exists($p_dict_path))
+    {
+	 	// since there is a single directory for all users this could end up containing
+		// quite a few subdirectories. To prevent a DOS situation we'll limit the 
+		// total directories created to 2000 (arbitrary). Adjust to suit your installation.
+
+		$count = 0;
+
+		if( $dir = @opendir( $p_dicts_path ) )
+			{
+
+			while( FALSE !== ($file = readdir($dir)) )
+				{
+				$count++;
+				}
+			}
+
+		// TODO: make this a config value.
+
+		if ( $count > 2000 )
+			{
+
+			// either very heavy use or a DOS attempt
+
+			die();
+
+			}
+
+      mkdir($p_dict_path);
+      chmod($p_dict_path, 02770);
+    }
+
+    if(file_exists($p_dict_path) && is_writable($p_dict_path))
+    {
+      // Good To Go!
+      $aspell_args .= ' --home-dir=' . $p_dict_path ;
+    }
+  }
+
+// as an additional precaution check the aspell_args for illegal 
+// characters
+  $aspell_args = preg_replace( "/[|><;\$]+/", '', $aspell_args );
+  $aspelldictionaries = "$aspell dump dicts";
+  $aspellcommand      = "$aspell $aspell_args < $temptext";
+
+
+?>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/img/he-spell-check.gif
Binary file Xinha_0.95/plugins/SpellChecker/img/he-spell-check.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/img/spell-check.gif
Binary file Xinha_0.95/plugins/SpellChecker/img/spell-check.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/lang/cz.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/SpellChecker/lang/cz.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,26 @@
+// I18N constants
+// LANG: "cz", ENCODING: UTF-8
+// Author: Jiri Lw, <jirilow@jirilow.com>
+{
+  "Please confirm that you want to open this link": "Prosm potvrte oteven tohoto odkazu",
+  "Cancel": "Zruit",
+  "Dictionary": "Slovnk",
+  "Finished list of mispelled words": "Dokonen seznam chybnch slov",
+  "I will open it in a new page.": "Bude oteven jej v nov strnce.",
+  "Ignore all": "Ignorovat ve",
+  "Ignore": "Ignorovat",
+  "No mispelled words found with the selected dictionary.": "Podle zvolenho slovnku nebyla nalezena dn chybn slova.",
+  "Spell check complete, didn't find any mispelled words.  Closing now...": "Kontrola sprvnosti slov dokonena, nebyla nalezena dn chybn slova. Ukonovn ...",
+  "OK": "OK",
+  "Original word": "Pvodn slovo",
+  "Please wait.  Calling spell checker.": "Prosm ekejte. Komunikuace s kontrolou sprvnosti slov.",
+  "Please wait: changing dictionary to": "Prosm ekejte: zmna adrese na",
+  "This will drop changes and quit spell checker.  Please confirm.": "Zmny budou zrueny a kontrola sprvnosti slov ukonena. Prosm potvrte.",
+  "Re-check": "Pekontrolovat",
+  "Replace all": "Zamnit vechno",
+  "Replace with": "Zamnit za",
+  "Replace": "Zamnit",
+  "Spell-check": "Kontrola sprvnosti slov",
+  "Suggestions": "Doporuen",
+  "One moment...": "strpen prosm ;-)"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/lang/da.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/SpellChecker/lang/da.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,26 @@
+// I18N constants
+// LANG: "da", ENCODING: UTF-8
+// Author: Steen Snderup, <steen@soenderup.com>
+{
+  "Please confirm that you want to open this link": "Vil du flge dette link?",
+  "Cancel": "Anuler",
+  "Dictionary": "Ordbog",
+  "Finished list of mispelled words": "Listen med stavefejl er gennemget",
+  "I will open it in a new page.": "Jeg vil bne det i en ny side.",
+  "Ignore all": "Ignorer alle",
+  "Ignore": "Ignorer",
+  "No mispelled words found with the selected dictionary.": "Der blev ikke fundet nogle stavefejl med den valgte ordbog.",
+  "Spell check complete, didn't find any mispelled words.  Closing now...": "Stavekontrollen er gennemfrt, der blev ikke fundet nogle stavefejl.  Lukker...",
+  "OK": "OK",
+  "Original word": "Oprindeligt ord",
+  "Please wait.  Calling spell checker.": "Vent venligst.  Henter stavekontrol.",
+  "Please wait: changing dictionary to": "Vent venligst: skifter ordbog til",
+  "This will drop changes and quit spell checker.  Please confirm.": "Alle dine ndringer vil g tabt, vil du fortstte?",
+  "Re-check": "Tjek igen",
+  "Replace all": "Erstat alle",
+  "Replace with": "Erstat med",
+  "Replace": "Erstat",
+  "Spell-check": "Stavekontrol",
+  "Suggestions": "Forslag",
+  "One moment...": "Vent venligst"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/lang/de.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/SpellChecker/lang/de.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,26 @@
+// I18N constants
+// LANG: "en", ENCODING: UTF-8
+// Author: Broxx, <broxx@broxx.com>
+{
+  "Please confirm that you want to open this link": "Wollen Sie diesen Link oeffnen",
+  "Cancel": "Abbrechen",
+  "Dictionary": "Woerterbuch",
+  "Finished list of mispelled words": "Liste der nicht bekannten Woerter",
+  "I will open it in a new page.": "Wird auf neuer Seite geoeffnet",
+  "Ignore all": "Alle ignorieren",
+  "Ignore": "Ignorieren",
+  "No mispelled words found with the selected dictionary.": "Keine falschen Woerter mit gewaehlten Woerterbuch gefunden",
+  "Spell check complete, didn't find any mispelled words.  Closing now...": "Rechtsschreibpruefung wurde ohne Fehler fertiggestellt.  Wird nun geschlossen...",
+  "OK": "OK",
+  "Original word": "Original Wort",
+  "Please wait.  Calling spell checker.": "Bitte warten.  Woerterbuch wird durchsucht.",
+  "Please wait: changing dictionary to": "Bitte warten: Woerterbuch wechseln zu",
+  "This will drop changes and quit spell checker.  Please confirm.": "Aenderungen werden nicht uebernommen.  Bitte bestaettigen.",
+  "Re-check": "Neuueberpruefung",
+  "Replace all": "Alle ersetzen",
+  "Replace with": "Ersetzen mit",
+  "Replace": "Ersetzen",
+  "Spell-check": "Ueberpruefung",
+  "Suggestions": "Vorschlag",
+  "One moment...": "Bitte warten..."
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/lang/fr.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/SpellChecker/lang/fr.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,26 @@
+// I18N constants
+// LANG: "fr", ENCODING: UTF-8
+{
+  "Please confirm that you want to open this link": "Veuillez confirmer l'ouverture de ce lien",
+  "Cancel": "Annuler",
+  "Dictionary": "Dictionnaire",
+  "Finished list of mispelled words": "Liste des mots mal orthographis",
+  "I will open it in a new page.": "Ouverture dans une nouvelle fentre",
+  "Ignore all": "Tout ignorer",
+  "Ignore": "Ignorer",
+  "No mispelled words found with the selected dictionary.": "Aucune erreur orthographique avec le dictionnaire slectionn.",
+  "Spell check complete, didn't find any mispelled words.  Closing now...": "Vrification termine, aucune erreur orthographique dtecte.  Fermeture en cours...",
+  "OK": "OK",
+  "Original word": "Mot original",
+  "Please wait.  Calling spell checker.": "Veuillez patienter.  Appel du correcteur.",
+  "Please wait: changing dictionary to": "Veuillez patienter. Changement du dictionnaire vers",
+  "This will drop changes and quit spell checker.  Please confirm.": "Ceci fermera la fentre et annulera les modifications. Veuillez confirmer.",
+  "Re-check": "Vrifier encore",
+  "Replace all": "Tout remplacer",
+  "Replace with": "Remplacer par",
+  "Replace": "Remplacer",
+  "Revert": "Annuler",
+  "Spell-check": "Correction",
+  "Suggestions": "Suggestions",
+  "One moment...": "Veuillez patienter"
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/lang/he.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/SpellChecker/lang/he.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,27 @@
+// I18N constants
+// LANG: "en", ENCODING: UTF-8
+// Author: Mihai Bazon, http://dynarch.com/mishoo
+{
+  "Please confirm that you want to open this link": "     ",
+  "Cancel": "",
+  "Dictionary": "",
+  "Finished list of mispelled words": "     ",
+  "I will open it in a new page.": "     .",
+  "Ignore all": " ",
+  "Ignore": "",
+  "No mispelled words found with the selected dictionary.": "        .",
+  "Spell check complete, didn't find any mispelled words.  Closing now...": "  ,      .   ...",
+  "OK": "",
+  "Original word": " ",
+  "Please wait.  Calling spell checker.": " .    .",
+  "Please wait: changing dictionary to": " :   -",
+  "This will drop changes and quit spell checker.  Please confirm.": "      .   .",
+  "Re-check": " ",
+  "Replace all": " ",
+  "Replace with": " -",
+  "Replace": "",
+  "Revert": " ",
+  "Spell-check": " ",
+  "Suggestions": "",
+  "One moment...": "  ;-)"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/lang/hu.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/SpellChecker/lang/hu.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,26 @@
+// I18N constants
+// LANG: "hu", ENCODING: UTF-8
+// Author: Mikls Somogyi, <somogyine@vnet.hu>
+{
+  "Please confirm that you want to open this link": "Megersts",
+  "Cancel": "Mgsem",
+  "Dictionary": "Sztr",
+  "Finished list of mispelled words": "A tvesztett szavak listjnak vge",
+  "I will open it in a new page.": "Megnyits j lapon",
+  "Ignore all": "Minden elvetse",
+  "Ignore": "Elvets",
+  "No mispelled words found with the selected dictionary.": "A vlasztott sztr szerint nincs tvesztett sz.",
+  "Spell check complete, didn't find any mispelled words.  Closing now...": "A helyesrsellenrzs ksz, tvesztett sz nem fordult el. Bezrs...",
+  "OK": "Rendben",
+  "Original word": "Eredeti sz",
+  "Please wait.  Calling spell checker.": "Kis trelmet, a helyesrsellenrz hvsa folyamatban.",
+  "Please wait: changing dictionary to": "Kis trelmet, sztr cserje",
+  "This will drop changes and quit spell checker.  Please confirm.": "Kilps a vltozsok eldobsval. Jvhagyja?",
+  "Re-check": "jraellenrzs",
+  "Replace all": "Mind cserje",
+  "Replace with": "Csere a kvetkezre:",
+  "Replace": "Csere",
+  "Spell-check": "Helyesrsellenrzs",
+  "Suggestions": "Tippek",
+  "One moment...": "Kis trelmet ;-)"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/lang/ja.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/SpellChecker/lang/ja.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,28 @@
+// I18N constants
+// LANG: "ja", ENCODING: UTF-8
+{
+  "Please confirm that you want to open this link": "",
+  "Cancel": "",
+  "Dictionary": "",
+  "Finished list of mispelled words": "",
+  "I will open it in a new page.": "",
+  "Ignore all": "",
+  "Ignore": "",
+  "No mispelled words found with the selected dictionary.": "",
+  "Spell check complete, didn't find any mispelled words.  Closing now...": "...",
+  "OK": "OK",
+  "Original word": "",
+  "Please wait.  Calling spell checker.": "",
+  "Please wait: changing dictionary to": ": ",
+  "This will drop changes and quit spell checker.  Please confirm.": "",
+  "Re-check": "",
+  "Replace all": "",
+  "Replace with": "",
+  "Replace": "",
+  "Revert": "",
+  "Spell-check": "",
+  "Suggestions": "",
+  "One moment...": "...",
+  "Info": "",
+  "Learn": ""
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/lang/nb.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/SpellChecker/lang/nb.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,26 @@
+// I18N constants
+// LANG: "nb", ENCODING: UTF-8
+// translated: Kim Steinhaug, http://www.steinhaug.com/, kim@steinhaug.com
+{
+  "Please confirm that you want to open this link": "nsker du  pne denne lenken",
+  "Cancel": "Avbryt",
+  "Dictionary": "Ordliste",
+  "Finished list of mispelled words": "Ferdig med liste over feilstavede ord",
+  "I will open it in a new page.": "pnes i ny side",
+  "Ignore all": "Ignorer alle",
+  "Ignore": "Ignorer",
+  "No mispelled words found with the selected dictionary.": "Ingen feilstavede ord funnet med den valgte ordlisten",
+  "Spell check complete, didn't find any mispelled words.  Closing now...": "Stavekontroll fullfrt, ingen feilstavede ord ble funnet, stavekontroll avsluttes.",
+  "OK": "OK",
+  "Original word": "Opprinnelig ord",
+  "Please wait.  Calling spell checker.": "Vennligst vent, kaller opp stavekontrollprogrammet",
+  "Please wait: changing dictionary to": "Vennligst vent, endrer ordliste til",
+  "This will drop changes and quit spell checker.  Please confirm.": "Dette vil droppe endringene og avbryte stavekontrollen, vennligst bekreft.",
+  "Re-check": "Kjr stavekontroll p nytt",
+  "Replace all": "Erstatt alle",
+  "Replace with": "Erstatt med",
+  "Replace": "Erstatt",
+  "Spell-check": "Stavekontroll",
+  "Suggestions": "Forslag",
+  "One moment...": "Et yeblikk..."
+};
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/lang/nl.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/SpellChecker/lang/nl.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,27 @@
+// I18N constants
+// LANG: "nl", ENCODING: UTF-8
+// Author: A.H van den Broek  http://www.kontaktfm.nl, tonbroek@kontaktfm.nl
+{
+  "Please confirm that you want to open this link": "Weet u zeker dat u deze link wilt openen?",
+  "Cancel": "Annuleer",
+  "Dictionary": "Woordenboek",
+  "Finished list of mispelled words": "klaar met de lijst van fouten woorden",
+  "I will open it in a new page.": "Ik zal het in een nieuwe pagina openen.",
+  "Ignore all": "alles overslaan",
+  "Ignore": "Overslaan",
+  "No mispelled words found with the selected dictionary.": "Geen fouten gevonden met dit woordenboek.",
+  "Spell check complete, didn't find any mispelled words.  Closing now...": "Spell checking is klaar, geen fouten gevonden.  spell checking word gesloten...",
+  "OK": "OK",
+  "Original word": "Originele woord",
+  "Please wait.  Calling spell checker.": "Even wachten. spell checker wordt geladen.",
+  "Please wait: changing dictionary to": "even wachten: woordenboek wordt veranderd naar",
+  "This will drop changes and quit spell checker.  Please confirm.": "Dit zal alle veranderingen annuleren en de spell checker sluiten.  Weet u het zeker?",
+  "Re-check": "Opnieuw",
+  "Replace all": "Alles vervangen",
+  "Replace with": "Vervangen met",
+  "Replace": "Vervangen",
+  "Revert": "Omkeren",
+  "Spell-check": "Spell-check",
+  "Suggestions": "Suggestie",
+  "One moment...": "Even wachten ;-)"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/lang/pt_br.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/SpellChecker/lang/pt_br.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,44 @@
+// I18N constants
+//
+// LANG: "pt_br", ENCODING: UTF-8
+// Portuguese Brazilian Translation
+//
+// Author: Marcio Barbosa, <marcio@mpg.com.br>
+// MSN: tomarshall@msn.com - ICQ: 69419933
+// Site: http://www.mpg.com.br
+//
+// Last revision: 06 september 2007
+// Please dont remove this information
+// If you modify any source, please insert a comment with your name and e-mail
+//
+// Distributed under the same terms as HTMLArea itself.
+// This notice MUST stay intact for use (see license.txt).
+
+{
+  "Cancel": "Cancelar",
+  "Dictionary": "Dicionrio",
+  "Finished list of mispelled words": "Finalizada lista de palavras desconhecidas",
+  "HTMLArea Spell Checker": "Dicionrio HTMLArea",
+  "I will open it in a new page.": "Ser aberto em uma nova pgina",
+  "Ignore": "Ignorar",
+  "Ignore all": "Ignorar todas",
+  "Info": "Informao",
+  "Learn": "Aprender",
+  "No mispelled words found with the selected dictionary.": "Nenhuma palavra desconhecida foi encontrada no dicionrio selecionado",
+  "OK": "OK",
+  "Original word": "Palavra Original",
+  "Please confirm that you want to open this link": "Por favor, confirme se deseja abrir este link",
+  "Please wait.  Calling spell checker.": "Por favor, aguarde. Chamando dicionrio.",
+  "Please wait: changing dictionary to": "Por favor, aguarde: mudando dicionrio para",
+  "Re-check": "Re-verificar",
+  "Replace": "Substituir",
+  "Replace all": "Substituir tudo",
+  "Replace with": "Substituir com",
+  "Revert": "Reverter",
+  "Spell Checker": "Dicionrio",
+  "Spell-check": "Dicionrio",
+  "Suggestions": "Sugestes",
+  "This will drop changes and quit spell checker.  Please confirm.": "Isso desfar as mudanas e finalizar o dicionrio. Por favor, confirme.",
+  "pliz weit ;-)": "Por favor, aguarde...",
+  "One moment...": "Um momento..."
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/lang/ro.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/SpellChecker/lang/ro.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,26 @@
+// I18N constants
+// LANG: "ro", ENCODING: UTF-8
+// Author: Mihai Bazon, http://dynarch.com/mishoo
+{
+  "Please confirm that you want to open this link": "V rog confirmai c vrei s deschidei acest link",
+  "Cancel": "Anuleaz",
+  "Dictionary": "Dicionar",
+  "Finished list of mispelled words": "Am terminat lista de cuvinte greite",
+  "I will open it in a new page.": "O voi deschide ntr-o alt fereastr.",
+  "Ignore all": "Ignor toate",
+  "Ignore": "Ignor",
+  "No mispelled words found with the selected dictionary.": "Nu am gsit nici un cuvnt greit cu acest dicionar.",
+  "Spell check complete, didn't find any mispelled words.  Closing now...": "Am terminat, nu am detectat nici o greeal.  Acum nchid fereastra...",
+  "OK": "OK",
+  "Original word": "Cuvntul original",
+  "Please wait.  Calling spell checker.": "V rog ateptai.  Apelez spell-checker-ul.",
+  "Please wait: changing dictionary to": "V rog ateptai.  Schimb dicionarul cu",
+  "This will drop changes and quit spell checker.  Please confirm.": "Dorii s renunai la modificri i s nchid spell-checker-ul?",
+  "Re-check": "Scaneaz",
+  "Replace all": "nlocuiete toate",
+  "Replace with": "nlocuiete cu",
+  "Replace": "nlocuiete",
+  "Spell-check": "Detecteaz greeli",
+  "Suggestions": "Sugestii",
+  "One moment...": "va rog ashteptatzi ;-)"
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/readme
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/SpellChecker/readme	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,8 @@
+ExecCGI Note:
+If you intend to use the perl (.cgi) backend then you will need to have the ExecCGI option enabled for this directory (if you are using Apache), you may be able to do this by adding a file called .htaccess in this directory, with the below contents.
+
+## EXAMPLE .htaccess
+Options +ExecCGI
+####################
+
+It is however recommended that you use the PHP backend where possible.
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/readme-tech.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/SpellChecker/readme-tech.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,114 @@
+<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 3.2//EN">
+<html>
+  <head>
+    <title>HTMLArea Spell Checker</title>
+  </head>
+
+  <body>
+    <h1>HTMLArea Spell Checker</h1>
+
+    <p>The HTMLArea Spell Checker subsystem consists of the following
+      files:</p>
+
+    <ul>
+
+      <li>spell-checker.js &mdash; the spell checker plugin interface for
+        HTMLArea</li>
+
+      <li>spell-checker-ui.html &mdash; the HTML code for the user
+        interface</li>
+
+      <li>spell-checker-ui.js &mdash; functionality of the user
+        interface</li>
+
+      <li>spell-checker-logic.cgi &mdash; Perl CGI script that checks a text
+        given through POST for spelling errors</li>
+
+      <li>spell-checker-style.css &mdash; style for mispelled words</li>
+
+      <li>lang/en.js &mdash; main language file (English).</li>
+
+    </ul>
+
+    <h2>Process overview</h2>
+
+    <p>
+      When an end-user clicks the "spell-check" button in the HTMLArea
+      editor, a new window is opened with the URL of "spell-check-ui.html".
+      This window initializes itself with the text found in the editor (uses
+      <tt>window.opener.SpellChecker.editor</tt> global variable) and it
+      submits the text to the server-side script "spell-check-logic.cgi".
+      The target of the FORM is an inline frame which is used both to
+      display the text and correcting.
+    </p>
+
+    <p>
+      Further, spell-check-logic.cgi calls Aspell for each portion of plain
+      text found in the given HTML.  It rebuilds an HTML file that contains
+      clear marks of which words are incorrect, along with suggestions for
+      each of them.  This file is then loaded in the inline frame.  Upon
+      loading, a JavaScript function from "spell-check-ui.js" is called.
+      This function will retrieve all mispelled words from the HTML of the
+      iframe and will setup the user interface so that it allows correction.
+    </p>
+
+    <h2>The server-side script (spell-check-logic.cgi)</h2>
+
+    <p>
+      <strong>Unicode safety</strong> &mdash; the program <em>is</em>
+      Unicode safe.  HTML entities are expanded into their corresponding
+      Unicode characters.  These characters will be matched as part of the
+      word passed to Aspell.  All texts passed to Aspell are in Unicode
+      (when appropriate).  <strike>However, Aspell seems to not support Unicode
+      yet (<a
+        href="http://mail.gnu.org/archive/html/aspell-user/2000-11/msg00007.html">thread concerning Aspell and Unicode</a>).
+      This mean that words containing Unicode
+      characters that are not in 0..255 are likely to be reported as "mispelled" by Aspell.</strike>
+    </p>
+
+    <p>
+      <strong style="font-variant: small-caps; color:
+      red;">Update:</strong> though I've never seen it mentioned
+      anywhere, it looks that Aspell <em>does</em>, in fact, speak
+      Unicode.  Or else, maybe <code>Text::Aspell</code> does
+      transparent conversion; anyway, this new version of our
+      SpellChecker plugin is, as tests show so far, fully
+      Unicode-safe... well, probably the <em>only</em> freeware
+      Web-based spell-checker which happens to have Unicode support.
+    </p>
+
+    <p>
+      The Perl Unicode manual (man perluniintro) states:
+    </p>
+
+    <blockquote>
+      <em>
+        Starting from Perl 5.6.0, Perl has had the capacity to handle Unicode
+        natively.  Perl 5.8.0, however, is the first recommended release for
+        serious Unicode work.  The maintenance release 5.6.1 fixed many of the
+        problems of the initial Unicode implementation, but for example regular
+        expressions still do not work with Unicode in 5.6.1.
+      </em>
+    </blockquote>
+
+    <p>In other words, do <em>not</em> assume that this script is
+      Unicode-safe on Perl interpreters older than 5.8.0.</p>
+
+    <p>The following Perl modules are required:</p>
+
+    <ul>
+      <li><a href="http://search.cpan.org/search?query=Text%3A%3AAspell&mode=all" onclick="window.open(this.href,'_blank');return false;">Text::Aspell</a></li>
+      <li><a href="http://search.cpan.org/search?query=XML%3A%3ADOM&mode=all" onclick="window.open(this.href,'_blank');return false;">XML::DOM</a></li>
+      <li><a href="http://search.cpan.org/search?query=CGI&mode=all" onclick="window.open(this.href,'_blank');return false;">CGI</a></li>
+    </ul>
+
+    <p>Of these, only Text::Aspell might need to be installed manually.  The
+      others are likely to be available by default in most Perl distributions.</p>
+
+    <hr />
+    <address><a href="http://dynarch.com/mishoo/">Mihai Bazon</a></address>
+<!-- Created: Thu Jul 17 13:22:27 EEST 2003 -->
+<!-- hhmts start --> Last modified: Fri Jan 30 19:14:11 EET 2004 <!-- hhmts end -->
+<!-- doc-lang: English -->
+  </body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/spell-check-logic.cgi
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/SpellChecker/spell-check-logic.cgi	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,210 @@
+#! /usr/bin/perl -w
+
+# Spell Checker Plugin for HTMLArea-3.0
+# Sponsored by www.americanbible.org
+# Implementation by Mihai Bazon, http://dynarch.com/mishoo/
+#
+# (c) dynarch.com 2003.
+# Distributed under the same terms as HTMLArea itself.
+# This notice MUST stay intact for use (see license.txt).
+#
+# $Id:spell-check-logic.cgi 21 2005-02-19 05:23:56Z gogo $
+
+use strict;
+use utf8;
+use Encode;
+use Text::Aspell;
+use XML::DOM;
+use CGI;
+
+my $TIMER_start = undef;
+eval {
+    use Time::HiRes qw( gettimeofday tv_interval );
+    $TIMER_start = [gettimeofday()];
+};
+# use POSIX qw( locale_h );
+
+binmode STDIN, ':utf8';
+binmode STDOUT, ':utf8';
+
+my $debug = 0;
+
+my $speller = new Text::Aspell;
+my $cgi = new CGI;
+
+my $total_words = 0;
+my $total_mispelled = 0;
+my $total_suggestions = 0;
+my $total_words_suggested = 0;
+
+# FIXME: report a nice error...
+die "Can't create speller!" unless $speller;
+
+my $dict = $cgi->param('dictionary') || $cgi->cookie('dictionary') || 'en';
+
+# add configurable option for this
+$speller->set_option('lang', $dict);
+$speller->set_option('encoding', 'UTF-8');
+#setlocale(LC_CTYPE, $dict);
+
+# ultra, fast, normal, bad-spellers
+# bad-spellers seems to cause segmentation fault
+$speller->set_option('sug-mode', 'normal');
+
+my %suggested_words = ();
+keys %suggested_words = 128;
+
+my $file_content = decode('UTF-8', $cgi->param('content'));
+$file_content = parse_with_dom($file_content);
+
+my $ck_dictionary = $cgi->cookie(-name     => 'dictionary',
+                                 -value    => $dict,
+                                 -expires  => '+30d');
+
+print $cgi->header(-type    => 'text/html; charset: utf-8',
+                   -cookie  => $ck_dictionary);
+
+my $js_suggested_words = make_js_hash(\%suggested_words);
+my $js_spellcheck_info = make_js_hash_from_array
+  ([
+    [ 'Total words'           , $total_words ],
+    [ 'Mispelled words'       , $total_mispelled . ' in dictionary \"'.$dict.'\"' ],
+    [ 'Total suggestions'     , $total_suggestions ],
+    [ 'Total words suggested' , $total_words_suggested ],
+    [ 'Spell-checked in'      , defined $TIMER_start ? (tv_interval($TIMER_start) . ' seconds') : 'n/a' ]
+   ]);
+
+print qq^<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+<html>
+<head>
+<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
+<link rel="stylesheet" type="text/css" media="all" href="spell-check-style.css" />
+<script type="text/javascript">
+  var suggested_words = { $js_suggested_words };
+  var spellcheck_info = { $js_spellcheck_info }; </script>
+</head>
+<body onload="window.parent.finishedSpellChecking();">^;
+
+print $file_content;
+if ($cgi->param('init') eq '1') {
+    my @dicts = $speller->dictionary_info();
+    my $dictionaries = '';
+    foreach my $i (@dicts) {
+        next if $i->{jargon};
+        my $name = $i->{name};
+        if ($name eq $dict) {
+            $name = '@'.$name;
+        }
+        $dictionaries .= ',' . $name;
+    }
+    $dictionaries =~ s/^,//;
+    print qq^<div id="HA-spellcheck-dictionaries">$dictionaries</div>^;
+}
+
+print '</body></html>';
+
+# Perl is beautiful.
+sub spellcheck {
+    my $node = shift;
+    my $doc = $node->getOwnerDocument;
+    my $check = sub {                 # called for each word in the text
+        # input is in UTF-8
+        my $word = shift;
+        my $already_suggested = defined $suggested_words{$word};
+        ++$total_words;
+        if (!$already_suggested && $speller->check($word)) {
+            return undef;
+        } else {
+            # we should have suggestions; give them back to browser in UTF-8
+            ++$total_mispelled;
+            if (!$already_suggested) {
+                # compute suggestions for this word
+                my @suggestions = $speller->suggest($word);
+                my $suggestions = decode($speller->get_option('encoding'), join(',', @suggestions));
+                $suggested_words{$word} = $suggestions;
+                ++$total_suggestions;
+                $total_words_suggested += scalar @suggestions;
+            }
+            # HA-spellcheck-error
+            my $err = $doc->createElement('span');
+            $err->setAttribute('class', 'HA-spellcheck-error');
+            my $tmp = $doc->createTextNode;
+            $tmp->setNodeValue($word);
+            $err->appendChild($tmp);
+            return $err;
+        }
+    };
+    while ($node->getNodeValue =~ /([\p{IsWord}']+)/) {
+        my $word = $1;
+        my $before = $`;
+        my $after = $';
+        my $df = &$check($word);
+        if (!$df) {
+            $before .= $word;
+        }
+        {
+            my $parent = $node->getParentNode;
+            my $n1 = $doc->createTextNode;
+            $n1->setNodeValue($before);
+            $parent->insertBefore($n1, $node);
+            $parent->insertBefore($df, $node) if $df;
+            $node->setNodeValue($after);
+        }
+    }
+};
+
+sub check_inner_text {
+    my $node = shift;
+    my $text = '';
+    for (my $i = $node->getFirstChild; defined $i; $i = $i->getNextSibling) {
+        if ($i->getNodeType == TEXT_NODE) {
+            spellcheck($i);
+        }
+    }
+};
+
+sub parse_with_dom {
+    my ($text) = @_;
+    $text = '<spellchecker>'.$text.'</spellchecker>';
+
+    my $parser = new XML::DOM::Parser;
+    if ($debug) {
+        open(FOO, '>:utf8', '/tmp/foo');
+        print FOO $text;
+        close FOO;
+    }
+    my $doc = $parser->parse($text);
+    my $nodes = $doc->getElementsByTagName('*');
+    my $n = $nodes->getLength;
+
+    for (my $i = 0; $i < $n; ++$i) {
+        my $node = $nodes->item($i);
+        if ($node->getNodeType == ELEMENT_NODE) {
+            check_inner_text($node);
+        }
+    }
+
+    my $ret = $doc->toString;
+    $ret =~ s{<spellchecker>(.*)</spellchecker>}{$1}sg;
+    return $ret;
+};
+
+sub make_js_hash {
+    my ($hash) = @_;
+    my $js_hash = '';
+    while (my ($key, $val) = each %$hash) {
+        $js_hash .= ',' if $js_hash;
+        $js_hash .= '"'.$key.'":"'.$val.'"';
+    }
+    return $js_hash;
+};
+
+sub make_js_hash_from_array {
+    my ($array) = @_;
+    my $js_hash = '';
+    foreach my $i (@$array) {
+        $js_hash .= ',' if $js_hash;
+        $js_hash .= '"'.$i->[0].'":"'.$i->[1].'"';
+    }
+    return $js_hash;
+};
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/spell-check-logic.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/SpellChecker/spell-check-logic.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,171 @@
+<?php
+  $text = stripslashes($_POST['content']);
+
+  // Convert UTF-8 multi-bytes into decimal character entities.  This is because
+  // aspell isn't fully utf8-aware - ticket:120 raises the possibility 
+  // that this is not required (any more) and so you can turn it off
+  // with editor.config.SpellChecker.utf8_to_entities = false 
+  if(!isset($_REQUEST['utf8_to_entitis']) || $_REQUEST['utf8_to_entities'])
+  {
+    $text = preg_replace('/([\xC0-\xDF][\x80-\xBF])/e', "'&#' . utf8_ord('\$1') . ';'", $text);
+    $text = preg_replace('/([\xE0-\xEF][\x80-\xBF][\x80-\xBF])/e',             "'&#' . utf8_ord('\$1') . ';'",  $text);
+    $text = preg_replace('/([\xF0-\xF7][\x80-\xBF][\x80-\xBF][\x80-\xBF])/e', "'&#' . utf8_ord('\$1') . ';'",   $text);
+  }
+  
+  function utf8_ord($chr)
+  {
+    switch(strlen($chr))
+    {
+      case 1 :
+        return ord($chr);
+
+      case 2 :
+        $ord = ord($chr{1}) & 63;
+        $ord = $ord | ((ord($chr{0}) & 31) << 6);
+        return $ord;
+
+      case 3 :
+        $ord = ord($chr{2}) & 63;
+        $ord = $ord | ((ord($chr{1}) & 63) << 6);
+        $ord = $ord | ((ord($chr{0}) & 15) << 12);
+        return $ord;
+
+      case 4 :
+        $ord = ord($chr{3}) & 63;
+        $ord = $ord | ((ord($chr{2}) & 63) << 6);
+        $ord = $ord | ((ord($chr{1}) & 63) << 12);
+        $ord = $ord | ((ord($chr{0}) & 7)  << 18);
+        return $ord;
+
+      default :
+        trigger_error('Character not utf-8', E_USER_ERROR);
+    }
+  }
+
+  require_once(dirname(__FILE__) . DIRECTORY_SEPARATOR . 'aspell_setup.php');
+
+##############################################################################
+header('Content-Type: text/html; charset=utf-8');
+  echo '<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+<html>
+<head>
+<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
+<link rel="stylesheet" type="text/css" media="all" href="spell-check-style.css" />';
+
+// Lets define some values outside the condition below, in case we have an empty 
+// document.                                                                     
+$textarray = array();
+$varlines = '<script type="text/javascript">var suggested_words = { ';
+$infolines = 'var spellcheck_info = {';
+$counter = 0;
+$suggest_count = 0;
+
+if (trim($text) != "")
+{
+    if ($fd = fopen($temptext, 'w'))
+    {
+        $textarray = explode("\n", $text);
+        fwrite ($fd, "!\n");
+        foreach ($textarray as $key=>$value)
+        {
+            // adding the carat to each line prevents the use of aspell commands within the text...
+            fwrite($fd, "^$value\n");
+        }
+        fclose($fd);
+        chmod($temptext, 0777);
+        // next run aspell
+        $return = shell_exec($aspellcommand . ' 2>&1');
+        // echo $return;
+        unlink($temptext);
+        $returnarray = explode("\n", $return);
+        $returnlines = count($returnarray);
+//print_r(htmlentities($return));
+        $textlines = count($textarray);
+
+        $lineindex = -1;
+        $poscorrect = 0;
+        foreach ($returnarray as $key=>$value)
+        {
+            // if there is a correction here, processes it, else move the $textarray pointer to the next line
+            if (substr($value, 0, 1) == '&')
+            {
+               $counter=$counter+1;
+                $correction = explode(' ', $value);
+                $word = $correction[1];
+                $suggest_count += $correction[2];
+                $absposition = substr($correction[3], 0, -1) - 1;
+                $position = $absposition + $poscorrect;
+                $niceposition = $lineindex.','.$absposition;
+                $suggstart = strpos($value, ':') + 2;
+                $suggestions = substr($value, $suggstart);
+                $suggestionarray = explode(', ', $suggestions);
+
+                $beforeword = substr($textarray[$lineindex], 0, $position);
+                $afterword = substr($textarray[$lineindex], $position + strlen($word));
+                $textarray[$lineindex] = $beforeword.'<span class="HA-spellcheck-error">'.$word.'</span>'.$afterword;
+
+             $suggestion_list = '';
+                foreach ($suggestionarray as $key=>$value)
+                {
+                    $suggestion_list .= $value.',';
+                }
+                $suggestion_list = substr($suggestion_list, 0, strlen($suggestion_list) - 1);
+                $varlines .= '"'.$word.'":"'.$suggestion_list.'",';
+
+                $poscorrect = $poscorrect + 41;
+            }
+            elseif (substr($value, 0, 1) == '#')
+            {
+                $correction = explode(' ', $value);
+                $word = $correction[1];
+                $absposition = $correction[2] - 1;
+                $position = $absposition + $poscorrect;
+                $niceposition = $lineindex.','.$absposition;
+                $beforeword = substr($textarray[$lineindex], 0, $position);
+                $afterword = substr($textarray[$lineindex], $position + strlen($word));
+                $textarray[$lineindex] = $beforeword.$word.$afterword;
+                $textarray[$lineindex] = $beforeword.'<span class="HA-spellcheck-error">'.$word.'</span><span class="HA-spellcheck-suggestions">'.$word.'</span>'.$afterword;
+//                $poscorrect = $poscorrect;
+                $poscorrect = $poscorrect + 88 + strlen($word);
+            }
+            else
+            {
+                //print "Done with line $lineindex, next line...<br><br>";
+                $poscorrect = 0;
+                $lineindex = $lineindex + 1;
+            }
+         }
+     }
+     else
+     {
+       // This one isnt used for anything at the moment!
+       $return = 'failed to open!';
+     }
+} 
+else 
+{ 
+  $returnlines=0; 
+}
+$infolines .= '"Language Used":"'.$lang.'",';
+$infolines .= '"Mispelled words":"'.$counter.'",';
+$infolines .= '"Total words suggested":"'.$suggest_count.'",';
+$infolines .= '"Total Lines Checked":"'.$returnlines.'"';
+$infolines .= '};';
+$varlines = substr($varlines, 0, strlen($varlines) - 1);
+echo $varlines.'};'.$infolines.'</script>';
+
+echo '</head>
+<body onload="window.parent.finishedSpellChecking();">';
+
+foreach ($textarray as $key=>$value)
+{
+  echo $value;
+}
+
+$dictionaries = str_replace(chr(10),",", shell_exec($aspelldictionaries));
+if(ereg(",$",$dictionaries))
+  $dictionaries = ereg_replace(",$","",$dictionaries);
+echo '<div id="HA-spellcheck-dictionaries">'.$dictionaries.'</div>';
+
+echo '</body></html>';
+?>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/spell-check-savedicts.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/SpellChecker/spell-check-savedicts.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,38 @@
+<?php
+  require_once(dirname(__FILE__) . DIRECTORY_SEPARATOR . 'aspell_setup.php');
+
+
+  $to_p_dict = $_REQUEST['to_p_dict'] ? $_REQUEST['to_p_dict'] : array();
+  $to_r_list = $_REQUEST['to_r_list'] ? $_REQUEST['to_r_list'] : array();
+print_r($to_r_list);
+  if($to_p_dict || $to_r_list)
+  {
+    if($fh = fopen($temptext, 'w'))
+    {
+      foreach($to_p_dict as $personal_word)
+      {
+        $cmd = '&' . $personal_word . "\n";
+        echo $cmd;
+        fwrite($fh, $cmd, strlen($cmd));
+      }
+
+      foreach($to_r_list as $replace_pair)
+      {
+        $cmd = '$$ra ' . $replace_pair[0] . ' , ' . $replace_pair[1] . "\n";
+        echo $cmd;
+        fwrite($fh, $cmd, strlen($cmd));
+      }
+      $cmd = "#\n";
+      echo $cmd;
+      fwrite($fh, $cmd, strlen($cmd));
+      fclose($fh);
+    }
+    else
+    {
+      die("Can't Write");
+    }
+    echo $aspellcommand."\n";
+    echo shell_exec($aspellcommand . ' 2>&1');
+    unlink($temptext);
+  }
+?>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/spell-check-style.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/SpellChecker/spell-check-style.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,10 @@
+.HA-spellcheck-error { border-bottom: 1px dashed #f00; cursor: default; }
+.HA-spellcheck-same { background-color: #cef; color: #000; }
+.HA-spellcheck-hover { background-color: #433; color: white; }
+.HA-spellcheck-fixed { border-bottom: 1px dashed #0b8; }
+.HA-spellcheck-current { background-color: #9be; color: #000; }
+.HA-spellcheck-suggestions { display: none; }
+
+#HA-spellcheck-dictionaries { display: none; }
+
+a:link, a:visited { color: #55e; }
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/spell-check-ui.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/SpellChecker/spell-check-ui.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,125 @@
+<!--
+
+  Strangely, IE sucks with or without the DOCTYPE switch.
+  I thought it would only suck without it.
+
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
+    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
+
+   Spell Checker Plugin for HTMLArea-3.0
+   Sponsored by www.americanbible.org
+   Implementation by Mihai Bazon, http://dynarch.com/mishoo/
+
+   (c) dynarch.com 2003.
+   Distributed under the same terms as HTMLArea itself.
+   This notice MUST stay intact for use (see license.txt).
+
+   $Id:spell-check-ui.html 987 2008-04-12 12:39:04Z ray $
+
+-->
+<html>
+
+  <head>
+    <title>Spell Checker</title>
+    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
+    <script type="text/javascript" src="spell-check-ui.js"></script>
+
+    <style type="text/css">
+      html, body { height: 100%; margin: 0px; padding: 0px; background-color: #fff;
+      color: #000; }
+      a:link, a:visited { color: #00f; text-decoration: none; }
+      a:hover { color: #f00; text-decoration: underline; }
+
+      table { background-color: ButtonFace; color: ButtonText;
+      font-family: tahoma,verdana,sans-serif; font-size: 11px; }
+
+      iframe { background-color: #fff; color: #000; height: 100%; width: 100%; }
+
+      .controls { width: 13em; }
+      .controls .sectitle { /* background-color: #736c6c; color: #fff;
+      border-top: 1px solid #000; border-bottom: 1px solid #fff; */
+      text-align: center;
+      font-weight: bold; padding: 2px 4px; }
+      .controls .secbody { margin-bottom: 10px; }
+
+      button, select { font-family: tahoma,verdana,sans-serif; font-size: 11px; }
+      button { width: 6em; padding: 0px; }
+
+      input, select { font-family: fixed,"andale mono",monospace; }
+
+      #v_currentWord { color: #f00; font-weight: bold; }
+      #statusbar { padding: 7px 0px 0px 5px; }
+      #status { font-weight: bold; }
+    </style>
+
+  </head>
+
+  <body onload="initDocument()">
+
+    <form style="display: none;" action="spell-check-logic.cgi"
+          method="post" target="framecontent"
+          accept-charset="UTF-8"
+          ><input type="hidden" name="content" id="f_content"
+          /><input type="hidden" name="dictionary" id="f_dictionary"
+          /><input type="hidden" name="init" id="f_init" value="1"
+          /><input type="hidden" name="utf8_to_entities" id="utf8_to_entities" value="1"
+    /></form>
+
+    <table style="height: 100%; width: 100%; border-collapse: collapse;" cellspacing="0" cellpadding="0">
+      <tr>
+        <td colspan="2" style="height: 1em; padding: 2px;">
+          <div style="float: right; padding: 2px;"><span>Dictionary</span>
+            <select id="v_dictionaries" style="width: 10em"></select>
+            <button id="b_recheck">Re-check</button>
+          </div>
+          <span id="status">Please wait.  Calling spell checker.</span>
+        </td>
+      </tr>
+      <tr>
+        <td style="vertical-align: top;" class="controls">
+          <div class="secbody" style="text-align: center">
+            <button id="b_info">Info</button>
+          </div>
+          <div class="sectitle">Original word</div>
+          <div class="secbody" id="v_currentWord" style="text-align:
+          center; margin-bottom: 0px;">pliz weit ;-)</div>
+          <div class="secbody" style="text-align: center">
+            <button id="b_revert">Revert</button>
+          </div>
+          <div class="sectitle">Replace with</div>
+          <div class="secbody">
+            <input type="text" id="v_replacement" style="width: 94%; margin-left: 3%;" /><br />
+            <div style="text-align: center; margin-top: 2px;">
+              <button id="b_replace">Replace</button><button
+                id="b_replall">Replace all</button><br /><button
+                id="b_ignore">Ignore</button><button
+                id="b_ignall">Ignore all</button>
+                <button
+                id="b_learn">Learn</button>
+            </div>
+          </div>
+          <div class="sectitle">Suggestions</div>
+          <div class="secbody">
+            <select size="11" style="width: 94%; margin-left: 3%;" id="v_suggestions"></select>
+          </div>
+        </td>
+
+        <td>
+          <iframe src="../../popups/blank.html" width="100%" height="100%"
+            id="i_framecontent" name="framecontent"></iframe>
+        </td>
+      </tr>
+      <tr>
+        <td style="height: 1em;" colspan="2">
+          <div style="padding: 4px 2px 2px 2px; float: right;">
+            <button id="b_ok">OK</button>
+            <button id="b_cancel">Cancel</button>
+          </div>
+          <div id="statusbar"></div>
+        </td>
+      </tr>
+    </table>
+
+  </body>
+
+</html>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/spell-check-ui.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/SpellChecker/spell-check-ui.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,394 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/SpellChecker/spell-check-ui.js */
+var SpellChecker=window.opener.SpellChecker;
+var Xinha=window.opener.Xinha;
+var _editor_url=window.opener._editor_url;
+var is_ie=Xinha.is_ie;
+var editor=SpellChecker.editor;
+var frame=null;
+var currentElement=null;
+var wrongWords=null;
+var modified=false;
+var allWords={};
+var fixedWords=[];
+var suggested_words={};
+var to_p_dict=[];
+var to_r_list=[];
+function _lc(_1){
+return Xinha._lc(_1,"SpellChecker");
+}
+function makeCleanDoc(_2){
+var _3=wrongWords.concat(fixedWords);
+for(var i=_3.length;--i>=0;){
+var el=_3[i];
+if(!(_2&&/HA-spellcheck-fixed/.test(el.className))){
+if(el.firstChild){
+el.parentNode.insertBefore(el.firstChild,el);
+}
+el.parentNode.removeChild(el);
+}else{
+el.className="HA-spellcheck-fixed";
+}
+}
+return Xinha.getHTML(frame.contentWindow.document.body,true,editor);
+}
+function recheckClicked(){
+document.getElementById("status").innerHTML=_lc("Please wait: changing dictionary to")+": \""+document.getElementById("f_dictionary").value+"\".";
+var _6=document.getElementById("f_content");
+_6.value=makeCleanDoc(true);
+_6.form.submit();
+}
+function saveClicked(){
+if(modified){
+editor.setHTML(makeCleanDoc(false));
+}
+if(to_p_dict.length||to_r_list.length&&editor.config.SpellChecker.backend=="php"){
+var _7={};
+for(var i=0;i<to_p_dict.length;i++){
+_7["to_p_dict["+i+"]"]=to_p_dict[i];
+}
+for(var i=0;i<to_r_list.length;i++){
+_7["to_r_list["+i+"][0]"]=to_r_list[i][0];
+_7["to_r_list["+i+"][1]"]=to_r_list[i][1];
+}
+window.opener.Xinha._postback(Xinha.getPluginDir("SpellChecker")+"/spell-check-savedicts.php",_7);
+window.close();
+}else{
+window.close();
+}
+return false;
+}
+function cancelClicked(){
+var ok=true;
+if(modified){
+ok=confirm(_lc("This will drop changes and quit spell checker.  Please confirm."));
+}
+if(ok){
+window.close();
+}
+return false;
+}
+function replaceWord(el){
+var _b=document.getElementById("v_replacement").value;
+var _c=(el.innerHTML!=_b);
+if(_c){
+modified=true;
+}
+if(el){
+el.className=el.className.replace(/\s*HA-spellcheck-(hover|fixed)\s*/g," ");
+}
+el.className+=" HA-spellcheck-fixed";
+el.__msh_fixed=true;
+if(!_c){
+return false;
+}
+to_r_list.push([el.innerHTML,_b]);
+el.innerHTML=_b;
+}
+function replaceClicked(){
+replaceWord(currentElement);
+var _d=currentElement.__msh_id;
+var _e=_d;
+do{
+++_e;
+if(_e==wrongWords.length){
+_e=0;
+}
+}while((_e!=_d)&&wrongWords[_e].__msh_fixed);
+if(_e==_d){
+_e=0;
+alert(_lc("Finished list of mispelled words"));
+}
+wrongWords[_e].__msh_wordClicked(true);
+return false;
+}
+function revertClicked(){
+document.getElementById("v_replacement").value=currentElement.__msh_origWord;
+replaceWord(currentElement);
+currentElement.className="HA-spellcheck-error HA-spellcheck-current";
+return false;
+}
+function replaceAllClicked(){
+var _f=document.getElementById("v_replacement").value;
+var ok=true;
+var _11=allWords[currentElement.__msh_origWord];
+if(_11.length==0){
+alert("An impossible condition just happened.  Call FBI.  ;-)");
+}else{
+if(_11.length==1){
+replaceClicked();
+return false;
+}
+}
+if(ok){
+for(var i=0;i<_11.length;++i){
+if(_11[i]!=currentElement){
+replaceWord(_11[i]);
+}
+}
+replaceClicked();
+}
+return false;
+}
+function ignoreClicked(){
+document.getElementById("v_replacement").value=currentElement.__msh_origWord;
+replaceClicked();
+return false;
+}
+function ignoreAllClicked(){
+document.getElementById("v_replacement").value=currentElement.__msh_origWord;
+replaceAllClicked();
+return false;
+}
+function learnClicked(){
+to_p_dict.push(currentElement.__msh_origWord);
+return ignoreAllClicked();
+}
+function internationalizeWindow(){
+var _13=["div","span","button"];
+for(var i=0;i<_13.length;++i){
+var tag=_13[i];
+var els=document.getElementsByTagName(tag);
+for(var j=els.length;--j>=0;){
+var el=els[j];
+if(el.childNodes.length==1&&/\S/.test(el.innerHTML)){
+var txt=el.innerHTML;
+el.innerHTML=_lc(txt);
+}
+}
+}
+}
+function initDocument(){
+internationalizeWindow();
+modified=false;
+frame=document.getElementById("i_framecontent");
+var _1a=document.getElementById("f_content");
+_1a.value=Xinha.getHTML(editor._doc.body,false,editor);
+var _1b=document.getElementById("f_dictionary");
+if(typeof editor.config.SpellChecker.defaultDictionary!="undefined"&&editor.config.SpellChecker.defaultDictionary!=""){
+_1b.value=editor.config.SpellChecker.defaultDictionary;
+}else{
+_1b.value="en_GB";
+}
+if(editor.config.SpellChecker.backend=="php"){
+_1a.form.action=Xinha.getPluginDir("SpellChecker")+"/spell-check-logic.php";
+}
+if(editor.config.SpellChecker.utf8_to_entities){
+document.getElementById("utf8_to_entities").value=1;
+}else{
+document.getElementById("utf8_to_entities").value=0;
+}
+_1a.form.submit();
+document.getElementById("f_init").value="0";
+var _1c=document.getElementById("v_suggestions");
+_1c.onchange=function(){
+document.getElementById("v_replacement").value=this.value;
+};
+if(is_ie){
+_1c.attachEvent("ondblclick",replaceClicked);
+}else{
+_1c.addEventListener("dblclick",replaceClicked,true);
+}
+document.getElementById("b_replace").onclick=replaceClicked;
+if(editor.config.SpellChecker.backend=="php"){
+document.getElementById("b_learn").onclick=learnClicked;
+}else{
+document.getElementById("b_learn").parentNode.removeChild(document.getElementById("b_learn"));
+}
+document.getElementById("b_replall").onclick=replaceAllClicked;
+document.getElementById("b_ignore").onclick=ignoreClicked;
+document.getElementById("b_ignall").onclick=ignoreAllClicked;
+document.getElementById("b_recheck").onclick=recheckClicked;
+document.getElementById("b_revert").onclick=revertClicked;
+document.getElementById("b_info").onclick=displayInfo;
+document.getElementById("b_ok").onclick=saveClicked;
+document.getElementById("b_cancel").onclick=cancelClicked;
+_1c=document.getElementById("v_dictionaries");
+_1c.onchange=function(){
+document.getElementById("f_dictionary").value=this.value;
+};
+}
+function getAbsolutePos(el){
+var r={x:el.offsetLeft,y:el.offsetTop};
+if(el.offsetParent){
+var tmp=getAbsolutePos(el.offsetParent);
+r.x+=tmp.x;
+r.y+=tmp.y;
+}
+return r;
+}
+function wordClicked(_20){
+var _21=this;
+if(_20){
+(function(){
+var pos=getAbsolutePos(_21);
+var ws={x:frame.offsetWidth-4,y:frame.offsetHeight-4};
+var wp={x:frame.contentWindow.document.body.scrollLeft,y:frame.contentWindow.document.body.scrollTop};
+pos.x-=Math.round(ws.x/2);
+if(pos.x<0){
+pos.x=0;
+}
+pos.y-=Math.round(ws.y/2);
+if(pos.y<0){
+pos.y=0;
+}
+frame.contentWindow.scrollTo(pos.x,pos.y);
+})();
+}
+if(currentElement){
+var a=allWords[currentElement.__msh_origWord];
+currentElement.className=currentElement.className.replace(/\s*HA-spellcheck-current\s*/g," ");
+for(var i=0;i<a.length;++i){
+var el=a[i];
+if(el!=currentElement){
+el.className=el.className.replace(/\s*HA-spellcheck-same\s*/g," ");
+}
+}
+}
+currentElement=this;
+this.className+=" HA-spellcheck-current";
+var a=allWords[currentElement.__msh_origWord];
+for(var i=0;i<a.length;++i){
+var el=a[i];
+if(el!=currentElement){
+el.className+=" HA-spellcheck-same";
+}
+}
+var txt;
+if(a.length==1){
+txt="one occurrence";
+}else{
+if(a.length==2){
+txt="two occurrences";
+}else{
+txt=a.length+" occurrences";
+}
+}
+var _29=suggested_words[this.__msh_origWord];
+if(_29){
+_29=_29.split(/,/);
+}else{
+_29=[];
+}
+var _2a=document.getElementById("v_suggestions");
+document.getElementById("statusbar").innerHTML="Found "+txt+" for word \"<b>"+currentElement.__msh_origWord+"</b>\"";
+for(var i=_2a.length;--i>=0;){
+_2a.remove(i);
+}
+for(var i=0;i<_29.length;++i){
+var txt=_29[i];
+var _2b=document.createElement("option");
+_2b.value=txt;
+_2b.appendChild(document.createTextNode(txt));
+_2a.appendChild(_2b);
+}
+document.getElementById("v_currentWord").innerHTML=this.__msh_origWord;
+if(_29.length>0){
+_2a.selectedIndex=0;
+_2a.onchange();
+}else{
+document.getElementById("v_replacement").value=this.innerHTML;
+}
+_2a.style.display="none";
+_2a.style.display="block";
+return false;
+}
+function wordMouseOver(){
+this.className+=" HA-spellcheck-hover";
+}
+function wordMouseOut(){
+this.className=this.className.replace(/\s*HA-spellcheck-hover\s*/g," ");
+}
+function displayInfo(){
+var _2c=frame.contentWindow.spellcheck_info;
+if(!_2c){
+alert("No information available");
+}else{
+var txt="** Document information **";
+for(var i in _2c){
+txt+="\n"+i+" : "+_2c[i];
+}
+alert(txt);
+}
+return false;
+}
+function finishedSpellChecking(){
+currentElement=null;
+wrongWords=null;
+allWords={};
+fixedWords=[];
+suggested_words=frame.contentWindow.suggested_words;
+document.getElementById("status").innerHTML="Xinha Spell Checker (<a href=\"readme-tech.html\" onclick=\"window.open(this.href,'_blank');return false;\" title=\"Technical information\">info</a>)";
+var doc=frame.contentWindow.document;
+var _30=doc.getElementsByTagName("span");
+var sps=[];
+var id=0;
+for(var i=0;i<_30.length;++i){
+var el=_30[i];
+if(/HA-spellcheck-error/.test(el.className)){
+sps.push(el);
+el.__msh_wordClicked=wordClicked;
+el.onclick=function(ev){
+ev||(ev=window.event);
+ev&&Xinha._stopEvent(ev);
+return this.__msh_wordClicked(false);
+};
+el.onmouseover=wordMouseOver;
+el.onmouseout=wordMouseOut;
+el.__msh_id=id++;
+var txt=(el.__msh_origWord=el.firstChild.data);
+el.__msh_fixed=false;
+if(typeof allWords[txt]=="undefined"){
+allWords[txt]=[el];
+}else{
+allWords[txt].push(el);
+}
+}else{
+if(/HA-spellcheck-fixed/.test(el.className)){
+fixedWords.push(el);
+}
+}
+}
+var _37=doc.getElementById("HA-spellcheck-dictionaries");
+if(_37){
+_37.parentNode.removeChild(_37);
+_37=_37.innerHTML.split(/,/);
+var _38=document.getElementById("v_dictionaries");
+for(var i=_38.length;--i>=0;){
+_38.remove(i);
+}
+var _39=document.getElementById("f_dictionary").value;
+for(var i=0;i<_37.length;++i){
+var txt=_37[i];
+var _3a=document.createElement("option");
+if(txt==_39){
+_3a.selected=true;
+}
+_3a.value=txt;
+_3a.appendChild(document.createTextNode(txt));
+_38.appendChild(_3a);
+}
+}
+wrongWords=sps;
+if(sps.length==0){
+if(!modified){
+alert(_lc("No mispelled words found with the selected dictionary."));
+}else{
+alert(_lc("No mispelled words found with the selected dictionary."));
+}
+return false;
+}
+(currentElement=sps[0]).__msh_wordClicked(true);
+var as=doc.getElementsByTagName("a");
+for(var i=as.length;--i>=0;){
+var a=as[i];
+a.onclick=function(){
+if(confirm(_lc("Please confirm that you want to open this link")+":\n"+this.href+"\n"+_lc("I will open it in a new page."))){
+window.open(this.href);
+}
+return false;
+};
+}
+}
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/SpellChecker/spell-checker.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/SpellChecker/spell-checker.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,38 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/SpellChecker/spell-checker.js */
+Xinha.Config.prototype.SpellChecker={"backend":"php","personalFilesDir":"","defaultDictionary":"en_GB","utf8_to_entities":true};
+function SpellChecker(_1){
+this.editor=_1;
+var _2=_1.config;
+var bl=SpellChecker.btnList;
+var _4=this;
+var id="SC-spell-check";
+_2.registerButton(id,this._lc("Spell-check"),_1.imgURL("spell-check.gif","SpellChecker"),false,function(_6,id){
+_4.buttonPress(_6,id);
+});
+_2.addToolbarElement("SC-spell-check","htmlmode",1);
+}
+SpellChecker._pluginInfo={name:"SpellChecker",version:"1.0",developer:"Mihai Bazon",developer_url:"http://dynarch.com/mishoo/",c_owner:"Mihai Bazon",sponsor:"American Bible Society",sponsor_url:"http://www.americanbible.org",license:"htmlArea"};
+SpellChecker.prototype._lc=function(_8){
+return Xinha._lc(_8,"SpellChecker");
+};
+SpellChecker.btnList=[null,["spell-check"]];
+SpellChecker.prototype.buttonPress=function(_9,id){
+switch(id){
+case "SC-spell-check":
+SpellChecker.editor=_9;
+SpellChecker.init=true;
+var _b=Xinha.getPluginDir("SpellChecker")+"/spell-check-ui.html";
+var _c;
+if(Xinha.is_ie){
+_c=window.open(_b,"SC_spell_checker","toolbar=no,location=no,directories=no,status=no,menubar=no,"+"scrollbars=no,resizable=yes,width=600,height=450");
+}else{
+_c=window.open(_b,"SC_spell_checker","toolbar=no,menubar=no,personalbar=no,width=600,height=450,"+"scrollbars=no,resizable=yes");
+}
+_c.focus();
+break;
+}
+};
+SpellChecker.editor=null;
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/plugins/css/css.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/plugins/css/css.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,77 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/plugins/CSS/css.js */
+Xinha.Config.prototype.cssPluginConfig={combos:[{label:"Syntax",options:{"None":"","Code":"code","String":"string","Comment":"comment","Variable name":"variable-name","Type":"type","Reference":"reference","Preprocessor":"preprocessor","Keyword":"keyword","Function name":"function-name","Html tag":"html-tag","Html italic":"html-helper-italic","Warning":"warning","Html bold":"html-helper-bold"},context:"pre"},{label:"Info",options:{"None":"","Quote":"quote","Highlight":"highlight","Deprecated":"deprecated"}}]};
+function CSS(_1,_2){
+this.editor=_1;
+var _3=_1.config;
+var _4=this;
+var _5;
+if(_2&&_2.length){
+_5=_2[0];
+}else{
+_5=_1.config.cssPluginConfig;
+}
+var _6=_5.combos;
+for(var i=0;i<_6.length;i++){
+var _8=_6[i];
+var id="CSS-class"+i;
+var _a={id:id,options:_8.options,action:function(_b){
+_4.onSelect(_b,this,_8.context,_8.updatecontextclass);
+},refresh:function(_c){
+_4.updateValue(_c,this);
+},context:_8.context};
+_3.registerDropdown(_a);
+_3.addToolbarElement(["T["+_8.label+"]",id,"separator"],"formatblock",-1);
+}
+}
+CSS._pluginInfo={name:"CSS",version:"1.0",developer:"Mihai Bazon",developer_url:"http://dynarch.com/mishoo/",c_owner:"Mihai Bazon",sponsor:"Miro International",sponsor_url:"http://www.miro.com.au",license:"htmlArea"};
+CSS.prototype.onSelect=function(_d,_e,_f,_10){
+var _11=_d._toolbarObjects[_e.id];
+var _12=_11.element.selectedIndex;
+var _13=_11.element.value;
+var _14=_d.getParentElement();
+var _15=true;
+var _16=(_14&&_14.tagName.toLowerCase()=="span");
+var _17=(_f&&_10&&_14&&_14.tagName.toLowerCase()==_f);
+if(_17){
+_14.className=_13;
+_d.updateToolbar();
+return;
+}
+if(_16&&_12==0&&!/\S/.test(_14.style.cssText)){
+while(_14.firstChild){
+_14.parentNode.insertBefore(_14.firstChild,_14);
+}
+_14.parentNode.removeChild(_14);
+_d.updateToolbar();
+return;
+}
+if(_16){
+if(_14.childNodes.length==1){
+_14.className=_13;
+_15=false;
+_d.updateToolbar();
+}
+}
+if(_15){
+_d.surroundHTML("<span class='"+_13+"'>","</span>");
+}
+};
+CSS.prototype.updateValue=function(_18,obj){
+var _1a=_18._toolbarObjects[obj.id].element;
+var _1b=_18.getParentElement();
+if(typeof _1b.className!="undefined"&&/\S/.test(_1b.className)){
+var _1c=_1a.options;
+var _1d=_1b.className;
+for(var i=_1c.length;--i>=0;){
+var _1f=_1c[i];
+if(_1d==_1f.value){
+_1a.selectedIndex=i;
+return;
+}
+}
+}
+_1a.selectedIndex=0;
+};
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/popups/about.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/popups/about.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,301 @@
+<!--
+
+(c) dynarch.com, 2003-2004
+Author: Mihai Bazon, http://dynarch.com/mishoo
+Distributed as part of HTMLArea 3.0
+
+"You are not expected to understand this...  I don't neither."
+
+                      (from The Linux Kernel Source Code,
+                            ./arch/x86_64/ia32/ptrace.c:90)
+
+;-)
+
+-->
+
+<html>
+<head>
+<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
+<title>About Xinha</title>
+<script type="text/javascript" src="popup.js"></script>
+<script type="text/javascript">
+window.resizeTo(450, 365);
+var TABS = [];
+var CURRENT_TAB = 0;
+var CONTENT_HEIGHT_DIFF = 0;
+var CONTENT_WIDTH_DIFF = 0;
+function selectTab(idx) {
+  var ct = TABS[CURRENT_TAB];
+  ct.className = ct.className.replace(/\s*tab-current\s*/, ' ');
+  ct = TABS[CURRENT_TAB = idx];
+  ct.className += ' tab-current';
+  for (var i = TABS.length; --i >= 0;) {
+    var area = document.getElementById("tab-area-" + i);
+    if (CURRENT_TAB == i) {
+      area.style.display = "block";
+    } else {
+      area.style.display = "none";
+    }
+  }
+  document.body.style.visibility = "hidden";
+  document.body.style.visibility = "visible";
+  document.cookie = "HTMLAREA-ABOUT-TAB=" + idx;
+}
+var editor = null;
+function initDocument() {
+  editor = window.dialogArguments;
+  Xinha = window.opener.Xinha;
+
+  var plugins = document.getElementById("plugins");
+  var j = 0;
+  var html = "<table width='99%' cellpadding='2' cellspacing=2 style='margin-top: 1em; collapse-borders: collapse; border: 1px solid black;'>" +
+    "<thead><tr>" +
+    "<td>Name</td>" +
+    "<td>Developer</td>" +
+    "<td>Sponsored by</td>" +
+    "<td>License</td>" +
+    "</tr></thead><tbody>";
+  for (var i in editor.plugins) {
+    var info = editor.plugins[i];
+    if (typeof info != 'object' || !info.name || typeof info.name !='string')   continue;
+    html += "<tr><td>" + info.name + " v" + info.version + "</td>" +
+            "<td><a href='" + info.developer_url + "' target='_blank' title='Visit developer website'>" +
+      info.developer + "</a></td>" +
+      "<td><a href='" + info.sponsor_url + "' target='_blank' title='Visit sponsor website'>" +
+      info.sponsor + "</a></td>" +
+      "<td>" + info.license + "</td></tr>";
+    ++j;
+  }
+
+  if (j) {
+          html += "</tbody></table>" +
+      "<p>License \"htmlArea\" means that the plugin is distributed under the same terms " +
+      "as Xinha itself.</p>";
+    plugins.innerHTML = "<p>The following plugins have been loaded.</p>" + html;
+  } else {
+    plugins.innerHTML = "<p>No plugins have been loaded</p>";
+  }
+
+  plugins.innerHTML += "<p>User agent reports:<br/>" + navigator.userAgent + "</p>";
+
+  var content = document.getElementById("content");
+  if (window.innerHeight) {
+    CONTENT_HEIGHT_DIFF = window.innerHeight - 250;
+    CONTENT_WIDTH_DIFF = window.innerWidth - content.offsetWidth;
+  } else {
+    CONTENT_HEIGHT_DIFF = document.body.offsetHeight - 250;
+    CONTENT_WIDTH_DIFF = document.body.offsetWidth - 400;
+  }
+  window.onresize();
+  var bar = document.getElementById("tabbar");
+  j = 0;
+  for (var i = bar.firstChild; i; i = i.nextSibling) {
+    TABS.push(i);
+    i.__msh_tab = j;
+    i.onmousedown = function(ev) { selectTab(this.__msh_tab); Xinha._stopEvent(ev || window.event); };
+    var area = document.getElementById("tab-area-" + j);
+    if (/tab-current/.test(i.className)) {
+      CURRENT_TAB = j;
+      area.style.display = "block";
+    } else {
+      area.style.display = "none";
+    }
+    ++j;
+  }
+  if (document.cookie.match(/HTMLAREA-ABOUT-TAB=([0-9]+)/))
+    selectTab(RegExp.$1);
+}
+window.onresize = function() {
+  var content = document.getElementById("content");
+  if (window.innerHeight) {
+    content.style.height = (window.innerHeight - CONTENT_HEIGHT_DIFF) + "px";
+    content.style.width = (window.innerWidth - CONTENT_WIDTH_DIFF) + "px";
+  } else {
+    content.style.height = (document.body.offsetHeight - CONTENT_HEIGHT_DIFF) + "px";
+    //content.style.width = (document.body.offsetWidth - CONTENT_WIDTH_DIFF) + "px";
+  }
+}
+</script>
+<style>
+  html, body { height: 100%}
+  html,body,textarea,table
+  { font-family: helvetica,arial,sans-serif;
+    font-size: 11px; padding: 0px; margin: 0px;
+  }
+
+  body { padding: 0px; background: #f5f6f6; color: black; }
+  a:link, a:visited { color: #00f; }
+  a:hover           { color: #f00; }
+  a:active          { color: #f80; }
+  button            { font: 11px; border-width: 1px; background-color:#f5f6f6; color:black; }
+
+  p { margin: 0.5em 0px; }
+
+  #tdheader h1
+  { font: bold 40px "Staccato222 BT", cursive; margin: 0px; padding-left:4px; border-bottom: 1px solid #6a6; }
+  h1 { font: bold 20px; margin: 0px; border-bottom: 1px solid #6a6; }
+  h2 { font: bold 110%; margin: 0.7em 0px; }
+
+  thead {
+    font-weight: bold;
+    background-color: #CCC;
+  }
+
+  thead td { padding-left:4px; }
+
+  .buttons {
+    text-align: right; padding: 3px;
+    background-color: white;
+    border-top: 1px solid #555;
+  }
+
+  #tabbar {
+    position: relative;
+    left: 10px;
+  }
+  .tab {
+    color: #OOO;
+    cursor: pointer;
+    margin-left: -5px;
+    float: left; position: relative;
+    border: 1px solid #555;
+    top: -3px; left: -2px;
+    padding: 2px 10px 3px 10px;
+    border-top: none; background-color: #CCC;
+    -moz-border-radius: 0px 0px 4px 4px;
+    z-index: 0;
+  }
+  .tab-current
+  {
+    color: #000;
+    top: -4px;
+    background-color: #f5f6f6;
+    padding: 3px 10px 4px 10px;
+    z-index: 10;
+  }
+
+  li, ol, ul { margin-top: 0px; margin-bottom: 0px; }
+</style></head>
+<body onload="__dlg_init(); initDocument();"
+><table cellspacing="0" cellpadding="0" style="border-collapse: collapse;
+      width: 100%; height: 100%;">
+
+<tr style="height: 1em"><td id="tdheader">
+
+<h1><img src="../images/xinha_logo.gif" alt="Xinha" /></h1>
+
+</td></tr>
+<tr><td id="tdcontent" style="padding: 0.5em;">
+
+<div style="overflow: auto; height: 250px;" id="content">
+<div id="tab-areas">
+
+<div id="tab-area-0">
+
+  <p>A free WYSIWYG editor replacement for <tt>&lt;textarea&gt;</tt> fields.</p>
+  <p>Visit the <a href="http://xinha.gogo.co.nz/">Xinha Website</a> for more information.</p>
+
+  <p>
+   Use of Xinha is granted by the terms of the htmlArea License (based on BSD license)
+  </p>
+  <pre>
+   Copyright (c) 2005-2008 Xinha Developer Team and contributors
+  </pre>
+  <p>
+    Xinha was originally based on work by Mihai Bazon which is:
+  </p>
+  <pre>
+Copyright (c) 2003-2004 dynarch.com.
+Copyright (c) 2002-2003 interactivetools.com, inc.
+This copyright notice MUST stay intact for use.
+  </pre>
+</div>
+
+<div id="tab-area-1">
+
+  <p>
+   The development of Xinha would not have been possible without the original work of <a href="http://dynarch.com/">Mihai Bazon</a>, <a href="http://interactivetools.com" target="_blank">InteractiveTools.com</a>, and the many sponsors and contributors from around the world.
+  </p>
+
+</div>
+
+<div id="tab-area-2">
+<pre>htmlArea License (based on BSD license)
+Copyright (c) 2002-2004, interactivetools.com, inc.
+Copyright (c) 2003-2004 dynarch.com
+All rights reserved.
+
+Redistribution and use in source and binary forms, with or without
+modification, are permitted provided that the following conditions are met:
+
+1) Redistributions of source code must retain the above copyright notice,
+   this list of conditions and the following disclaimer.
+
+2) Redistributions in binary form must reproduce the above copyright notice,
+   this list of conditions and the following disclaimer in the documentation
+   and/or other materials provided with the distribution.
+
+3) Neither the name of interactivetools.com, inc. nor the names of its
+   contributors may be used to endorse or promote products derived from this
+   software without specific prior written permission.
+
+THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
+LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
+INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+POSSIBILITY OF SUCH DAMAGE.</pre>
+</div>
+
+<div id="tab-area-3">
+<div id="plugins">
+</div>
+</div>
+
+
+<div id="tab-area-4">
+  <script type="text/javascript">
+    if(window.opener && window.opener.Xinha)
+    {
+      var ver = window.opener.Xinha.version;
+      document.write('<pre>'
+                      + '\nRelease: ' + ver.Release + ' (' + ver.Date + ')'
+                      + '\nHead: ' + ver.Head
+                      + '\nRevision: ' + ver.Revision
+                      + '\nLast Changed By: ' + ver.RevisionBy
+                      + '\n' +
+                      '</pre>');
+    }
+    else
+    {
+      document.write('<pre>Version information unavailable.</pre>');
+    }
+  </script>
+</div>
+
+</div></div>
+
+
+</td></tr>
+<tr style="height: 1em"><td id="tdfooter">
+
+
+<div class="buttons">
+<div id="tabbar"
+><div class="tab tab-current"
+>About</div><div class="tab"
+>Thanks</div><div class="tab"
+>License</div><div class="tab"
+>Plugins</div><div class="tab"
+>Version</div></div>
+<button type="button" onclick="__dlg_close(null);">Close</button>
+</div>
+
+</td></tr></table>
+
+</body></html>
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/popups/blank.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/popups/blank.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,1 @@
+<html><body onload="window.xinhaReadyToRoll = true;"></body></html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/popups/editor_help.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/popups/editor_help.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,62 @@
+<html>
+ <head>
+  <title>Editor Help</title>
+  <script type="text/javascript" src="popup.js"></script>
+  <link rel="stylesheet" type="text/css" href="popup.css" />
+
+<script type="text/javascript">
+  window.resizeTo(400, 480);
+Xinha = window.opener.Xinha;
+function Init() {
+  __dlg_translate('Xinha');
+  __dlg_init();
+
+}
+
+
+function onCancel() {
+  __dlg_close(null);
+  return false;
+}
+
+</script>
+</head>
+
+<body class="dialog" onload="Init()">
+<div class="title">Xinha Help</div>
+<table width="100%" style="background: white none repeat scroll 0%;">
+  <thead style="border: 1px solid gray; background: silver none repeat scroll 0%;">
+  <tr>
+    <th colspan="2"> 
+      <span style="text-align:center">Keyboard shortcuts</span><br />
+      <span>The editor provides the following key combinations:</span>
+    </th>
+  </tr>
+  </thead>
+  <tbody>
+  <tr><td>ENTER</td><td><span>new paragraph</span>(&lt;P&gt;)</td></tr>
+  <tr><td>SHIFT-ENTER</td><td><span>insert linebreak</span>(&lt;BR&gt;)</td></tr>
+  <tr><td>CTRL-A</td><td><span>Select all</span></td></tr>
+  <tr><td>CTRL-B</td><td><span>Bold</span></td></tr>
+  <tr><td>CTRL-I</td><td><span>Italic</span></td></tr>
+  <tr><td>CTRL-U</td><td><span>Underline</span></td></tr>
+  <tr><td>CTRL-S</td><td><span>Strikethrough</span></td></tr>
+  <tr><td>CTRL-L</td><td><span>Justify Left</span></td></tr>
+  <tr><td>CTRL-E</td><td><span>Justify Center</span></td></tr>
+  <tr><td>CTRL-R</td><td><span>Justify Right</span></td></tr>
+  <tr><td>CTRL-J</td><td><span>Justify Full</span></td></tr>
+  <tr><td>CTRL-Z</td><td><span>Undoes your last action</span></td></tr>
+  <tr><td>CTRL-Y</td><td><span>Redoes your last action</span></td></tr>
+  <tr><td>CTRL-N</td><td><span>Set format to paragraph</span></td></tr>
+  <tr><td>CTRL-0 (zero)</td><td><span>Clean content pasted from Word</span></td></tr>
+  <tr><td>CTRL-1 .. CTRL-6</td><td><span>Headings</span> (&lt;h1&gt; .. &lt;h6&gt;)</td></tr>
+  <tr><td>CTRL-X</td><td><span>Cut selection</span></td></tr>
+  <tr><td>CTRL-C</td><td><span>Copy selection</span></td></tr>
+  <tr><td>CTRL-V</td><td><span>Paste from clipboard</span></td></tr>
+  </tbody>
+</table>
+<div id="buttons">
+  <button type="button" name="cancel" onclick="return onCancel();">Close</button>
+</div>
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/popups/popup.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/popups/popup.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,39 @@
+html, body, .dialog {
+  background: ButtonFace;
+  color: ButtonText;
+  font: 11px Tahoma,Verdana,sans-serif;
+  margin: 0px;
+  padding: 0px;
+}
+body { padding: 5px; }
+form { padding: 0px; margin: 0px; }
+form p {
+  margin-top: 5px;
+  margin-bottom: 5px;
+}
+table {
+  font: 11px Tahoma,Verdana,sans-serif;
+}
+select, input, button { font: 11px Tahoma,Verdana,sans-serif; }
+button { width: 70px; }
+table .label { text-align: right; width: 8em; }
+
+.fl { width: 9em; float: left; padding: 2px 5px; text-align: right; }
+.fr { width: 7em; float: left; padding: 2px 5px; text-align: right; }
+fieldset { padding: 0px 10px 5px 5px; }
+.space { padding: 2px; }
+.title { background: #ddf; color: #000; font-weight: bold; font-size: 120%; padding: 3px 10px; margin-bottom: 10px;
+border-bottom: 1px solid black; letter-spacing: 2px;
+}
+.buttonColor {
+  padding: 1px;
+  cursor: default;
+  border: 1px solid;
+  border-color: ButtonHighlight ButtonShadow ButtonShadow ButtonHighlight;
+}
+#buttons {
+      margin-top: 1em; 
+      border-top: 1px solid #999;
+      padding: 1em; 
+      text-align: right;
+}
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/popups/popup.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/popups/popup.js	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,108 @@
+/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
+/* This file is part of version 0.95 released Mon, 12 May 2008 17:33:15 +0200 */
+/* The URL of the most recent version of this file is http://svn.xinha.webfactional.com/trunk/popups/popup.js */
+if(typeof Xinha=="undefined"){
+Xinha=window.opener.Xinha;
+}
+HTMLArea=Xinha;
+function getAbsolutePos(el){
+var r={x:el.offsetLeft,y:el.offsetTop};
+if(el.offsetParent){
+var _3=getAbsolutePos(el.offsetParent);
+r.x+=_3.x;
+r.y+=_3.y;
+}
+return r;
+}
+function comboSelectValue(c,_5){
+var _6=c.getElementsByTagName("option");
+for(var i=_6.length;--i>=0;){
+var op=_6[i];
+op.selected=(op.value==_5);
+}
+c.value=_5;
+}
+function __dlg_onclose(){
+opener.Dialog._return(null);
+}
+function __dlg_init(_9,_a){
+__xinha_dlg_init(_a);
+}
+function __xinha_dlg_init(_b){
+if(window.__dlg_init_done){
+return true;
+}
+if(window.opener._editor_skin){
+var _c=document.getElementsByTagName("head")[0];
+var _d=document.createElement("link");
+_d.type="text/css";
+_d.href=window.opener._editor_url+"skins/"+window.opener._editor_skin+"/skin.css";
+_d.rel="stylesheet";
+_c.appendChild(_d);
+}
+if(!window.dialogArguments&&opener.Dialog._arguments){
+window.dialogArguments=opener.Dialog._arguments;
+}
+var _e=Xinha.pageSize(window);
+if(!_b){
+_b={width:_e.x,height:_e.y};
+}
+window.resizeTo(_b.width,_b.height);
+var _f=Xinha.viewportSize(window);
+window.resizeBy(0,_e.y-_f.y);
+if(_b.top&&_b.left){
+window.moveTo(_b.left,_b.top);
+}else{
+if(!Xinha.is_ie){
+var x=opener.screenX+(opener.outerWidth-_b.width)/2;
+var y=opener.screenY+(opener.outerHeight-_b.height)/2;
+}else{
+var x=(self.screen.availWidth-_b.width)/2;
+var y=(self.screen.availHeight-_b.height)/2;
+}
+window.moveTo(x,y);
+}
+Xinha.addDom0Event(document.body,"keypress",__dlg_close_on_esc);
+window.__dlg_init_done=true;
+}
+function __dlg_translate(_12){
+var _13=["input","select","legend","span","option","td","th","button","div","label","a","img"];
+for(var _14=0;_14<_13.length;++_14){
+var _15=document.getElementsByTagName(_13[_14]);
+for(var i=_15.length;--i>=0;){
+var _17=_15[i];
+if(_17.firstChild&&_17.firstChild.data){
+var txt=Xinha._lc(_17.firstChild.data,_12);
+if(txt){
+_17.firstChild.data=txt;
+}
+}
+if(_17.title){
+var txt=Xinha._lc(_17.title,_12);
+if(txt){
+_17.title=txt;
+}
+}
+if(_17.tagName.toLowerCase()=="input"&&(/^(button|submit|reset)$/i.test(_17.type))){
+var txt=Xinha._lc(_17.value,_12);
+if(txt){
+_17.value=txt;
+}
+}
+}
+}
+document.title=Xinha._lc(document.title,_12);
+}
+function __dlg_close(val){
+opener.Dialog._return(val);
+window.close();
+}
+function __dlg_close_on_esc(ev){
+ev||(ev=window.event);
+if(ev.keyCode==27){
+__dlg_close(null);
+return false;
+}
+return true;
+}
+
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/popups/select_color.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/popups/select_color.html	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,359 @@
+<!--<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">-->
+<html><head><title>Select Color</title>
+<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
+<script type="text/javascript" src="popup.js"></script>
+<script type="text/javascript">
+window.resizeTo(240, 182);
+// run on page load
+function Init()
+{
+  __dlg_translate('Xinha');
+  __dlg_init();
+  Xinha.addDom0Event(document, 'keypress', __dlg_close_on_esc);
+
+  var color = window.dialogArguments;
+  color = ValidateColor(color) || '000000';
+  View(color);
+}
+// preview color
+function View(color)
+{
+  document.getElementById("ColorPreview").style.backgroundColor = '#' + color;
+  document.getElementById("ColorHex").value = '#' + color;
+}
+// select color
+function Set(string)
+{
+  var color = ValidateColor(string);
+  if (color == null)
+  {
+    alert("Invalid color code: " + string);
+  }
+  else
+  {
+    View(color);
+    __dlg_close(color);
+  }
+}
+// return valid color code
+function ValidateColor(string)
+{
+  string = string || '';
+  string = string + "";
+  string = string.toUpperCase();
+  var chars = '0123456789ABCDEF';
+  var out   = '';
+  // remove invalid color chars
+  for (var i=0; i<string.length; i++)
+  {
+    var schar = string.charAt(i);
+    if (chars.indexOf(schar) != -1) out += schar;
+  }
+  // check length
+  if (out.length != 6) return null;
+  return out;
+}
+</script>
+<style type="text/css">
+body { background:buttonface; margin:0; padding:0; }
+form { margin:0; padding:0; }
+#containerpreview td { background:buttonface; }
+#preview { background-color:#000000; padding:1px; height:21px; width:50px; }
+#ColorPreview { height:100%; width:100%; }
+#ColorHex { font-size:12px; background:buttonface; border:0; }
+#palettecolor { cursor:pointer; }
+#palettecolor td { width:10px; height:10px; }
+</style>
+</head>
+<body class="dialog" onload="Init()">
+
+<form action="#" method="get" onsubmit="Set(document.getElementById('ColorHex').value); return false;">
+<table border="0" cellspacing="0" cellpadding="4" width="100%" id="containerpreview">
+ <tr>
+  <td style="vertical-align: middle;"><div id="preview"><div id="ColorPreview"></div></div></td>
+  <td style="vertical-align: middle;" width="100%"><input type="text" name="ColorHex"
+    id="ColorHex" value="" size=15></td>
+ </tr>
+</table>
+</form>
+
+<table id="palettecolor" border="0" cellspacing="1" cellpadding="0" width="100%" bgcolor="#000000">
+<tr>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#003300" onmouseover="View('003300')" onclick="Set('003300')"></td>
+<td bgcolor="#006600" onmouseover="View('006600')" onclick="Set('006600')"></td>
+<td bgcolor="#009900" onmouseover="View('009900')" onclick="Set('009900')"></td>
+<td bgcolor="#00CC00" onmouseover="View('00CC00')" onclick="Set('00CC00')"></td>
+<td bgcolor="#00FF00" onmouseover="View('00FF00')" onclick="Set('00FF00')"></td>
+<td bgcolor="#330000" onmouseover="View('330000')" onclick="Set('330000')"></td>
+<td bgcolor="#333300" onmouseover="View('333300')" onclick="Set('333300')"></td>
+<td bgcolor="#336600" onmouseover="View('336600')" onclick="Set('336600')"></td>
+<td bgcolor="#339900" onmouseover="View('339900')" onclick="Set('339900')"></td>
+<td bgcolor="#33CC00" onmouseover="View('33CC00')" onclick="Set('33CC00')"></td>
+<td bgcolor="#33FF00" onmouseover="View('33FF00')" onclick="Set('33FF00')"></td>
+<td bgcolor="#660000" onmouseover="View('660000')" onclick="Set('660000')"></td>
+<td bgcolor="#663300" onmouseover="View('663300')" onclick="Set('663300')"></td>
+<td bgcolor="#666600" onmouseover="View('666600')" onclick="Set('666600')"></td>
+<td bgcolor="#669900" onmouseover="View('669900')" onclick="Set('669900')"></td>
+<td bgcolor="#66CC00" onmouseover="View('66CC00')" onclick="Set('66CC00')"></td>
+<td bgcolor="#66FF00" onmouseover="View('66FF00')" onclick="Set('66FF00')"></td>
+</tr>
+<tr>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#333333" onmouseover="View('333333')" onclick="Set('333333')"></td>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#000033" onmouseover="View('000033')" onclick="Set('000033')"></td>
+<td bgcolor="#003333" onmouseover="View('003333')" onclick="Set('003333')"></td>
+<td bgcolor="#006633" onmouseover="View('006633')" onclick="Set('006633')"></td>
+<td bgcolor="#009933" onmouseover="View('009933')" onclick="Set('009933')"></td>
+<td bgcolor="#00CC33" onmouseover="View('00CC33')" onclick="Set('00CC33')"></td>
+<td bgcolor="#00FF33" onmouseover="View('00FF33')" onclick="Set('00FF33')"></td>
+<td bgcolor="#330033" onmouseover="View('330033')" onclick="Set('330033')"></td>
+<td bgcolor="#333333" onmouseover="View('333333')" onclick="Set('333333')"></td>
+<td bgcolor="#336633" onmouseover="View('336633')" onclick="Set('336633')"></td>
+<td bgcolor="#339933" onmouseover="View('339933')" onclick="Set('339933')"></td>
+<td bgcolor="#33CC33" onmouseover="View('33CC33')" onclick="Set('33CC33')"></td>
+<td bgcolor="#33FF33" onmouseover="View('33FF33')" onclick="Set('33FF33')"></td>
+<td bgcolor="#660033" onmouseover="View('660033')" onclick="Set('660033')"></td>
+<td bgcolor="#663333" onmouseover="View('663333')" onclick="Set('663333')"></td>
+<td bgcolor="#666633" onmouseover="View('666633')" onclick="Set('666633')"></td>
+<td bgcolor="#669933" onmouseover="View('669933')" onclick="Set('669933')"></td>
+<td bgcolor="#66CC33" onmouseover="View('66CC33')" onclick="Set('66CC33')"></td>
+<td bgcolor="#66FF33" onmouseover="View('66FF33')" onclick="Set('66FF33')"></td>
+</tr>
+<tr>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#666666" onmouseover="View('666666')" onclick="Set('666666')"></td>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#000066" onmouseover="View('000066')" onclick="Set('000066')"></td>
+<td bgcolor="#003366" onmouseover="View('003366')" onclick="Set('003366')"></td>
+<td bgcolor="#006666" onmouseover="View('006666')" onclick="Set('006666')"></td>
+<td bgcolor="#009966" onmouseover="View('009966')" onclick="Set('009966')"></td>
+<td bgcolor="#00CC66" onmouseover="View('00CC66')" onclick="Set('00CC66')"></td>
+<td bgcolor="#00FF66" onmouseover="View('00FF66')" onclick="Set('00FF66')"></td>
+<td bgcolor="#330066" onmouseover="View('330066')" onclick="Set('330066')"></td>
+<td bgcolor="#333366" onmouseover="View('333366')" onclick="Set('333366')"></td>
+<td bgcolor="#336666" onmouseover="View('336666')" onclick="Set('336666')"></td>
+<td bgcolor="#339966" onmouseover="View('339966')" onclick="Set('339966')"></td>
+<td bgcolor="#33CC66" onmouseover="View('33CC66')" onclick="Set('33CC66')"></td>
+<td bgcolor="#33FF66" onmouseover="View('33FF66')" onclick="Set('33FF66')"></td>
+<td bgcolor="#660066" onmouseover="View('660066')" onclick="Set('660066')"></td>
+<td bgcolor="#663366" onmouseover="View('663366')" onclick="Set('663366')"></td>
+<td bgcolor="#666666" onmouseover="View('666666')" onclick="Set('666666')"></td>
+<td bgcolor="#669966" onmouseover="View('669966')" onclick="Set('669966')"></td>
+<td bgcolor="#66CC66" onmouseover="View('66CC66')" onclick="Set('66CC66')"></td>
+<td bgcolor="#66FF66" onmouseover="View('66FF66')" onclick="Set('66FF66')"></td>
+</tr>
+<tr>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#999999" onmouseover="View('999999')" onclick="Set('999999')"></td>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#000099" onmouseover="View('000099')" onclick="Set('000099')"></td>
+<td bgcolor="#003399" onmouseover="View('003399')" onclick="Set('003399')"></td>
+<td bgcolor="#006699" onmouseover="View('006699')" onclick="Set('006699')"></td>
+<td bgcolor="#009999" onmouseover="View('009999')" onclick="Set('009999')"></td>
+<td bgcolor="#00CC99" onmouseover="View('00CC99')" onclick="Set('00CC99')"></td>
+<td bgcolor="#00FF99" onmouseover="View('00FF99')" onclick="Set('00FF99')"></td>
+<td bgcolor="#330099" onmouseover="View('330099')" onclick="Set('330099')"></td>
+<td bgcolor="#333399" onmouseover="View('333399')" onclick="Set('333399')"></td>
+<td bgcolor="#336699" onmouseover="View('336699')" onclick="Set('336699')"></td>
+<td bgcolor="#339999" onmouseover="View('339999')" onclick="Set('339999')"></td>
+<td bgcolor="#33CC99" onmouseover="View('33CC99')" onclick="Set('33CC99')"></td>
+<td bgcolor="#33FF99" onmouseover="View('33FF99')" onclick="Set('33FF99')"></td>
+<td bgcolor="#660099" onmouseover="View('660099')" onclick="Set('660099')"></td>
+<td bgcolor="#663399" onmouseover="View('663399')" onclick="Set('663399')"></td>
+<td bgcolor="#666699" onmouseover="View('666699')" onclick="Set('666699')"></td>
+<td bgcolor="#669999" onmouseover="View('669999')" onclick="Set('669999')"></td>
+<td bgcolor="#66CC99" onmouseover="View('66CC99')" onclick="Set('66CC99')"></td>
+<td bgcolor="#66FF99" onmouseover="View('66FF99')" onclick="Set('66FF99')"></td>
+</tr>
+<tr>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#CCCCCC" onmouseover="View('CCCCCC')" onclick="Set('CCCCCC')"></td>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#0000CC" onmouseover="View('0000CC')" onclick="Set('0000CC')"></td>
+<td bgcolor="#0033CC" onmouseover="View('0033CC')" onclick="Set('0033CC')"></td>
+<td bgcolor="#0066CC" onmouseover="View('0066CC')" onclick="Set('0066CC')"></td>
+<td bgcolor="#0099CC" onmouseover="View('0099CC')" onclick="Set('0099CC')"></td>
+<td bgcolor="#00CCCC" onmouseover="View('00CCCC')" onclick="Set('00CCCC')"></td>
+<td bgcolor="#00FFCC" onmouseover="View('00FFCC')" onclick="Set('00FFCC')"></td>
+<td bgcolor="#3300CC" onmouseover="View('3300CC')" onclick="Set('3300CC')"></td>
+<td bgcolor="#3333CC" onmouseover="View('3333CC')" onclick="Set('3333CC')"></td>
+<td bgcolor="#3366CC" onmouseover="View('3366CC')" onclick="Set('3366CC')"></td>
+<td bgcolor="#3399CC" onmouseover="View('3399CC')" onclick="Set('3399CC')"></td>
+<td bgcolor="#33CCCC" onmouseover="View('33CCCC')" onclick="Set('33CCCC')"></td>
+<td bgcolor="#33FFCC" onmouseover="View('33FFCC')" onclick="Set('33FFCC')"></td>
+<td bgcolor="#6600CC" onmouseover="View('6600CC')" onclick="Set('6600CC')"></td>
+<td bgcolor="#6633CC" onmouseover="View('6633CC')" onclick="Set('6633CC')"></td>
+<td bgcolor="#6666CC" onmouseover="View('6666CC')" onclick="Set('6666CC')"></td>
+<td bgcolor="#6699CC" onmouseover="View('6699CC')" onclick="Set('6699CC')"></td>
+<td bgcolor="#66CCCC" onmouseover="View('66CCCC')" onclick="Set('66CCCC')"></td>
+<td bgcolor="#66FFCC" onmouseover="View('66FFCC')" onclick="Set('66FFCC')"></td>
+</tr>
+<tr>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#FFFFFF" onmouseover="View('FFFFFF')" onclick="Set('FFFFFF')"></td>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#0000FF" onmouseover="View('0000FF')" onclick="Set('0000FF')"></td>
+<td bgcolor="#0033FF" onmouseover="View('0033FF')" onclick="Set('0033FF')"></td>
+<td bgcolor="#0066FF" onmouseover="View('0066FF')" onclick="Set('0066FF')"></td>
+<td bgcolor="#0099FF" onmouseover="View('0099FF')" onclick="Set('0099FF')"></td>
+<td bgcolor="#00CCFF" onmouseover="View('00CCFF')" onclick="Set('00CCFF')"></td>
+<td bgcolor="#00FFFF" onmouseover="View('00FFFF')" onclick="Set('00FFFF')"></td>
+<td bgcolor="#3300FF" onmouseover="View('3300FF')" onclick="Set('3300FF')"></td>
+<td bgcolor="#3333FF" onmouseover="View('3333FF')" onclick="Set('3333FF')"></td>
+<td bgcolor="#3366FF" onmouseover="View('3366FF')" onclick="Set('3366FF')"></td>
+<td bgcolor="#3399FF" onmouseover="View('3399FF')" onclick="Set('3399FF')"></td>
+<td bgcolor="#33CCFF" onmouseover="View('33CCFF')" onclick="Set('33CCFF')"></td>
+<td bgcolor="#33FFFF" onmouseover="View('33FFFF')" onclick="Set('33FFFF')"></td>
+<td bgcolor="#6600FF" onmouseover="View('6600FF')" onclick="Set('6600FF')"></td>
+<td bgcolor="#6633FF" onmouseover="View('6633FF')" onclick="Set('6633FF')"></td>
+<td bgcolor="#6666FF" onmouseover="View('6666FF')" onclick="Set('6666FF')"></td>
+<td bgcolor="#6699FF" onmouseover="View('6699FF')" onclick="Set('6699FF')"></td>
+<td bgcolor="#66CCFF" onmouseover="View('66CCFF')" onclick="Set('66CCFF')"></td>
+<td bgcolor="#66FFFF" onmouseover="View('66FFFF')" onclick="Set('66FFFF')"></td>
+</tr>
+<tr>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#FF0000" onmouseover="View('FF0000')" onclick="Set('FF0000')"></td>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#990000" onmouseover="View('990000')" onclick="Set('990000')"></td>
+<td bgcolor="#993300" onmouseover="View('993300')" onclick="Set('993300')"></td>
+<td bgcolor="#996600" onmouseover="View('996600')" onclick="Set('996600')"></td>
+<td bgcolor="#999900" onmouseover="View('999900')" onclick="Set('999900')"></td>
+<td bgcolor="#99CC00" onmouseover="View('99CC00')" onclick="Set('99CC00')"></td>
+<td bgcolor="#99FF00" onmouseover="View('99FF00')" onclick="Set('99FF00')"></td>
+<td bgcolor="#CC0000" onmouseover="View('CC0000')" onclick="Set('CC0000')"></td>
+<td bgcolor="#CC3300" onmouseover="View('CC3300')" onclick="Set('CC3300')"></td>
+<td bgcolor="#CC6600" onmouseover="View('CC6600')" onclick="Set('CC6600')"></td>
+<td bgcolor="#CC9900" onmouseover="View('CC9900')" onclick="Set('CC9900')"></td>
+<td bgcolor="#CCCC00" onmouseover="View('CCCC00')" onclick="Set('CCCC00')"></td>
+<td bgcolor="#CCFF00" onmouseover="View('CCFF00')" onclick="Set('CCFF00')"></td>
+<td bgcolor="#FF0000" onmouseover="View('FF0000')" onclick="Set('FF0000')"></td>
+<td bgcolor="#FF3300" onmouseover="View('FF3300')" onclick="Set('FF3300')"></td>
+<td bgcolor="#FF6600" onmouseover="View('FF6600')" onclick="Set('FF6600')"></td>
+<td bgcolor="#FF9900" onmouseover="View('FF9900')" onclick="Set('FF9900')"></td>
+<td bgcolor="#FFCC00" onmouseover="View('FFCC00')" onclick="Set('FFCC00')"></td>
+<td bgcolor="#FFFF00" onmouseover="View('FFFF00')" onclick="Set('FFFF00')"></td>
+</tr>
+<tr>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#00FF00" onmouseover="View('00FF00')" onclick="Set('00FF00')"></td>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#990033" onmouseover="View('990033')" onclick="Set('990033')"></td>
+<td bgcolor="#993333" onmouseover="View('993333')" onclick="Set('993333')"></td>
+<td bgcolor="#996633" onmouseover="View('996633')" onclick="Set('996633')"></td>
+<td bgcolor="#999933" onmouseover="View('999933')" onclick="Set('999933')"></td>
+<td bgcolor="#99CC33" onmouseover="View('99CC33')" onclick="Set('99CC33')"></td>
+<td bgcolor="#99FF33" onmouseover="View('99FF33')" onclick="Set('99FF33')"></td>
+<td bgcolor="#CC0033" onmouseover="View('CC0033')" onclick="Set('CC0033')"></td>
+<td bgcolor="#CC3333" onmouseover="View('CC3333')" onclick="Set('CC3333')"></td>
+<td bgcolor="#CC6633" onmouseover="View('CC6633')" onclick="Set('CC6633')"></td>
+<td bgcolor="#CC9933" onmouseover="View('CC9933')" onclick="Set('CC9933')"></td>
+<td bgcolor="#CCCC33" onmouseover="View('CCCC33')" onclick="Set('CCCC33')"></td>
+<td bgcolor="#CCFF33" onmouseover="View('CCFF33')" onclick="Set('CCFF33')"></td>
+<td bgcolor="#FF0033" onmouseover="View('FF0033')" onclick="Set('FF0033')"></td>
+<td bgcolor="#FF3333" onmouseover="View('FF3333')" onclick="Set('FF3333')"></td>
+<td bgcolor="#FF6633" onmouseover="View('FF6633')" onclick="Set('FF6633')"></td>
+<td bgcolor="#FF9933" onmouseover="View('FF9933')" onclick="Set('FF9933')"></td>
+<td bgcolor="#FFCC33" onmouseover="View('FFCC33')" onclick="Set('FFCC33')"></td>
+<td bgcolor="#FFFF33" onmouseover="View('FFFF33')" onclick="Set('FFFF33')"></td>
+</tr>
+<tr>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#0000FF" onmouseover="View('0000FF')" onclick="Set('0000FF')"></td>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#990066" onmouseover="View('990066')" onclick="Set('990066')"></td>
+<td bgcolor="#993366" onmouseover="View('993366')" onclick="Set('993366')"></td>
+<td bgcolor="#996666" onmouseover="View('996666')" onclick="Set('996666')"></td>
+<td bgcolor="#999966" onmouseover="View('999966')" onclick="Set('999966')"></td>
+<td bgcolor="#99CC66" onmouseover="View('99CC66')" onclick="Set('99CC66')"></td>
+<td bgcolor="#99FF66" onmouseover="View('99FF66')" onclick="Set('99FF66')"></td>
+<td bgcolor="#CC0066" onmouseover="View('CC0066')" onclick="Set('CC0066')"></td>
+<td bgcolor="#CC3366" onmouseover="View('CC3366')" onclick="Set('CC3366')"></td>
+<td bgcolor="#CC6666" onmouseover="View('CC6666')" onclick="Set('CC6666')"></td>
+<td bgcolor="#CC9966" onmouseover="View('CC9966')" onclick="Set('CC9966')"></td>
+<td bgcolor="#CCCC66" onmouseover="View('CCCC66')" onclick="Set('CCCC66')"></td>
+<td bgcolor="#CCFF66" onmouseover="View('CCFF66')" onclick="Set('CCFF66')"></td>
+<td bgcolor="#FF0066" onmouseover="View('FF0066')" onclick="Set('FF0066')"></td>
+<td bgcolor="#FF3366" onmouseover="View('FF3366')" onclick="Set('FF3366')"></td>
+<td bgcolor="#FF6666" onmouseover="View('FF6666')" onclick="Set('FF6666')"></td>
+<td bgcolor="#FF9966" onmouseover="View('FF9966')" onclick="Set('FF9966')"></td>
+<td bgcolor="#FFCC66" onmouseover="View('FFCC66')" onclick="Set('FFCC66')"></td>
+<td bgcolor="#FFFF66" onmouseover="View('FFFF66')" onclick="Set('FFFF66')"></td>
+</tr>
+<tr>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#FFFF00" onmouseover="View('FFFF00')" onclick="Set('FFFF00')"></td>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#990099" onmouseover="View('990099')" onclick="Set('990099')"></td>
+<td bgcolor="#993399" onmouseover="View('993399')" onclick="Set('993399')"></td>
+<td bgcolor="#996699" onmouseover="View('996699')" onclick="Set('996699')"></td>
+<td bgcolor="#999999" onmouseover="View('999999')" onclick="Set('999999')"></td>
+<td bgcolor="#99CC99" onmouseover="View('99CC99')" onclick="Set('99CC99')"></td>
+<td bgcolor="#99FF99" onmouseover="View('99FF99')" onclick="Set('99FF99')"></td>
+<td bgcolor="#CC0099" onmouseover="View('CC0099')" onclick="Set('CC0099')"></td>
+<td bgcolor="#CC3399" onmouseover="View('CC3399')" onclick="Set('CC3399')"></td>
+<td bgcolor="#CC6699" onmouseover="View('CC6699')" onclick="Set('CC6699')"></td>
+<td bgcolor="#CC9999" onmouseover="View('CC9999')" onclick="Set('CC9999')"></td>
+<td bgcolor="#CCCC99" onmouseover="View('CCCC99')" onclick="Set('CCCC99')"></td>
+<td bgcolor="#CCFF99" onmouseover="View('CCFF99')" onclick="Set('CCFF99')"></td>
+<td bgcolor="#FF0099" onmouseover="View('FF0099')" onclick="Set('FF0099')"></td>
+<td bgcolor="#FF3399" onmouseover="View('FF3399')" onclick="Set('FF3399')"></td>
+<td bgcolor="#FF6699" onmouseover="View('FF6699')" onclick="Set('FF6699')"></td>
+<td bgcolor="#FF9999" onmouseover="View('FF9999')" onclick="Set('FF9999')"></td>
+<td bgcolor="#FFCC99" onmouseover="View('FFCC99')" onclick="Set('FFCC99')"></td>
+<td bgcolor="#FFFF99" onmouseover="View('FFFF99')" onclick="Set('FFFF99')"></td>
+</tr>
+<tr>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#00FFFF" onmouseover="View('00FFFF')" onclick="Set('00FFFF')"></td>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#9900CC" onmouseover="View('9900CC')" onclick="Set('9900CC')"></td>
+<td bgcolor="#9933CC" onmouseover="View('9933CC')" onclick="Set('9933CC')"></td>
+<td bgcolor="#9966CC" onmouseover="View('9966CC')" onclick="Set('9966CC')"></td>
+<td bgcolor="#9999CC" onmouseover="View('9999CC')" onclick="Set('9999CC')"></td>
+<td bgcolor="#99CCCC" onmouseover="View('99CCCC')" onclick="Set('99CCCC')"></td>
+<td bgcolor="#99FFCC" onmouseover="View('99FFCC')" onclick="Set('99FFCC')"></td>
+<td bgcolor="#CC00CC" onmouseover="View('CC00CC')" onclick="Set('CC00CC')"></td>
+<td bgcolor="#CC33CC" onmouseover="View('CC33CC')" onclick="Set('CC33CC')"></td>
+<td bgcolor="#CC66CC" onmouseover="View('CC66CC')" onclick="Set('CC66CC')"></td>
+<td bgcolor="#CC99CC" onmouseover="View('CC99CC')" onclick="Set('CC99CC')"></td>
+<td bgcolor="#CCCCCC" onmouseover="View('CCCCCC')" onclick="Set('CCCCCC')"></td>
+<td bgcolor="#CCFFCC" onmouseover="View('CCFFCC')" onclick="Set('CCFFCC')"></td>
+<td bgcolor="#FF00CC" onmouseover="View('FF00CC')" onclick="Set('FF00CC')"></td>
+<td bgcolor="#FF33CC" onmouseover="View('FF33CC')" onclick="Set('FF33CC')"></td>
+<td bgcolor="#FF66CC" onmouseover="View('FF66CC')" onclick="Set('FF66CC')"></td>
+<td bgcolor="#FF99CC" onmouseover="View('FF99CC')" onclick="Set('FF99CC')"></td>
+<td bgcolor="#FFCCCC" onmouseover="View('FFCCCC')" onclick="Set('FFCCCC')"></td>
+<td bgcolor="#FFFFCC" onmouseover="View('FFFFCC')" onclick="Set('FFFFCC')"></td>
+</tr>
+<tr>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#FF00FF" onmouseover="View('FF00FF')" onclick="Set('FF00FF')"></td>
+<td bgcolor="#000000" onmouseover="View('000000')" onclick="Set('000000')"></td>
+<td bgcolor="#9900FF" onmouseover="View('9900FF')" onclick="Set('9900FF')"></td>
+<td bgcolor="#9933FF" onmouseover="View('9933FF')" onclick="Set('9933FF')"></td>
+<td bgcolor="#9966FF" onmouseover="View('9966FF')" onclick="Set('9966FF')"></td>
+<td bgcolor="#9999FF" onmouseover="View('9999FF')" onclick="Set('9999FF')"></td>
+<td bgcolor="#99CCFF" onmouseover="View('99CCFF')" onclick="Set('99CCFF')"></td>
+<td bgcolor="#99FFFF" onmouseover="View('99FFFF')" onclick="Set('99FFFF')"></td>
+<td bgcolor="#CC00FF" onmouseover="View('CC00FF')" onclick="Set('CC00FF')"></td>
+<td bgcolor="#CC33FF" onmouseover="View('CC33FF')" onclick="Set('CC33FF')"></td>
+<td bgcolor="#CC66FF" onmouseover="View('CC66FF')" onclick="Set('CC66FF')"></td>
+<td bgcolor="#CC99FF" onmouseover="View('CC99FF')" onclick="Set('CC99FF')"></td>
+<td bgcolor="#CCCCFF" onmouseover="View('CCCCFF')" onclick="Set('CCCCFF')"></td>
+<td bgcolor="#CCFFFF" onmouseover="View('CCFFFF')" onclick="Set('CCFFFF')"></td>
+<td bgcolor="#FF00FF" onmouseover="View('FF00FF')" onclick="Set('FF00FF')"></td>
+<td bgcolor="#FF33FF" onmouseover="View('FF33FF')" onclick="Set('FF33FF')"></td>
+<td bgcolor="#FF66FF" onmouseover="View('FF66FF')" onclick="Set('FF66FF')"></td>
+<td bgcolor="#FF99FF" onmouseover="View('FF99FF')" onclick="Set('FF99FF')"></td>
+<td bgcolor="#FFCCFF" onmouseover="View('FFCCFF')" onclick="Set('FFCCFF')"></td>
+<td bgcolor="#FFFFFF" onmouseover="View('FFFFFF')" onclick="Set('FFFFFF')"></td>
+</tr>
+</table>
+
+</body></html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/release-notes.txt
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/release-notes.txt	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,212 @@
+Xinha - The Community-Built Online HTML Editor
+
+For bug reports, forum, and updates go to 
+http://xinha.org
+
+Release History
+Xinha 0.95
+Bugs Fixed
+ * fixed #1040 htmlRemoveTags doesn't work in IE 
+ * fixed #645 IE Save as function only saves the original html 
+ * fixed #1136 FF3 Linux select boxes in toolbar are too small 
+ * fixed #1100 Extended File Manager - Error after opening window
+ * fixed #1103 [TransformInnerHTML] IE breaks singlet attributes starting with "no"
+ * fixed #1086 Repeated javascript insertion in onclick attributes
+ * fixed #1094 IE throws error in Xinha.loadStyle function
+ * fixed  #1117 IE returns javascript error -1072896658
+ * fixed #993 PageStyle to override styles in PageStylesheets
+ * #1112 switching between modes leaves strange characters in source 
+ * fixed #1128 loading fails when Fullscreen tried to load as plugin
+ * fixed #1126 Percent (%) in URL prevent stripSelfNamedAnchors from working  
+ * fixed #1120 HTML select overlaps color picker in IE6
+ * #1115 + #1127 fixed compatibility issues with Firefox 3
+ * #961 +  #1130 changed behaviour of xinha_config.baseHref
+ * fixed #645 Save as function only saves the original html
+ * fixed #1040 htmlRemoveTags doesn't work in IE
+ * fixed #1015 Mozilla shows scrollbars on click in Stylist 
+ * #918 removed mozParaHandler dirty as it had been broken for a long time
+ * fixed #1015 Mozilla shows scrollbars on click in Stylist 
+ * fixed #1148 HTML entities break when cursor is inside when switching from HTML to WYSIWYG 
+ * fixed #1151 form action always made absolute
+ * fixed #1155 InsertAnchor broken in IE 7
+ * fixed #1158 [ImageManager] in Japanese environment, an error occurs by reading of lang/ja.js in IE6/7 
+ * fixed #1152 Plugins using surroundHTML (EditTag, LangMarks) no longer work in IE7
+ * fixed #1161 permission error from ColorPicker.js
+ * fixed #1181 [TableOperations] Table Options dialog first entry for border style faulty
+ * fixed #1185 [TableOperations] IE: style float broken
+ * fixed #1197 [Linker] IE shows bug in line 262
+ * fixed #1200 [Linker] Dialog does not show if scanned folder empty
+ 
+Enhancements
+ * #1143 add Safari support
+ * #938  add Opera support
+ * #1138 added API functions Xinha.getEditor(), Xinha.prototype.getPluginInstance(), Xinha.addOnloadHandler() 
+ * #1137 [Equation] FF3 fixes & improved way of avoiding formula changes in editor
+ * #1150 synchronize "Remove Format" between browsers
+ * added plugin PreserveScripts for enhanced editing of pages containing PHP and/or JavaScript ()
+ * Loading message facelift
+ * added XinhaLoader.js for enhanced user experience through early loading message
+ * made Xinha.makeEditors accept a DOM reference to the textarea instead of the id as part of xinha_editors array (#1105)
+ * #1123 Allow return of PHP array from xinha_pass_to_php_backend
+ * [Linker] scan.php: Allow specification of base url to use (so that a subdirectory can be used as $dir and return appropriate urls to the files (prefixing the url
+ * [ExtendedFileManager] new Version
+ * #961 +  #1130 changed behaviour of xinha_config.baseHref
+ * #1137 [Equation] improved way of avoiding formula changes in editor
+ * #442 removed alert "Your Document is not well formed..."
+ * #1119 disabled Firefox 2 spell check when ContextMenu is enabled 
+ * added a plugin "GenericPlugin" as a democase for plugin event handlers
+ * #1171 [SmartReplace] now also replaces three dots with an ellipsis
+ * #1119 [ContextMenu] optionally switch of Firefox Spell check
+ * #1172 [LangMarks] make available languages configurable
+ * enhanced behaviour when xinha_config.baseHref is set to another server
+ * #1195 Allow to specify an external url to load a plugin from
+ * #1201 Add inwardHtml/outwardHtml functions to Config object
+ 
+I18n
+ * #1109 Spanish language extended
+ * #1116 [ExtendedFileManager] added French translation
+ * #853 updated Translation for farsi
+ * fixed wrong encoding in Spanish language file 
+ * fixed no bold/italic/underline button images in Spanish
+ *  #1194 [ExtendedFileManager] updated French translation
+
+ 
+Xinha 0.94
+ * Ticket #1093 [InsertSmiley] remove smiley gifs from trunk
+ * fixed Ticket #1019 Cusor not jumping to editable part of window when clicked in IE
+ * [TableOperations] Add config option to not dispaly toolbar buttons
+ * fixed Ticket #1021  Prevent ExtendedFileManager from masking ImageManager
+ * fixed Ticket #1023 [ImageManager] Add config item to allow the advanced image options to be hidden from the user
+ * fixed Ticket #1026 fix problems with loading skins
+ * fixed Tickets #1030 & #1031: slow loading large pages in IE
+ * fixed Ticket #1034 [ExtendedFileManager] Color pickers shown when use_color_pickers is false
+ * fixed Ticket #1035 [TransformInnerHTML] tags corruptedunder certain circumstances
+ * fixed Ticket #1036 [ExtendedFileManager] window is only resized after all thumbnails have benn loaded, which can take quite some time
+ * fixed Ticket #1039 Firefox full page adds multiple paragraphs after view source
+ * fixed Ticket #1019 Cusor not jumping to editable part of window when clicked in IE7
+ * fixed Ticket #1046 Error in IE 6 when switching from text to wysiwyg
+ * [DOMwalk] linebreaks inserted before <br />s
+ * catch error in IE when trying to restore selection on non-displayed area
+ * fixed Ticket #973 Error switching wysiwyg/html including javascript file on the code
+ * fixed Ticket #1028  - [Linker] automatically (attempt to) work around an issue with mod_security being triggered because of the charset on our POST requests
+ * fixed Ticket #1055 [Stylist] Inappropriate styles (for other tags) are shown
+ * added Dutch language files
+ * added new hook 'onBeforeSubmit' for firePluginEvent()
+ * added new hook 'onBeforeUnload' for firePluginEvent()
+ * fixed Ticket #1048 Full Screen plugin doesn't load if many editors on page
+ * fixed Ticket #1053 ListType plugin doesn't work in panel config with multiple editors
+ * fixed Ticket #1026 Skins referenced with <link>-tags don't work anymore
+ * fixed Ticket #1059 [Equation] loosing formula onsubmit
+ * fixed Ticket #1060 [Equation] various updates
+ * [Equation] preserve formula on reload in Mozilla
+ * [Equation] updated ASCIIMathML.js
+ * [Skin:silva] padding and border on textarea make the textmode too wide 
+ * fixed Ticket#1001 Editor loads a bunch of null urls in ie
+ * fixed Ticket #1068 [TranformInnerHTML] newlines added after </script>
+ * fixed Ticket#1069 Editor document URL prefixed to any href that only consists of URL parameters
+ * added Thai translation for core
+ * added complete Portuguese Brazilian translation
+ * updated lc_parse script
+ * fixed Ticket #1071 [ExtendedFileManager] external image URL image inserted with width/height 0, amking it invisible
+ * fixed Ticket #1074 [SuperClean] throws warnings in PHP 5
+ * fixed Ticket #1079 [DynamicCSS] lists Xinha internal CSS
+ * fixed Ticket #1080 Some plugins leave behind stylesheet links in fullpage mode
+ * fixed Ticket #1083 Convert URLs to links - Error
+ * fixed Ticket #1084 URL auto-linking (Gecko): URLs with user:password@domain.tld falsely recognized as email address
+ * fixed Ticket #1085 URL auto-linking (Gecko): IP numbers don't work
+ * fixed Ticket #1081 Control character is not being removed inside SCRIPT tags or HEAD when switching from textmode to htmlmode
+ * fixed Ticket #1078 [InsertImage] spacing attributes: inconsistent behaviour when editing image
+ * fixed Ticket #1089 [Color Picker] Localize OK Label
+ * fixed Ticket #1091 [SaveSubmit] does not correctly submit value of checkboxes and radio buttons
+
+Xinha 0.93
+ - fixed Ticket #967 Font Color Picker stops working after using one of ImageManager, ExtendedFileManager, FullPage, or HorizontalRule
+ - fixed Ticket #965 When switching between Xinhas in the same page, in textmode toolbar stays disabled
+ - fixwd Ticket #963 DOMwalk IE: head tag attributes without quotes and closing slash
+ - Ticket #962 DOMwalk Mozilla: improved source indentation
+ - fixed Ticket #957 If item in in xinha_editors is not a textarea: skip gracefully
+ - fixed Ticket #900: catch an fatal error that occured sometimes when switching between modes in fullpage mode in Mozilla
+ - fixed Ticket #969 DOMwalk Gecko: line breaks rendered as <br>s inside <pre> blocks
+ - fixed Ticket #976 Loading message misplaced in IE7
+ - fixed Ticket #977 TableOperations toolbar off-place in ext_example.html
+ - fixed Ticket #978 defining a padding for <td>s in global css affects Xinha framework
+ - Ticket #979 improve checking for non-supported browsers
+ - fixed Ticket #934 SuperClean plugin returns just quotation when executed on localhost
+ - Ticket #929 Save changes on page unload fixed for Mozilla 
+ - fixed Ticket #980 ImageManager color format bug
+ - fixed Ticket #981 No doctype in iframe content document/ editor always in quirks mode
+ - fixed Ticket #543 Stylist Panel overflow broken
+ - Ticket #983 added id for iframe
+ - fixed Ticket #984 !ExtendedFileManager produces php warning
+ - optimized icon file size
+ - fixed !JavaScript error in !ImageManager/!ExtendedFileManager image editor
+ - Ticket #908* Prompts broken in IE7: fixed for EFM, !ImageManager & !TableOperations
+ - Fixes for TableOperations, tickets #82, #908*, #912 and #947
+ - fixed Ticket #998* whitespace added before and/or after content (in non-fullpage mode)
+ - fixed slow unloading in Mozilla
+ - Fix focus problem when switching from html to wysiwyg in Gecko. See ticket #900.
+ - fixed toolbar floating issue
+ - fixed #1003 HTML length limited to 1024 characters with plugin CharCounter
+ - Ticket #1000 new public methods for getting/setting editor content
+ - fixed #735 - IE eating scripts and comments at the beginning of pages.
+ - Added new config variables to set iframe width if less than editor width (ticket:322) and set alignment of toolbar buttons.
+ - added Basque translation for XinhaCore
+ - prevent an error if server is set to parse .js files as PHP
+ - Ticket #127 plugin HtmlEntities: Entities.js  file corrupt
+
+Xinha 0.92beta
+ - fixed Ticket #831 stop empty anchors from being removed
+ - Make htmlarea.js just load XinhaCore.js instead of being a copy of it.
+ - fixed Ticket #445 Toggle TableBorder doesn't work if this.fullpage=true or using FullPage plugin
+ - fixed Ticket #551 shape and coord attributes of area element are ignored by IE
+ - fixed Ticket #650 SpellChecker is not compatible with FullPage plugin
+ - fixed Ticket #816 CharacterMap and ListType panel modes make editor jump to top in IE
+ - fixed Ticket #570 change behaviour of justify when an image is selected to make the image float left/right, 
+   click the justify button again to undo it
+ - fixed Ticket #891 noscript content got escaped
+ - fixed Ticket #857 Firefox fails to load in fullpage mode when <link ..> tag in wrong place.
+ - fixed Ticket #841 Spell Checker - Won't return to xinha.
+ - fixed Ticket #914 All buttons stay grey & this.getParentElement is not a function message when not calling
+   Xinha.loadPlugins() in xinha_init function
+ - fixed Ticket #911 Background color does not work in Firefox
+ - fixed Ticket #912 an error is thrown in Mozilla when clicking merge cells button and fewer than 2 cells are selected
+ - fixed Ticket #816 CharacterMap and ListType panel modes make editor jump to top in IE
+ - fixed Ticket #917 getHTMLWrapper in IE renders attributes like _stylist_usedtobe="[object Object]"
+ - fixed Ticket #556 stripBaseHref didn't work without baseHref defined explicitly.
+ - Update InsertPicture plugin Update
+ - fixed Ticket #921 EFM extended file manager - iframe height problem (IE)
+ - Ticket #923 colorPicker face lift & localisation
+ - fixed Ticket #924 EFM + ImageManager re-transforming of url to original image after automatic resize broken
+ - Ticket #900- retain editing position position between modes
+ - fixed Ticket #928 ImageManager fails if (another) Files.php exists in include path
+ - fixed Ticket #935 EFM demo_images php upload allowed: possible security risk
+ - Ticket #939 Japanese langage support 
+ - fixed Ticket #3 Horizontal Rule Selection
+ - Plugin ExtendedFileManager: added doc to allowed upload extensions
+ - Plugin PasteText update
+ - Plugin HtmlEntities: default preset iso-8859-1
+ - fixed Ticket #948 IE: inline styles are not rendered by DOMwalk getHTML()
+ - Plugin HorizontalRule update
+ - Plugin SaveSubmit update
+ - Plugin Linker update
+ - fixed Ticket #823 editor contents was not submitted when using JavaScript form.submit() without prior form.onsubmit()
+ - fixed Ticket #459 all body attributes removed in full page mode in FireFox
+ - _editor_url is now converted to absolute if it is relative. 
+ - fixed Ticket #594 IE: insertHTML() inserts HTML outside editor when editor is not focussed
+ - Ticket #954 FullScreen mode can now be called programmatically or on startup with or without button
+ - fixed Ticket #321 FullScreen : select elements show through in IE6 
+ - fixed Ticket #953 Statusbar has ugly white gap at the bottom when switching back from full screen in IE 
+ - fixed Ticket #952 FullScreen: scrollbars don't disappear in IE in QuirksMode
+ - fixed Ticket #603 Popop Dialog Height problems
+ - fixed Ticket #955 DOMwalk getHTML outputs empty attribute with value "true" instead of attribute name and some are skipped at all
+ 
+Xinha 0.91beta
+ - changed namespace from HTMLArea to Xinha
+ - the core file is now named XinhaCore.js instead of htmlarea.js,
+   please change your pages accordingly (the htmlarea.js will be removed!)
+ - the color picker script is now loaded on demand to reduce initial loading time
+ 
+Xinha 0.9beta
+This equals Xinha revision 635 of Jan 11 2007
+ - All JavaScript files over 2kb have been compressed using the dojo JavaScript compressor
+ - All gifs have been optimized using Trout's GIF Optimizer version 2.3
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/blue-look/button-background.png
Binary file Xinha_0.95/skins/blue-look/button-background.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/blue-look/separator.gif
Binary file Xinha_0.95/skins/blue-look/separator.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/blue-look/skin.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/skins/blue-look/skin.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,98 @@
+.htmlarea .toolbar, .htmlarea .toolbar .button
+{
+  background-color:#f7f8fd;
+}
+
+.htmlarea .toolbarRow
+{
+  margin-top:2px;
+  margin-bottom:2px;
+  border:1px dotted #DEDEDE;
+  padding:2px;
+  -moz-border-radius:3px;
+  margin:4px;
+  height:25px;
+}
+
+.htmlarea .toolbar .button
+{
+  background-image: url(button-background.png);
+  width:20px;
+  height:20px;
+  padding:0px;
+  border:1px solid #f7f8fd;
+}
+
+.buttonImageContainer
+{
+  position:relative;
+  left:1px;
+  top :1px;
+}
+
+.htmlarea .toolbar .separator {
+  margin:0px;
+  background-image: url(separator.gif);
+  border:1px #f7f8fd;
+  width:   7px;
+  height: 20px;
+  padding: 0px;
+}
+
+.htmlarea .toolbar a.button:hover
+{
+  border: 1px solid;
+  border-color: white #CCC #CCC white;
+}
+
+.htmlarea .toolbar a.buttonDisabled:hover
+{
+  border-color: #f7f8fd;
+}
+
+.htmlarea .toolbar .button.buttonActive,
+.htmlarea .toolbar .button.buttonPressed
+{
+  border: 1px solid;
+  border-color: #CCC white white #CCC;
+}
+
+.htmlarea .statusBar {
+  border-color: #CCC white white #CCC;
+  padding: 0px;
+  height:20px;
+  background-image: url(button-background.png);
+  background-repeat: repeat-x;
+  background-color: #f7f8fd;
+  color: ButtonText;
+  font: 11px helvetica,arial,sans-serif;
+}
+
+.htmlarea .statusBar .statusBarTree
+{
+  display:block;
+  margin: 3px;
+}
+
+.htmlarea .statusBar .statusBarTree a
+{
+  padding: 2px 5px;
+  color: #00f;
+  text-decoration:none;
+}
+
+.htmlarea .panel h1
+{
+  background-image: url('button-background.png');
+  background-repeat: repeat-x;
+  background-color: #f7f8fd;
+}
+.dialog {
+  background-color:#f7f8fd;
+}
+.dialog .title {
+  background-image: url(button-background.png);
+}  
+.dialog button{
+  background-image: url(button-background.png);
+}
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/blue-metallic/button-background.png
Binary file Xinha_0.95/skins/blue-metallic/button-background.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/blue-metallic/separator.gif
Binary file Xinha_0.95/skins/blue-metallic/separator.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/blue-metallic/skin.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/skins/blue-metallic/skin.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,96 @@
+.htmlarea .toolbar { background-color:#f7f8fd;}
+
+.htmlarea .toolbarRow
+{
+  /*background-image: url(button-background.png);*/
+  background-color: #C5DCEC;
+  margin-top:2px;
+  margin-bottom:2px;
+  border:1px solid #7A8A99;
+  padding:2px;
+  -moz-border-radius:4px;
+  margin:4px;
+  height:25px;
+}
+
+.htmlarea .toolbar .button {
+  background-image: url(button-background.png);
+  width:20px;
+  height:21px;
+  padding:1px;
+  border:0px;
+}
+
+.buttonImageContainer
+{
+  position:relative;
+  left:1px;
+  top :1px;
+}
+
+.htmlarea .toolbar .separator
+{
+  margin:0px;
+  background-image: url(separator.gif);
+  border:1px #f7f8fd;
+  width:   7px;
+  height: 21px;
+  padding: 0px;
+}
+
+.htmlarea .toolbar a.button:hover,
+.htmlarea .toolbar a.buttonDisabled:hover
+{
+  padding: 0px;
+  border: 1px solid;
+  border-color: #7A8A99;
+}
+
+.htmlarea .toolbar .button.buttonActive,
+.htmlarea .toolbar .button.buttonPressed
+{
+  padding: 0px;
+  border: 1px solid;
+  border-color: #79A4CC #FFFFFF #FFFFFF #79A4CC;
+}
+
+.htmlarea .statusBar {
+  border-color: #CCC white white #CCC;
+  padding: 0px;
+  height:20px;
+  background-image: url(button-background.png);
+  background-repeat: repeat-x;
+  background-color: #f7f8fd;
+  color: ButtonText;
+  font: 11px helvetica,arial,sans-serif;
+}
+
+.htmlarea .statusBar .statusBarTree
+{
+  display:block;
+  margin: 3px;
+}
+
+.htmlarea .statusBar .statusBarTree a
+{
+  padding: 2px 5px;
+  color: #00f;
+  text-decoration:none;
+}
+
+.htmlarea .panel h1
+{
+  background-image: url('button-background.png');
+  background-repeat: repeat-x;
+  background-color: #f7f8fd;
+}
+
+.dialog {
+  background-color: #EEEEEE;
+}
+.dialog .title {
+  background-image: url(button-background.png);
+}
+.dialog button{
+  background-image: url(button-background.png);
+}
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/green-look/button-background.gif
Binary file Xinha_0.95/skins/green-look/button-background.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/green-look/separator.gif
Binary file Xinha_0.95/skins/green-look/separator.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/green-look/skin.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/skins/green-look/skin.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,88 @@
+.htmlarea .toolbar, .htmlarea .toolbar .button
+{
+  background-color:#f8fdf8;
+}
+.htmlarea .toolbarRow
+{
+  margin-top:2px;
+  margin-bottom:2px;
+  border:1px dotted #DEDEDE;
+  padding:2px;
+  -moz-border-radius:3px;
+  margin:4px;
+  height:25px;
+}
+.htmlarea .toolbar .button
+{
+  background-image:url(button-background.gif);
+  width:20px;
+  height:20px;
+  padding:0;
+  border:1px solid #f8fdf8;
+}
+.buttonImageContainer
+{
+  position:relative;
+  left:1px;
+  top:1px;
+}
+.htmlarea .toolbar .separator {
+  margin:0;
+  background-image:url(separator.gif);
+  border:1px #f8fdf8;
+  width:7px;
+  height:20px;
+  padding:0;
+}
+.htmlarea .toolbar a.button:hover
+{
+  border:1px solid;
+  border-color:#fff #ccc #ccc #fff;
+}
+.htmlarea .toolbar a.buttonDisabled:hover
+{
+  border-color:#f8fdf8;
+}
+.htmlarea .toolbar .buttonActive,
+.htmlarea .toolbar .buttonPressed
+{
+  border:1px solid;
+  border-color:#ccc #fff #fff #ccc;
+  background:#ffb166;
+}
+.htmlarea .statusBar {
+  border-color:#ccc #fff #fff #ccc;
+  padding:0;
+  height:20px;
+  background-image:url(button-background.gif);
+  background-repeat:repeat-x;
+  background-color:#f8fdf8;
+  color:ButtonText;
+  font:11px helvetica,arial,sans-serif;
+}
+.htmlarea .statusBar .statusBarTree
+{
+  display:block;
+  margin:3px;
+}
+.htmlarea .statusBar .statusBarTree a
+{
+  padding:2px 5px;
+  color:#00f;
+  text-decoration:none;
+}
+.htmlarea .panel h1
+{
+  background-image:url(button-background.gif);
+  background-repeat:repeat-x;
+  background-color:#f8fdf8;
+}
+.dialog {
+  background-color:#f8fdf8;
+}
+.dialog .title {
+  background-image: url(button-background.png);
+}  
+.dialog button{
+  background-image: url(button-background.png);
+}
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/inditreuse/back.png
Binary file Xinha_0.95/skins/inditreuse/back.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/inditreuse/button-background.png
Binary file Xinha_0.95/skins/inditreuse/button-background.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/inditreuse/hover.png
Binary file Xinha_0.95/skins/inditreuse/hover.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/inditreuse/readme
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/skins/inditreuse/readme	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,9 @@
+Skin inditreuse
+Author: Kyle Kochis (http://completesiteservices.com/)
+This work is licensed under the Creative Commons Attribution-ShareAlike License.
+To view a copy of this license, visit http://creativecommons.org/licenses/by-sa/2.0/
+or send a letter to
+Creative Commons,
+559 Nathan Abbott Way
+Stanford, California 94305
+USA
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/inditreuse/selected.png
Binary file Xinha_0.95/skins/inditreuse/selected.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/inditreuse/separator.png
Binary file Xinha_0.95/skins/inditreuse/separator.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/inditreuse/skin.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/skins/inditreuse/skin.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,73 @@
+.htmlarea .toolbar {
+	background-color:#889fc9;
+  background-image:url(back.png);
+  background-repeat:repeat-y;
+}
+.htmlarea .toolbarRow {
+  margin-top:2px;
+  margin-bottom:2px;
+  background-image:url(button-background.png);
+  height:25px;
+}
+.htmlarea .toolbar .button {
+  width:20px;
+  height:20px;
+  padding:1px;
+  border:none;
+  background-image:url(button-background.png);
+}
+.buttonImageContainer {
+  position:relative;
+  left:1px;
+  top:1px;
+}
+.htmlarea .toolbar .separator {
+  margin:0;
+  background-image: url(separator.png);
+  width:7px;
+  height:20px;
+  padding:1px;
+  border:none;
+}
+.htmlarea .toolbar a.button:hover {
+  border:none !important;
+  padding:1px;
+  background-image:url(hover.png);
+}
+.htmlarea .toolbar .button.buttonPressed
+{
+  padding:1px;
+  background-image:url(selected.png);
+}
+.htmlarea .statusBar {
+  padding:0;
+  height:20px;
+  background-image:url(button-background.png);
+  background-repeat:repeat-x;
+  background-color:#889fc9;
+  color:ButtonText;
+  font:11px helvetica,arial,sans-serif;
+}
+.htmlarea .statusBar .statusBarTree {
+  display:block;
+  margin:3px;
+}
+.htmlarea .statusBar .statusBarTree a {
+  padding:2px 5px;
+  color:#00f;
+  text-decoration:none;
+}
+.htmlarea .panel h1 {
+  background-image:url(button-background.png);
+  background-repeat:repeat-x;
+  background-color:#889fc9;
+}
+.dialog {
+  background-color:#889fc9;
+}
+.dialog .title {
+  background-image: url(button-background.png);
+}  
+.dialog button{
+  background-image: url(button-background.png);
+}
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/silva/dialog.jpg
Binary file Xinha_0.95/skins/silva/dialog.jpg has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/silva/html.gif
Binary file Xinha_0.95/skins/silva/html.gif has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/silva/skin.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/skins/silva/skin.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,172 @@
+/*--------------------------------*/ 
+/*      silva skin for Xinha      */ 
+/*                                */ 
+/*      by Raimund Meyer (ray)    */ 
+/*      xinha@raimundmeyer.de     */
+/*           2007-1-9             */ 
+/*--------------------------------*/ 
+
+.htmlarea .toolbar, .htmlarea .toolbar .button
+{
+  background-color:transparent;
+}
+.htmlarea .toolbar
+{
+  padding:0;
+  background-image: url(toolbar.png);
+}
+.htmlarea .toolbarRow
+{
+  margin-top:0px;
+  margin-bottom:0px;
+  border:1px solid #F1F1F1;
+  padding:0px;
+  -moz-border-radius:15px;
+  margin:4px;
+  height:20px;
+}
+/* hack: IE6 does not know border-color: transparent;*/
+html > body .htmlarea .toolbarRow {
+  border-color: transparent;
+}
+
+.htmlarea .toolbar .button
+{
+  width:18px;
+  height:18px;
+  padding:1px 2px 2px 1px ;
+  border: solid #F1F1F1;
+  border-width:1px;
+}
+
+html > body .htmlarea .toolbar .button {
+  border-color: transparent;
+}
+
+.buttonImageContainer
+{
+  position:relative;
+  left:1px;
+  top :1px;
+}
+
+.htmlarea .toolbar a.button:hover
+{
+  border: solid 1px;
+  border-color: black;
+}
+.htmlarea .toolbar a.buttonDisabled:hover
+{
+  border: solid transparent 1px;
+}
+
+.htmlarea .toolbar .button.buttonActive,
+.htmlarea .toolbar .button.buttonPressed
+{
+  border: black dotted 1px;
+  padding:2px 1px 1px 2px;  
+}
+
+.htmlarea .toolbar .button.buttonPressed {
+  padding:1px 2px 2px 1px ;
+}
+.htmlarea .toolbar .separator {
+  margin: 3px;
+  border-left: 1px dotted black;
+  border-right: none;
+  width: 1px;
+  height: 11px;
+  padding: 0px;
+}
+
+.htmlarea .statusBar {
+  border-color: #CCC white white #CCC;
+  padding: 0px;
+  height:20px;
+  background-image: url(statusbar.png);
+  background-repeat: repeat-x;
+  background-color: white;
+  color: grey;
+  font: 11px Arial,Helvetica,sans-serif;
+  vertical-align: middle;
+}
+
+.htmlarea .statusBar .statusBarTree
+{
+  display:block;
+  margin: 3px;
+}
+.htmlarea .statusBar span {
+ display:none;
+}
+.htmlarea .statusBar .statusBarTree a
+{
+  padding: 0 5px;
+  color: green;
+  text-decoration:none;
+  letter-spacing:0.15em;
+  font-size:120%;
+  border: none;
+  padding: 2px 5px;
+}
+.htmlarea .statusBar .statusBarTree a:visited { color:green; }
+.htmlarea .statusBar .statusBarTree a:hover {
+  background-color: transparent;
+  color: green;
+  border: none;
+  padding: 1px 5px;
+}
+
+.dialog {
+  /* background: url(dialog.jpg) #f0f0f0 no-repeat; */
+  background-color: #f0f0f0;
+ }
+body.dialog {
+	padding-top:0;
+}
+.dialog, .dialog button, .dialog input, .dialog select, .dialog textarea, .dialog table,.dialog td,.dialog th, .panel {
+  font: 11px Arial,Helvetica,sans-serif !IMPORTANT;
+}
+.panel a {
+  color:#444;
+  border-bottom: 1px dotted #bbb;
+}
+.panel a:hover {
+  background-color: #eee;
+}
+.dialog .title,.dialog  h1,.htmlarea .panel h1 {
+  background-image: url(toolbar.png);
+  background-repeat: repeat-x;
+  color:black;
+  font:Arial,Helvetica,sans-serif !IMPORTANT;
+  letter-spacing:0.2em;
+  font-size:13px;
+  font-weight:400;
+}  
+.dialog .title {
+
+}
+
+.dialog button{
+  background: url(statusbar.png) bottom repeat-x;
+  border:1px solid grey;
+  height:18px;
+  vertical-align: middle
+}
+/* separate definition for the sake of IE6*/
+.dialog input[type=button],.dialog input[type=submit]{
+  background: url(statusbar.png) bottom repeat-x;
+  border:1px solid grey;
+  height:18px;
+  vertical-align: middle
+}
+.htmlarea textarea.xinha_textarea {
+  background:url(html.gif) bottom right no-repeat;
+  /*padding:5px;
+  border:2px dotted #bbb;*/
+  font-family: "Lucida Console",Courier,monospace;
+  font-size: 10pt;
+}
+.htmlarea .dTreeNode {
+  color:black;
+}
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/silva/statusbar.png
Binary file Xinha_0.95/skins/silva/statusbar.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/silva/toolbar.png
Binary file Xinha_0.95/skins/silva/toolbar.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/titan/back.png
Binary file Xinha_0.95/skins/titan/back.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/titan/button-background.png
Binary file Xinha_0.95/skins/titan/button-background.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/titan/hover.png
Binary file Xinha_0.95/skins/titan/hover.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/titan/readme
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/skins/titan/readme	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,12 @@
+Skin Titan, a modification of Skin inditreuse by Mike Harris (www.jonesstandard.org)
+I simply changed the background to look more like nickel, and the dots on the separator have been replaced.  
+Everything else is the same.
+
+Skin inditreuse Author: Kyle Kochis (http://completesiteservices.com/)
+This work is licensed under the Creative Commons Attribution-ShareAlike License.
+To view a copy of this license, visit http://creativecommons.org/licenses/by-sa/2.0/
+or send a letter to
+Creative Commons,
+559 Nathan Abbott Way
+Stanford, California 94305
+USA
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/titan/selected.png
Binary file Xinha_0.95/skins/titan/selected.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/titan/separator.png
Binary file Xinha_0.95/skins/titan/separator.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/titan/skin.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/skins/titan/skin.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,73 @@
+.htmlarea .toolbar {
+        background-color:#889fc9;
+  background-image:url(back.png);
+  background-repeat:repeat-y;
+}
+.htmlarea .toolbarRow {
+  margin-top:2px;
+  margin-bottom:2px;
+  background-image:url(button-background.png);
+  height:25px;
+}
+.htmlarea .toolbar .button {
+  width:20px;
+  height:20px;
+  padding:1px;
+  border:none;
+  background-image:url(button-background.png);
+}
+.buttonImageContainer {
+  position:relative;
+  left:1px;
+  top:1px;
+}
+.htmlarea .toolbar .separator {
+  margin:0;
+  background-image: url(separator.png);
+  width:7px;
+  height:20px;
+  padding:1px;
+  border:none;
+}
+.htmlarea .toolbar a.button:hover {
+  border:none !important;
+  padding:1px;
+  background-image:url(hover.png);
+}
+.htmlarea .toolbar .button.buttonPressed
+{
+  padding:1px;
+  background-image:url(selected.png);
+}
+.htmlarea .statusBar {
+  padding:0;
+  height:20px;
+  background-image:url(button-background.png);
+  background-repeat:repeat-x;
+  background-color:#889fc9;
+  color:ButtonText;
+  font:11px helvetica,arial,sans-serif;
+}
+.htmlarea .statusBar .statusBarTree {
+  display:block;
+  margin:3px;
+}
+.htmlarea .statusBar .statusBarTree a {
+  padding:2px 5px;
+  color:#00f;
+  text-decoration:none;
+}
+.htmlarea .panel h1 {
+  background-image:url(button-background.png);
+  background-repeat:repeat-x;
+  background-color:#889fc9;
+}
+.dialog {
+  background-color:#f7f8fd;
+}
+.dialog .title {
+  background-image: url(button-background.png);
+}  
+.dialog button{
+  background-image: url(button-background.png);
+}
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/xp-blue/back.png
Binary file Xinha_0.95/skins/xp-blue/back.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/xp-blue/button-background.png
Binary file Xinha_0.95/skins/xp-blue/button-background.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/xp-blue/hover.png
Binary file Xinha_0.95/skins/xp-blue/hover.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/xp-blue/selected.png
Binary file Xinha_0.95/skins/xp-blue/selected.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/xp-blue/separator.png
Binary file Xinha_0.95/skins/xp-blue/separator.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/xp-blue/skin.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/skins/xp-blue/skin.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,76 @@
+.htmlarea .toolbar {
+	background-color:#c3daf9;
+  background-image:url(back.png);
+  background-repeat:repeat-y;
+}
+.htmlarea .toolbarRow {
+  margin-top:2px;
+  margin-bottom:2px;
+  background-image:url(button-background.png);
+  height:25px;  
+}
+.htmlarea .toolbar .button {
+  width:20px;
+  height:20px;
+  padding:1px;
+  border:none;
+  background-image:url(button-background.png);
+}
+.buttonImageContainer {
+  position:relative;
+  left:1px;
+  top:1px;
+}
+.htmlarea .toolbar .separator {
+  margin:0;
+  background-image:url(separator.png);
+  width:7px;
+  height:20px;
+  padding:0;
+}
+.separator {
+  border:none;
+}
+.htmlarea .toolbar a.button:hover {
+  border:1px solid #003355;
+  padding:0;
+  background-image:url(hover.png);
+}
+.htmlarea .toolbar .button.buttonPressed
+{
+  border:1px solid #003355;
+  padding:0;
+  background-image:url(selected.png);
+}
+.htmlarea .statusBar {
+  padding:0;
+  height:20px;
+  background-image:url(button-background.png);
+  background-repeat:repeat-x;
+  background-color:#c3daf9;
+  color:ButtonText;
+  font:11px helvetica,arial,sans-serif;
+}
+.htmlarea .statusBar .statusBarTree {
+  display:block;
+  margin:3px;
+}
+.htmlarea .statusBar .statusBarTree a {
+  padding:2px 5px;
+  color:#00f;
+  text-decoration:none;
+}
+.htmlarea .panel h1 {
+  background-image:url(button-background.png);
+  background-repeat:repeat-x;
+  background-color:#c3daf9;
+}
+.dialog {
+  background-color:#c3daf9;
+}
+.dialog .title {
+  background-image: url(button-background.png);
+}  
+.dialog button{
+  background-image: url(button-background.png);
+}
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/xp-green/back.png
Binary file Xinha_0.95/skins/xp-green/back.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/xp-green/button-background.png
Binary file Xinha_0.95/skins/xp-green/button-background.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/xp-green/hover.png
Binary file Xinha_0.95/skins/xp-green/hover.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/xp-green/selected.png
Binary file Xinha_0.95/skins/xp-green/selected.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/xp-green/separator.png
Binary file Xinha_0.95/skins/xp-green/separator.png has changed
diff -r 82e55d328c8c -r 9881d5db150a Xinha_0.95/skins/xp-green/skin.css
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/Xinha_0.95/skins/xp-green/skin.css	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,76 @@
+.htmlarea .toolbar {
+  background-color:#f2f0e4;
+  background-image:url(back.png);
+  background-repeat:repeat-y;
+}
+.htmlarea .toolbarRow {
+  margin-top:2px;
+  margin-bottom:2px;
+  background-image:url(button-background.png);
+  height:25px;
+}
+.htmlarea .toolbar .button {
+  width:20px;
+  height:20px;
+  padding:1px;
+  border:none;
+  background-image:url(button-background.png);
+}
+.buttonImageContainer {
+  position:relative;
+  left:1px;
+  top:1px;
+}
+.htmlarea .toolbar .separator {
+  margin:0;
+  background-image:url(separator.png);
+  width:7px;
+  height:20px;
+  padding:0;
+}
+.separator {
+  border:none;
+}
+.htmlarea .toolbar a.button:hover {
+  border:1px solid #335500;
+  padding:0;
+  background-image:url(hover.png);
+}
+.htmlarea .toolbar .button.buttonPressed
+{
+  border:1px solid #335500;
+  padding:0;
+  background-image:url(selected.png);
+}
+.htmlarea .statusBar {
+  padding:0;
+  height:20px;
+  background-image:url(button-background.png);
+  background-repeat:repeat-x;
+  background-color:#f2f0e4;
+  color:ButtonText;
+  font:11px helvetica,arial,sans-serif;
+}
+.htmlarea .statusBar .statusBarTree {
+  display:block;
+  margin:3px;
+}
+.htmlarea .statusBar .statusBarTree a {
+  padding:2px 5px;
+  color:#00f;
+  text-decoration:none;
+}
+.htmlarea .panel h1 {
+  background-image:url(button-background.png);
+  background-repeat:repeat-x;
+  background-color:#f2f0e4;
+}
+.dialog {
+  background-color:#f2f0e4;
+}
+.dialog .title {
+  background-image: url(button-background.png);
+}  
+.dialog button{
+  background-image: url(button-background.png);
+}
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a acceso.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/acceso.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,34 @@
+<div id="acceso" style="width:100%">
+	<form name="f1" method="post" action="validacion.php" onsubmit="valida();" >  			 
+		<label></label>
+		<br />
+		<table width="232" border="0" align="center" cellpadding="0" cellspacing="0">
+            <!--  Login Form-->
+          <tr>
+            <td width="63" height="28" class="Estilo22" style="vertical-align:middle"><div align="left">Usuario</div></td>
+            <td width="9" class="Estilo22" style="vertical-align:middle"><div align="center">:</div></td>
+            <td width="160"><input type="text" name="usuario" id="usuario" class="caja"/></td>
+          </tr>
+          <tr>
+            <td height="28" class="Estilo22" style="vertical-align:middle"><div align="left">Password</div></td>
+            <td class="Estilo22" style="vertical-align:middle"><div align="center">:</div></td>
+            <td><input type="password" name="password" onkeypress="checkTheKey(event.keyCode)" id="password" class="caja"/></td>
+          </tr>
+          <tr>
+            <td>&nbsp;</td>
+            <td>&nbsp;</td>
+            <td>&nbsp;</td>
+          </tr>
+          <tr>
+            <td colspan="3"><div align="center">
+              <input type="submit" name="enviar" value="Ingresar" class="boton" />
+            </div></td>
+          </tr>
+      </table>
+		<br /> 
+		<?php
+if($error){ ?>
+	<div class="error"><?php echo " ERROR: Usuario o Password Incorrecto, Por favor ingrese de nuevo! ";?></div><?php
+ }?>
+	</form>
+</div>
diff -r 82e55d328c8c -r 9881d5db150a acciones.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/acciones.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,83 @@
+<?php  
+	include("includes.php");
+	require_once("cls/class.adminacciones.php");
+	$menu = array(1,1,0,0,0,0);
+	if(!$_SESSION['session'][3] == "SI" ){
+		header("location: error_permisos.php");
+ 	}
+?>
+
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head> 
+<?php include("includes/inc.header.php"); ?>
+<title>Administraci&oacute;n</title>
+</head>
+<body>
+<table  id="principal"  align="left" cellpadding="0" cellspacing="0" width="100%" style="margin:0px; vertical-align:top">
+	<tr>		
+		<td  align="left" colspan="2"><?php  Plantilla::PlantillaEncabezado("ADMINISTRACION DE ACCIONES");?> </td>		
+	</tr>
+	<tr>
+		<td class="menu"><?php  Plantilla::PlantillaIzquierdo();?></td>	
+		<td style="width:100%">
+			<table  class="contenido" cellpadding="0" cellspacing="0" width="100%" align="left">
+				<tr>
+					<td><?php  Plantilla::menuSuperior("acciones.php",$menu,$_GET['id'],false);?></td>
+				</tr>
+				<tr>								
+					<td style="width:100%; height:417px">	
+					<div>
+					<?php  
+					if( $_SESSION['session'][3] == "SI" ){  
+						switch($_GET['opcion']){
+							case 'new':										 
+								AdminAcciones::AccionesNew();		
+							break;
+							case 'add':
+								AdminAcciones::AccionesAdd();
+								AdminAcciones::AccionesList();			
+							break;									
+							case 'edit':										
+								AdminAcciones::AccionesEdit($_GET['id']);	
+							break;
+							case 'update':
+								AdminAcciones::AccionesUpdate($_GET['id'], $_POST);
+								AdminAcciones::AccionesList();			
+							break;
+							case 'delete':										 
+								AdminAcciones::AccionesDelete($_GET['id']);	
+								AdminAcciones::AccionesList();			
+							break;
+							case 'detailAccion':										 
+								AdminAcciones::AccionesDetalle($_GET['id']);			
+							break;
+							case 'addDetailAccion':										 
+								AdminAcciones::GuardarDetalleAccion($_GET['id'],$_POST);			
+							break;
+							case 'list':
+								AdminAcciones::AccionesList();	
+							break;					
+							default:	
+								AdminAcciones::AccionesList();
+							 
+							break; 
+						}	
+					}else if($_SESSION['session'][3]=="NO") {
+						echo "<div id='error'> CUIDADO: Usted es Usuario del sistema pero no esta Autorizado para ver esta informacin </div><br><br>";		
+					}else{
+						echo " ERROR: Usted esta entrando de manera Incorrecta !!! " ;
+					}	?>
+					</div>						
+					</td>					
+				</tr>			
+			</table>
+		</td>		
+	</tr>
+	<tr>
+		<td colspan="2" class="pie"><?php Plantilla::PlantillaPie();?>	</td>
+	</tr>	
+</table>
+	
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a anp.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/anp.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,89 @@
+<?php  
+	include("includes.php");
+	require_once("cls/class.anps.php");
+	$menu = array(0,1,0,0,0,0);
+	if(!$_SESSION['session'][3] == "SI" ){
+		header("location: error_permisos.php");
+ 	}
+?>
+
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head> 
+<?php include("includes/inc.header.php"); ?>
+<title>Administraci&oacute;n</title>
+</head>
+<body>
+<table  id="principal"  align="left" cellpadding="0" cellspacing="0" width="100%" style="margin:0px; vertical-align:top">
+	<tr>		
+		<td  align="left" colspan="2"><?php  Plantilla::PlantillaEncabezado("ADMINISTRACION DE ANPS");?> </td>		
+	</tr>
+	<tr>
+		<td class="menu"><?php  Plantilla::PlantillaIzquierdo();?></td>	
+		<td style="width:100%">
+			<table  class="contenido" cellpadding="0" cellspacing="0" width="100%" align="left">								
+				<tr>
+					<td><?php  Plantilla::menuSuperior("anp.php",$menu,$_GET['id'],false);?></td>
+				</tr>
+				<tr>								
+					<td style="width:100%; height:417px">	
+					<div id="cuerpo" > 	<?php  
+					if( $_SESSION['session'][3] == "SI" ){  
+						switch($_GET['opcion']){
+							case 'new':										 
+								Anps::AnpsNew();		
+							break;
+							case 'add':
+								Anps::AnpsAdd();
+								Anps::AnpsList();			
+							break;									
+							case 'edit':										
+								Anps::AnpsEdit($_GET['id']);	
+							break;
+							case 'update':
+								Anps::AnpsUpdate($_GET['id'], $_POST);
+								Anps::AnpsList();			
+							break;
+							case 'delete':										 
+								Areas::AnpsDelete($_GET['id']);	
+								Areas::AnpsList();			
+							break;
+							case 'detailUser':										 
+								Anps::AreasDetalleUsuario($_GET['id']);			
+							break;
+							case 'detailArea':										 
+								Anps::AreasDetalleArea($_GET['id']);			
+							break;
+							case 'addArea':										 
+								Anps::GuardarDetalleArea($_GET['id'],$_POST);			
+							break;
+							case 'addUser':										 
+								Anps::GuardarDetalleUsuario($_GET['id'],$_POST);			
+							break;																					
+							case 'list':
+								Anps::AnpsList();	
+							break;					
+							default:	
+								Anps::AnpsList();
+							 
+							break; 
+						}	
+					}else if($_SESSION['session'][3]=="NO") {
+						echo "<div id='error'> CUIDADO: Usted es Usuario del sistema pero no esta Autorizado para ver esta informacin </div><br><br>";		
+					}else{
+						echo " ERROR: Usted esta entrando de manera Incorrecta !!! " ;
+					}	?>
+					</div>						
+					</td>					
+				</tr>			
+			</table>
+		</td>		
+	</tr>
+	<tr>
+		<td colspan="2" class="pie"><?php Plantilla::PlantillaPie();?>	</td>
+	</tr>	
+</table>
+	
+</body>
+</html>
+
diff -r 82e55d328c8c -r 9881d5db150a aprobar_derivacion.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/aprobar_derivacion.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,113 @@
+<?php  
+	include_once("includes.php");
+	include_once("cls/class.accion.php");
+	include_once("cls/class.usuario.php");
+	include_once("cls/class.documentos.php");	
+?>
+
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
+<?php include_once("includes/inc.header.php"); ?>
+<style>
+	input{
+		height:21px;
+	}
+	td{
+		vertical-align:middle;
+	}
+	fieldset{
+		margin:0px 4px 4px 4px;
+		width:95%;
+	}
+	
+</style>
+<title>STD .:. Aprobar Derivacion</title>
+</head>
+<body>
+	<fieldset>
+		<legend>Aprobaci&oacute;n de la Derivaci&oacute;n de &Aacute;rea </legend>							
+	    <?
+		if($_REQUEST["opcion"]=='addha'){
+			$documento = new Documento($_REQUEST['id']);
+			$atencion  = $documento->addHistorialAtencion();
+			if($atencion!=0){
+				Documentos::GuardarArchivoJustificacion($atencion);
+				echo  "<p>Se propuso correctamente</p></div>";
+			}else{
+				echo  "<div id='error'>Hubo un error al procesar su consulta</div>";
+			}
+    	}else{		
+		if($_REQUEST["id"]){			
+			$accion= new Accion($_REQUEST["acc"]);
+			$categoria=($_REQUEST["cat"]==1)?"Original":"Copia";					                             			  
+		?>
+		<form id="form_justificacion" name="form_justificacion" method="post" action="javascript:validar_aprobacion(<?= $_REQUEST["id"]?>)" enctype="multipart/form-data">			
+				<input type="hidden" id="area" name="area" value="<?php echo $_SESSION['session'][5] ?>" />
+				<input type="hidden" id="user" name="user" value="<?php echo $_SESSION['session'][0] ?>" />			
+				<input type="hidden" id="categoria" name="categoria" size="30" value="<?=$_REQUEST["cat"]?>"/>
+				<input type="hidden" id="accion" name="accion" value="<?=$accion->getId()?>"/>	
+
+		<table width="100%" height="275" border="0">
+		<tr>
+			<td width="10%" height="21" class="Estilo22">Acci&oacute;n</td>
+			<td width="1%" class="Estilo22"><div align="center">:</div></td>
+			<td ><?=$accion->getNombre()?></td>
+		    <td colspan="3" class="Estilo22" width="7%">Categoria</td>
+		    <td width="1%" class="Estilo22"><div align="center">:</div></td>
+		    <td colspan="2" width="7%"><?=$categoria?></td>
+		</tr>
+		
+		<tr>
+		  <td height="24" colspan="3" class="Estilo21"><strong>(*) Tama&ntilde;o M&aacute;ximo 2Mb </strong></td>
+		  <td colspan="4" style="vertical-align:top;">&nbsp;</td>
+		  <td colspan="2" class="Estilo21" style="vertical-align:top; padding-top:2px;">&nbsp;</td>
+		  </tr>
+		<tr>
+			<td height="24" style="vertical-align:top;"><label style="margin-top:1px;" class="Estilo22">Documento</label></td>
+			<td class="Estilo22" style="vertical-align:top; text-align:center;padding-top:4px;"><div align="center">:</div></td>
+			<td>
+				<div class="ileft_img">
+				<div id='cp_item_0' style="float:left">					
+					<input id="doc[]" type="file" name="doc[]" size="39" />
+				</div>
+				 <div class="iright_img" style="float:left; height:22px;"></div>
+			  </div>			</td>
+		    <td width="3%" style="vertical-align:top;"><img src="public_root/imgs/edit_add.png" alt="" onclick="crearCarchivo(2)" style="margin-top:1px;"/></td>
+		    <td width="3%" style="vertical-align:top;"><img src="public_root/imgs/edit_remove.png" alt="" onclick="quitarCarchivo(2)" style="margin-top:1px;"/></td>
+		    <td style="vertical-align:top;" colspan="2">&nbsp;</td>
+		    <td colspan="2">&nbsp;</td>
+	      </tr>
+		<tr>
+			<td class="Estilo22" height="19"> Comentario </td>
+			<td height="19" class="Estilo22"><div align="center">:</div></td>
+			<td colspan="7">&nbsp;</td>
+		</tr>
+		<tr>
+			<td height="137" colspan="9">
+				<div align="center"><textarea name="comentario" cols="80" rows="10" id="comentario"></textarea>
+				</div>			</td>
+		</tr>
+		<tr>
+			<td height="36" colspan="2" align="center" style="vertical-align:middle">
+		  <td>&nbsp;</td>
+		  <td colspan="5">		    <div align="right">
+		    <input name="aceptar" type="submit" class="boton" id="aceptar_b" value="Aceptar"/>	      
+	      </div></td>
+		  <td width="12%"><div align="right">
+		    <input name="cancelar" type="button" class="boton" id="cancelar_b" value="Cancelar" />
+	      </div></td>
+		</tr>
+	</table>
+	</form>
+	<?
+	}else{
+	?>
+		<script>javascript:cerrar_popups</script>
+	<? }
+	}
+	?>
+	</fieldset>
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a aprobar_derivacion_archivo.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/aprobar_derivacion_archivo.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,135 @@
+<?php  
+	include_once("includes.php");
+	include_once("cls/class.accion.php");
+	include_once("cls/class.usuario.php");
+	include_once("cls/class.documentos.php");	
+?>
+
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
+<?php include_once("includes/inc.header.php"); ?>
+<style>
+	input{
+		height:21px;
+	}
+	td{
+		vertical-align:middle;
+	}
+	fieldset{
+		margin:0px 4px 4px 4px;
+		width:95%;
+	}
+	
+</style>
+<title>STD .:. Aprobar Derivacion</title>
+</head>
+<body>
+	<fieldset>		
+		<legend>Aprobaci&oacute;n</legend>							
+	    <?
+		if($_REQUEST["opcion"]=='addha'){
+			$documento = new Documento($_REQUEST['id']);
+			$atencion  = $documento->AprobarDocumento($_REQUEST['comentario']);
+			if($atencion!=0){
+				//if($_REQUEST['accion']==35){ //Archivar Aprobado
+					//Documentos::GuardarArchivoRespuesta($atencion);
+					//Documentos::GuardarAdjuntosArchivo($atencion,$_REQUEST['categoria']);
+				//}
+				//else
+					Documentos::GuardarAprobacion($atencion);
+				echo  "<p>Se propuso correctamente</p></div>";
+			}else{
+				echo  "<div id='error'>Hubo un error al procesar su consulta</div>";
+			}
+			?>
+			<br/>
+			<br/>
+			<input name="cancelar" type="button" class="boton" id="cerrar_j" value="Cerrar" />
+		<?	
+    	}else{		
+		if($_REQUEST["id"]){			
+			$accion= new Accion($_REQUEST["acc"]);
+			$categoria=($_REQUEST["cat"]==1)?"Original":"Copia";					                             			  
+		?>
+		<form id="form_justificacion" name="form_justificacion" method="post" action="javascript:validar_aprobacion(<?= $_REQUEST["id"]?>)" enctype="multipart/form-data">			
+				<input type="hidden" id="area" name="area" value="<?php echo $_SESSION['session'][5] ?>" />
+				<input type="hidden" id="user" name="user" value="<?php echo $_SESSION['session'][0] ?>" />			
+				<input type="hidden" id="categoria" name="categoria" size="30" value="<?=$_REQUEST["cat"]?>"/>
+				<input type="hidden" id="accion" name="accion" value="<?=$accion->getId()?>"/>	
+
+		<table width="100%" height="301" border="0">
+		<tr>
+			<td width="18%" height="21" class="Estilo22">Acci&oacute;n</td>
+			<td width="1%" class="Estilo22"><div align="center">:</div></td>
+			<td ><?=$accion->getNombre()?></td>
+		    <td colspan="3" class="Estilo22" width="7%">Categoria</td>
+		    <td width="1%" class="Estilo22"><div align="center">:</div></td>
+		    <td colspan="2" width="7%"><?=$categoria?></td>
+		</tr>
+		
+		<tr>
+		  <td height="24" colspan="3" class="Estilo21"><strong>(*) Tama&ntilde;o M&aacute;ximo 2Mb </strong></td>
+		  <td colspan="4" style="vertical-align:top;">&nbsp;</td>
+		  <td colspan="2" class="Estilo21" style="vertical-align:top; padding-top:2px;">&nbsp;</td>
+		  </tr>
+		<!--  
+		<? if($_REQUEST['acc']==35){ ?>  
+		<tr>
+		  <td height="24" class="Estilo22">Doc. Respuesta </td>
+		  <td height="24" class="Estilo22"><div align="center">:</div></td>
+		  <td height="24" class="Estilo21">
+			<input id="respuesta" type="file" name="respuesta" size="39" />
+          </td>
+		  <td colspan="4" style="vertical-align:top;">&nbsp;</td>
+		  <td colspan="2" class="Estilo21" style="vertical-align:top; padding-top:2px;">&nbsp;</td>
+		  </tr>
+		<tr>
+		<? }?>-->
+			<td height="24" style="vertical-align:top;" class="Estilo22">Doc. Adjunto</td>
+			<td class="Estilo22" style="vertical-align:top; text-align:center;padding-top:4px;"><div align="center">:</div></td>
+			<td>
+				<div class="ileft_img">
+				<div id='cp_item_0' style="float:left">					
+					<input id="doc[]" type="file" name="doc[]" size="39" />
+				</div>
+				 <div class="iright_img" style="float:left; height:22px;"></div>
+			  </div>			</td>
+		    <td width="3%" style="vertical-align:top;"><img src="public_root/imgs/edit_add.png" alt="" onclick="crearCarchivo(2)" style="margin-top:1px;"/></td>
+		    <td width="3%" style="vertical-align:top;"><img src="public_root/imgs/edit_remove.png" alt="" onclick="quitarCarchivo(2)" style="margin-top:1px;"/></td>
+		    <td style="vertical-align:top;" colspan="2">&nbsp;</td>
+		    <td colspan="2">&nbsp;</td>
+	      </tr>
+		<tr>
+			<td class="Estilo22" height="19"> Comentario </td>
+			<td height="19" class="Estilo22"><div align="center">:</div></td>
+			<td colspan="7">&nbsp;</td>
+		</tr>
+		<tr>
+			<td height="137" colspan="9">
+				<div align="center"><textarea name="comentario" cols="80" rows="10" id="comentario" class="caja"></textarea>
+				</div>			</td>
+		</tr>
+		<tr>
+			<td height="36" colspan="2" align="center" style="vertical-align:middle">
+		  <td>&nbsp;</td>
+		  <td colspan="5">		    <div align="right">
+		    <input name="aceptar" type="submit" class="boton" id="aceptar_b" value="Aceptar"/>	      
+	      </div></td>
+		  <td width="12%"><div align="right">
+		    <input name="cancelar" type="button" class="boton" id="cancelar_b" value="Cancelar" />
+	      </div></td>
+		</tr>
+	</table>
+	</form>
+	<?
+	}else{
+	?>
+		<script>javascript:cerrar_popups</script>
+	<? }
+	}
+	?>
+	</fieldset>
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a archivar_documento_comentario.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/archivar_documento_comentario.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,93 @@
+<?php  
+	include("includes.php");
+	include_once("cls/class.documentos.php");
+?>
+
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head> 
+<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
+<title>STD .:. Archivar Documento</title>
+<?php include_once("includes/inc.header.php"); ?>
+</head>
+<body>
+<?php  
+if( $_SESSION['session'][3] == "SI" ){ 
+	
+	if($_REQUEST['op']=="cargar_adj"){
+		if($_REQUEST['id_hist']&&$_REQUEST['id_hist']!=0){
+			Documentos::GuardarArchivoRespuesta($_REQUEST['id_hist']);
+			Documentos::GuardarAdjuntosArchivo($_REQUEST['id_hist'],$_REQUEST['cat']);
+			echo  "<p>Se propuso correctamente</p></div>";			
+		}
+		?>
+		<input name="cancelar" type="button" class="boton" id="cerrar_a" value="Cerrar" />
+		<?
+	}else{	
+	 
+?>
+<fieldset>
+	<legend>Archivar Documento</legend>
+	<form id="form_archivo" name="form_justificacion" method="post" action="javascript:ArchivarCompletado(<?=$_REQUEST['id']?>)" enctype="multipart/form-data">																
+	<input type="hidden" value="<?=$_REQUEST["cat"]?>" id="cat">
+	<input type="hidden" value="<?=$_REQUEST["tipo"]?>" id="tipo">
+	<input type="hidden" value="" id="id_archivo">
+	<table border="0">
+	<tr>
+	  <td height="26" colspan="7" class="Estilo21"><strong>(*) Tama&ntilde;o M&aacute;ximo 2Mb </strong></td>
+	  </tr>
+	<tr>
+	  <td height="26" class="Estilo22">Doc. Respuesta </td>
+	  <td height="26" class="Estilo22"><div align="center">:</div></td>
+	  <td colspan="5"><span style="float:left">
+	    <input id="respuesta" type="file" name="respuesta" size="39" />
+	  </span></td>
+	  </tr>
+	<tr>
+	  <td height="26" class="Estilo22"><div align="left">Doc. Adjunto</div></td>
+	  <td height="26" class="Estilo22"><div align="center">:</div></td>
+	  <td>
+	 	<div class="ileft_img">
+			<div id='cp_item_0' style="float:left">					
+				<input id="doc[]" type="file" name="doc[]" size="39" />
+			</div>
+		    <div class="iright_img" style="float:left; height:22px;"></div>
+		</div>	  </td>
+	  <td><div align="center"><img src="public_root/imgs/edit_add.png" alt="" onclick="crearCarchivo(2)" style="margin-top:1px;"/></div></td>
+	  <td><div align="center"><img src="public_root/imgs/edit_remove.png" alt="" onclick="quitarCarchivo(2)" style="margin-top:1px;"/></div></td>
+	  <td>&nbsp;</td>
+	  <td>&nbsp;</td>
+	</tr>
+	<tr>
+		<td height="26" class="Estilo22"><div align="left">Descripci&oacute;n</div></td>
+	  <td height="26" class="Estilo22"><div align="center">:</div></td>
+		<td colspan="5">&nbsp;</td>
+	</tr>
+	<tr>
+		<td height="62" colspan="7">
+			
+				<div align="center">
+					<textarea name="textarea" cols="80" rows="6" id="comentario" class="caja"></textarea>
+				</div>		</td>
+	</tr>
+	<tr>
+		<td colspan="2"></td>
+		<td colspan="4"><div align="right">
+		  <input name="Submit" type="submit" class="boton" value="Archivar" />
+	    </div></td>
+	    <td><div align="right">
+	      <input name="Submit2" type="button" class="boton" value="Cancelar" onclick="cerrar_popups();"/>
+      </div></td>
+	</tr>
+</table>
+<?	
+	}
+	}else if($_SESSION['session'][3]=="NO") {
+		echo "<div id='error'> CUIDADO: Usted es Usuario del sistema pero no esta Autorizado para ver esta informacin </div><br><br>";		
+	}else{
+		echo " ERROR: Usted esta entrando de manera Incorrecta !!! " ;
+	}	?>
+	</form>
+</fieldset>
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a areas.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/areas.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,89 @@
+<?php  
+	include("includes.php");
+	require_once("cls/class.areas.php");
+	$menu = array(1,1,0,0,0,0);
+	if(!$_SESSION['session'][3] == "SI" ){
+		header("location: error_permisos.php");
+ 	}
+?>
+
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head> 
+<?php include("includes/inc.header.php"); ?>
+<title>Administraci&oacute;n</title>
+</head>
+<body>
+<table  id="principal"  align="left" cellpadding="0" cellspacing="0" width="100%" style="margin:0px; vertical-align:top">
+	<tr>		
+		<td  align="left" colspan="2"><?php  Plantilla::PlantillaEncabezado("ADMINISTRACION DE AREAS");?> </td>		
+	</tr>
+	<tr>
+		<td class="menu"><?php  Plantilla::PlantillaIzquierdo();?></td>	
+		<td style="width:100%">
+			<table  class="contenido" cellpadding="0" cellspacing="0" width="100%" align="left">								
+				<tr>
+					<td><?php  Plantilla::menuSuperior("areas.php",$menu,$_GET['id'],false);?></td>
+				</tr>
+				<tr>								
+					<td style="width:100%; height:417px">	
+					<div id="cuerpo" > 	<?php  
+					if( $_SESSION['session'][3] == "SI" ){  
+						switch($_GET['opcion']){
+							case 'new':										 
+								Areas::AreasNew();		
+							break;
+							case 'add':
+								Areas::AreasAdd();
+								Areas::AreasList();			
+							break;									
+							case 'edit':										
+								Areas::AreasEdit($_GET['id']);	
+							break;
+							case 'update':
+								Areas::AreasUpdate($_GET['id'], $_POST);
+								Areas::AreasList();			
+							break;
+							case 'delete':										 
+								Areas::AreasDelete($_GET['id']);	
+								Areas::AreasList();			
+							break;
+							case 'detailUser':										 
+								Areas::AreasDetalleUsuario($_GET['id']);			
+							break;
+							case 'detailArea':										 
+								Areas::AreasDetalleArea($_GET['id']);			
+							break;
+							case 'addArea':										 
+								Areas::GuardarDetalleArea($_GET['id'],$_POST);			
+							break;
+							case 'addUser':										 
+								Areas::GuardarDetalleUsuario($_GET['id'],$_POST);			
+							break;																					
+							case 'list':
+								Areas::AreasList();	
+							break;					
+							default:	
+								Areas::AreasList();
+							 
+							break; 
+						}	
+					}else if($_SESSION['session'][3]=="NO") {
+						echo "<div id='error'> CUIDADO: Usted es Usuario del sistema pero no esta Autorizado para ver esta informacin </div><br><br>";		
+					}else{
+						echo " ERROR: Usted esta entrando de manera Incorrecta !!! " ;
+					}	?>
+					</div>						
+					</td>					
+				</tr>			
+			</table>
+		</td>		
+	</tr>
+	<tr>
+		<td colspan="2" class="pie"><?php Plantilla::PlantillaPie();?>	</td>
+	</tr>	
+</table>
+	
+</body>
+</html>
+
diff -r 82e55d328c8c -r 9881d5db150a areas_acceso_registro.cls.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/areas_acceso_registro.cls.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,1882 @@
+<?php
+
+class Registro {
+
+function RegistraListado($ide){	
+
+if ($ide==''){
+	
+	//if($_SESSION['session'][6]){
+		//$where = "WHERE	(d.id_estado = '3' OR d.id_estado = '13' OR d.id_estado = '12' OR d.id_estado = '11')";
+	//}else{
+		$where = "WHERE
+				(((d.id_estado = '4' OR d.id_estado = '12' OR d.id_estado = '11' 
+				OR d.id_estado = '6' OR d.id_estado = '16' OR d.id_estado = '17' 
+				OR d.id_estado = '18' OR d.id_estado = '3' OR d.id_estado = '13' 
+				OR d.id_estado = '12')";
+	//}
+	
+	$sql_reg = "SELECT
+				hd.id_documento as id,
+				d.fecha_registro_documento as fecha,
+				d.asunto_documento as asunto,
+				d.codigo_documento as codigo,
+				td.nombre_tipo_documento as tipo,
+				r.nombre_remitente as remitente,
+				hd.original_historial_documento as categoria,
+				d.numero_documento as numero,
+				d.id_estado as id_estado,
+				e.abrev_nombre_estado as estado
+				FROM
+				historial_documentos AS hd
+				Inner Join documentos AS d ON d.id_documento = hd.id_documento
+				Inner Join estados AS e ON e.id_estado = d.id_estado
+				LEFT Join remitentes AS r ON r.id_remitente = d.id_remitente
+				LEFT Join tipos_documento AS td ON d.id_tipo_documento = td.id_tipo_documento
+				$where
+				AND hd.original_historial_documento = 1) OR hd.original_historial_documento = 2 )
+				AND hd.id_area = '".$_SESSION['session'][5]."'
+				UNION
+				SELECT
+				ha.id_documento as id,
+				d.fecha_registro_documento as fecha,
+				d.asunto_documento as asunto,
+				d.codigo_documento as codigo,
+				td.nombre_tipo_documento as tipo,
+				r.nombre_remitente as remitente,
+				ha.original_historial_atencion as categoria,
+				d.numero_documento as numero,
+				d.id_estado as id_estado,
+				e.abrev_nombre_estado as estado	
+				FROM
+				historial_atencion AS ha
+				Inner Join documentos AS d ON ha.id_documento = d.id_documento
+				Inner Join estados AS e ON d.id_estado = e.id_estado
+				LEFT Join tipos_documento AS td ON d.id_tipo_documento = td.id_tipo_documento
+				LEFT Join remitentes AS r ON d.id_remitente = r.id_remitente
+				$where
+				AND ha.original_historial_atencion = 1) OR ha.original_historial_atencion = 2 )
+                AND(
+				(ha.id_area = '".$_SESSION['session'][5]."' AND ha.tipo_historial_atencion=0) OR
+				(ha.id_area_destino = '".$_SESSION['session'][5]."' AND ha.tipo_historial_atencion=1) OR
+                (ha.id_area_destino = '".$_SESSION['session'][5]."' AND ha.tipo_historial_atencion=2)
+				)
+				ORDER BY 1 DESC, 7 ASC";
+				
+   $query_reg=new Consulta($sql_reg);	
+}
+else{
+	
+	if($ide=="LT")
+		$where="";
+	else{
+		$where="AND d.id_estado = $ide ";
+	}
+	
+    $sql_reg = "SELECT
+				hd.id_documento as id,
+				d.fecha_registro_documento as fecha,
+				d.asunto_documento as asunto,
+				d.codigo_documento as codigo,
+				td.nombre_tipo_documento as tipo,
+				r.nombre_remitente as remitente,
+				hd.original_historial_documento as categoria,
+				d.numero_documento as numero,
+				d.id_estado as id_estado,
+				e.abrev_nombre_estado as estado
+				FROM
+				historial_documentos AS hd
+				Inner Join documentos AS d ON d.id_documento = hd.id_documento
+				Inner Join estados AS e ON e.id_estado = d.id_estado
+				LEFT Join remitentes AS r ON r.id_remitente = d.id_remitente
+				LEFT Join tipos_documento AS td ON d.id_tipo_documento = td.id_tipo_documento
+				WHERE 
+				hd.id_area = '".$_SESSION['session'][5]."' 
+				".$where."
+				UNION
+				SELECT
+				ha.id_documento as id,				
+				d.fecha_registro_documento as fecha,
+				d.asunto_documento as asunto,
+				d.codigo_documento as codigo,
+				td.nombre_tipo_documento as tipo,
+				r.nombre_remitente as remitente,
+				ha.original_historial_atencion as categoria,
+				d.numero_documento as numero,
+				d.id_estado as id_estado,
+				e.abrev_nombre_estado as estado
+				FROM
+				historial_atencion AS ha
+				Inner Join documentos AS d ON ha.id_documento = d.id_documento
+				Inner Join estados AS e ON d.id_estado = e.id_estado
+				LEFT Join tipos_documento AS td ON d.id_tipo_documento = td.id_tipo_documento
+				LEFT Join remitentes AS r ON d.id_remitente = r.id_remitente
+				WHERE
+				(
+				(ha.id_area = '".$_SESSION['session'][5]."' AND ha.tipo_historial_atencion=0) OR
+				(ha.id_area_destino = '".$_SESSION['session'][5]."' AND ha.tipo_historial_atencion=1) OR
+                (ha.id_area_destino = '".$_SESSION['session'][5]."' AND ha.tipo_historial_atencion=2)
+				) ".$where."
+				ORDER BY id DESC,categoria";
+	
+    $query_reg=new Consulta($sql_reg);
+
+}//Fin de if ide
+
+	?>
+<div class="ui-jqgrid ui-widget ui-widget-content ui-corner-all">
+<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" id="tabla_despacho" class="gview_frmgrid">
+	<tr>
+		<td>
+			<table width="100%" class="ui-jqgrid-htable" cellpadding="0" cellspacing="0">
+				<tr bgcolor="#6699CC" class="ui-widget-header ui-th-column grid_resize">
+					<th width="16%" class="ui-widget-header ui-th-column grid_resize">Reg. Nro</th>
+					<th width="26%" class="ui-widget-header ui-th-column grid_resize">Remitente</th>
+					<th width="26%" class="ui-widget-header ui-th-column grid_resize">Documento</th>
+					<th width="13%" class="ui-widget-header ui-th-column grid_resize">Registrado</th>
+					<th width="5%" class="ui-widget-header ui-th-column grid_resize">Estado</th>
+					<th width="4%" class="ui-widget-header ui-th-column grid_resize">Cat</th>
+					<th class="ui-widget-header ui-th-column grid_resize">Ubicacion</th>
+				</tr>			
+			</table>
+		</td>
+	</tr>
+	<tr class="ui-jqgrid-bdiv">
+		<td>
+			<table id="frmgrid" width="100%" class="ui-jqgrid-btable" cellpadding="0" cellspacing="0">
+    <? 			
+		$codigo="";
+		
+		while($row_reg=$query_reg->ConsultaVerRegistro()){
+
+		$ids=$row_reg["id"];		
+		$estado=$row_reg["id_estado"];
+		$anterior = $codigo;
+		$codigo=$row_reg["codigo"];
+		$cat = $row_reg["categoria"];       
+		$loTengo = true;
+		
+		if($codigo!=$anterior){		
+		if($cat == 1){
+			if($estado == 11 && $ide == ""){ //No es un filtro y esta archivado			
+				$loTengo = false; // Para no mostrarlo
+			}else{
+				if($_SESSION['session'][6]&&$estado!=3&&$estado!=13&&$estado!=12&&$ide == ""){
+					$loTengo = false;
+				}elseif(!$_SESSION['session'][6]&&($estado==3||$estado==13||$estado==12)&&$ide == ""){
+					$loTengo = false;
+				}elseif($estado==3){
+					//Si es un despachado no pregunto si esta en mi area
+					$doc  = new Documento($ids);
+					if($doc->DespachoAreaTieneOriginal())
+						$loTengo = true;
+					else
+						$loTengo = false;
+				}
+				elseif($estado==4||$estado==13||$estado==12||$estado==6||$estado==16||$estado==17){
+					
+					$total = 10; //Un numero Mayor a 0 para que tambien lo usen los otros estados
+					if($estado==16||$estado==17){ 
+						$total = 0;
+						$sql_hist ="SELECT Count(ha.id_historial_atencion) AS total						
+									FROM
+									historial_atencion AS ha
+									WHERE
+									ha.id_documento =  $ids";
+									
+						$query_hist = new Consulta($sql_hist);		
+						$row_hist = $query_hist->ConsultaVerRegistro();
+						$total = $row_hist["total"];			
+					}	
+							
+					//Si tiene historial se muestra en el area donde se quedo el ultimo original
+					if($total>0){
+						$loTengo = false;
+						$sql_destino="SELECT ha.id_historial_atencion AS ultimo, 
+										ha.tipo_historial_atencion,
+										ha.id_area,
+										ha.id_area_destino
+										FROM
+										historial_atencion AS ha
+										WHERE
+										ha.id_documento=".$ids." AND
+										ha.original_historial_atencion=1
+										ORDER BY
+										`ha`.`id_historial_atencion` DESC
+										LIMIT 1";
+								
+						$query_destino = new Consulta($sql_destino);		
+						$row_destino = $query_destino->ConsultaVerRegistro();
+					
+						if($row_destino["tipo_historial_atencion"]>0&&$row_destino["id_area_destino"]==$_SESSION['session'][5])
+							$loTengo = true;
+						elseif($row_destino["tipo_historial_atencion"]==0){
+							if($row_destino["id_area"]==$_SESSION['session'][5])
+								$loTengo = true;
+						}//Fin elseif			
+						
+					}//Fin if			
+					
+					//Si no tiene historial anteriormente fue despacho asi que se muestra siempre ($loTengo estaba en true)
+					
+				}//Fin if Verificacion de estados
+			} //Fin if estado = 11
+		}//Fin if cat
+		else{
+			
+			$sql_arch = "SELECT
+						a.id_documento
+						FROM
+						archivo_copia AS a
+						WHERE
+						a.id_documento =  $ids AND
+						a.id_area_duenia = ".$_SESSION['session'][5]." 
+						AND
+						a.id_usuario_duenio = 0";
+	
+			$query_arch = new Consulta($sql_arch);
+				
+			if($query_arch->NumeroRegistros()>0){				
+				if($ide == "LT" || $ide == 11)
+					$loTengo=true;
+				else
+					$loTengo=false;
+			}
+			
+        }
+		//Pregunto si mi area lo tiene
+		if($loTengo){
+		$clase = "Estilo7";						
+		if($estado==12){
+			$clase = "Estilo7 fila_finalizada";
+		}else{
+			$dias_faltantes = ObtenerDiasFaltantes($ids, date('d/m/Y',strtotime($row_reg['fecha'])));
+			if($dias_faltantes <=0)
+				$clase = "Estilo7 fila_peligro";
+			elseif($dias_faltantes > 0 && $dias_faltantes <= 3)
+				$clase = "Estilo7 fila_urgente";
+			else	
+				$clase = "Estilo7 fila_baja";
+		}	
+		
+		$tooltip_asunto="";
+		
+		if(!empty($row_reg['asunto'])){
+			$tooltip_asunto="title ='".$row_reg['asunto']."' class='tip'";
+		}		
+		?>
+		
+    <tr class="ui-widget-content1 jqgrow <?=$clase?>">		
+		<td width="16%" <?=$tooltip_asunto?>>
+			<div align="center">
+			  <? if($estado==11&&$cat==1){?>
+			  		<?=$row_reg['codigo']?>
+			  <? }
+				else{?>
+				<a href="areas_acceso_registro.php?opcion=despachar&amp;ids=<?=$ids?>&amp;cat=<?=$row_reg['categoria']?>">
+			  <?=$row_reg['codigo']?>
+			  </a>		  
+			      <? }?>	
+	        </div></td>
+ 		<td width="26%"><input name="Input3" value="<?=$row_reg['remitente']?>" style="width:100%"/></td>
+ 		<td width="26%"><input value="<?=$row_reg['numero']?>" style="width:100%"/></td>
+		<td width="13%"> <div align="center">
+	        <input type="text" value="<?=date('d/m/Y H:i',strtotime($row_reg['fecha']))?>" style="text-align:center;width:100%;"/>
+		</div></td>
+		<?php
+			$tooltip="";
+			if($estado==5){
+				$sql_des = "SELECT
+							d.id_devuelto AS ultimo,
+							d.descripcion AS descripcion
+							FROM
+							devuelto AS d
+							WHERE
+							d.id_documento =  '".$ids."'
+							ORDER BY
+							d.id_devuelto DESC
+							LIMIT 1";
+				
+				$query_des = new Consulta($sql_des);		
+				$row_des = $query_des->ConsultaVerRegistro();		
+				
+				if(!empty($row_des['descripcion'])){
+					$tooltip="title ='".$row_des['descripcion']."' class='tip'";
+				}						
+			}
+			elseif($estado==11){
+
+				$sql_des = "SELECT
+							a.id_archivo AS ultimo,
+							a.descripcion AS descripcion
+							FROM
+							archivo AS a
+							WHERE
+							a.id_documento =  '".$ids."'
+							ORDER BY
+							a.id_archivo DESC
+							LIMIT 1";
+				
+				$query_des = new Consulta($sql_des);		
+				$row_des = $query_des->ConsultaVerRegistro();
+				
+				if(!empty($row_des['descripcion'])){
+					$tooltip="title ='".$row_des['descripcion']."' class='tip'";
+				}
+				
+			}elseif($estado==16||$estado==17){
+				$doc_d_a = new Documento($row_reg['id']);				
+				$tooltip="title ='".$doc_d_a->ObtenerDescripcionUltimoOriginal($estado)."' class='tip'";
+			}
+			
+			
+		?>
+				
+		<td align="center" <? if($cat == 1) echo $tooltip;?> width="5%">
+			<div align="center">
+			<? if($cat == 1){?>
+			  <? if($estado==11){?>
+			  <a href="javascript:QuitarArchivado(<?=$row_reg['id']?>)" id="desarchivar">
+			    <?=$row_reg['estado'];?>
+			  </a>
+		        <? }elseif($estado==12){?>
+			  <a href="javascript:QuitarFinalizar(<?=$row_reg['id']?>)" id="nofinalizar">
+			  	<?=$row_reg['estado'];?>
+			  </a>
+		        <? }
+				else{?>				
+			     <input type="text" value="<?=$row_reg['estado'];?>" size="3" style="text-align:center; width:100%"/>
+		        <? }?>				    
+			<? }else{
+				$doc = new Documento();
+				$estado = $doc->ObtenerEstadoCopia($ids,1); 
+				?>				
+				<input type="text" value="<?=$estado?>" size="3" style="text-align:center; width:100%"/>
+			<? }?>
+			</div>
+			</td>
+		<td align="center" width="4%">
+			<div align="center">
+			<input type="text" value="<? echo ($row_reg['categoria']=='1')?'O':'C' ?>" style=" width:20PX; text-align:center"/>
+			</div>		</td>
+
+      <?php
+
+		$sql_data=" SELECT a.abve_nombre_area
+					FROM
+					areas AS a 
+					WHERE
+					a.id_area = '".$_SESSION['session'][5]."' ";
+					
+		$query_data=new Consulta($sql_data);		
+		$data=$query_data->ConsultaVerRegistro();
+	?>
+      <td>
+	 <?  
+		if($row_reg['categoria']!=1){
+			$doc = new Documento();
+			$ubic = $doc->ObtenerUbicacionCopia($ids,1);
+			$area = $data['abve_nombre_area'];
+			$tooltip_ubic = "";
+			
+			if(count($ubic)>0){
+				$cont = 0;
+				foreach($ubic as $u){
+					if($cont==0)
+						$tooltip_ubic = $tooltip_ubic."$area - ".$u["destino"];
+					else
+						$tooltip_ubic = $tooltip_ubic."<br/>$area - ".$u["destino"];
+					$cont++;
+				} 
+				if(count($ubic)==1){
+				?>
+				<input type="text" value="<?=$tooltip_ubic?>" style="width:95%"/>	
+				<? }else{?>
+				<input type="text" value="<?=$area."- Varios"?>" style="width:95%" title ='<?=$tooltip_ubic?>' class='tip'/>
+		<?		}
+			}else{
+		?>
+			<input type="text" value="<?=$area?>" style="width:95%"/>	
+		<?	} 
+		} 
+		elseif($row_reg['id_estado']=='3'||$row_reg['id_estado']=='12'||$row_reg['id_estado']=='16'||$row_reg['id_estado']=='17'){			
+	?>
+			<input type="text" value="<?=$data['abve_nombre_area']?>" />        	
+        <? }elseif($row_reg['id_estado']=='13'){
+			$sql_area_derivado= "SELECT ha.id_historial_atencion AS ultimo, 
+								a.id_area AS area,
+								a.abve_nombre_area AS abreviatura	
+								FROM
+								historial_atencion AS ha
+								Inner Join areas AS a ON a.id_area = ha.id_area_destino
+								WHERE
+								ha.id_documento=".$ids." and
+								ha.tipo_historial_atencion = 1 and
+								ha.original_historial_atencion = 1
+								ORDER BY
+								ultimo DESC
+								LIMIT 1";
+						
+			$query_area_derivado = new Consulta($sql_area_derivado);		
+			$row_area_derivado = $query_area_derivado->ConsultaVerRegistro();
+			?>
+        <input name="text" type="text" value="<?=$row_area_derivado["abreviatura"]?>" />
+        <? }elseif($row_reg['id_estado']=='4'||$row_reg['id_estado']=='18'){		
+				
+				$sql_usu = "SELECT
+							ha.id_historial_atencion AS ultimo,
+							a.abve_nombre_area AS abreviatura,
+							u.login_usuario
+							FROM
+							historial_atencion AS ha
+							Inner Join areas AS a ON a.id_area = ha.id_area
+							LEFT Join usuarios AS u ON u.id_usuario = ha.id_usuario_destino
+							WHERE
+							ha.id_documento=$ids and
+							(ha.tipo_historial_atencion = 0 
+							OR ha.tipo_historial_atencion = 5 
+							)and
+							ha.original_historial_atencion = 1
+							ORDER BY
+							ultimo DESC
+							LIMIT 1";
+		
+				$query_usu=new Consulta($sql_usu);		
+				$usu=$query_usu->ConsultaVerRegistro();
+				?>
+				<input type="text" value="<?=$usu['abreviatura'].' - '.$usu['login_usuario']?>" />
+			<?	
+			}elseif($row_reg['id_estado']=='6'){
+			
+				$sql_usu = "SELECT
+							a.abve_nombre_area AS abreviatura,
+							u.login_usuario AS login_usuario
+							FROM
+							borradores_respuesta AS b
+							Inner Join usuarios AS u ON u.id_usuario = b.id_destino
+							Inner Join areas AS a ON a.id_area = u.id_area 							
+							WHERE
+							b.id_documento =  '".$ids."' AND
+							b.categoria =  '1'
+							ORDER BY
+							b.fecha_borrador_respuesta DESC
+							LIMIT 1";
+							
+				$query_usu=new Consulta($sql_usu);		
+				$usu=$query_usu->ConsultaVerRegistro();
+			?>
+				<input type="text" value="<?=$usu['abreviatura'].' - '.$usu['login_usuario']?>" />
+			<? } elseif($row_reg['id_estado']=='11'){
+			
+				$sql_usu = "SELECT
+							ar.abve_nombre_area
+							FROM
+							archivo AS a
+							Inner Join areas AS ar ON a.id_area = ar.id_area
+							WHERE
+							a.id_documento =  '".$ids."'
+							ORDER BY a.id_archivo DESC
+							LIMIT 1";
+							
+				$query_usu=new Consulta($sql_usu);		
+				$usu=$query_usu->ConsultaVerRegistro();
+			?>
+				<input type="text" value="<?=$usu['abve_nombre_area']?>" />
+			<? }	 	 	
+	?>	 </td>
+    </tr>
+	<?	
+	     } //Fin de if categoria = 1
+	 	}//Fin de if anterior = codigo
+	 } //Fin de While
+	 ?>
+		 </table>
+		</td>
+	</tr>
+</table>
+</div>
+
+<?php }//Fin de Funcion
+
+function Busqueda($campo, $valor){	
+
+	if($campo == "nombre_remitente"){
+		$where = $campo == "nombre_remitente" ? " AND r.nombre_remitente like '%$valor%' " : "";
+	}else{
+		$where = $campo != "" ? " AND d.$campo like '%$valor%' " : ""  ;
+	}
+
+	$sql_reg = "SELECT  				
+				hd.id_documento as id,
+				d.fecha_registro_documento as fecha,
+				d.asunto_documento as asunto,
+				d.codigo_documento as codigo,
+				td.nombre_tipo_documento as tipo,
+				r.nombre_remitente as remitente,
+				hd.original_historial_documento as categoria,
+				d.numero_documento as numero,
+				d.id_estado as id_estado,
+				e.abrev_nombre_estado as estado
+				FROM
+				historial_documentos AS hd
+				Inner Join documentos AS d ON d.id_documento = hd.id_documento
+				Inner Join estados AS e ON e.id_estado = d.id_estado
+				Inner Join remitentes AS r ON r.id_remitente = d.id_remitente
+				Inner Join tipos_documento AS td ON d.id_tipo_documento = td.id_tipo_documento				
+				WHERE
+				(d.id_estado >  '1' AND d.id_estado <> 14) $where AND
+				hd.id_area = ".$_SESSION['session'][5]."
+				UNION
+				SELECT
+				ha.id_documento as id,				
+				d.fecha_registro_documento as fecha,
+				d.asunto_documento as asunto,
+				d.codigo_documento as codigo,
+				td.nombre_tipo_documento as tipo,
+				r.nombre_remitente as remitente,
+				ha.original_historial_atencion as categoria,
+				d.numero_documento as numero,
+				d.id_estado as id_estado,
+				e.abrev_nombre_estado as estado
+				FROM
+				historial_atencion AS ha
+				Inner Join documentos AS d ON ha.id_documento = d.id_documento
+				Inner Join estados AS e ON d.id_estado = e.id_estado
+				Inner Join tipos_documento AS td ON d.id_tipo_documento = td.id_tipo_documento
+				Inner Join remitentes AS r ON d.id_remitente = r.id_remitente
+				WHERE
+				(
+                (ha.id_area = '".$_SESSION['session'][5]."' AND ha.tipo_historial_atencion=0) OR
+				(ha.id_area_destino = '".$_SESSION['session'][5]."' AND ha.tipo_historial_atencion>0)
+                ) 
+				AND (d.id_estado >  '1' AND d.id_estado <> 14) $where
+				ORDER BY codigo DESC, categoria ";
+	
+	$query_reg = new Consulta($sql_reg);	
+	
+?>
+
+<div class="ui-jqgrid ui-widget ui-widget-content ui-corner-all">
+<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" id="tabla_despacho" class="gview_frmgrid">
+	<tr>
+		<td>
+			<table width="100%" class="ui-jqgrid-htable" cellpadding="0" cellspacing="0">
+				<tr bgcolor="#6699CC" class="ui-widget-header ui-th-column grid_resize" height="25">
+					<th width="16%" class="ui-widget-header ui-th-column grid_resize">Reg. Nro</th>
+					<th width="26%" class="ui-widget-header ui-th-column grid_resize">Remitente</th>
+					<th width="26%" class="ui-widget-header ui-th-column grid_resize">Documento</th>
+					<th width="13%" class="ui-widget-header ui-th-column grid_resize">Registrado</th>
+					<th width="6%" class="ui-widget-header ui-th-column grid_resize">Estado</th>
+					<th width="4%" class="ui-widget-header ui-th-column grid_resize">Cat</th>
+					<th class="ui-widget-header ui-th-column grid_resize">Ubicacion</th>
+				</tr>			
+			</table>
+		</td>
+	</tr>
+	<tr class="ui-jqgrid-bdiv">
+		<td>
+			<table id="frmgrid" width="100%" class="ui-jqgrid-btable" cellpadding="0" cellspacing="0">
+		<?php 
+			$codigo = "";
+			
+			while($row_reg=$query_reg->ConsultaVerRegistro()){
+									
+				$ids=$row_reg['id'];
+				$anterior = $codigo;
+				$codigo=$row_reg["codigo"];
+				$cat = $row_reg['categoria'];
+				if($codigo!=$anterior){
+				
+        		$estado=$row_reg["id_estado"];        
+				$clase = "Estilo7";						
+				if($estado==12){
+					$clase = "Estilo7 fila_finalizada";
+				}else{
+					$dias_faltantes = ObtenerDiasFaltantes($ids, date('d/m/Y',strtotime($row_reg['fecha'])));
+					if($dias_faltantes <=0)
+						$clase = "Estilo7 fila_peligro";
+					elseif($dias_faltantes > 0 && $dias_faltantes <= 3)
+						$clase = "Estilo7 fila_urgente";
+					else	
+						$clase = "Estilo7 fila_baja";
+				}	
+				
+				$tooltip_asunto="";
+				
+				if(!empty($row_reg['asunto'])){
+					$tooltip_asunto="title ='".$row_reg['asunto']."' class='tip'";
+				}		
+			?>
+			
+		<tr class="ui-widget-content1 jqgrow <?=$clase?>">
+		<td width="16%" <?=$tooltip_asunto?>>
+			<div align="center">
+			  <? if($estado==11&&$cat==1){?>
+			  		<?=$row_reg['codigo']?>
+			  <? }
+				else{?>
+				<a href="areas_acceso_registro.php?opcion=despachar&ids=<?=$ids?>&cat=<?=$row_reg['categoria']?>">
+			  <?=$row_reg['codigo']?>
+			  </a>		  
+			      <? }?>	
+	        </div>
+		</td>  
+		<td width="26%"><input name="Input" value="<?=$row_reg['remitente']?>" size="35"/></td>
+		<td width="26%"><input name="Input2" value="<?=$row_reg['numero']?>" size="40"/></td>
+		<td width="13%"> 
+		  	<input type="text" value="<?=date('d/m/Y H:i',strtotime($row_reg['fecha']))?>" style="text-align:center;width:100%;"/>		  </td>
+		  <?php
+			$tooltip="";
+			if($row_reg['id_estado']==5){
+				$sql_des = "SELECT
+							d.id_devuelto AS ultimo,
+							d.descripcion AS descripcion
+							FROM
+							devuelto AS d
+							WHERE
+							d.id_documento =  '".$ids."'
+							ORDER BY
+							d.id_devuelto DESC
+							LIMIT 1";
+				
+				$query_des = new Consulta($sql_des);		
+				$row_des = $query_des->ConsultaVerRegistro();	
+				if(!empty($row_des['descripcion'])){
+					$tooltip="title ='".$row_des['descripcion']."' class='tip'";
+				}							
+			}
+			elseif($row_reg['id_estado']==11){
+
+				$sql_des = "SELECT
+							a.id_archivo AS ultimo,
+							a.descripcion AS descripcion
+							FROM
+							archivo AS a
+							WHERE
+							a.id_documento =  '".$ids."'
+							ORDER BY
+							a.id_archivo DESC
+							LIMIT 1";
+				
+				$query_des = new Consulta($sql_des);		
+				$row_des = $query_des->ConsultaVerRegistro();			
+			
+				if(!empty($row_des['descripcion'])){
+					$tooltip="title ='".$row_des['descripcion']."' class='tip'";
+				}
+			
+			}elseif($estado==16||$estado==17){
+				$doc_d_a = new Documento($row_reg['id']);				
+				$tooltip="title ='".$doc_d_a->ObtenerDescripcionUltimoOriginal($estado)."' class='tip'";
+			}
+			
+			
+		?>
+				
+		<td width="6%" align="center" <?=$tooltip?>>
+			<div align="center">
+			  <? if($estado==11){?>
+			  <a href="javascript:QuitarArchivado(<?=$row_reg['id']?>)" id="desarchivar">
+			    <?=$row_reg['estado'];?>
+			    </a>
+		        <? }elseif($estado==12){?>
+			  <a href="javascript:QuitarFinalizar(<?=$row_reg['id']?>)" id="nofinalizar">
+			    <?=$row_reg['estado'];?>
+			    </a>
+		        <? }
+				else{?>
+		        <input name="text3" type="text" style="text-align:center" value="<?=$row_reg['estado'];?>" size="3" maxlength="3"/>
+		        <? }?>		
+		    </div></td>
+		<td align="center" width="4%"><div align="center">
+		  <input name="text2" type="text" style=" width:20PX; text-align:center" value="<? echo ($row_reg['categoria']=='1')?'O':'C' ?>"/>
+		  </div></td>
+		  <?php
+			$sql_data ="SELECT `a`.`abve_nombre_area`
+						FROM `areas` AS `a` 
+						WHERE
+						`a`.`id_area` =  '".$_SESSION['session'][5]."' ";
+
+			$query_data=new Consulta($sql_data);		
+			$data=$query_data->ConsultaVerRegistro();
+			
+			$sql_usu = "SELECT 
+						Max(`ha`.`id_historial_atencion`) AS `ultimo`, 			
+						`ha`.`id_documento`, 
+						ha.original_historial_atencion, 
+						`usuarios`.`id_area`  
+						FROM  
+						`historial_atencion` AS `ha` 
+						Inner Join `usuarios` ON `usuarios`.`id_usuario` = `ha`.`id_usuario_destino` 
+						WHERE 
+						ha.id_documento='".$row_reg['id']."' and 
+						usuarios.id_area =  '".$_SESSION['session'][5]."'
+						GROUP BY
+						`ha`.`id_historial_atencion`	";
+
+		$query_usu=new Consulta($sql_usu);		
+		$usu=$query_usu->ConsultaVerRegistro();
+
+		$susu = "SELECT `u`.`login_usuario`
+				FROM
+				`historial_atencion` AS `ha`
+				Inner Join `usuarios` AS `u` ON `u`.`id_usuario` = `ha`.`id_usuario_destino`
+				WHERE
+				`ha`.`id_historial_atencion` = '".$usu['ultimo']."'  ";
+
+				$qusu=new Consulta($susu);		
+				$u=$qusu->ConsultaVerRegistro();
+?>
+
+      <td>
+	<? 
+		if($row_reg['categoria']!=1){
+			$doc = new Documento();
+			$ubic = $doc->ObtenerUbicacionCopia($ids,1);
+			$area = $data['abve_nombre_area'];
+			$tooltip_ubic = "";
+			
+			if(count($ubic)>0){
+				$cont = 0;
+				foreach($ubic as $u){
+					if($cont==0)
+						$tooltip_ubic = $tooltip_ubic."$area - ".$u["destino"];
+					else
+						$tooltip_ubic = $tooltip_ubic."<br/>$area - ".$u["destino"];
+					$cont++;
+				} 
+				if(count($ubic)==1){
+				?>
+				<input type="text" value="<?=$tooltip_ubic?>" style="width:95%"/>	
+				<? }else{?>
+				<input type="text" value="<?=$area."- Varios"?>" style="width:95%" title ='<?=$tooltip_ubic?>' class='tip'/>
+		<?		}
+			}else{
+		?>
+			<input type="text" value="<?=$area?>" style="width:95%"/>	
+		<?	} 
+		} 
+		elseif($row_reg['id_estado']=='3'||$row_reg['id_estado']=='12'||$row_reg['id_estado']=='16'||$row_reg['id_estado']=='17'){			
+	?>
+			<input type="text" value="<?=$data['abve_nombre_area']?>" />        	
+    <? }elseif($row_reg['id_estado']=='13'){
+			$sql_area_derivado= "SELECT ha.id_historial_atencion AS ultimo, 
+								a.id_area AS area,
+								a.abve_nombre_area AS abreviatura	
+								FROM
+								historial_atencion AS ha
+								Inner Join areas AS a ON a.id_area = ha.id_area_destino
+								WHERE
+								ha.id_documento=".$ids." and
+								ha.tipo_historial_atencion = 1 and
+								ha.original_historial_atencion = 1
+								ORDER BY
+								ultimo DESC
+								LIMIT 1";
+						
+			$query_area_derivado = new Consulta($sql_area_derivado);		
+			$row_area_derivado = $query_area_derivado->ConsultaVerRegistro();
+			?>
+			<input type="text" value="<?=$row_area_derivado["abreviatura"]?>" />					
+			<?					
+			}elseif($row_reg['id_estado']=='4'){		
+				
+				$sql_usu = "SELECT ha.id_historial_atencion AS ultimo, 
+							a.abve_nombre_area AS abreviatura,
+							u.login_usuario AS login_usuario	
+							FROM
+							historial_atencion AS ha
+							Inner Join areas AS a ON a.id_area = ha.id_area 
+							Inner Join usuarios AS u ON u.id_usuario = ha.id_usuario_destino
+							WHERE
+							ha.id_documento=".$ids." and
+							ha.tipo_historial_atencion = 0 and
+							ha.original_historial_atencion = 1
+							ORDER BY
+							ultimo DESC
+							LIMIT 1";
+							
+				$query_usu=new Consulta($sql_usu);		
+				$usu=$query_usu->ConsultaVerRegistro();
+			?>
+			<input type="text" value="<?=$usu['abreviatura'].' - '.$usu['login_usuario']?>" />					
+			<?	
+			}elseif($row_reg['id_estado']=='6'){
+			
+				$sql_usu = "SELECT
+							a.abve_nombre_area AS abreviatura,
+							u.login_usuario AS login_usuario
+							FROM
+							borradores_respuesta AS b
+							Inner Join usuarios AS u ON u.id_usuario = b.id_destino
+							Inner Join areas AS a ON a.id_area = u.id_area 							
+							WHERE
+							b.id_documento =  '".$ids."' AND
+							b.categoria =  '1'
+							ORDER BY
+							b.fecha_borrador_respuesta DESC
+							LIMIT 1";
+							
+				$query_usu=new Consulta($sql_usu);		
+				$usu=$query_usu->ConsultaVerRegistro();
+			?>
+			<input type="text" value="<?=$usu['abreviatura'].' - '.$usu['login_usuario']?>" />					
+			<? } elseif($row_reg['id_estado']=='11'){
+			
+				$sql_usu = "SELECT
+							ar.abve_nombre_area
+							FROM
+							archivo AS a
+							Inner Join areas AS ar ON a.id_area = ar.id_area
+							WHERE
+							a.id_documento =  '".$ids."'
+							ORDER BY a.id_archivo DESC
+							LIMIT 1";
+							
+				$query_usu=new Consulta($sql_usu);		
+				$usu=$query_usu->ConsultaVerRegistro();
+			?>
+				<input type="text" value="<?=$usu['abve_nombre_area']?>" />
+			<? }	 	 	
+		?></td>
+		</tr><? 
+		}
+		}?>
+		 </table>
+		</td>
+	</tr>
+</table>
+</div>
+
+          <? }
+
+function ConsultarDocumento($ids){
+
+	$sql_resumen="SELECT *
+				FROM
+				documentos
+                LEFT Join remitentes ON remitentes.id_remitente = documentos.id_remitente
+				LEFT Join tipos_documento ON tipos_documento.id_tipo_documento = documentos.id_tipo_documento
+				WHERE
+				documentos.id_documento = '".$ids."'";
+				
+				$query_resumen=new Consulta($sql_resumen);
+				$row_resumen=$query_resumen->ConsultaVerRegistro(); 
+				
+	$estado = $row_resumen["id_estado"];
+
+	//Esta finalizado
+	if($estado==12){		
+		
+		$doc = new Documento ($ids);
+		$escaneados = $doc->ObtenerTodosEscaneados();
+        $usu_actual = new Usuario($_SESSION['session'][0]);
+        $tipos = $usu_actual->ObtenerTiposDocumento();
+
+		$sql_sal = "SELECT * 
+					FROM saludo_despedida 
+					WHERE tipo = 0
+					ORDER BY descripcion";
+					
+		$query_sal = new Consulta($sql_sal);	
+		
+		$sql_des = "SELECT * 
+					FROM saludo_despedida
+					WHERE tipo = 1 
+					ORDER BY descripcion ";
+					
+		$query_des = new Consulta($sql_des);	
+
+        $sql = "SELECT id_documento_finalizado
+                FROM documento_finalizado
+                WHERE id_documento = ".$ids;
+
+        $query_f = new Consulta($sql);
+        $row_f = $query_f->VerRegistro();
+
+        $finalizado = new DocumentoFinalizado($row_f["id_documento_finalizado"]);
+
+	//Hacemos un post al popup	
+	?>	
+	<form id="form_documento_fin_imprimir" method="post" action="documento_finalizado.php" target="popup">
+	
+	<input type="hidden" name="id" id="id" value="<?=$ids?>">	
+	
+	<fieldset>
+		<legend>Documento Finalizado</legend>
+			   
+		<table width="100%" border="0" id="imprimir_documento_finalizado">
+		  <tr>
+		    <td class="Estilo22"><div align="left">Asunto</div></td>
+		    <td class="Estilo22"><div align="left">:</div></td>
+		    <td><div align="left">
+		      <input name="asunto" type="text" id="asunto" size="80" value="<?=$finalizado->getAsunto()?>"/>
+		      </div></td>
+	      </tr>
+		  <tr>
+		    <td class="Estilo22"><div align="left">Referencia</div></td>
+		    <td class="Estilo22"><div align="left">:</div></td>
+		    <td><div align="left">
+                    <input name="referencia" type="text" id="referencia" size="80" value="<?=$finalizado->getReferencia()?>"/>
+		      </div></td>
+	      </tr>
+		  
+		  
+		  <tr>
+		    <td class="Estilo22"><div align="left">Destinatario</div></td>
+		    <td class="Estilo22"><div align="left">:</div></td>
+		    <td><div align="left">
+                    <input name="destinatario" type="text" id="destinatario" size="80" value="<?=$finalizado->getDestinatario()?>"/>
+		      </div></td>
+	      </tr>
+		  <tr>
+		    <td class="Estilo22"><div align="left">Cargo</div></td>
+		    <td class="Estilo22"><div align="left">:</div></td>
+		    <td><div align="left">
+		      <input name="cargo" type="text" id="cargo" size="80" value="<?=$finalizado->getCargo()?>"/>
+	        </div></td>
+	      </tr>
+		  <tr>
+			<td width="17%" class="Estilo22"><div align="left">Tipo de Plantilla</div></td>
+			<td width="2%" class="Estilo22"><div align="left">:</div></td>
+			<td width="84%">
+			
+			  <div align="left">
+			    <select name="tipo" class="tipo_doc" id="tipo" style="width:150px">
+			      <option value="">---Tipo de Documento---</option>
+			      <?
+                    $ttip = count($tipos);
+                    for($i=0;$i<$ttip;$i++){?>
+                        <option value="<?=$tipos[$i]['id']?>">
+                            <?=$tipos[$i]['nombre']?>
+                        </option>
+			      <? }?>
+	            </select>
+	        </div></td>
+		  </tr>
+		  
+		  <tr>
+		    <td class="Estilo22"><div align="left">Despedida</div></td>
+		    <td class="Estilo22"><div align="left">:</div></td>
+		    <td>
+				<div align="left">
+				  <select name="despedida" id="despedida" style="width:400px">
+				    <option value="">---Despedida del Documento---</option>
+			        <?
+        			while($row_des=$query_des->ConsultaVerRegistro()){
+				?>	
+				    <option value="<?=$row_des[0]?>">
+			        <?=$row_des[1]?>
+			        </option>
+		            <? }?>	        	        
+			      </select>
+                </div></td>
+	      </tr>
+		  <tr>
+		    <td class="Estilo22"><div align="left">Documentos Adjuntos</div></td>
+		    <td class="Estilo22"><div align="left">:</div></td>
+		    <td>&nbsp;</td>
+	      </tr>
+		  
+		  <tr>
+		    <td colspan="2">&nbsp;</td>
+		    <td></td>
+	      </tr>
+		  <tr>
+			<td colspan="2">&nbsp;</td>
+			<td>
+			  <div align="left">
+			    <input name="vista" type="button" id="vista" value="Vista Preliminar" class="boton"/>
+			  </div>			</td>
+		  </tr>
+		</table>
+	  </fieldset>
+	    <fieldset>
+			<legend>Documentos Adjuntos</legend>	    	
+	        <table width="100%" align="center" id="lista_escaneados">
+              <tr>
+			  	<th width="5%" style="border-left-color:#6699cc">N&ordm;</th>
+                <th width="23%">Origen</th>
+                <th width="22%">Destino</th>
+				<th width="23%">Accion</th>
+                <th width="22%">Documento</th>
+				<th width="5%" style="border-right-color:#6699cc"><div align="center">
+				  <input type="checkbox" name="checkbox" value="checkbox" />
+			    </div></th>
+              </tr>
+			  <?
+			  $tam = count($escaneados);
+
+			  for($i = 0 ; $i < $tam ; $i++){
+			  
+			  	$escaneado = $escaneados[$i];
+				
+				$accion = $escaneado["accion"];
+				$nombre = $escaneado["nombre"];
+				
+				if($escaneado["tipo"]==2){
+					$usuario = $escaneado["usuario"];
+					$a_destino = $escaneado["area_destino"];
+					$origen = $usuario->getNombreCompleto();
+					$destino = $a_destino->getNombre();					
+				}elseif($escaneado["tipo"]==1){					
+					$origen = $escaneado["usuario"];
+					$destino = $escaneado["usuario_destino"];
+				}else{
+					$usuario = $escaneado["usuario"];
+					$u_destino = $escaneado["usuario_destino"];
+					$origen = $usuario->getNombreCompleto();
+					$destino = $u_destino->getNombreCompleto();
+				}
+				
+				if($escaneado["tipo"]==2||$escaneado["tipo"]==4)//Justidicacion por propuestas 
+					$ref = "Justificados/".rawurlencode($nombre);
+				elseif($escaneado["tipo"]==0) //De Borradores
+					$ref = "Archivados/".rawurlencode($nombre);
+				else{
+					if(is_null($escaneado['fecha']))//El propio documento
+					$ref = "Escaneo/".rawurlencode($nombre);
+				else
+					$ref = "../archivo/Escaneado_completo/".$row_resumen[1]."/".rawurlencode($nombre);
+				}
+			  
+			  ?>
+              <tr>
+                <td width="5%" style="padding:0px;"><div align="center">
+                  <?=($i+1)?>
+                </div></td>
+                <td width="23%"><div align="left">
+                  <?=$origen?>
+                </div></td>
+                <td width="22%"><div align="left">
+                  <?=$destino?>
+                </div></td>
+                <td width="23%"><div align="left">
+                  <?=$accion?>
+                </div></td>
+                <td><div align="left"><a href="<?=$ref?>" target="_blank">
+                <?=$nombre?>
+                </a></div></td>
+                <td width="5%"><div align="center"><input type="checkbox" name="checkbox2" value="checkbox" /></div></td>
+              </tr>
+			  <? }?>
+            </table>
+	        <p>&nbsp;</p>
+		</fieldset>
+	</form>
+    <?
+	}else{
+		
+		if($row_resumen['id_estado']==3){//Viene de despacho
+			$edi="SELECT
+				`td`.`asunto_documento`,
+				`td`.`observacion_documento`,
+				`td`.`id_prioridad`,
+				`hd`.`observacion_historial_documento`,
+				`td`.`id_documento`,
+				`hd`.`original_historial_documento`
+				FROM
+				`documentos` AS `td`
+				Inner Join `historial_documentos` AS `hd` ON `hd`.`id_documento` = `td`.`id_documento`
+				WHERE
+				`hd`.`id_documento` =  '".$ids."' AND 
+				`hd`.id_area=".$_SESSION['session'][5];
+				
+		}else{//Viene de una derivacion o despacho de area (es original o copia del original)
+				
+			$edi="SELECT
+				`td`.`asunto_documento`,
+				`td`.`observacion_documento`,
+				`td`.`id_prioridad`,
+				`hd`.`observacion_historial_documento`,
+				`td`.`id_documento`,
+				`hd`.`original_historial_documento`
+				FROM
+				`documentos` AS `td`
+				Inner Join `historial_documentos` AS `hd` ON `hd`.`id_documento` = `td`.`id_documento`
+				WHERE
+				`hd`.`id_documento` =  '".$ids."' AND 
+				`hd`.original_historial_documento=1";
+		}
+
+			$qedit=new Consulta($edi);	
+			$row_edit=$qedit->ConsultaVerRegistro();
+
+			$_POST['idhd']=$row_edit['id_historial_documento']; 
+
+			$escaneo = "SELECT * 
+						from documentos_escaneados de
+						where de.id_documento = ".$ids;
+						
+			$qescaneo = new Consulta($escaneo);
+
+		?>
+     <fieldset>
+  <legend class="Estilo9">DATOS DEL DOCUMENTO</legend>
+
+  <table border="0" align="center" bordercolor="#000000" bgcolor="#ffffff" width="100%">
+    <tbody>    
+      <tr>
+      <td width="20%" class="Estilo22"><div align="left">Nro. Registro</div></td>
+      <td width="2%" class="Estilo22"><div align="center">:</div></td>
+      <td width="38%" class="Estilo23"><div align="left">
+        <?=$row_resumen[1]?>
+      </div></td>
+      <td width="15%" class="Estilo22"><div align="left">Categor&iacute;a</div></td>
+      <td width="2%" class="Estilo22"><div align="center">:</div></td>
+      <td class="Estilo23">
+	  	<div align="left"><?=($_REQUEST["cat"]==1)?"Original":"Copia"?>
+		</div>	  </td>
+      </tr>
+      <tr>
+        <td class="Estilo22"><div align="left">Remitente</div></td>
+        <td class="Estilo22"><div align="center">:</div></td>
+        <td class="Estilo23">          
+        <div align="left"><?=$row_resumen['nombre_remitente']?></div></td>
+        <td class="Estilo22"><div align="left">Nro de Folios</div></td>
+        <td class="Estilo22"><div align="center">:</div></td>
+        <td class="Estilo23" ><div align="left">
+          <?=$row_resumen['numero_folio_documento']?>
+        </div></td>
+      </tr>
+      <tr>
+        <td class="Estilo22"><div align="left">Nro. Documento</div></td>
+        <td class="Estilo22"><div align="center">:</div></td>
+        <td class="Estilo23"><div align="left">
+          <?=$row_resumen['numero_documento']?>
+        </div></td>
+      
+        <td class="Estilo22"><div align="left">Fecha de Doc</div></td>
+        <td class="Estilo22"><div align="center">:</div></td>
+        <td class="Estilo23"><div align="left"><?php echo date('d/m/Y',strtotime($row_resumen['fecha_documento']))?></div></td>
+      </tr>
+      <tr>
+        <td class="Estilo22"><div align="left">Tipo de Documento</div></td>
+        <td class="Estilo22"><div align="center">:</div></td>
+        <td colspan="4" class="Estilo23"><div align="left">
+          <?=$row_resumen['nombre_tipo_documento']?>
+        </div></td>
+      </tr>
+      <tr>
+        <td class="Estilo22"><div align="left">Referencia</div></td>
+        <td class="Estilo22"><div align="center">:</div></td>
+        <td colspan="4" class="Estilo23"><div align="left"><?=$row_resumen['referencia_documento']?>
+        </div></td>
+      </tr>
+      <tr>
+        <td class="Estilo22"><div align="left">Anexos</div></td>
+        <td class="Estilo22"><div align="center">:</div></td>
+        <td colspan="4" class="Estilo23"><div align="left">
+          <?=$row_resumen['anexo_documento']?>
+        </div></td>
+      </tr>
+      <tr>
+          <td bgcolor="#ffffff" class="Estilo22"><div align="left">Documento Digitalizado</div></td>
+          <td bgcolor="#ffffff" class="Estilo22"><div align="center">:</div></td>
+        <td colspan="4"><div align="left"><span class="Estilo23">
+          <?
+	  		$index = 1;
+			
+			while($row_reg = $qescaneo->ConsultaVerRegistro()){
+				if(is_null($row_reg['fecha_escaneo']))
+					$ref = "Escaneo/".$row_reg['nombre_documento_escaneado'];
+				else
+					$ref = "../archivo/Escaneado_completo/".$row_resumen[1]."/".$row_reg['nombre_documento_escaneado'];			
+			?>
+          	<a href="<?=$ref?>" id="<?=$row_reg["id_documento_escaneado"]?>" target="_blank"><?=$index?></a>
+		  	<?
+				$index++;
+            }
+	  		?>               
+            </span>
+          <?=$id?>
+          <? if($row_edit['original_historial_documento']=='1'){ ?>
+          <? } else { "null" ;}?>
+        </div></td>
+      </tr>
+      <tr>
+        <td class="Estilo22"><div align="left">Fecha y Hora de Registro</div></td>
+        <td class="Estilo22"><div align="center">:</div></td>
+        <td colspan="4" class="Estilo23"><div align="left"><?php echo date('d/m/Y H:I:s',strtotime($row_resumen["fecha_registro_documento"]))?></div>   
+       </td>
+      </tr>
+    </tbody>
+</table>
+<p align="left"><a href="javascript:verDetalleDoc()" id = "control" class="v" >Ver Detalles </a></p>
+<div id="detalle_documento" style="display:none">
+<table border="0" align="center" bordercolor="#000000" bgcolor="#ffffff" width="100%">
+<tbody>          
+      <tr>
+        <td width="20%" class="Estilo22"><div align="left">Asunto</div></td>
+        <td width="2%" class="Estilo22"><div align="center">:</div></td>
+        <td colspan="38%"><div align="left">
+          <textarea name="textfield2" id="textfield2" rows="2" cols="100" class="disabled" disabled="disabled"><?=$row_edit[0]?>
+        </textarea>
+        </div></td>
+      </tr>
+      <tr>
+        <td width="20%" class="Estilo22"><div align="left">Observaci&oacute;n Registro</div></td>
+        <td width="2%" class="Estilo22"><div align="center">:</div></td>
+        <td colspan="5"><div align="left">
+          <textarea name="textarea2" id="textarea2" rows="2" cols="100" class="disabled" disabled="disabled"><?=$row_edit[1]?>
+        </textarea>
+        </div></td>
+      </tr>
+      <tr>
+      <td class="Estilo22"><div align="left">Observaci&oacute;n Despacho</div></td>
+      <td class="Estilo22"><div align="center">:</div></td>
+      <td colspan="5"><div align="left">
+        <textarea name="textarea3" id="textarea3" rows="2" cols="100" class="disabled" disabled="disabled"><?=$row_edit[3]?>
+        </textarea>
+      </div></td>
+      </tr>
+      <tr>
+      <td class="Estilo22"><div align="left">Prioridad</div></td>
+      <td class="Estilo22"><div align="center">:</div></td>
+      <td colspan="5"><div align="left"><span class="Estilo23">
+        <?
+	  
+	  $sql_prioridad = "SELECT prioridades.id_prioridad, 
+	  					prioridades.nombre_prioridad, 
+						prioridades.tiempo_horas_respuesta_prioridad/24 AS dias,
+						prioridades.tiempo_horas_respuesta_prioridad AS horas
+						FROM prioridades 
+						where 
+						prioridades.id_prioridad='".$row_resumen["id_prioridad"]."' 
+						ORDER BY prioridades.id_prioridad ASC";
+    	
+		$query_prioridad=new Consulta($sql_prioridad);
+		$row_prioridad=$query_prioridad->ConsultaVerRegistro();
+		
+		$documento_p = new Documento($ids);		
+		?>		
+        <?=$row_prioridad["nombre_prioridad"]?>        
+        </span>		
+      </div></td>
+	  </tr>
+      <tr>
+        <td class="Estilo22"><div align="left">Tiempo de Respuesta</div></td>
+        <td bgcolor="#ffffff" class="Estilo22"><div align="center">:</div></td>
+        <td width="19" class="Estilo23">
+		  <div align="left">
+		    <?=number_format($row_prioridad["dias"],0)?>
+        </div></td>
+        <td width="296" class="Estilo23"><div align="left"><? echo "dias";?></div></td>
+        <td width="131" class="Estilo23"><div align="left">Fecha Estimada de Respuesta</div></td>
+        <td width="11" class="Estilo23"><div align="center">:</div></td>
+        <td width="148" class="Estilo23"><div id="fecha_respuesta" align="left">
+          <?=$documento_p->setFechaRespuesta($row_prioridad["horas"])?>
+        </div></td>
+      </tr>
+</tbody>
+</table>
+</div>
+</fieldset>
+
+<form name="form_despacho_area" id = "form_despacho_area" method="post"  action="" >  
+
+	<?
+		$td="SELECT
+			td.id_documento,
+			td.observacion_historial_atencion
+			FROM
+			historial_atencion AS td
+			WHERE
+			td.id_documento =  '".$ids."'";
+		
+		$qtd=new Consulta($td);	
+		$row_td=$qtd->ConsultaVerRegistro();
+	?>
+
+<fieldset>
+  <legend class="Estilo9">ESTABLECER DESTINO Y ACCION A REALIZAR</legend>
+  <table align="center" border="0" class="formularios">
+  	<tbody>
+    	<tr>
+			<td height="12" class="Estilo21" >&nbsp;</td>
+			<td class="Estilo22" >&nbsp;</td>
+        	<td>&nbsp;</td>
+          	<td><input type="hidden" value="<?=$ids?>" name="id_documento" id="id_documento"/></td>
+          	<td width="41%" class="Estilo22" ><div align="left">Observaci&oacute;n Area:</div></td>
+			<td  bgcolor="#ffffff" class="Estilo21">&nbsp;</td>
+			<td  bgcolor="#ffffff" class="Estilo22">&nbsp;</td>
+			<td bgcolor="#ffffff" class="Estilo22">&nbsp;</td>
+			<td width="5%" rowspan="3" bgcolor="#ffffff" class="Estilo22">
+				<input type="hidden" value="<?=$_REQUEST['cat']?>" name="cat" id="cat"/>
+			</td>
+        </tr>
+		<tr>
+        	<td height="12" class="Estilo21" ><div align="center">(*)</div></td>
+        	<td width="6%" class="Estilo22" ><div align="left">Acc&iacute;on</div></td>
+        	<td><div align="center">:</div></td>
+        	<td width="33%" ><div align="left">
+        	  <?php
+				$acciones = new Acciones();
+				if($_REQUEST['cat']==1){
+					if($_SESSION['session'][6])
+						$accions = $acciones->getAcciones(4,$_SESSION['session'][0]);
+					else
+						$accions = $acciones->getAcciones(1,$_SESSION['session'][0]);
+				}else{
+					$accions = $acciones->getAcciones(5,$_SESSION['session'][0]);
+				}
+				$tacciones = sizeof($accions);				
+		?>
+          <select name="cboaccion2" style="width:200px" id="accion_despacho">
+            <option value="">--Seleccione Accion--</option>
+            <?php
+				for($u = 0; $u < $tacciones; $u++){ 
+				?>
+           		<option value="<?php echo $accions[$u]['id']?>"><?php echo $accions[$u]['nombre']?> </option>
+            <?php
+			}?>
+          </select>
+        </div>
+		</td>
+        <td width="41%" rowspan="2" class="Estilo22" >
+			<textarea name="textarea4" id="comentario" rows="3" cols="55"></textarea>
+		</td>
+        <td width="3%"  bgcolor="#ffffff" class="Estilo21"><div align="center">(*)</div></td>      
+	    <td width="3%"  bgcolor="#ffffff" class="Estilo22"><div align="center">
+        <input name="radiobutton" value="1" type="radio" id="original" />      
+      	</div>	  	</td>
+      	<td width="6%" bgcolor="#ffffff" class="Estilo22"><div align="left">Original</div></td>
+   	  </tr>
+      <tr>
+        <td height="13" class="Estilo21" ><div align="center">(*)</div></td>
+        <td width="6%" class="Estilo22" ><div align="left">Pase A</div></td>
+        <td ><div align="center">:</div></td>
+        <td><div align="left">
+          <?
+		
+    		$sql_areas="SELECT * 
+						FROM usuarios 
+						where usuarios.id_area='".$_SESSION['session'][5]."' ";
+						
+	    	$query_areas=new Consulta($sql_areas);
+		?>
+          <input name="hidden" type="hidden" id="idArea" value="<?=$_SESSION['session'][5]?>"/>
+          <select name="destino" id="destino" style="width:200px" class="usuarios">
+			<option value="" selected="selected">--- Seleccione un Usuario---</option>
+            <? while($row_areas=$query_areas->ConsultaVerRegistro()) {?>
+            <option value="<? echo $row_areas[0]?>">
+				<? echo $row_areas[nombre_usuario]." "?><? echo $row_areas[apellidos_usuario]?>
+			</option>
+            <? } ?>
+          </select>
+          <? if($_REQUEST["cat"]!=2){?>
+          <a href="javascript:void(0);" id="cambiar_destino" style="margin-left:5px;">Areas</a>
+          <? }?>
+        </div>
+		</td>
+        <td  bgcolor="#ffffff" class="Estilo21">&nbsp;</td>            
+        <td width="5%"  bgcolor="#ffffff" class="Estilo22">
+			<div align="center"><input name="radiobutton" value="2" type="radio" id="copia"/></div>
+		</td>
+		<td width="6%" bgcolor="#ffffff" class="Estilo22"><div align="left">Copia</div></td>
+	</tr>      
+    <tr>    
+        <td width="2%" height="26" class="Estilo21">&nbsp;</td>
+        <td width="6%" height="26" class="Estilo22" >&nbsp;</td>
+        <td width="1%" height="26" >&nbsp;</td>
+        <td>&nbsp;</td>
+        <td width="41%" class="Estilo22" >&nbsp;</td>
+        <td colspan="4" align="center">          
+          	<div align="right">
+            	<input type="button" name="CargarLista" id="cargar_accion_areas" value="Cargar Lista" class="boton"/>
+        	</div>
+		</td>
+      </tr>
+    </tbody>
+  </table>
+  </fieldset>
+</form>
+<div id="question" style="display:none; cursor: default"> 
+	<p class="Estilo22">&iquest;Est&aacute; seguro que desea enviar un <span id="conf_categoria" style="font-weight:bold; color: #D3455A">a</span> del documento a <span id="conf_usuario" style="font-weight:bold; color:#D3455A">b</span>?</p>
+	<p class="Estilo22">
+		<input type="button" id="yes_d_a" value="Si" class="boton"/> 
+		<input type="button" id="no_d_a" value="No" class="boton"/> 
+	</p>
+</div>
+<?	
+	$doc=new Documento($ids);
+	$tengoOriginal = $doc->DespachoAreaTieneOriginal();
+    $estado = $doc->getEstado();
+	if($_REQUEST["cat"]==2){
+	?> <script>
+			javascript:deshabilitado();
+			javascript:habilita_copia();
+		</script>	
+	<?
+	}elseif(!$tengoOriginal){ 
+	?> 
+		<script>
+		javascript:deshabilitado();
+		javascript:habilita_copia();
+		javascript:quita_archivar();				
+		</script>
+	<? }else{?>
+		<script>
+		javascript:habilitado();
+		javascript:deshabilita_copia();
+		</script>
+	<?
+	}
+    ?>
+        <script>javascript:accion_por_defecto_area(<?=$estado->getId()?>);</script>
+    <?
+	Registro::DespacharListarDestino($ids);
+}
+?>
+<? }
+
+function DespacharListarDestino($ids)  {  ?>
+
+<table width="100%" border="0" align="center" cellpadding="0" cellspacing="1" id="tabla_despacho" >
+	<tr bgcolor="#6699CC" class="Estilo7">
+		<td width="5%" height="25" ><div align="center" class="msgok1"><strong>Nro</strong></div></td>
+		<td width="21%"><div align="center" class="msgok1"><strong>ORIGEN</strong></div></td>
+		<td width="24%"><div align="center" class="msgok1"><strong>DESTINO</strong></div></td>
+		<td width="13%"><div align="center" class="msgok1"><strong>Fecha y Hora </strong></div></td>
+		<td width="13%"><div align="center" class="msgok1"><strong>Acci&oacute;n</strong></div></td>
+	  <td width="10%"><div align="center" class="msgok1"><strong>Categor&iacute;a</strong></div></td>
+	  <td width="14%"><div align="center" class="msgok1"><strong>Opciones </strong></div></td>
+	</tr>
+
+	<?
+
+	$sql_origen = " SELECT
+					hd.id_historial_documento AS id,
+					'6' AS tipo_historial,
+					null AS id_usuario_destino,
+					hd.id_area AS id_area_destino,
+					null AS id_usuario,
+					null AS id_area,
+					DATE_FORMAT(hd.fecha_historial_documento, '%Y-%m-%d %H:%i') AS fecha,				 
+					hd.original_historial_documento AS categoria,
+					hd.observacion_historial_documento AS observacion,
+					a.nombre_accion AS nombre_accion
+					FROM
+					historial_documentos AS hd
+					Inner Join accion AS a ON a.id_accion = hd.id_accion					
+					WHERE
+					hd.id_documento =  '".$ids."'
+					UNION
+					SELECT
+                    th.id_historial_atencion AS id,
+                    th.tipo_historial_atencion AS tipo_historial,
+                    th.id_usuario_destino AS id_usuario_destino,
+                    th.id_area_destino AS id_area_destino,
+                    th.id_usuario AS id_usuario,
+                    th.id_area AS id_area,
+					DATE_FORMAT(th.fecha_historial_atencion, '%Y-%m-%d %H:%i') AS fecha,
+                    th.original_historial_atencion AS categoria,
+                    th.observacion_historial_atencion AS observacion,
+                    tac.nombre_accion AS nombre_accion
+                    FROM
+                    historial_atencion AS th
+                    LEFT Join accion AS tac ON tac.id_accion = th.id_accion
+                    WHERE
+                    th.id_documento ='".$ids."'
+                    AND (th.tipo_historial_atencion = 0 OR th.tipo_historial_atencion = 1
+                    OR th.tipo_historial_atencion = 2 OR th.tipo_historial_atencion = 4)
+                    UNION
+                    SELECT
+                    b.id_borrador_respuesta AS id,
+                    '3' AS tipo_historial,
+                    b.id_destino AS id_usuario_destino,
+                    null AS id_area_destino,
+                    b.id_usuario AS id_usuario,
+                    b.id_area  AS id_area,
+					DATE_FORMAT(b.fecha_borrador_respuesta, '%Y-%m-%d %H:%i') AS fecha,
+                    b.categoria AS categoria,
+                    b.descripcion_borrador_respuesta AS observacion,
+                    accion.nombre_accion AS nombre_accion
+                    FROM
+                    borradores_respuesta AS b
+                    LEFT Join accion ON accion.id_accion = b.id_accion
+                    WHERE
+                    b.id_documento ='".$ids."'
+					UNION
+					SELECT
+					d.id_devuelto,
+					'7' AS tipo_historial,
+					null AS id_usuario_destino,
+					null AS id_area_destino,
+					d.id_usuario AS usuario,
+					d.id_area AS area,
+					DATE_FORMAT(d.fecha_devolucion, '%Y-%m-%d %H:%i') AS fecha,
+					'1' AS categoria,
+					d.descripcion,
+					'DEVOLVER A DESPACHO' AS nombre_accion
+					FROM
+					devuelto AS d
+					WHERE
+                    d.id_documento ='".$ids."'
+                    ORDER BY
+                    fecha ASC,
+                    categoria ASC";
+		   			
+                $query_origen = new Consulta($sql_origen);
+				
+				$query = new Consulta($sql_origen);
+				$ultimo_original=0;				
+				$contador = 1;
+								
+				while($row=$query->ConsultaVerRegistro()){//Recorremos para saber cual es el ltimo original
+									
+					if($row["categoria"]==1&&$contador!=1){
+						$ultimo_original=$contador; 								
+					}	
+					$contador++;	
+				}	
+					
+				$hayOriginal = 0;
+				$cont=0;
+											
+				while($row_org=$query_origen->ConsultaVerRegistro()){
+                    $noEsMio = '';
+					$idp=$row_org[0];
+
+                 if($row_org["tipo_historial"]==0){ //Es de AREA a usuarios del area
+					$id_ori = new Area($row_org['id_area']);
+                    $origen = $id_ori->getNombre();
+					$id_dest= new Usuario($row_org['id_usuario_destino']);
+                    $destino = $id_dest->getNombreCompleto();
+                 }elseif($row_org["tipo_historial"]==1){//Es de AREA a AREA									 
+                    $id_ori = new Area($row_org['id_area']);
+                    $id_des = new Area($row_org['id_area_destino']);
+                    $origen = $id_ori->getNombre();
+                    $destino = $id_des->getNombre();
+                 }elseif($row_org["tipo_historial"]==2){//Es de USUARIO a AREA
+                    $id_ori = new Usuario($row_org['id_usuario']);
+                    $id_des = new Area($row_org['id_area_destino']);
+                    $origen = $id_ori->getNombreCompleto();
+                    $destino = $id_des->getNombre();
+                 }elseif($row_org["tipo_historial"]==3||$row_org["tipo_historial"]==4||$row_org["tipo_historial"]==5){//Es de USUARIO a USUARIO
+                    $id_ori = new Usuario($row_org['id_usuario']);
+                    $id_des = new Usuario($row_org['id_usuario_destino']);
+                    $origen = $id_ori->getNombreCompleto();
+                    $destino = $id_des->getNombreCompleto();
+                 }elseif($row_org["tipo_historial"]==6){//Es de MESA a AREA                    
+                    $id_des = new Area($row_org['id_area_destino']);
+                    $origen = "DESPACHO GENERAL";
+                    $destino = $id_des->getNombre();
+                 }elseif($row_org["tipo_historial"]==7){//Es de AREA a MESA                    
+                    $id_ori = new Area($row_org['id_area']);
+                    $origen = $id_ori->getNombre();
+                    $destino = "DESPACHO GENERAL";
+                 }
+				 					 
+				 //Solo se muestra como historial(no lo hizo el area actual)
+				 if($row_org["id_area"]!=$_SESSION['session'][5])
+				 	$noEsMio = "class = 'historial'";
+	  ?>	
+		
+      <tr <?=$noEsMio?>>
+        <td><input type="hidden" value="<?=$idp?>"><div align="center"><?=++$cont?></div></td>
+        <td><?=$origen?></td>
+        <td><?=$destino?></td>
+        <td><div align="center"><?=date('d/m/Y H:i',strtotime($row_org['fecha']))?></div></td>
+        <td><div align="center"><?=$row_org['nombre_accion']?></div></td>
+        <td>
+			<div align="center"><? echo ($row_org['categoria']=='1')?'ORIGINAL':'COPIA';?></div>        </td>
+        <td>
+            <div align="center">				
+			<? 
+			if(($row_org['id_area']==$_SESSION['session'][5]||$row_org['id_usuario']==$_SESSION['session'][0]||$row_org['id_area_destino']==$_SESSION['session'][5])&&$row_org["categoria"]==2){?>
+				<a href="areas_acceso_registro.php?opcion=eliminar&ids=<?=$ids?>&idp=<?=$idp?>&cat=<?=$_REQUEST["cat"]?>&th=<?=$row_org["tipo_historial"]?>"><img src="public_root/imgs/b_drop.png" alt="Eliminar" width="16" height="16" border="0"></a>
+		<? }
+			elseif(($row_org['id_area']==$_SESSION['session'][5]||$row_org['id_usuario']==$_SESSION['session'][0]||$row_org['id_area_destino']==$_SESSION['session'][5])&&$ultimo_original==$cont){//Yo lo envie lo puedo eliminar
+		?>
+				<a href="areas_acceso_registro.php?opcion=eliminar&ids=<?=$ids?>&idp=<?=$idp?>&cat=<?=$_REQUEST["cat"]?>&th=<?=$row_org["tipo_historial"]?>"><img src="public_root/imgs/b_drop.png" alt="Eliminar" width="16" height="16" border="0"></a>
+		<? }
+			elseif($row_org['id_usuario']==$_SESSION['session'][0]&&$row_org["tipo_historial"]==3&&$ultimo_original==$cont){?>
+				<a href="areas_acceso_registro.php?opcion=eliminar&ids=<?=$ids?>&idp=<?=$idp?>&cat=<?=$_REQUEST["cat"]?>&th=<?=$row_org["tipo_historial"]?>"><img src="public_root/imgs/b_drop.png" alt="Eliminar" width="16" height="16" border="0"></a>
+		<? }
+			else{ ?>
+				<img src="public_root/imgs/b_drop_d.png" alt="Eliminar" width="16" height="16" border="0">
+		<? }//Fin del if de eliminar
+		?>            	
+			<?
+				$observacion = trim($row_org['observacion']);
+                if(!empty($observacion)){?>
+                   <a href="javascript:VerDetalleObservacion(<?php echo $cont ?>)">
+                     <img src="public_root/imgs/b_search.png" width="16" height="16" border="0" alt="Ver Detalle" />                   </a>
+                <?
+                }else{
+                ?>
+                   <img src="public_root/imgs/b_search_d.png" width="16" height="16" border="0" alt="Ver Detalle" />
+                <? }				
+				?>				
+            	<?
+                $tipo=$row_org['tipo_historial'];
+				if($tipo==2||$tipo==3||$tipo==4){
+					$doc_archivo=new Documento($ids);
+					$archivo = array();
+                    if($tipo==2||$tipo==4)
+                        $archivo = $doc_archivo->obtenerJustificacionesEscaneadas($idp);					
+                    else
+                        $archivo = $doc_archivo->obtenerBorradoresEscaneados($idp);
+
+    	            if(count($archivo)>0){?>
+                   	<a href="javascript:void(0)" onclick="ver_mas_adjuntos($(this))">
+                     		<img src="public_root/imgs/attach.png" width="16" height="16" border="0" alt="Ver Archivo" />	                    </a>
+					<div id="doc_adjuntos<?php echo ($cont) ?>" class="doc_adjuntos">
+						<p>Documentos Adjuntos : </p>
+						<? 						
+							for($i = 0; $i < count($archivo); $i++){								
+							?>
+								<p><a href="<? echo ($tipo==2||$tipo==4)?"Justificados/".rawurlencode($archivo[$i]):"Archivados/".rawurlencode($archivo)?>"  target="_blank"><?=$archivo[$i]?></a></p>
+						<? }?>
+					</div>		
+                <?
+                	}
+                   else{
+                ?>
+                   <img src="public_root/imgs/attach_d.png" width="16" height="16" border="0" alt="Ver Archivo"/>
+                <? }
+				}else{?>
+                    <img src="public_root/imgs/attach_d.png" width="16" height="16" border="0" alt="Ver Archivo"/>
+                <? }
+                ////Fin del if para file.gif
+				?>
+			</div>        </td>
+      </tr>
+	  <tr>
+		<td colspan="7" align="center">
+			<div style="display:none; text-align:left;" id="detalle_observacion<?=$cont?>">
+					<?=$observacion?>
+			</div>
+		</td>
+	</tr>
+     <? } //Fin del While ?>
+  </tr>    
+</table> 
+
+ <?
+	
+}
+
+function DespacharGuardarDestino($ids) {
+
+    $nombre=$_POST['nombre'];
+	$fecha_actual = time()-3600;
+	$fecha=date("Y-m-d H:i:s",$fecha_actual);
+    $destino=$_POST['destino'];
+    $radiobutton=$_POST['radiobutton'];
+    $cboaccion2=$_POST['cboaccion2'];
+    $cboprioridad=$_POST['cboprioridad'];
+    $textarea4=$_POST['textarea4'];    
+    $idhd=$_POST['idhd'];
+    $usu=$_SESSION['session'][0];
+    $idarea= $_SESSION['session'][5];
+    $usuario = new Usuario($usu);
+    $id_area_destino = "'null'"; //Para una DA (area-usuario) como es de mi area
+                                 // No se coloca area destino
+	$ubicacion = "";
+	
+    $sqlrep =  "SELECT id_documento_reporte as id
+                FROM documentos_reporte
+                WHERE id_documento=$ids";
+
+    $qrep=new Consulta($sqlrep);
+    $rowrep=$qrep->VerRegistro();
+	
+	$documento = new Documento($ids);      
+    $accion = new Accion($cboaccion2);
+	
+	//Obtenermos el ultimo estado
+	//$documento = new Documento($ids);
+	//$c_estado = $documento->getEstado();
+	
+    if($usuario->esMiArea($destino)){ //Es un Despacho de Area (Area a Usuario)
+        $tipo = 0;
+        $estado='4';
+        $a_origen = new Area($_SESSION['session'][5]);
+        $origen = $a_origen->getNombre();
+        $u_destino = new Usuario($destino);
+        $n_destino = $u_destino->getNombreCompleto();
+		//if($radiobutton==1){
+            $ubicacion = $a_origen->getAbreviatura()."-".$u_destino->getLogin();
+			$est='DA';
+            $esta = 'DESPACHADO DE AREA';
+		//}else{	
+			//$est = $c_estado->getId();
+			//$esta = $c_estado->getNombre();
+		//}
+
+    }
+    else{    //Es una Derivacion de Documento (Area a Area)
+        $usuario_destino = new Usuario($destino);
+        $area_destino = $usuario_destino->getArea();
+        $id_area_destino = $area_destino->getId();
+        $a_origen = new Area($_SESSION['session'][5]);
+		$origen = $a_origen->getNombre();
+		$n_destino = $area_destino->getNombre();
+		$destino = '';//Para que no guarde en historial de atencion
+        $tipo = 1;
+        $estado='13';
+        			
+		//if($radiobutton==1){
+			$ubicacion = $area_destino->getAbreviatura();
+			$est='DR';
+            $esta = 'DOCUMENTO DERIVADO';
+		//}else{
+			//$est = $c_estado->getId();
+			//$esta = $c_estado->getNombre();
+		//}
+    }  
+
+    $guades="Insert INTO
+             historial_atencion values('',
+			 '".$idhd."',
+			 '".$ids."',
+			 '".$destino."',
+			 ".$id_area_destino.",
+			 '".$idarea."',
+			 '".$fecha."',
+			 '".$radiobutton."',
+			 '".$cboaccion2."',
+			 '".$usu."',
+			 '".$estado."',
+			 '".$textarea4."',
+			 $tipo)";
+			 
+    $qdest=new Consulta($guades);
+
+    //Para el reporte
+    $sha_r  =  "Insert INTO
+                movimientos values('',
+                '".$rowrep['id']."',
+                '".$qdest->NuevoId()."',
+                '".$origen."',
+                '".$n_destino."',
+                '".$accion->getNombre()."',
+                '".$radiobutton."',
+                '".$usuario->getLogin()."',
+                '".$textarea4."',
+                '".$fecha."',								
+                '".$esta."',
+				'".$ubicacion."',
+                '2')";
+	
+    $qha_r =new Consulta($sha_r);
+
+
+	if(	$radiobutton=='1'){//Si es el original el que esta moviendose
+        
+        $s_act = "Update documentos SET id_estado='".$estado."'
+                  WHERE id_documento='".$ids."'";
+
+        $qact=new Consulta($s_act);
+
+		$s_ma = "Update documentos_reporte SET estado='".$est."',
+                 ubicacion='".$ubicacion."'
+                 WHERE id_documento='".$ids."'";
+		$sma=new Consulta($s_ma);
+    }
+
+}
+
+function DespacharEliminarDestino($idp,$ids){
+	
+	//Aca opdra borrar los de historial_atencion, historial_documentos y borrador (cuando desaparece de su bandeja de AteDoc)
+	
+    if($_REQUEST["th"]!=3&&$_REQUEST["th"]!=6&&$_REQUEST["th"]!=5&&$_REQUEST["th"]!=7){ //De que tipo de historial viene
+        $sst="Delete from historial_atencion where id_historial_atencion='".$idp."'"; 
+    }
+    elseif($_REQUEST["th"]==7){
+		$sst="Delete from devuelto where id_devuelto='".$idp."'";
+	}elseif($_REQUEST["th"]==3){
+        $sst="Delete from borradores_respuesta where id_borrador_respuesta='".$idp."'";
+    }elseif($_REQUEST["th"]==6){
+        $sst="Delete from historial_documentos where id_historial_documento='".$idp."'";      
+    }
+	
+    $qt=new Consulta($sst);
+	
+	if($_REQUEST["th"]==0||$_REQUEST["th"]==1||$_REQUEST["th"]==4)
+		$tipo = 2;
+	elseif($_REQUEST["th"]==2)
+		$tipo = 4;	
+	elseif($_REQUEST["th"]==3)
+		$tipo = 3;
+	elseif($_REQUEST["th"]==5)
+		$tipo = 7;
+	elseif($_REQUEST["th"]==6)
+		$tipo = 1;
+	elseif($_REQUEST["th"]==7)
+		$tipo = 6;	
+	
+		
+	//Borramos de movimientos
+    $sst_r="DELETE FROM movimientos where id_historial='".$idp."' AND tipo = $tipo";
+	$qt_r=new Consulta($sst_r);
+	
+	//Vemos si cambia de estado
+	$doc = new Documento($ids);
+	$ultimo_estado=$doc->UltimoEstadoMovimientos();
+	$doc->actualizarEstado($ultimo_estado);
+    $doc->ActualizaUbicacion();
+	
+ }
+
+
+function DespacharDesArchivarDestino($ids){    
+
+    $documento = new Documento($ids);
+    $documento->actualizarEstado(16);
+    $documento->ActualizaUbicacion();
+}
+
+function DespacharDesFinalizarDestino($ids){    
+
+    $documento = new Documento($ids);
+    $documento->actualizarEstado(6);
+    $documento->ActualizaUbicacion();
+}
+
+function RegistraFiltrar(){
+
+    $sql_estado =  "SELECT *
+					FROM
+					estados AS e
+					WHERE e.display = 1
+					ORDER BY
+					e.nombre_estado ASC";
+					
+                $q_estado=new Consulta($sql_estado);
+    ?>
+	<form name="f5" method="post" action="<?=$_SESSION['PHP_SELF']?>?opcion=list&ide=<?=$ide?>&ide=<?=$ide2?>">
+	  <table width="100%" height="50" border="0" >
+		<tr>
+			<td align="center">
+				<select name="ide">
+					<option value="">---Estado---</option>
+					<?
+						while($row_estado=$q_estado->ConsultaVerRegistro()){
+							$ide=$row_estado[0];
+					?>
+					<option value="<?=$row_estado[0]?>"<? if(isset($ide) && $ide== $row_estado[0]){echo "selected";} ?>>
+						<?=$row_estado[1]?>
+					</option> 
+					<?  } ?>
+					<option value="LT">LISTAR TODOS</option>
+				</select>
+			</td>
+		</tr>
+		<tr>
+			<td align="center">
+				<input name="Filtrar" type="submit" class="boton"  value="Filtrar"/>
+			</td>
+		</tr>
+	  </table>
+	</form>
+<?
+}
+
+ }
+
+?>
+
diff -r 82e55d328c8c -r 9881d5db150a areas_acceso_registro.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/areas_acceso_registro.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,126 @@
+<?php  	
+	include("includes.php");
+	require_once("libs/lib.php");
+	require_once("cls/areas_acceso_registro.cls.php");
+	require_once("cls/class.documento_finalizado.php");
+	require_once("cls/class.documento_reporte.php");
+	
+	if(!$_SESSION['session'][3] == "SI" ){?>
+		<script>location.href="error_permisos.php";</script>
+ 	<?
+	}
+
+	set_time_limit(100);
+	$menu = array(0,1,0,0,1,0); 
+?>
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+<title>M&Oacute;DULO DE TRAMITE DOCUMENTARIO/ DESPACHO DE <?=$row_td['nombre_area']?></title>
+<?php include("includes/inc.header.php"); 
+?>
+<script src="public_root/js/jquery.blockUI.js" type="text/javascript" language="javascript"></script>
+<script type="text/javascript" src="public_root/js/leyendas/cargar_estados.js"></script>
+<script type="text/javascript">
+function cambia_saldo(id_total,id_doc){
+	$("#capa_tiempo").load("carga_saldo.php?horas=s&amp;id_total="+id_total).fadeIn("slow");
+	$("#fecha_respuesta").load("carga_saldo.php?fechar="+id_total+"&amp;id="+id_doc).fadeIn("slow");
+}
+</script>
+</head>
+<body>
+<table  id="principal"  align="left" cellpadding="0" cellspacing="0" width="100%" style="margin:0px; vertical-align:top">
+	<tr>		
+		<td  align="left" colspan="2">
+			<?php
+				if($_SESSION['session'][6]) 
+					$titulo = "DESPACHO DE AREA";
+				else
+					$titulo = "TRAMITE DE DOCUMENTOS";
+				
+				Plantilla::PlantillaEncabezado($titulo);
+			?>
+		</td>		
+	</tr>
+	<tr>
+		<td class="menu"><?php Plantilla::PlantillaIzquierdo();?></td>	
+		<td>
+			<table  class="contenido" cellpadding="0" cellspacing="0" width="100%" align="left">	
+            	<tr>
+					<td><?php  Plantilla::menuSuperior("areas_acceso_registro.php",$menu,$_GET['id'],false);?></td>
+				</tr>							
+				<tr>								
+					<td style="width:100%; height:417px">	
+                    
+					<?php 
+							switch($_REQUEST['opcion']){
+
+								case 'list':
+									Registro::RegistraListado($_REQUEST['ide']);		
+								break;	
+
+								case 'x':
+									Registro::RegistraListado($_REQUEST['ide']);	
+								break;
+
+								case 'guardar':
+									Registro::RegistraGuardar();
+									Registro::RegistraListado($_REQUEST['ide']);			
+								break;	
+
+								case 'agre':
+									Registro::RegistraAgrega();
+								break;	
+
+								case 'despachar':	
+									Registro::ConsultarDocumento($_REQUEST['ids']);	
+									//Registro::DespacharListarDestino($_REQUEST['ids']);			
+								break;	
+
+								case 'des_list':	
+									Registro::ConsultarDocumento($_REQUEST['ids']);									
+									//Registro::DespacharListarDestino($_REQUEST['ids']);			
+								break;	
+
+								case 'des_guard':	
+									Registro::DespacharGuardarDestino($_REQUEST['ids']);
+									Registro::ConsultarDocumento($_REQUEST['ids']);		
+								break;	
+
+								case 'eliminar':	
+									Registro::DespacharEliminarDestino($_REQUEST['idp'],$_REQUEST['ids']);
+									Registro::ConsultarDocumento($_REQUEST['ids']);		
+								break;		
+
+								case 'filtrar';
+									Registro::RegistraFiltrar();
+								break;	
+
+								case 'busqueda';
+									Registro::Busqueda($_REQUEST['campo'],$_REQUEST['valor']);
+								break;	
+
+								case 'desarch';
+									Registro::DespacharDesArchivarDestino($_REQUEST['id']);
+								break;
+								
+								case 'desfin';
+									Registro::DespacharDesFinalizarDestino($_REQUEST['id']);
+								break;			
+
+								default:	
+									Registro::RegistraListado($_REQUEST['ide']);	
+								break;
+									}
+							?>							
+					</td>					
+				</tr>			
+			</table>
+		</td>		
+	</tr>
+	<tr>
+		<td colspan="2" class="pie"><?php Plantilla::PlantillaPie();?>	</td>
+	</tr>	
+</table>	
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a areaspro_bdstdsernanp.sql
Binary file areaspro_bdstdsernanp.sql has changed
diff -r 82e55d328c8c -r 9881d5db150a atencion.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/atencion.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,110 @@
+<?php
+	/**
+	 * Edited by Enrique Juan de Dios 
+	 * 12JUL2010
+	 */
+	include("includes.php");  
+    
+	require_once("cls/atencion.cls.php");
+    require_once('cls/class.areas.php');
+	
+    if (!ini_get('display_errors')) {
+        ini_set('display_errors', 1);
+    }
+
+    $areas = new Areas();
+	$usuario = new Usuario($_SESSION['session'][0]);
+	if(!$_SESSION['session'][3] == "SI" ){
+	?>
+		<script>location.href="error_permisos.php";</script>
+ 	<?
+	}
+    
+    $get = (object)$_GET;
+    $filtro = 'atencion';
+    $areas = $areas->lista();
+	set_time_limit(100);
+?>
+
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+    <head>
+        <?php include("includes/inc.header.php"); ?>
+		<script type="text/javascript" src="public_root/js/calendar/calendar.js"></script>
+		<script>
+			function abre_ventana(ref){
+				screen_width = screen.width;
+				str = 'width='+screen_width+',height=600,top=20,left=3,scrollbars=yes';
+				window.open(ref.href, ref.target,str);
+			}			
+		</script>
+        <title>Atenci&oacute;n de documentos</title>
+    </head>
+<body>
+
+<table  id="principal"  align="left" cellpadding="0" cellspacing="0" width="100%" style="margin:0px; vertical-align:top">
+	<tr>		
+		<td colspan="2" align="left"> 
+        <?php Plantilla::PlantillaEncabezado("REPORTE DE ATENCION DE DOCUMENTOS ");?> 
+       </td>		
+	</tr>
+	<tr>	
+		<td>
+			<table  class="contenido" cellpadding="0" cellspacing="0" width="100%" align="left">	
+            								
+				<tr>								
+					<td style="width:100%; height:417px">	
+                    <div id="panel">
+                        <form id="filters" action="" method="post">
+                            <p>
+                                <label>Area</label>
+                                <select name="area" id="area">
+                                    <option value="">Seleccionar...</option>
+                                    <?foreach($areas as $area){?>
+                                        <option value="<?=$area->id_area?>"
+                                            <?=($get->area == $area->id_area)?"selected='selected'":'';?>
+                                            ><?=$area->Nombre?></option>
+                                    <?}?>
+                                </select>
+                            </p>
+                            <p>
+                                <span>
+                                    <input name="pendientes" id="pendientes" type="checkbox" value="1"
+                                    <?=($get->pendientes)?"checked='checked'":'';?>
+                                        />
+                                    <label for="pendientes">Pendientes (No estan archivados ni finalizados)</label>
+                                </span>
+                                <!--
+                                -->
+                                <span>
+                                    <input name="atendidos" id="atendidos" type="checkbox" value="1"
+                                        <?=($get->atendidos)?"checked='checked'":'';?>
+                                        />
+                                    <label for="atendidos">Atendidos (Archivados o finalizados)</label>
+                                </span>
+                                <span>
+                                    <input name="vencidos" id="vencidos" type="checkbox" value="1" 
+                                        <?=($get->vencidos)?"checked='checked'":'';?>
+                                        />
+                                    <label for="vencidos">Vencidos</label>
+                                </span>  
+                            </p>
+                        </form>
+                        <div id="list">
+                            <?			
+                                Atencion::listado( $filtro ,true);	
+                            ?>
+                        </div>
+                        
+                    </div>
+					</td>					
+				</tr>			
+			</table>
+		</td>		
+	</tr>
+	<tr>
+		<td colspan="2" class="pie"><?php Plantilla::PlantillaPie();?>	</td>
+	</tr>	
+</table>	
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a atencion_acceso_registro.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/atencion_acceso_registro.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,79 @@
+<?php 
+	include("includes.php");
+		require_once("cls/class.documentos.php");
+
+	if(!$_SESSION['session'][3] == "SI" ){?>
+		<script>location.href="error_permisos.php";</script>
+ 	<?
+	}
+	
+$usuario = new Usuario($_SESSION['session'][0]);
+$menu = array(0,1,0,0,0,0); ?>
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+<?php include("includes/inc.header.php"); ?>
+<script src="public_root/js/jquery.blockUI.js" type="text/javascript" language="javascript"></script>
+<script type="text/javascript" src="public_root/js/leyendas/cargar_estados.js"></script>
+<title>Administraci&oacute;n</title>
+</head>
+<body >
+<table  id="principal" align="left" cellpadding="0" cellspacing="0" width="100%" style="margin:0px; vertical-align:top">
+	<tr>		
+		<td  align="left" colspan="2"><?php Plantilla::PlantillaEncabezado("ATENCION DE DOCUMENTOS")?></td>		
+	</tr> 
+	<tr>
+		<td class="menu"><?php Plantilla::PlantillaIzquierdo()?></td>	
+		<td>
+			<table  class="contenido" cellpadding="0" cellspacing="0" width="100%" align="left">
+				<tr>
+					<td><?php  Plantilla::menuSuperior("atencion_acceso_registro.php",$menu,$_GET['id'],false);?></td>
+				</tr>										
+				<tr>								
+					<td style="width:100%;height:417px"><?php 
+					$docs = new Documentos();
+					switch($_REQUEST['opcion']){
+                        case 'deleteha':
+							$documento = new Documento($_REQUEST['id']);
+                            $documento->deleteHistorialBorrador($_REQUEST['idb']);
+							$nuevo_doc = new Documento($_REQUEST['id']);
+							$docs->detalleDocumentosPorUsuario($usuario, $nuevo_doc);							
+						break;
+						case 'detalle':		
+							$documento = new Documento($_GET['id']);																	
+							$docs->detalleDocumentosPorUsuario($usuario, $documento);	
+						break;
+						case 'list':											
+							$docs->listarDocumentosPorUsuario($usuario);				
+						break;
+						case 'aprobar':	
+							$documento = new Documento($_GET['id']);
+							$documento->AprobarDocumento("");
+							$docs->listarDocumentosPorUsuario($usuario);		
+						break;
+						case 'fin':	
+							$documento = new Documento($_REQUEST['id']);
+                            $documento->finalizarDocumento($_REQUEST['borrador']);
+                            $docs->listarDocumentosPorUsuario($usuario);
+							?>
+                            <script>alert("Se Finalizo el documento");</script>
+                            <?
+						break;
+						case 'busqueda': 
+							$docs->listarDocumentosPorUsuario($usuario);
+						break;		
+						default:											
+							$docs->listarDocumentosPorUsuario($usuario);
+						break;
+					} ?>							
+					</td>					
+				</tr>			
+			</table>
+		</td>		
+	</tr>
+	<tr>
+		<td colspan="2" class="pie"><?php Plantilla::PlantillaPie();?>	</td>
+	</tr>	
+</table>	
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a axopoa.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/axopoa.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,12 @@
+<?
+session_start();
+require("includes.php");
+if (isset($_GET['filename']) && $AuthVar['Auth'] ==true || isset($AuthVar[modulo]) ){
+	$_SESSION["inrena_".$AuthVar[modulo]][2]=$_GET[axo];
+	$dirn=dirname($_GET['filename'])."/";
+	header("Location: $dirn"); 
+}else{
+	$dirn=dirname($PHP_SELF)."./";
+	header("Location: $dirn"); 
+}
+?>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a buscador.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/buscador.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,205 @@
+	<form id="form_busqueda_simple" name="form_busqueda_simple" method="post" action="" style="background-color: #eee;">
+		<?php
+			$anp = new Anp($_SESSION['session'][7]);
+			$n_anp = $anp->getSiglas();
+		?>		
+		<div style="border-bottom:#5C96BB solid 1px;">
+		<table width="97%" border="0" align="center" cellpadding="1" cellspacing="1" style="margin-top:5px;">			
+			<tr>
+			  <td width="14%" height="31" class="Estilo22"><div align="left">N&ordm; de Registro</div></td>
+			  <td class="Estilo22" width="2%"><div align="center">:</div></td>
+				<td width="20%">
+					<div align="left">
+					  <input type="text" name="anp" size="6" id="anp" value="<?=$n_anp?>"/> - 
+					  <input name="registro" type="text" size="5" maxlength="6" id="registro" class="caja"/> 
+						-
+<!-- 	  <input name="anio" type="text" value="<?=date('Y')?>" size="2" maxlength="5" id="anio" />	
+					  -->
+					   <select name="anio" id="anio">
+					  <option value="<?=date('Y')?>"><?=date('Y')?></option>
+					  <option value="<?=(date('Y')-1)?>"><?=(date('Y')-1)?></option>
+					  </select>					 
+
+				
+				  </div>
+			  </td>
+				<td width="10%">
+					<div align="right">
+						<input name="consulta_simple" type="button" class="boton" id="consulta_simple" value="Consultar" />
+					</div>
+			  </td>
+				<td class="Estilo21" width="3%">&nbsp;</td>
+			  <td class="Estilo21">
+					<div align="left">
+						<a href="javascript:ver_busqueda_avanzada();"><strong>Desplegar B&uacute;squeda Avanzada </strong>
+						</a>				
+					</div>
+			  </td>
+		    </tr>
+		</table>
+		</div>
+		</form>
+		
+		<div id="busqueda_avanzada" style="display:none;">
+		<form name="form_busqueda_avanzada" id="form_busqueda_avanzada" action="" method="post">
+			<table width="97%" border="0" align="center" cellpadding="1" cellspacing="1" class="formularios">				
+				<tr>
+				  <td class="Estilo22">&nbsp;</td>
+				  <td class="Estilo22">&nbsp;</td>
+				  <td bgcolor="#FFFFFF">&nbsp;</td>
+				  <td bgcolor="#FFFFFF">&nbsp;</td>
+				  <td bgcolor="#FFFFFF" class="Estilo22">&nbsp;</td>
+				  <td bgcolor="#FFFFFF" class="Estilo22">&nbsp;</td>
+				  <td bgcolor="#FFFFFF">&nbsp;</td>
+				  <td bgcolor="#FFFFFF" class="Estilo22">&nbsp;</td>
+				  <td bgcolor="#FFFFFF">&nbsp;</td>
+				  <td bgcolor="#FFFFFF">&nbsp;</td>
+			  </tr>
+				<tr>
+				  <td class="Estilo22" width="14%"><div align="left">Documento</div></td>
+					<td class="Estilo22" width="2%"><div align="center">:</div></td>
+					<td bgcolor="#FFFFFF" width="30%">
+					  <div align="left">
+							<input name="documento" type="text" id="documento" value="" size="44" class="caja"/>
+					  </div>					</td>
+					<td bgcolor="#FFFFFF" width="3%">&nbsp;</td>
+					<td bgcolor="#FFFFFF" class="Estilo22" width="14%"><div align="left">Fecha de registro </div></td>
+					<td bgcolor="#FFFFFF" class="Estilo22" width="2%"><div align="center">:</div></td>
+					<td bgcolor="#FFFFFF">
+						<div align="left">
+							<input name="date_registrar1" type="text" id="datepicker1" autocomplete="off" style="width:92px;" class="caja"/>
+						</div>					</td>
+				  <td bgcolor="#FFFFFF" class="Estilo22"><div align="left">hasta</div></td>
+					<td bgcolor="#FFFFFF">
+						<div align="left">
+						    <input name="date_registrar2" type="text" id="datepicker2" size="14" autocomplete="off" style="width:92px;" class="caja"/>
+				      </div></td>
+			        <td bgcolor="#FFFFFF">&nbsp;</td>
+			  </tr>
+				<tr>
+				  <td class="Estilo22"><div align="left">Remitente</div></td>
+					<td class="Estilo22"><div align="center">:</div></td>
+					<td bgcolor="#FFFFFF">
+						<div align="left">
+							<input name="remitente" type="text" id="text_remitente" value="" size="44" class="caja"/>
+							<input name="remit" type="hidden" id="id_remitente" value="">					
+					  </div>					</td>
+					<td bgcolor="#FFFFFF">&nbsp;</td>
+					<td bgcolor="#FFFFFF"><div align="left" class="Estilo22">Asunto</div></td>
+					<td bgcolor="#FFFFFF" class="Estilo22"><div align="center">:</div></td>
+					<td colspan="3" bgcolor="#FFFFFF" width="30%">
+					  <div align="left">
+							<input name="asunto" type="text" id="asunto" value="" style="width:230px;" class="caja"/>
+					  </div>					</td>
+				    <td bgcolor="#FFFFFF">&nbsp;</td>
+				</tr>
+				<tr>
+					<td class="Estilo22"><div align="left" class="Estilo22">Estado</div></td>
+					<td class="Estilo22"><div align="center">:</div></td>
+					<td bgcolor="#FFFFFF">
+					  <div align="left">
+						<?php
+							$sql_estado="SELECT *
+                            	         FROM `estados` AS `e`
+										 WHERE e.display = 1
+      									 ORDER BY
+        								 `e`.`nombre_estado` ASC";
+                            $q_estado=new Consulta($sql_estado);
+						?>
+						<select id="select_estado" name="estado" style="width:240px" class="caja">
+						  <option value="">--Seleccione un Estado--</option>
+							<?
+								while($row_estado=$q_estado->ConsultaVerRegistro()){
+								   $ide=$row_estado[0];
+							?>
+							<option value="<?=$row_estado[2]?>"><?=$row_estado[1]?></option>
+						  <?  }?>
+						</select>
+               		  </div>				  	</td>
+				    <td bgcolor="#FFFFFF" class="Estilo21">
+						<div align="center" style="font-weight:bolder"><a href="javascript:verDetalleEstado()" title="Ver m&aacute;s Opciones"><img src="public_root/imgs/edit_add.png" border="0"></a></div>
+					</td>
+				    <td bgcolor="#FFFFFF" class="Estilo22"><div align="left" class="Estilo22">Ubicaci&oacute;n</div></td>
+				    <td bgcolor="#FFFFFF" class="Estilo22"><div align="center">:</div></td>
+			        <td colspan="3" bgcolor="#FFFFFF">
+					  <div align="left">
+							<input name="ubicacion" type="text" id="ubicacion" value=""  style="width:230px;" class="caja"/>
+					  </div>
+					</td>					
+				    <td bgcolor="#FFFFFF">&nbsp;</td>
+				</tr>
+		</table>
+		<div id="detalleEstado" style="display:none">
+		<table width="97%" border="0" align="center" cellpadding="1" cellspacing="1">
+			<tr>
+				<td width="14%"><div align="left" class="Estilo22">Fecha de cambio </div></td>
+				<td width="2%"><div align="center" class="Estilo22">:</div></td>
+				<td width="12%">
+					<div align="left">
+						<input name="date_cambio1" type="text" disabled="disabled" id="date_cambio1" size="13" class="disabled"/>
+					</div>				</td>
+				<td width="4%"><div align="left" class="Estilo22">hasta</div></td>
+				<td width="2%"><div align="left"></div></td>
+				<td width="12%">
+					<div align="left">
+						<input name="date_cambio2" type="text" disabled="disabled" id="date_cambio2" size="13" class="disabled"/>
+					</div>
+				</td>
+				<td>&nbsp;</td>
+			</tr>
+			<tr>
+				<td><div align="left" class="Estilo22">Origen</div></td>
+				<td><div align="center" class="Estilo22">:</div></td>
+				<td>
+					<div align="left">
+					<input name="origen" type="text" disabled="disabled" id="origen" size="13" class="disabled"/>
+					</div>
+				</td>
+				<td><div align="left" class="Estilo22">Destino</div></td>
+				<td width="2%"><div align="center" class="Estilo22">:</div></td>
+				<td>
+					<div align="left">
+					<input name="destino" type="text" disabled="disabled" id="destino" size="13" class="disabled"/>
+					</div>
+				</td>
+				<td>&nbsp;</td>
+			</tr>
+		</table>
+		</div>
+			<table width="98%" border="0" align="center">
+				<tr>
+					<td width="14%" height="48">&nbsp;</td>
+					<td width="70%" style="vertical-align:middle">
+						<div align="right">						
+						<input name="consulta_avanzada" type="button" class="boton" id="consulta_avanzada" value="Consultar" />
+						</div>				  </td>
+					<td width="12%" style="vertical-align:middle">
+						<div align="right">
+							<input name="cancelar" type="reset" class="boton" id="cancelar" value="Cancelar"/>
+						</div>				  </td>
+					<td width="4%">&nbsp;</td>
+				</tr>
+		  </table>        
+	</form>
+</div>
+<div align="right">
+	<a href='javascript:exportar_datos(1)'>
+		<img src="public_root/imgs/icon-pdf.gif" alt="pdf" width="18" height="20" border="0"/>
+	</a>
+	<a href='javascript:exportar_datos(2)'>
+		<img src="public_root/imgs/icon-xls.gif" alt="Excel" width="20" height="20" title="Exportar Excel" border="0"/>
+	</a>
+</div>
+<div id="resultado" style="text-align:center">
+	<table id="frmgrid" class="scroll" cellpadding="0" cellspacing="0" align="left"></table>
+	<div id="pfrmgrid" class="scroll" style="text-align:center;"></div>	
+</div>
+<div id="dialog" title="Mensaje de error" style="display:none">
+	<table width="100%" border="0" id="msg">
+      <tr>
+        <td width="10%" style="vertical-align:middle"><div align="center"><img src="public_root/imgs/warning_2_1.png" border="0" style="border:none"></div></td>
+        <td style="vertical-align:middle; padding-left:10px;"><span id="msg_dialogo" style="padding:7px 0 7px 0;"></span></td>
+      </tr>
+    </table>	
+</div>
+
diff -r 82e55d328c8c -r 9881d5db150a busqueda.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/busqueda.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,113 @@
+<?php  	
+	include("includes.php");
+	require_once("libs/lib.php");
+	require_once("cls/class.documento_reporte.php");
+	
+	if(!$_SESSION['session'][3] == "SI" ){?>
+		<script>location.href="error_permisos.php";</script>
+ 	<?
+	}
+	
+	$table="registro";
+	if(!isset($pag)){ $pag = 1; } 
+	$tampag = 20;
+	$reg1 = ($pag-1) * $tampag;
+	 
+	$pags=array($pag,$tampag,$table,$reg1);
+	set_time_limit(100);
+$menu = array(0,1,0,0,1,0); 
+?>
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+    <?php include("includes/inc.header.php"); 
+    ?>
+    <script type="text/javascript" src="public_root/js/jquery.autocomplete.js"></script>
+    <script type="text/javascript" src="public_root/js/jquery.bgiframe.min.js"></script>
+    <script type="text/javascript" src="public_root/js/ui/ui.core.js"></script>
+    <script type="text/javascript" src="public_root/js/ui/ui.draggable.js"></script>
+    <script type="text/javascript" src="public_root/js/ui/ui.droppable.js"></script>
+    <script type="text/javascript" src="public_root/js/ui/ui.datepicker.js"></script>
+    <script type="text/javascript" src="public_root/js/ui/ui.datepicker-es.js"></script>
+    <script type="text/javascript" src="public_root/js/ui/ui.dialog.js"></script>
+    <script src="public_root/js/jgrid/jquery.layout.js" type="text/javascript"></script>
+    <script src="public_root/js/jgrid/grid.import.js" type="text/javascript"></script>
+    <script src="public_root/js/jgrid/JsonXml.js" type="text/javascript"></script>
+    <script src="public_root/js/jgrid/json2.js" type="text/javascript"></script>
+    <script src="public_root/js/jgrid/jquery.jqGrid.js" type="text/javascript"></script>
+    <script src="public_root/js/jgrid/jqModal.js" type="text/javascript"></script>
+    <script src="public_root/js/jgrid/jqDnR.js" type="text/javascript"></script>
+    <script src="public_root/js/jgrid/grid.setcolumns.js" type="text/javascript"></script>
+    <script type="text/javascript" src="public_root/js/leyendas/cargar_estados.js"></script>
+    <link href="public_root/css/jquery.autocomplete.css" rel="stylesheet">
+    <link href="public_root/css/start/ui.all.css" rel="stylesheet">
+    <link href="public_root/css/ui.jqgrid.css" rel="stylesheet">
+
+    <script type="text/javascript">
+    var gridimgpath = 'public_root/css/start/images';
+    jQuery(document).ready(function(){
+
+        $.jgrid.defaults = $.extend($.jgrid.defaults,{loadui:"enable"});	
+
+        jQuery("#frmgrid").jqGrid({
+        url:'Ajax/AjaxBusqueda.php',
+        datatype: "json",
+        colNames:['asunto','N&ordm; Registro','Remitente', 'Documento', 'Registrado','F. Respuesta','Estado','Ubicacion'],
+        colModel:[
+            {name:'asunto',index:'asunto',hidden:true},
+            {name:'registro',index:'registro', width:135,formatter:'link',formatoptions: {baseLinkUrl: 'VerDetalleBusqueda', addParam: '',showAction: 'popup'},align:"center"},
+            {name:'remitente',index:'remitente', width:190},
+            {name:'documento',index:'documento', width:190},
+            {name:'fecha',index:'fecha', width:95, align:"center"},
+            {name:'fecha_r',index:'fecha_r', width:95, align:"center"},
+            {name:'estado',index:'estado', width:45,align:"center"},
+            {name:'ubicacion',index:'ubicacion',width:70,align:'center'}
+            
+        ],
+        rowNum:15,
+        rowList:[10,15,20],
+        imgpath: gridimgpath,
+        pager: '#pfrmgrid',
+        sortname: 'id',
+        viewrecords: true,
+        sortorder: "asc",
+        caption:"",
+        height:330
+        });
+
+    });
+    </script>
+    <title>MODULO DE TR&Aacute;MITE DOCUMENTARIO/B&Uacute;SQUEDA DE DOCUMENTOS</title>
+</head>
+<body>
+<div id="#contenedor">
+<span id="toolTipBox" width="200"></span>
+<table  id="principal"  align="left" cellpadding="0" cellspacing="0" height="100%">
+	<tr>		
+		<td  align="left" colspan="2"> <?php Plantilla::PlantillaEncabezado("DESPACHO DE AREA ");?></td>		
+	</tr>
+	<tr>
+		<td class="menu"><?php Plantilla::PlantillaIzquierdo();?></td>	
+		<td>
+			<table  class="contenido" cellpadding="0" cellspacing="0">	
+             <tr>
+					<td><?php  Plantilla::menuSuperior("areas_acceso_registro.php",$menu,$_GET['id'],false);?></td>
+				</tr>									
+												
+				<tr>								
+				  <td style="width:100%; height:417px">
+						<?php
+                            include("buscador.php");
+                        ?>
+					</td>					
+				</tr>			
+			</table>
+		</td>		
+	</tr>
+	<tr>
+		<td colspan="2" class="pie"><?php Plantilla::PlantillaPie();?>	</td>
+	</tr>	
+</table>
+</div>
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a calculadora.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/calculadora.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,545 @@
+<html>
+<head>
+<title>Calculadora cientfica</title>
+<script language="javascript">
+<!--
+var broj = "0"
+var tocka = 0
+var eksp = 0
+var eksponent = 3
+var rjesenje = 0
+var decimala = 0
+var enter = "";
+function memory(operator) {
+
+	document.racunalo.zadatak.focus();
+
+	if (operator == 1) {		// MS 
+		document.racunalo.memorija.value = document.racunalo.rezultat.value
+	}
+	else if (operator == 2)	{	// MR
+		var memorija = document.racunalo.memorija.value;
+		if (memorija==0 || slovo(memorija.charAt(0))) {memorija = ""};
+		document.racunalo.zadatak.value += memorija
+	}
+	else if (operator == 3) {	// CLS
+		if (document.racunalo.zadatak.value == "") {
+			document.racunalo.rezultat.value = ""
+		}
+		else {
+			document.racunalo.zadatak.value = ""
+		}
+	}
+}
+
+
+function display(noviznak) {
+	if (noviznak=="")
+		{document.racunalo.zadatak.focus()}
+	else
+		{document.racunalo.rezultat.select()}
+}
+
+
+function dodajBroj(noviznak) {
+	document.racunalo.zadatak.focus();
+	document.racunalo.zadatak.value += noviznak
+}
+
+
+function izracunaj(zarez) {
+	var pitanje = "";
+	var mem = 0;
+
+	if (zarez >= 1) {
+		if (document.racunalo.zadatak.value == "") {
+			broj = document.racunalo.rezultat.value
+		}
+		else {
+	 	broj = document.racunalo.zadatak.value;
+			if (ubacirezultat(broj.charAt(0))) {
+				broj = document.racunalo.rezultat.value + broj
+			}
+		}
+	}
+
+	for (var i=0; i<broj.length; i++) {
+		if (broj.charAt(i) == ",") {pitanje += "."}
+		else if (broj.charAt(i) == " ") {}
+		else {pitanje += broj.charAt(i)}
+	}
+
+	if (operator(broj.charAt(broj.length-1))) {return false};
+
+	if (pitanje==''){
+		pitanje=0;
+	}
+	
+	/*if (isNaN(pitanje)){
+		alert ("No se puede opear... \n\n El ingreso debe ser solo valor numerico");
+		return false;
+	}*/
+	
+	pitanje = eval("1*" + pitanje);
+
+	if (zarez > 1) {
+		pitanje = matematika(zarez, pitanje)
+	}
+
+	document.racunalo.oldrezultat.value = pitanje;
+
+	zaokruzi(pitanje);
+
+	document.racunalo.zadatak.value = "";
+	document.racunalo.zadatak.focus()
+}
+
+
+function matematika(zarez, rjesenje) {
+with (Math)
+{
+	if (zarez == 2) {
+		rjesenje = pow(rjesenje, 2)
+	}
+	else if (zarez == 3) {
+		rjesenje = sqrt(rjesenje)
+	}
+	else if (zarez == 4) {
+		rjesenje = -rjesenje
+	}
+	else if (zarez == 5) {
+		rjesenje = log(rjesenje)
+	}
+	else if (zarez == 6) {
+		rjesenje = pow(E, rjesenje)
+	}
+	else if (zarez == 7) {
+		rjesenje = 1/rjesenje
+	}
+	else if (zarez == 8) {
+		rjesenje = log(rjesenje)/LN10
+	}
+	else if (zarez == 9) {
+		rjesenje = pow(10, rjesenje)
+	}
+	else if (zarez >= 10 && zarez <= 12) {
+		if (zarez == 10) {
+			rjesenje = atan(rjesenje)
+		}
+		else if (zarez == 11) {
+			rjesenje = acos(rjesenje)
+		}
+		else if (zarez == 12) {
+			rjesenje = asin(rjesenje)
+		}
+
+		if (document.racunalo.stupnjevi[1].checked) {rjesenje = (rjesenje * 180) / PI}
+	}
+	else if (zarez >= 14 && zarez <= 16) {
+		if (document.racunalo.stupnjevi[1].checked)
+			{radijani = (rjesenje / 180) * PI}
+		else
+			{radijani = rjesenje};
+
+		if (zarez == 14) {
+			rjesenje = tan(radijani)
+		}
+		else if (zarez == 15) {
+			rjesenje = cos(radijani)
+		}
+		else if (zarez == 16) {
+			rjesenje = sin(radijani)
+		}
+	}
+	else if (zarez == 17) {
+		rjesenje = rjesenje/100
+	}
+	else if (zarez == 18) {
+		rjesenje = rjesenje/1000000
+	}
+	else if (zarez == 20) {
+		rjesenje = factorial(rjesenje)
+	}
+	else if (zarez == 21) {
+		eksponent = prompt("Introduce exponente:", 3);
+		rjesenje = pow(rjesenje, eksponent)
+	}
+	else if (zarez == 22) {
+		eksponent = prompt("Introduce nmero de raz:", 3);
+		rjesenje = pow(rjesenje, (1/eksponent))
+	}
+	return rjesenje
+}
+}
+
+
+function zaokruzi(ebroj) {
+
+decimala=parseFloat(document.racunalo.izaZareza.options[document.racunalo.izaZareza.selectedIndex].value);
+	var strbroj = ebroj + " ";
+	if (strbroj.charAt(0) == ".") {strbroj = "0" + strbroj};
+	var intbroj = strbroj.length - 1;
+	deczarez(strbroj);
+
+	if (intbroj > 16 && eksp == -1) {
+		if (decimala == -1) {decimala = 14};
+		strbroj = izazareza(strbroj.substring(0,intbroj)) + " ";
+		intbroj = strbroj.length - 1;
+		deczarez(strbroj)
+	}
+
+	if (decimala >= 0 && decimala != 14) {
+		if (tocka > 0) {
+			var odgovor = izazareza(strbroj.substring(0,intbroj))
+		}
+		else {
+			ebroj = strbroj.substring(0,intbroj);
+			if (decimala > 0) {
+				ebroj += ".";
+				for (var n = 0; n < decimala; n++) {
+					ebroj += "0"
+				}
+			}
+			var odgovor = ebroj
+		}
+	}
+	else {
+		decimala = 14;
+		var odgovor = izazareza(strbroj)
+	}
+
+	if (odgovor.charAt(0) == ".") {odgovor = "0" + odgovor};
+
+	document.racunalo.rezultat.value = odgovor;
+}
+
+
+function deczarez(novibroj) {
+	tocka = 0;
+	eksp = 0;
+
+	tocka = novibroj.indexOf(".");
+	eksp = novibroj.indexOf("e")
+}
+
+
+function izazareza(novibroj) {
+with (Math) {
+
+	if (eksp == -1) {
+		var duzina = tocka;
+		if (duzina == -1) {duzina = novibroj.length};
+		var desni = "";
+
+		if (duzina > 16) {
+			var privremeni = round(novibroj*pow(10, 18)) + " ";
+			var novie = privremeni.indexOf("e");
+			var lijevi = (privremeni.substring(0,novie));
+
+			lijevi = round(lijevi*pow(10, 15))/pow(10, 15) + " ";
+			desni = (privremeni.substring(novie+2,privremeni.length-1));
+			desni = "e+" + (desni-18)
+		}
+		else {
+			var lijevi = round(novibroj*pow(10, decimala))/pow(10, decimala) + " "
+		}
+	}
+	else {
+		var lijevi = novibroj.substring(0,eksp);
+		var desni = novibroj.substring(eksp,novibroj.length);
+
+		lijevi = round(lijevi*pow(10, decimala))/pow(10, decimala) + " "
+	}
+
+	lijevi = lijevi.substring(0,lijevi.length - 1);
+
+	if (lijevi.charAt(0) == ".") {lijevi = "0" + lijevi};
+
+	if (decimala < 14) {
+		if (lijevi.indexOf(".") == -1 && decimala != 0) {lijevi += "."};
+		var nula = (tocka + decimala) - (lijevi.length - 1);
+		if (nula > 0 && decimala > 0) {
+			for (var n = 0; n < nula; n++) {
+				lijevi += "0"
+			}
+		}
+	}
+	return (lijevi + " " + desni)
+}
+}
+
+
+function factorial(n) {
+	if ((n == 0) || (n == 1)) {
+		return 1
+	}
+	else {
+		var odgovor = (n * factorial(n-1));
+		return odgovor
+	}
+}
+
+
+function slovo(znak) {
+	var slovo="(ABCDEFGHIKLMNOPRSTUVWXYZ";
+    
+	for (i=0; i<slovo.length; i++){
+        if (znak == slovo.charAt(i)){
+            return true;
+        }
+        else{
+            return false;
+        }
+    }
+		
+}
+
+
+function operator(znak) {
+	var matoperator="*/+-";
+	for (var i=0; i<matoperator.length; i++)
+		if (znak == matoperator.charAt(i)) {return true}
+	return false
+}
+
+function ubacirezultat(znak) {
+	var ubacirezultat="*/+";
+	for (var i=0; i<ubacirezultat.length; i++)
+		if (znak == ubacirezultat.charAt(i)) {return true}
+	return false
+}
+
+function Close(){
+self.close();
+//top.close();
+}
+
+-->
+</script>
+<style>A:link {
+	COLOR: #0000cc; TEXT-DECORATION: none
+}
+A:visited {
+	COLOR: #0000cc; TEXT-DECORATION: none
+}
+A:hover {
+	COLOR: #123456; TEXT-DECORATION: none
+}
+BODY {
+	FONT-SIZE: 10pt;
+	FONT-FAMILY: "Arial", "Verdana";
+	margin-left: 0px;
+	margin-top: 0px;
+	margin-right: 0px;
+	margin-bottom: 0px;
+}
+TD {
+	FONT-SIZE: 10pt; FONT-FAMILY: "Arial", "Verdana"
+}
+TH {
+	FONT-SIZE: 10pt; FONT-FAMILY: "Arial", "Verdana"
+}
+</style>
+
+
+<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"></head>
+
+<body text="#234567" vLink="#000CC" aLink="#0000FF" link="#0000CC" bgColor="#FFFFFF" >
+<form name="racunalo">
+  <input type="hidden" name="oldrezultat"><input type="hidden" name="memorija">
+  <table cellSpacing="0" cellPadding="1" width="280" align="center" bgColor="#efefef" border="4">
+    <tr>
+      <td vAlign="center" align="middle">
+      <table cellSpacing="3" cellPadding="1" width="100%" bgColor="#cccccc" border="2">
+        <tr>
+          <td vAlign="center" align="middle" width="100%" bgColor="#efefef">
+          <input style="font-size: 14pt; width: 260px; height: 30px; background: #efefef" onFocus="display(document.racunalo.rezultat.value)" size="13" name="rezultat">
+          </td>
+        </tr>
+      </table>
+      <table cellSpacing="3" cellPadding="0" bgColor="#efefef" border="2">
+        <tr>
+          <td vAlign="center" align="middle" colSpan="4"><nobr><font size="+0">
+          <select title="Numero de Decimales" onChange="if (document.racunalo.oldrezultat.value != '') {zaokruzi(document.racunalo.oldrezultat.value)}; document.racunalo.zadatak.focus()" size="1" name="izaZareza">
+          <option value="-1" selected>decimal</option>
+          <option value="0">0</option>
+          <option value="1">1</option>
+          <option value="2">2</option>
+          <option value="3">3</option>
+          <option value="4">4</option>
+          <option value="5">5</option>
+          <option value="6">6</option>
+          <option value="7">7</option>
+          <option value="8">8</option>
+          <option value="9">9</option>
+          <option value="10">10</option>
+          <option value="11">11</option>
+          <option value="12">12</option>
+          <option value="13">13</option>
+          <option value="14">14</option>
+          <option value="15">15</option>
+          </select> </font><font face="Arial" color="#226622" size="2">
+          <input title="Radians" onClick="document.racunalo.zadatak.focus()" type="radio" CHECKED name="stupnjevi"><a onMouseOver="self.status='Radians'; return true" href="javascript:document.racunalo.stupnjevi[0].click()">Rad</a><input title="Stupnjevi" onClick="document.racunalo.zadatak.focus()" type="radio" name="stupnjevi"><a href="javascript:document.racunalo.stupnjevi[1].click()" onMouseOver="self.status='Degrees'; return true">Deg</a></font></nobr></td>
+          <td align="middle">
+          <input type="button" style="font-size: 10pt; width: 38px; height: 24px; background: #eeeeee"  onClick="Close();" name="cerrar" value="Cerrar">
+         </td>
+          <td>
+          <input title="Borra pantalla" style="font-size: 10pt; width: 38px; height: 24px; background: #eeeeee" onClick="memory(3)" type="button" value="Borra" name="Cls" WIDTH="38" HEIGHT="24">
+          </td>
+        </tr>
+        <tr>
+          <td colSpan="6"></td>
+        </tr>
+        <tr bgColor="#efefef">
+          <td vAlign="center" align="middle" width="100%" colSpan="6">
+          <font color="#0000ff" size="3">
+          <input onKeyDown="if (event.keyCode==13) {enter.click()}" style="FONT-WEIGHT: bold; FONT-SIZE: 10pt; WIDTH: 260px; HEIGHT: 25px" onChange="enter.click()" size="17" name="zadatak">
+          </font></td>
+        </tr>
+        <tr>
+          <td>
+          <input title="Raz cuadrada" style="font-size: 10pt; width: 38px; height: 28px; background: #cdcdcd" onClick="izracunaj(3)" type="button" value="sqrt" name="sqrt" WIDTH="38" HEIGHT="28">
+          </td>
+          <td>
+          <input title="Raz" style="font-size: 10pt; width: 38px; height: 28px; background: #cdcdcd" onClick="izracunaj(22)" type="button" value="root" name="root" WIDTH="38" HEIGHT="28">
+          </td>
+          <td>
+          <input title="Logaritmo neperiano" style="font-size: 10pt; width: 38px; height: 28px; background: #cdcdcd" onClick="izracunaj(5)" type="button" value="ln" name="ln" WIDTH="38" HEIGHT="28">
+          </td>
+          <td>
+          <input title="Logaritmo comn" style="font-size: 10pt; width: 38px; height: 28px; background: #cdcdcd" onClick="izracunaj(8)" type="button" value="log" name="log" WIDTH="38" HEIGHT="28">
+          </td>
+          <td>
+          <input title="Tangente" style="font-size: 10pt; width: 38px; height: 28px; background: #cdcdcd" onClick="izracunaj(14)" type="button" value="tan" name="tan" WIDTH="38" HEIGHT="28">
+          </td>
+          <td>
+          <input title="Arco tangente" style="font-size: 10pt; width: 38px; height: 28px; background: #cdcdcd" onClick="izracunaj(10)" type="button" value="atan" name="atan" WIDTH="38" HEIGHT="28">
+          </td>
+        </tr>
+        <tr>
+          <td>
+          <input title="Cuadrado" style="font-size: 10pt; width: 38px; height: 28px; background: #cdcdcd" onClick="izracunaj(2)" type="button" value="x^2" name="kvadrat" WIDTH="38" HEIGHT="28">
+          </td>
+          <td>
+          <input title="Potencia" style="font-size: 10pt; width: 38px; height: 28px; background: #cdcdcd" onClick="izracunaj(21)" type="button" value="x^y" name="potencija" WIDTH="38" HEIGHT="28">
+          </td>
+          <td>
+          <input title="Antilogaritmo neperiano" style="font-size: 10pt; width: 38px; height: 28px; background: #cdcdcd" onClick="izracunaj(6)" type="button" value="e^x" name="aln" WIDTH="38" HEIGHT="28">
+          </td>
+          <td>
+          <input title="Antilogaritmo" style="font-size: 10pt; width: 38px; height: 28px; background: #cdcdcd" onClick="izracunaj(9)" type="button" value="10^x" name="alog" WIDTH="38" HEIGHT="28">
+          </td>
+          <td>
+          <input title="Coseno" style="font-size: 10pt; width: 38px; height: 28px; background: #cdcdcd" onClick="izracunaj(15)" type="button" value="cos" name="cos" WIDTH="38" HEIGHT="28">
+          </td>
+          <td>
+          <input title="Arcocoseno" style="width: 38px; height: 28px; background: #cdcdcd" onClick="izracunaj(11)" type="button" value="acos" name="acos" WIDTH="38" HEIGHT="28">
+          </td>
+        </tr>
+        <tr>
+          <td>
+          <input title="Cambia signo" style="font-size: 10pt; width: 38px; height: 28px; background: #cdcdcd" onClick="izracunaj(4)" type="button" value="+/-" name="sign" WIDTH="38" HEIGHT="28">
+          </td>
+          <td>
+          <input style="font-size: 10pt; width: 38px; height: 28px; background: #cdcdcd" onClick="izracunaj(7)" type="button" value="1/x" name="1/x" WIDTH="38" HEIGHT="28">
+          </td>
+          <td>
+          <input title="Factorial" style="font-size: 10pt; width: 38px; height: 28px; background: #cdcdcd" onClick="izracunaj(20)" type="button" value="x!" name="fact" WIDTH="38" HEIGHT="28">
+          </td>
+          <td>
+          <input title="Pi" style="font-size: 10pt; width: 38px; height: 28px; background: #cdcdcd" onClick="dodajBroj(Math.PI)" type="button" value="Pi" name="PI" width="38" height="28">
+          </td>
+          <td>
+          <input title="Seno" style="font-size: 10pt; width: 38px; height: 28px; background: #cdcdcd" onClick="izracunaj(16)" type="button" value="sin" name="sin" WIDTH="38" HEIGHT="28">
+          </td>
+          <td>
+          <input title="Arcoseno" style="font-size: 10pt; width: 38px; height: 28px; background: #cdcdcd" onClick="izracunaj(12)" type="button" value="asin" name="asin" WIDTH="38" HEIGHT="28">
+          </td>
+        </tr>
+        <tr>
+          <td colSpan="6"></td>
+        </tr>
+        <tr>
+          <td>
+          <input style="font-size: 12pt; width: 38px; height: 32px; background: #dedede" onClick="dodajBroj(7)" type="button" value="7" name="7" WIDTH="38" HEIGHT="32">
+          </td>
+          <td>
+          <input style="font-size: 12pt; width: 38px; height: 32px; background: #dedede" onClick="dodajBroj(8)" type="button" value="8" name="8" WIDTH="38" HEIGHT="32">
+          </td>
+          <td>
+          <input style="font-size: 12pt; width: 38px; height: 32px; background: #dedede" onClick="dodajBroj(9)" type="button" value="9" name="9" WIDTH="38" HEIGHT="32">
+          </td>
+          <td>
+          <input style="font-size: 12pt; width: 38px; height: 32px; background: #dedede" onClick="dodajBroj('/')" type="button" value="/" name="djeljeno" WIDTH="38" HEIGHT="32">
+          </td>
+          <td>
+          <input title="Parte por milln" style="font-size: 10pt; width: 38px; height: 32px; background: #cdcdcd" onClick="izracunaj(18)" type="button" value="ppm" name="ppm" width="38" height="32">
+          </td>
+          <td>
+          <input title="Guarda en memoria" style="font-size: 10pt; width: 38px; height: 32px; background: #eeeeee" onClick="memory(1)" type="button" value="MS" name="MS" width="38" height="32">
+          </td>
+        </tr>
+        <tr>
+          <td>
+          <input style="font-size: 12pt; width: 38px; height: 32px; background: #dedede" onClick="dodajBroj(4)" type="button" value="4" name="4" WIDTH="38" HEIGHT="32">
+          </td>
+          <td>
+          <input style="font-size: 12pt; width: 38px; height: 32px; background: #dedede" onClick="dodajBroj(5)" type="button" value="5" name="5" WIDTH="38" HEIGHT="32">
+          </td>
+          <td>
+          <input style="font-size: 12pt; width: 38px; height: 32px; background: #dedede" onClick="dodajBroj(6)" type="button" value="6" name="6" WIDTH="38" HEIGHT="32">
+          </td>
+          <td>
+          <input style="font-size: 12pt; width: 38px; height: 32px; background: #dedede" onClick="dodajBroj('*')" type="button" value="*" name="puta" WIDTH="38" HEIGHT="32">
+          </td>
+          <td>
+          <input title="Porcentaje" style="font-size: 10pt; width: 38px; height: 32px; background: #cdcdcd" onClick="izracunaj(17)" type="button" value="%" name="postotak" width="38" height="32">
+          </td>
+          <td>
+          <input title="Visualiza memoria" style="font-size: 10pt; width: 38px; height: 32px; background: #eeeeee" onClick="memory(2)" type="button" value="MR" name="MR" width="38" height="32">
+          </td>
+        </tr>
+        <tr>
+          <td>
+          <input style="font-size: 12pt; width: 38px; height: 32px; background: #dedede" onClick="dodajBroj(1)" type="button" value="1" name="1" WIDTH="38" HEIGHT="32">
+          </td>
+          <td>
+          <input style="font-size: 12pt; width: 38px; height: 32px; background: #dedede" onClick="dodajBroj(2)" type="button" value="2" name="2" WIDTH="38" HEIGHT="32">
+          </td>
+          <td>
+          <input style="font-size: 12pt; width: 38px; height: 32px; background: #dedede" onClick="dodajBroj(3)" type="button" value="3" name="3" WIDTH="38" HEIGHT="32">
+          </td>
+          <td>
+          <input style="font-size: 12pt; width: 38px; height: 32px; background: #dedede" onClick="dodajBroj('-')" type="button" value="-" name="minus" WIDTH="38" HEIGHT="32">
+          </td>
+          <td>
+          <input style="font-size: 10pt; width: 38px; height: 32px; background: #cdcdcd" onClick="dodajBroj('(')" type="button" value="(" name="lijevo" WIDTH="38" HEIGHT="32">
+          </td>
+          <td>
+          <input style="font-size: 10pt; width: 38px; height: 32px; background: #cdcdcd" onClick="dodajBroj(')')" type="button" value=")" name="desno" WIDTH="38" HEIGHT="32">
+          </td>
+        </tr>
+        <tr>
+          <td>
+          <input style="font-size: 12pt; width: 38px; height: 32px; background: #dedede" onClick="dodajBroj(0)" type="button" value="0" name="0" WIDTH="38" HEIGHT="32">
+          </td>
+          <td>
+          <input style="font-size: 12pt; width: 38px; height: 32px; background: #dedede" onClick="dodajBroj('.')" type="button" value="." name="." WIDTH="38" HEIGHT="32">
+          </td>
+          <td>
+          <input style="font-size: 10pt; width: 38px; height: 32px; background: #dedede" onClick="dodajBroj('e')" type="button" value="E" name="exp" WIDTH="38" HEIGHT="32">
+          </td>
+          <td>
+          <input style="font-size: 12pt; width: 38px; height: 32px; background: #dedede" onClick="dodajBroj('+')" type="button" value="+" name="plus" WIDTH="38" HEIGHT="32">
+          </td>
+          <td colSpan="2">
+          <input style="font-size: 12pt; width: 83px; height: 32px; background: #cdcdcd" onClick="izracunaj(1)" type="button" value="=" name="enter" WIDTH="82" HEIGHT="32">
+          </td>
+        </tr>
+      </table>
+      </td>
+    </tr>
+  </table>
+</form>
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a carga_saldo.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/carga_saldo.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,48 @@
+<?php  
+	include("includes.php");
+	require_once("libs/lib.php");
+
+	if(isset($_GET['horas'])){		
+
+		$sql_prioridad  = " SELECT prioridades.id_prioridad, 
+							prioridades.nombre_prioridad, 		
+							prioridades.tiempo_horas_respuesta_prioridad/24 AS dias, 	
+							prioridades.tiempo_horas_respuesta_prioridad 
+							FROM prioridades
+							where 
+							prioridades.id_prioridad='".$_REQUEST['id_total']."'
+							ORDER BY prioridades.id_prioridad ASC";
+
+		$d_prioridad=new Consulta($sql_prioridad);
+		$dol_prio=$d_prioridad->ConsultaVerRegistro(); 
+     
+	 ?>
+
+     <input name="saldo" type="text" bgcolor="#999999" value="<?=$dol_prio[2]?>" size="1" readonly="" id="saldo" style="border:none"/>
+
+	<?php 
+		
+		}else if(isset($_GET['fechar'])){
+		
+			$sql_prioridad="SELECT prioridades.id_prioridad, prioridades.nombre_prioridad, prioridades.tiempo_horas_respuesta_prioridad
+					FROM prioridades
+
+						WHERE prioridades.id_prioridad='".$_GET['fechar']."'
+
+						ORDER BY prioridades.id_prioridad ASC";
+
+    	
+
+					$d_prioridad=new Consulta($sql_prioridad);
+
+					$dol_prio=$d_prioridad->ConsultaVerRegistro(); 
+
+					
+
+	$documento = new Documento($_REQUEST['id']);
+
+	echo $documento->setFechaRespuesta($dol_prio[2]);
+
+}
+
+?> 
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a class.documento.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/class.documento.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,1333 @@
+<?php 
+class Documento{
+	
+	var $_id;
+	var $_codigo;
+	var $_tipo;
+	var $_numero;
+	var $_referencia;
+	var $_anexo;
+	var $_numero_folio;
+	var $_fecha;
+	var $_fecha_registro;
+	var $_asunto;
+	var $_observacion;
+	var $_prioridad;
+	var $_destino;
+	var $_remitente;
+	var $_estado;
+	var $_historial; 
+	var $_historiala; 
+	var $_borradores_respuesta;
+	var $_escaneos;
+
+	function Documento($id = 0 ){
+		
+		$this->_id = $id;
+		if( $this->_id > 0 ){
+			$sql = "SELECT * FROM documentos WHERE id_documento = '".$this->_id."'";
+			$query = new Consulta($sql);
+			if($query->NumeroRegistros()){
+				$row = $query->VerRegistro();
+				 $this->_codigo 	= $row['codigo_documento'];
+				 $this->_tipo 		= new TipoDocumento($row['id_tipo_documento']);
+				 $this->_remitente 	= new Remitente($row['id_remitente']);
+				 $this->_estado 	= new Estado($row['id_estado']);
+				 $this->_prioridad 	= new Prioridad($row['id_prioridad']);
+				 $this->_numero	 	= $row['numero_documento'];
+				 $this->_asunto 	= $row['asunto_documento'];
+				 $this->_referencia = $row['referencia_documento'] ;
+				 $this->_anexo 		= $row['anexo_documento'] ;
+				 $this->_numero_folio = $row['numero_folio_documento'] ;
+				 $this->_fecha 		= $row['fecha_documento'] ;
+				 $this->_fecha_registro = $row['fecha_registro_documento'] ;
+				 $this->_observacion= $row['observacion_documento'] ;				 
+				 $this->_destino 	= $row['destino_documento'] ;
+				 
+				 
+				 $sql_historial = "SELECT * FROM historial_documentos WHERE id_documento = '".$this->_id."' ";
+				 $query_historial = new Consulta($sql_historial);
+				 while($rowh = $query_historial->VerRegistro()){
+				 	
+					$this->_historial[] = array(
+						'id'            =>	$rowh['id_historial_documento'],
+						'area'          =>	new Area($rowh['id_area']),
+						'destino'       =>	new Usuario($rowh['id_usuario_destino']),
+						'fecha'         =>	$rowh['fecha_historial_documento'] ,
+						'original'      =>	$rowh['original_historial_documento'] ,
+						'accion'        =>	new Accion($rowh['id_accion']) ,
+						'estado'        =>	new Estado($rowh['id_estado']),
+                        'observacion' 	=>	$rowh['observacion_historial_documento'],
+						'usuario'       =>	new Usuario($rowh['id_usuario'])
+					); 
+				}
+				
+				$sql_ahistorial = "SELECT * FROM historial_atencion WHERE id_documento = '".$this->_id."' ";
+				 $query_ahistorial = new Consulta($sql_ahistorial);
+				 while($rowha = $query_ahistorial->VerRegistro()){
+				 	
+					$this->_historiala[] = array(
+						'id' 		=>	$rowha['id_historial_atencion'],
+						'area' =>	new Area($rowha['id_area']),
+						'destino' 	=>	new Usuario($rowha['id_usuario_destino']),
+						'fecha' 	=>	date('d-m-Y H:i:s',strtotime($rowha['fecha_historial_atencion'])),	
+						'original'	=>	$rowha['original_historial_atencion'] ,
+						'accion' 	=>	new Accion($rowha['id_accion']) ,
+						'estado' 	=>	new Estado($rowha['id_estado']),
+						'usuario' 	=>	new Usuario($rowha['id_usuario'])								
+					); 
+				}				
+				
+				$sql_br = "SELECT * FROM borradores_respuesta WHERE id_documento = '".$this->_id."' ";
+				 $query_br = new Consulta($sql_br);
+				 while($rowbr = $query_br->VerRegistro()){
+				 	
+					$this->_borradores_respuesta[] = array(
+						'id' 		=>	$rowbr['id_borrador_respuesta'],
+						'fecha' 	=>	$rowbr['fecha_borrador_respuesta'] ,
+						'aprobacion'=>	$rowbr['aprobacion_borrador_respuesta'] ,
+						'fecha' 	=>	$rowbr['vobo_borrador_respuesta'] ,
+						'descripcion'=>	$rowbr['descripcion_borrador_respuesta'] ,
+						'usuario' 	=>	new Usuario($rowbr['id_usuario'])								
+					); 
+				}
+				
+				$sql_de = "SELECT * FROM documentos_escaneados WHERE id_documento = '".$this->_id."' ";
+				 $query_de = new Consulta($sql_de);
+				 while($rowde = $query_de->VerRegistro()){
+				 				 	
+					$this->_escaneos[] = array(
+						'id' 		=>	$rowde['id_documento_escaneado'],
+						'nombre' 	=>	$rowde['nombre_documento_escaneado']
+					);					 
+				}								 				 
+			}
+		}	
+	}
+	
+	function getFechaRespuesta(){
+		
+		$fecha_exacta = strtotime($this->_fecha_registro);		
+		$tiempo_extra = ($this->_prioridad->getTiempoHorasRespuesta() * 3600);		
+		$fecha_respuesta =  date("d/m/Y H:i",$fecha_exacta + $tiempo_extra); 
+		
+		return $fecha_respuesta;
+	}
+	
+	function setFechaRespuesta($horas){
+		
+		$fecha_exacta = strtotime($this->_fecha_registro);		
+		$tiempo_extra = ($horas * 3600);		
+		$fecha_respuesta =  date("d/m/Y H:i",$fecha_exacta + $tiempo_extra); 
+		
+		return $fecha_respuesta;
+	}	
+	
+	function getId(){
+		return $this->_id;
+	} 
+	
+	function getTipoDocumento(){
+		return $this->_tipo;
+	
+	}
+	
+	function getEscaneos(){
+		return $this->_escaneos;
+	
+	}	
+	
+	function getPrioridad(){
+		return $this->_prioridad;
+	}
+	
+	function getAccion(){
+		return $this->_accion;
+	}
+	
+	function getEstado(){
+		return $this->_estado;
+	}
+	
+	function getAsunto(){
+		return $this->_asunto;
+	}
+	
+	function getNumero(){
+		return $this->_numero;
+	}
+	
+	function getNumeroFolio(){
+		return $this->_numero_folio;
+	}
+	
+	function getRemitente(){
+		return $this->_remitente;
+	}
+	
+	function getHistorial(){
+		return $this->_historial;
+	}
+	
+	function getHistorialAtencion(){
+		return $this->_historiala;
+	}
+	
+	function getCodigo(){
+		return $this->_codigo;
+	}
+	
+	function getReferencia(){
+		return $this->_referencia;
+	}
+	
+	function getAnexo(){
+		return $this->_anexo;
+	}
+	
+	function getFecha(){
+		return date('d/m/Y',strtotime($this->_fecha));
+	}
+	
+	function getFechaRegistro(){
+		return date('d/m/Y',strtotime($this->_fecha_registro));
+	}
+	
+	function getHoraRegistro(){
+		return date('H:i:s',strtotime($this->_fecha_registro));
+	}
+	
+	function getFechaCompletaRegistro(){
+		return $this->_fecha_registro;
+	}
+		
+	function getBorradoresRespuesta(){
+		return $this->_borradores_respuesta;
+	}
+
+    function getObservacion(){
+		return $this->_observacion;
+	}
+	
+	function isOriginalCopia($original){
+		$return;
+		if( $original == 1){
+			$return = "Original";
+		}else{
+			$return = "Copia";
+		}
+		return $return;		
+	}
+		
+	function ActivarDocumento($usuario){
+		$sql = "INSERT INTO documentos_usuario VALUES( '".$this->_id."', '".$usuario->getId()."', '','".date('Y-m-d H:i:s')."')";
+		$query = new Consulta($sql);		
+	}
+	
+	function getAtencion($usuario, $id_documento){
+		if( $usuario->verificarDocumentoAtendido($id_documento) == TRUE ){
+			echo "Activado";
+		}else{
+		  	echo "<a href='".$_SERVER['PHP_SELF']."?opcion=activar&id=".$id_documento."'>Activar</a>";
+		}		
+	} 	
+	
+	function AprobarDocumento($com){
+
+        $a_destino = new Area($_SESSION['session'][5]);
+		$fecha_actual = time()-3600;
+		$fecha=date("Y-m-d H:i:s",$fecha_actual);
+		
+		if($_REQUEST['accion']==35){
+			$estado=16;
+			$est="AA";
+            $esta="ARCHIVO APROBADO";
+		}else{
+			$estado=17;
+			$est="DRA";
+            $esta="DERIVACION APROBADA";
+		}
+		
+		$sql_atencion ="INSERT INTO historial_atencion 
+						VALUES('','','".$this->_id."',
+                        '',
+						'".$_SESSION['session'][5]."',
+						'".$_SESSION['session'][5]."',
+						'".$fecha."',
+						'1',
+						'".$_REQUEST['accion']."',
+						'".$_SESSION['session'][0]."',
+						'".$estado."',
+						'$com','2')";
+
+        $query_atencion = new Consulta($sql_atencion);
+        $aten = $query_atencion->NuevoId();
+		
+		//Para el id del reporte
+	    $sqlrep =  "SELECT id_documento_reporte as id
+					FROM documentos_reporte
+					WHERE id_documento=".$this->_id;
+	
+		$qrep=new Consulta($sqlrep);
+		$rowrep=$qrep->VerRegistro();
+  
+		$accion = new Accion($_REQUEST['accion']);
+        $u_origen = new Usuario($_SESSION['session'][0]);
+        $origen = $u_origen->getNombreCompleto();
+        $n_destino = $a_destino->getNombre();
+        $ubicacion = $a_destino->getAbreviatura();
+		
+    	//Para el reporte
+		$sha_r  =  "Insert INTO
+					movimientos values('',
+					'".$rowrep['id']."',
+                    '".$aten."',
+					'".$origen."',
+					'".$n_destino."',
+					'".$accion->getNombre()."',
+					'1',
+					'".$u_origen->getLogin()."',
+					'$com',
+					'".$fecha."',
+					'".$esta."',
+					'".$ubicacion."',
+					'4')";
+	
+		$qha_r =new Consulta($sha_r);
+
+        $s_mov="Update documentos_reporte SET
+                ubicacion='".$ubicacion."'
+				WHERE id_documento=".$this->_id;
+				$qact_mov=new Consulta($s_mov);
+
+        $this->actualizarEstado($estado);
+        return $aten;   
+	}
+	
+	function addTramitePendiente(){
+		
+		$fecha_actual = time()-3600;
+		$fecha=date("Y-m-d H:i:s",$fecha_actual);
+		
+		$sql_atencion ="INSERT INTO historial_atencion 
+						VALUES('','','".$this->_id."',
+                        '".$_REQUEST['user']."',
+						'".$_REQUEST['area']."',
+						'".$_REQUEST['area']."',
+						'".$fecha."',
+						'1',
+						'".$_REQUEST['accion']."',
+						'".$_REQUEST['user']."',
+						'18',
+						'".$_REQUEST['comentario']."','5')";
+		
+        $query_atencion = new Consulta($sql_atencion);
+        $aten = $query_atencion->NuevoId();
+		
+		//Para el id del reporte
+	    $sqlrep =  "SELECT id_documento_reporte as id
+					FROM documentos_reporte
+					WHERE id_documento=".$this->_id;
+	
+		$qrep=new Consulta($sqlrep);
+		$rowrep=$qrep->VerRegistro();
+		
+		$accion = new Accion($_REQUEST['accion']);
+        $u_origen = new Usuario($_REQUEST['user']);
+        $origen = $u_origen->getNombreCompleto();
+        $n_destino = $origen;
+        $a_destino = $u_origen->getArea();
+        $ubicacion = $a_destino->getAbreviatura()."-".$u_origen->getLogin();
+		
+		
+		$est="TP";
+        $esta="TRAMITE PENDIENTE";		
+		
+		//Para el reporte
+		$sha_r  =  "Insert INTO
+					movimientos values('',
+					'".$rowrep['id']."',
+                    '".$aten."',
+					'".$origen."',
+					'".$n_destino."',
+					'".$accion->getNombre()."',
+					'1',
+					'".$u_origen->getLogin()."',
+					'".$_REQUEST['comentario']."',
+					'".$fecha."',
+					'".$esta."',
+					'".$ubicacion."',
+					'7')";
+	
+		$qha_r =new Consulta($sha_r);
+
+        $this->actualizarEstado(18);
+        return $aten;   
+	}
+	
+	function addHistorialAtencion(){
+		
+		$fecha_actual = time()-3600;
+		$fecha=date("Y-m-d H:i:s",$fecha_actual);
+		
+        $a_destino = new Area($_REQUEST['area']);
+
+		$sql_atencion ="INSERT INTO historial_atencion 
+						VALUES('','','".$this->_id."',
+                        '".$a_destino->getIdResponsable()."',
+						'".$_REQUEST['area']."',
+						'".$_REQUEST['area']."',
+						'".$fecha."',
+						'".$_REQUEST['categoria']."',
+						'".$_REQUEST['accion']."',
+						'".$_REQUEST['user']."',
+						'".$_REQUEST['estado']."',
+						'".$_REQUEST['comentario']."','4')";
+		
+        $query_atencion = new Consulta($sql_atencion);
+        $aten = $query_atencion->NuevoId();
+		
+		//Para el id del reporte
+	    $sqlrep =  "SELECT id_documento_reporte as id
+					FROM documentos_reporte
+					WHERE id_documento=".$this->_id;
+	
+		$qrep=new Consulta($sqlrep);
+		$rowrep=$qrep->VerRegistro();
+  
+		$accion = new Accion($_REQUEST['accion']);
+        $u_origen = new Usuario($_REQUEST['user']);
+        $origen = $u_origen->getNombreCompleto();
+        $u_destino = new Usuario($a_destino->getIdResponsable());
+        $n_destino = $u_destino->getNombreCompleto();
+        $a_destino = $u_destino->getArea();
+        $ubicacion = $a_destino->getAbreviatura()."-".$u_destino->getLogin();
+		
+		if($_REQUEST['estado']==14){
+			$est="AP";
+            $esta="ARCHIVO PROPUESTO";
+		}else{
+			$est="DRP";
+            $esta="DERIVACION PROPUESTA";
+		}
+		
+		//Para el reporte
+		$sha_r  =  "Insert INTO
+					movimientos values('',
+					'".$rowrep['id']."',
+                    '".$aten."',
+					'".$origen."',
+					'".$n_destino."',
+					'".$accion->getNombre()."',
+					'".$_REQUEST['categoria']."',
+					'".$u_origen->getLogin()."',
+					'".$_REQUEST['comentario']."',
+					'".$fecha."',
+					'".$esta."',
+					'".$ubicacion."',
+					'4')";
+	
+		$qha_r =new Consulta($sha_r);
+
+        $s_mov="Update documentos_reporte SET
+                ubicacion='".$ubicacion."'
+				WHERE id_documento=".$this->_id;
+				$qact_mov=new Consulta($s_mov);
+
+        $this->actualizarEstado($_REQUEST['estado']);
+        return $aten;   
+	}
+	
+	function addHistorialBorrador(){
+		
+		$fecha_actual = time()-3600;
+		$fecha=date("Y-m-d H:i:s",$fecha_actual);
+		
+        $sql_borrador = "INSERT INTO borradores_respuesta 
+						VALUES('','".$this->_id.
+						"','','".$_REQUEST['user'].
+						"','".$_REQUEST['usuario'].
+						"','".$_REQUEST['area']."','".
+						$_REQUEST['accion']."','".
+						$_REQUEST['categoria']."','".
+						$fecha."','".
+						$_REQUEST['comentario']."','','".
+                        $_REQUEST['adicional']."')";
+
+        $query_borrador = new Consulta($sql_borrador);
+        $borr = $query_borrador->NuevoId();
+
+		//Para el id del reporte
+	    $sqlrep =  "SELECT id_documento_reporte as id
+					FROM documentos_reporte
+					WHERE id_documento=$this->_id";
+	
+		$qrep=new Consulta($sqlrep);
+		$rowrep=$qrep->VerRegistro();	
+        
+		//Obtenermos el ultimo estado
+		$sql_e =   "SELECT
+					m.estado AS estado
+					FROM
+					movimientos m
+					WHERE
+					m.id_documento_reporte =  '".$rowrep['id']."' AND
+					m.categoria =  '1'
+					ORDER BY
+					m.fecha_movimiento DESC
+					LIMIT 0, 1";
+					
+		$query_e = new Consulta ($sql_e);
+		$row_e   = $query_e->VerRegistro();
+
+		$accion = new Accion($_REQUEST['accion']);
+        $u_origen = new Usuario($_REQUEST['user']);
+        $origen = $u_origen->getNombreCompleto();
+        $u_destino = new Usuario($_REQUEST['usuario']);
+        $n_destino = $u_destino->getNombreCompleto();
+        $area_actual = $u_destino->getArea();
+		$ubicacion = $area_actual->getAbreviatura()."-".$u_destino->getLogin();
+		
+		//if($_REQUEST['categoria']==1){			
+			$est="B";
+            $esta="BORRADOR";
+		//}else{
+			//$est = $row_e['estado'];
+		//}
+		
+		//Para el reporte
+		$sha_r  =  "Insert INTO
+					movimientos values('',
+					'".$rowrep['id']."',
+                    '".$borr."',
+					'".$origen."',
+					'".$n_destino."',
+					'".$accion->getNombre()."',
+					'".$_REQUEST['categoria']."',
+					'".$u_origen->getLogin()."',
+					'".$_REQUEST['adicional']."',
+					'".$fecha."',
+					'".$esta."',
+					'".$ubicacion."',
+					'3')";
+	
+		$qha_r =new Consulta($sha_r);		      			
+		
+		if($_REQUEST['categoria']==1){
+
+           $s_mov="Update documentos_reporte SET
+                   ubicacion='".$ubicacion."'
+                   WHERE id_documento=".$this->_id;
+
+            $qact_mov=new Consulta($s_mov);
+        	
+            $this->actualizarEstado(6);
+        }
+			
+		//Destinatario, Asunto y referencia del documento
+		if($this->ExisteFinalizado()){
+			$sqlfin =  "UPDATE documento_finalizado
+                   	 	SET asunto = '".$_REQUEST['asunto']."',
+						destinatario = '".$_REQUEST['destinatario']."',
+						cargo = '".$_REQUEST['cargo']."',
+						referencia = '".$_REQUEST['referencia']."'  
+                    	WHERE id_documento=".$this->_id;
+		}else{
+			$sqlfin =  "INSERT into documento_finalizado values
+                        ('',null,
+						$this->_id,'',
+						'".$_REQUEST['asunto']."',
+                        '".$_REQUEST['referencia']."',
+						'".$_REQUEST['destinatario']."',
+						'".$_REQUEST['cargo']."',						
+						null,
+						null)";
+		}		        
+					
+        $qfin=new Consulta($sqlfin);       
+        
+		return $borr;       
+	}
+
+	function ExisteFinalizado(){
+		
+		$Sql = "SELECT
+				df.id_documento_finalizado
+				FROM
+				documento_finalizado AS df
+				WHERE
+				df.id_documento = ".$this->_id;
+				
+		$query = new Consulta($Sql);
+		
+		if($query->NumeroRegistros()==0){
+			return false;
+		}
+		else{
+			return true;
+		}
+	}
+
+    function deleteHistorialAtencion($id_historial){
+
+        $sql = "DELETE FROM historial_atencion where id_historial_atencion=".$id_historial;
+		$query = new Consulta($sql);
+    }
+
+     function deleteHistorialBorrador($id_historial){
+	 
+		//Solo le pudo llegar de despacho de area o de otro atencion de documentos
+		if($_REQUEST["tipo"]==3){
+			$sql2 = "DELETE FROM borradores_respuesta
+		             where id_borrador_respuesta=".$id_historial;
+			$sst_r="DELETE FROM movimientos where id_historial='".$id_historial."' 
+                	AND tipo=3";		 
+		}else{
+			$sql2 = "DELETE FROM historial_atencion
+		             where id_historial_atencion=".$id_historial;
+			$sst_r="DELETE FROM movimientos where id_historial='".$id_historial."' 
+                	AND tipo=2 OR tipo = 4";			 
+		}					
+		
+		$query2 = new Consulta($sql2);        
+        $qt_r=new Consulta($sst_r);
+		
+		$ultimo_estado = $this->UltimoEstadoMovimientos();
+		
+		$this->ActualizaUbicacion();
+        $this->actualizarEstado($ultimo_estado);
+
+    }
+
+	function UltimoEstadoMovimientos(){
+		$sql = "SELECT
+				e.id_estado AS estado
+				FROM
+				movimientos AS m
+				Inner Join estados AS e ON m.estado = e.nombre_estado
+				WHERE
+				m.id_documento_reporte = ".$this->ObtenerIdReporte()." AND
+				m.categoria =  '1'
+				ORDER BY
+				m.id_movimiento DESC
+				LIMIT 0, 1";
+
+        $query = new Consulta ($sql);
+        $row = $query->VerRegistro();
+
+        return $row["estado"];		
+	}
+
+    function ActualizaUbicacion(){
+        $s_mov="Update documentos_reporte SET
+                ubicacion='".$this->UltimaUbicacionMovimientos()."'
+                WHERE id_documento=".$this->_id;
+        $qact_mov=new Consulta($s_mov);
+    }
+
+    function ActualizaUbicacionArchivo($ubicacion){
+        $s_mov="Update documentos_reporte SET
+                ubicacion='".$ubicacion."'
+                WHERE id_documento=".$this->_id;
+        $qact_mov=new Consulta($s_mov);
+    }
+	
+	function UltimaUbicacionMovimientos(){
+		
+		$sql = "SELECT
+				m.ubicacion AS ubicacion
+				FROM
+				movimientos AS m
+				WHERE
+				m.id_documento_reporte = ".$this->ObtenerIdReporte()." AND
+				m.categoria =  '1'
+				ORDER BY
+				m.id_movimiento DESC
+				LIMIT 0, 1";
+
+        $query = new Consulta ($sql);
+        $row = $query->VerRegistro();
+
+        return $row["ubicacion"];		
+	}
+	
+    function UltimaUbicacionReporte(){
+        
+        $sql = "SELECT
+                d.ubicacion AS ubicacion
+                FROM
+                documentos_reporte AS d
+                WHERE
+                d.id_documento_reporte = ".$this->ObtenerIdReporte();
+
+        $query = new Consulta ($sql);
+        $row = $query->VerRegistro();
+
+        return $row["ubicacion"];
+    }
+
+    function getNumeroBorradores(){
+        $sql = "SELECT * FROM borradores_respuesta WHERE id_documento = '".$this->_id."'";
+        $query = new Consulta($sql);
+
+        return $query->NumeroRegistros();
+    }
+
+    function getNumeroBorradoresOriginales(){
+        $sql = "SELECT * FROM borradores_respuesta WHERE id_documento = '".$this->_id."'
+                AND categoria = 1";
+        $query = new Consulta($sql);
+
+        return $query->NumeroRegistros();
+    }
+
+    function actualizarEstado($estado){
+
+        $fecha=date("Y-m-d H:i");
+
+        $sql3 = "Update documentos set id_estado=$estado where id_documento= ".$this->_id;
+        $sql_hist_doc = "Update historial_documentos set id_estado=$estado  where id_documento = ".$this->_id;
+        $sql_hist_ate = "Update historial_atencion set id_estado=$estado where id_documento = ".$this->_id;
+		
+		$c_estado = new Estado($estado);
+		
+		$s_ma = "Update documentos_reporte SET estado='".$c_estado->getAbreviatura()."'
+                 WHERE id_documento='".$this->_id."'";
+			
+        $query3 = new Consulta($sql3);
+        $query4 = new Consulta($sql_hist_doc);
+        $query5 = new Consulta($sql_hist_ate);
+		$sma=new Consulta($s_ma);
+    }
+
+    function finalizarDocumento($id_borrador){
+
+        //borrador como elegido
+       $sql_borr = "Update borradores_respuesta
+                    set aprobacion_respuesta_borrador = 1
+                    where id_borrador_respuesta= ".$id_borrador;
+
+        //modificar documento
+        $sql_doc = "Update documentos set id_estado=12 where id_documento = ".$this->_id;
+
+        //modificar historial_documentos        
+        $sql_hist_doc = "Update historial_documentos set id_estado=12 where id_documento = ".$this->_id;
+
+        //modificar historial_atencion        
+        $sql_hist_ate = "Update historial_atencion set id_estado=12 where id_documento = ".$this->_id;
+
+		//Reportes documento        
+        $sql_reporte = "UPDATE documentos_reporte set estado='F'
+						WHERE id_documento = ".$this->_id;
+
+        $query1 = new Consulta($sql_borr);
+        $query2 = new Consulta($sql_doc);
+        $query3 = new Consulta($sql_hist_doc);
+        $query4 = new Consulta($sql_hist_ate);
+        $query5 = new Consulta($sql_reporte);
+        
+    }
+	
+	function getHistorialBorradores($doc){
+	
+		$sql_borradores = " SELECT
+                            b.id_borrador_respuesta as id,
+                            b.id_usuario as usuario,
+                            b.id_destino as destino,
+                            b.id_area as area,
+                            b.id_accion as accion,
+                            b.categoria as categoria,
+                            b.fecha_borrador_respuesta as fecha,
+                            b.descripcion_borrador_respuesta as respuesta
+                            FROM
+                            borradores_respuesta AS b
+                            WHERE
+                            b.id_documento = $doc
+							order by fecha";
+							
+				 $query_borradores = new Consulta($sql_borradores);
+				 				 
+				 while($rowha = $query_borradores->VerRegistro()){
+				 	
+					$historial_b[] = array(
+						'id' 		=>	$rowha['id'],
+                        'usuario' 	=>	new Usuario($rowha['usuario']),
+						'destino' 	=>	new Usuario($rowha['destino']),
+                        'area'      =>	new Area($rowha['area']),
+                        'accion' 	=>	new Accion($rowha['accion']),
+						'original'	=>	$rowha['categoria'] ,												
+						'fecha' 	=>	date('d-m-Y H:i:s',strtotime($rowha['fecha'])),						
+						'respuesta'	=>	$rowha['respuesta']						
+					); 
+				}
+				
+				return $historial_b;
+	}
+
+    function getHistorialHastaBorradores($doc){
+
+        $sql_base = "SELECT
+                    ha.id_historial_atencion AS id,
+                    ha.id_usuario AS usuario,
+                    ha.id_area AS area,
+                    ha.id_usuario_destino AS destino,
+                    ha.id_area_destino AS area_destino,
+                    ha.observacion_historial_atencion AS observacion,
+                    ha.fecha_historial_atencion AS fecha,
+                    ha.original_historial_atencion AS categoria,
+                    ha.id_accion AS accion,
+                    ha.tipo_historial_atencion AS tipo
+                    FROM
+                    historial_atencion AS ha
+                    WHERE
+                    ha.id_documento =  '$doc' AND
+                    ((ha.id_usuario_destino =  '".$_SESSION['session'][0]."' AND ha.tipo_historial_atencion = '0') OR
+                    (ha.tipo_historial_atencion >  '1' AND ha.id_area_destino =  '".$_SESSION['session'][5]."'))";
+
+     $query_base = new Consulta($sql_base);
+				 				 
+	 while($rowhb = $query_base->VerRegistro()){
+				 	
+					$historial_b[] = array(
+						'id'            =>	$rowha['id'],
+                        'usuario'       =>	new Usuario($rowhb['usuario']),
+                        'area'          =>	new Area($rowhb['area']),
+						'destino'       =>	new Usuario($rowhb['destino']),
+                        'area_destino' 	=>	new Area($rowhb['area_destino']),
+                        'observacion' 	=>	$rowhb['observacion'],
+                        'accion'        =>	new Accion($rowhb['accion']),
+						'original'      =>	$rowhb['categoria'] ,
+						'fecha'         =>	date('d-m-Y H:i:s',strtotime($rowhb['fecha'])),
+						'tipo'          =>	$rowhb['tipo']
+					); 
+				}
+				
+				return $historial_b;
+    }
+
+    function getHistorialAtencionDocumentos(){
+        $sql= " SELECT
+				hd.id_historial_documento AS id,
+				'6' AS tipo,
+				null AS usuario,
+				null AS area,
+				null AS destino,
+				hd.id_area AS area_destino,				
+				hd.id_accion AS accion,
+				hd.original_historial_documento AS categoria,
+				null AS observacion,
+				hd.observacion_historial_documento AS comentario,
+				DATE_FORMAT(hd.fecha_historial_documento, '%Y-%m-%d %H:%i') AS fecha
+				FROM
+				historial_documentos AS hd				
+				WHERE
+				hd.id_documento =  $this->_id
+				UNION
+				SELECT
+                ha.id_historial_atencion AS id,
+                ha.tipo_historial_atencion AS tipo,
+                ha.id_usuario AS usuario,
+                ha.id_area AS area,
+                ha.id_usuario_destino AS destino,
+                ha.id_area_destino AS area_destino,
+                ha.id_accion AS accion,
+                ha.original_historial_atencion AS categoria,
+                null AS observacion,
+                ha.observacion_historial_atencion AS comentario,
+				DATE_FORMAT(ha.fecha_historial_atencion, '%Y-%m-%d %H:%i') AS fecha
+                FROM
+                historial_atencion AS ha
+                WHERE
+                ha.id_documento =  $this->_id AND
+                (ha.tipo_historial_atencion = 0 OR ha.tipo_historial_atencion = 1
+                 OR ha.tipo_historial_atencion = 2 OR ha.tipo_historial_atencion = 4)
+                UNION
+                SELECT
+                b.id_borrador_respuesta AS id,
+				3 AS tipo,
+                b.id_usuario AS usuario,
+                b.id_area AS area,
+                b.id_destino AS destino,
+                null AS area_destino,
+                b.id_accion AS accion,
+                b.categoria AS categoria,
+                b.descripcion_borrador_respuesta AS observacion,
+                b.comentario_adicional AS comentario,
+				DATE_FORMAT(b.fecha_borrador_respuesta, '%Y-%m-%d %H:%i') AS fecha
+                FROM
+                borradores_respuesta AS b
+                WHERE
+                b.id_documento = $this->_id
+                UNION
+				SELECT
+				d.id_devuelto AS id,
+				'7' AS tipo,
+				d.id_usuario AS usuario,
+				d.id_area AS area,
+				null AS destino,
+				null AS area_destino,								
+				null AS accion,
+				'1' AS categoria,
+				null AS observacion,
+				d.descripcion AS comentario,
+				DATE_FORMAT(d.fecha_devolucion, '%Y-%m-%d %H:%i') AS fecha
+				FROM
+				devuelto AS d
+				WHERE
+				d.id_documento = $this->_id
+				ORDER BY
+				fecha ASC,
+				categoria ASC";
+
+        $query = new Consulta($sql);
+
+        while($rowhb = $query->VerRegistro()){
+
+					$historial[] = array(
+						'id'            =>	$rowhb['id'],
+                        'usuario'       =>	new Usuario($rowhb['usuario']),
+                        'area'          =>	new Area($rowhb['area']),
+						'destino'       =>	new Usuario($rowhb['destino']),
+                        'area_destino' 	=>	new Area($rowhb['area_destino']),
+                        'observacion' 	=>	$rowhb['observacion'],
+                        'comentario' 	=>	$rowhb['comentario'],
+                        'accion'        =>	new Accion($rowhb['accion']),
+						'original'      =>	$rowhb['categoria'] ,
+						'fecha'         =>	date('d-m-Y H:i',strtotime($rowhb['fecha'])),
+						'tipo'          =>	$rowhb['tipo']
+					);
+				}
+
+				return $historial;
+    }
+
+	function obtenerBorradoresEscaneados($borr){
+		
+		$sql = "SELECT a.nombre_archivo
+				FROM
+				borrador_escaneado AS a
+				WHERE a.id_borrador_respuesta =".$borr;
+		
+		$query_sql=new Consulta($sql);
+		
+		$borrador = array();
+		
+		$index = 0;
+		
+		while($row = $query_sql->ConsultaVerRegistro()){
+			$borrador[$index++] = $row['nombre_archivo'];			
+		}
+		return $borrador;
+	}
+	
+	function obtenerJustificacionesEscaneadas($hist){
+		
+		$sql = "SELECT a.nombre_archivo
+				FROM
+				justificado_escaneado AS a
+				WHERE a.id_historial_atencion=".$hist;
+		
+		$query_sql=new Consulta($sql);		
+		
+		$archivo = array();
+		
+		$index=0;
+		
+		while($row = $query_sql->ConsultaVerRegistro()){
+			$archivo[$index++] = $row['nombre_archivo'];			
+		}
+				
+		return $archivo;
+		
+	}
+
+    function TengoElBorradorOriginal($usu){
+
+        $sql = "SELECT
+                id_destino AS destino,
+                b.fecha_borrador_respuesta
+                FROM
+                borradores_respuesta AS b
+                WHERE
+                b.id_documento =  '".$this->_id."' AND
+                b.categoria =  '1'
+                ORDER BY
+                b.fecha_borrador_respuesta DESC
+                LIMIT 1";
+
+        $query_sql=new Consulta($sql);
+		$row=$query_sql->VerRegistro();
+
+        if($row["destino"]==$usu)
+            return true;
+        else
+            return false;
+    }
+
+    function TengoElDocDAOriginal($usu){
+
+        $sql = "SELECT
+                ha.id_usuario_destino
+                FROM
+                historial_atencion AS ha
+                WHERE
+                ha.id_documento = '".$this->_id."' AND
+                ha.original_historial_atencion =  '1'
+                ORDER BY
+                ha.id_historial_atencion DESC
+                LIMIT 1";
+
+        $query_sql=new Consulta($sql);
+		$row=$query_sql->VerRegistro();
+
+        if($row["id_usuario_destino"]==$usu)
+            return true;
+        else
+            return false;
+    }
+
+	function DespachoAreaTieneOriginal(){
+
+        $sql = "SELECT
+                ha.id_area_destino AS destino,
+				ha.fecha_historial_atencion AS fecha
+                FROM
+                historial_atencion AS ha
+                WHERE
+                ha.id_documento =  '".$this->_id."' AND
+                ha.original_historial_atencion =  '1'
+				UNION 
+				SELECT
+				hd.id_area AS destino,
+				hd.fecha_historial_documento AS fecha
+				FROM
+				historial_documentos hd
+				WHERE
+				hd.id_documento =  '".$this->_id."' AND
+                hd.original_historial_documento =  '1'
+                ORDER BY
+                fecha DESC
+                LIMIT 1";
+        
+        $query_sql=new Consulta($sql);
+		$row=$query_sql->VerRegistro();
+	
+        if($row["destino"]==$_SESSION['session'][5])
+            return true;        	
+		else
+            return false;
+    }
+
+    function ObtenerTamanioHistorialOriginales(){
+
+        $sql = "SELECT *
+                FROM
+                borradores_respuesta AS b
+                WHERE
+                b.id_documento =  '".$this->_id."' AND
+                b.categoria =  '1'";
+
+        $query_sql=new Consulta($sql);
+
+        return $query_sql->NumeroRegistros();
+    }
+	
+	function ObtenerDescripcionUltimoOriginal($estado){
+
+        $id_accion="";
+
+        $descripcion = $this->UltimaDescripcionOriginal();
+
+        if(empty($descripcion)){
+            if($estado==14||$estado==16)
+                $id_accion=29;
+            elseif($estado==15||$estado==17)
+                $id_accion=24;
+
+            $sql = "SELECT
+                    ha.observacion_historial_atencion AS observacion
+                    FROM
+                    historial_atencion AS ha
+                    WHERE
+                    ha.id_documento =  '".$this->_id."' AND
+                    ha.original_historial_atencion =  '1' AND
+                    ha.id_accion = $id_accion
+                    ORDER BY
+                    ha.id_historial_atencion DESC
+                    LIMIT 1";
+
+            $query_sql=new Consulta($sql);
+            $row=$query_sql->VerRegistro();
+
+            return $row["observacion"];
+        }
+        else{
+            return $descripcion;
+        }
+	
+	}
+
+    function UltimaDescripcionOriginal(){
+
+		$sql = "SELECT
+                ha.observacion_historial_atencion AS observacion
+                FROM
+                historial_atencion AS ha
+                WHERE
+                ha.id_documento =  '".$this->_id."' AND
+                ha.original_historial_atencion =  '1'
+                ORDER BY
+                ha.id_historial_atencion DESC
+                LIMIT 1";
+
+        $query_sql=new Consulta($sql);
+		$row=$query_sql->VerRegistro();
+
+		return $row["observacion"];
+
+    }
+
+    function ObtenerIdFinalizado(){
+
+        $sql = "Select id_documento_finalizado
+                FROM documento_finalizado
+                WHERE id_documento = ".$this->_id;
+        $query= new Consulta($sql);
+
+        if($query->NumeroRegistros()==0)
+            return 0;
+        else{
+            $row = $query->VerRegistro();
+            return $row["id_documento_finalizado"];
+        }
+
+
+    }
+
+    function ObtenerIdReporte(){
+
+        $sql = "Select id_documento_reporte
+                FROM documentos_reporte
+                WHERE id_documento = ".$this->_id;
+        $query= new Consulta($sql);
+
+        if($query->NumeroRegistros()==0)
+            return 0;
+        else{
+            $row = $query->VerRegistro();
+            return $row["id_documento_reporte"];
+        }
+
+
+    }
+	
+	function actualizarFechaRespuesta($fecha){
+		$sql = "UPDATE documentos_reporte
+				SET fecha_respuesta = '$fecha'
+				WHERE id_documento_reporte = ".$this->ObtenerIdReporte();
+        $query= new Consulta($sql);
+	}
+	
+	function copiaArchivadaUsuario(){
+		$sql_arch = "SELECT
+					 a.id_documento
+					 FROM
+					 archivo_copia AS a
+					 WHERE
+					 a.id_documento =  ".$this->_id." AND
+					 a.id_area_duenia = ".$_SESSION['session'][5]." AND
+					 a.id_usuario_duenio = ".$_SESSION['session'][0];
+
+		$query_arch = new Consulta($sql_arch);
+
+		if($query_arch->NumeroRegistros()>0){
+			return true;
+		}
+		return false;
+	}
+	
+	function ObtenerTodosEscaneados(){
+	
+		$sql_esc = "SELECT
+					je.id_justificado_escaneado AS id,
+					ha.id_usuario AS usuario,
+					ha.id_usuario_destino AS usuario_destino,
+					ha.id_area_destino AS area_destino,
+					a.nombre_accion AS accion,
+					ha.fecha_historial_atencion AS fecha,
+					je.nombre_archivo AS nombre,
+					ha.tipo_historial_atencion AS tipo
+					FROM
+					justificado_escaneado AS je
+					Inner Join historial_atencion AS ha ON je.id_historial_atencion = ha.id_historial_atencion
+					Inner Join accion AS a ON ha.id_accion = a.id_accion
+					WHERE
+					ha.id_documento =  ".$this->_id."
+					UNION
+					SELECT
+					be.id_archivo_escaneado AS id,
+					br.id_usuario AS usuario,
+					br.id_destino AS usuario_destino,
+					null AS area_destino,
+					accion.nombre_accion AS accion,
+					br.fecha_borrador_respuesta AS fecha,
+					be.nombre_archivo AS nombre,
+					'0' AS tipo					
+					FROM 
+					borrador_escaneado AS be Inner Join borradores_respuesta AS br 
+					ON be.id_borrador_respuesta = br.id_borrador_respuesta
+					Inner Join accion ON br.id_accion = accion.id_accion
+					WHERE
+					br.id_documento =  ".$this->_id."
+					UNION
+					SELECT
+					de.id_documento_escaneado,
+					r.nombre_remitente AS usuario,
+					'ESCANEO' AS usuario_destino,
+					null AS area_destino,
+					'ESCANEAR' AS accion,
+					de.fecha_escaneo AS fecha,
+					de.nombre_documento_escaneado AS nombre,
+					'1' AS tipo					
+					FROM 
+					documentos_escaneados AS de Inner Join documentos AS d ON de.id_documento = d.id_documento
+					Inner Join remitentes AS r ON d.id_remitente = r.id_remitente
+					WHERE
+					d.id_documento =  ".$this->_id."
+					ORDER BY fecha";
+
+			$query_esc = new Consulta($sql_esc);
+			
+			while($row_esc = $query_esc->VerRegistro()){
+					if($row_esc['tipo']!=1){
+						$usuario = new Usuario($row_esc['usuario']);
+						$usuario_destino = new Usuario($row_esc['usuario_destino']);
+						$area_destino = new Area($row_esc['area_destino']);
+					}else{
+						$usuario = $row_esc['usuario'];
+						$usuario_destino = $row_esc['usuario_destino'];
+						$area_destino = "";
+					}
+					$escaneados[] = array(
+						'id'            	=>	$row_esc['id'],
+                        'usuario'       	=>	$usuario,
+						'usuario_destino'   =>	$usuario_destino,
+                        'area_destino' 		=>	$area_destino,
+                        'accion'        	=>	$row_esc['accion'],						
+						'fecha'         	=>	date('d-m-Y H:i',strtotime($row_esc['fecha'])),
+						'nombre'			=>	$row_esc['nombre'],
+						'tipo'          	=>	$row_esc['tipo']
+					);
+					
+				}
+		
+				return $escaneados;
+	}
+	
+	function ObtenerEstadoCopia($id_doc,$tipo){
+		// tipo = 1 ; si es de despacho de area
+		// tipo = 2 ; si es de atencion de documentos
+		
+		if($tipo == 1){
+			$area = new Area($_SESSION['session'][5]);
+			$n_area = $area->getNombre();
+			
+			$sql = "SELECT
+					m.estado
+					FROM
+					movimientos AS m
+					Inner Join documentos_reporte AS dr ON dr.id_documento_reporte = m.id_documento_reporte
+					WHERE
+					dr.id_documento =  '".$id_doc."' AND
+					m.categoria =  '2' AND
+					m.destino =  '".$n_area."'
+					ORDER BY
+					m.id_movimiento DESC
+					LIMIT 0, 1";
+		}else{
+			$usuario = new Usuario($_SESSION['session'][0]);
+			$nusuario = $usuario->GetNombreCompleto();
+			$sql = "SELECT
+					m.estado
+					FROM
+					movimientos AS m
+					Inner Join documentos_reporte AS dr ON dr.id_documento_reporte = m.id_documento_reporte
+					WHERE
+					dr.id_documento =  '".$id_doc."' AND
+					m.categoria =  '2' AND
+					m.destino =  '".$nusuario."'
+					ORDER BY
+					m.id_movimiento DESC
+					LIMIT 0, 1";
+		}
+		
+		$query = new Consulta($sql);
+		$row = $query->VerRegistro();
+		$estado = $row["estado"];
+		
+		$sql_est = "SELECT
+					e.abrev_nombre_estado AS abreviatura
+					FROM
+					estados AS e
+					WHERE
+					e.nombre_estado =  '$estado'";
+					
+		$query_est = new Consulta($sql_est);
+		$row_est = $query_est->VerRegistro();
+		
+		return $row_est["abreviatura"];
+		
+	}
+	
+	function ObtenerUbicacionCopia($id_doc,$tipo){
+		// tipo = 1 ; si es de despacho de area
+		// tipo = 2 ; si es de atencion de documentos
+		
+		if($tipo == 1){
+		
+			$area = new Area($_SESSION['session'][5]);
+			$n_area = $area->getNombre();
+		
+			$sql_ubic = "SELECT
+						m.destino,
+						m.tipo
+						FROM
+						movimientos AS m
+						Inner Join documentos_reporte AS dr ON m.id_documento_reporte = dr.id_documento_reporte
+						WHERE
+						dr.id_documento =  '$id_doc' AND
+						m.categoria =  '2' AND
+						m.origen =  '$n_area' AND
+						m.accion <> 'ARCHIVAR'";
+		}else{
+			$usuario = new Usuario($_SESSION['session'][0]);
+			$nusuario = $usuario->GetNombreCompleto();
+			
+			$sql_ubic = "SELECT
+						m.destino,
+						m.tipo
+						FROM
+						movimientos AS m
+						Inner Join documentos_reporte AS dr ON m.id_documento_reporte = dr.id_documento_reporte
+						WHERE
+						dr.id_documento =  '$id_doc' AND
+						m.categoria =  '2' AND
+						m.origen = '$nusuario' AND
+						m.accion <> 'ARCHIVAR'";
+		}
+		
+		$query = new Consulta($sql_ubic);
+		
+		$ubicacion = null;
+		
+		while($row = $query->VerRegistro()){
+			$ubicacion[] = array(
+				'destino'          	=>	$row['destino'],
+                'tipo' 		      	=>	$row['tipo']
+			);
+		}
+		
+		return $ubicacion;
+	}
+}
+?>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a class.documentos.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/class.documentos.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,709 @@
+<?php
+require_once('cls/class.acciones.php');
+
+class Documentos{
+
+	function Documentos(){	}
+
+	function DocumentosPorUsuario($id_usuario){
+
+		$return;
+		$sql = "SELECT * FROM documentos WHERE id_usuario = '".$id_usuario."' ";
+		$query = new Consulta($sql);
+		while($row = $query->VerRegistro()){
+			$return[] = array(
+				'id' 		=> $row['id_usuario'],
+				'codigo' 	=> $row['codigo_usuario'],
+				'tipo' 		=> $row['id_tipo_documento'],
+				'numero' 	=> $row['numero_documento'],
+				'referencia'=> $row['referencia_documento'],
+				'anexo' 	=> $row['anexo_documento'],
+				'numero_folio' => $row['numero_folio_documento'],
+				'fecha' 	=> $row['fecha_documento'],
+				'asunto' 	=> $row['asunto_documento'],
+				'fecha_registro' => $row['fecha_registro_documento'],
+				'observacion' => $row['observacion_documento'],
+				'prioridad' => $row['prioridad_documento'],
+				'destino' 	=> $row['destino_documento'],
+				'remitente' => $row['id_remitente'],
+				'estado' 	=> $row['id_estado']
+			);
+		}
+		return $return;
+	}
+
+	function HistorialDocumentosPorUsuario($id_usuario){
+	
+		$return;
+		$sql = "SELECT * FROM historial_documentos WHERE id_usuario = '".$id_usuario."' ";
+		$query = new Consulta($sql);
+		while($row = $query->VerRegistro()){
+			$return[] = array(
+				'id' 		=>	$row['id_historial_documento'],
+				'documento'	=>	new Documento($row['id_documento']),
+				'remitente' =>	new Remitente($row['id_remitente']),
+				'destino' 	=>	new Usuario($row['id_usuario_destino']),
+				'fecha' 	=>	$row['fecha_historial_documento'] ,
+				'original'	=>	$row['original_historial_documento'] ,
+				'accion' 	=>	new Accion($row['id_accion']) ,
+				'estado' 	=>	new Estado($row['id_estado']),
+				'usuario' 		=>	new Usuario($row['id_usuario'])
+			);
+		}
+		return $return;
+	}
+
+	function listarDocumentosPorUsuario( $usuario ){
+		if(isset($_POST['campo']) && isset($_POST['valor']) && !empty($_POST['campo']) && !empty($_POST['valor'])){
+		 	$docs = $usuario->getIdAtencionPorFiltro($_POST['campo'], $_POST['valor']);
+		}else{
+			$docs = $usuario->getIdAtencion();
+		}
+		 ?>
+		 
+<div class="ui-jqgrid ui-widget ui-widget-content ui-corner-all">
+<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" id="tabla_despacho" class="gview_frmgrid">
+	<tr>
+	  <td>
+			<table width="100%" class="ui-jqgrid-htable" cellpadding="0" cellspacing="0">
+				<tr bgcolor="#6699CC" class="ui-widget-header ui-th-column grid_resize" height="25">
+					<th width="17%" class="ui-widget-header ui-th-column grid_resize">Reg. Nro</th>
+					<th width="27%" class="ui-widget-header ui-th-column grid_resize">Remitente</th>
+					<th class="ui-widget-header ui-th-column grid_resize">Documento</th>
+					<th width="14%" class="ui-widget-header ui-th-column grid_resize">Registrado</th>
+					<th width="6%" class="ui-widget-header ui-th-column grid_resize">Estado</th>
+					<th width="5%" class="ui-widget-header ui-th-column grid_resize">Cat</th>
+				</tr>			
+			</table>
+	</tr>
+	<tr class="ui-jqgrid-bdiv">
+		<td>
+			<table id="frmgrid" width="100%" class="ui-jqgrid-btable" cellpadding="0" cellspacing="0">
+		<?php			
+			
+			$cod_documento = "";
+			$muestra_copia=true;
+			
+			for($d=0; $d < count($docs); $d++ ){
+			
+			$doc[$d] = new Documento($docs[$d]['id']);
+						
+			$anterior = $cod_documento;
+			$cod_documento = $doc[$d]->getCodigo();
+            $tem = $doc[$d]->getEstado();
+            $estado = $tem-> getId();
+			
+			if($cod_documento != $anterior||$muestra_copia){			
+										
+			//Vemos si se muestra en la lista o no			
+			$tam_borr_orig = $doc[$d]->ObtenerTamanioHistorialOriginales();
+
+			if($tam_borr_orig>0&&!$doc[$d]->TengoElBorradorOriginal($_SESSION['session'][0])&&$docs[$d]['original']==1&&$estado==6){
+				//hay un historial de borradores donde se ha enviado el original y yo no tengo el original
+				//No se debe mostrar asi que no pasa nada
+				$muestra_copia = true;
+				//Como no se mostro original se muestra la copia
+			}elseif($docs[$d]['original']==1&&($estado==4||$estado==14||$estado==15)&&!$doc[$d]->TengoElDocDAOriginal($_SESSION['session'][0])){
+                //Viene de despacho de area y no lo tengo
+                $muestra_copia = true;
+            }
+			elseif($docs[$d]['original']==2&&$doc[$d]->copiaArchivadaUsuario()){			
+				//Esta archiovada no se muestra la copia	
+							
+			}			
+            else{
+				// Se mostrara el original, ya no se muestra copia
+				$muestra_copia = false;               		
+				
+				$clase = "Estilo7";
+						
+				if($estado==12){
+					$clase = "Estilo7 fila_finalizada";
+				}else{
+					$dias_faltantes = ObtenerDiasFaltantes($docs[$d]['id'], date('d/m/Y',strtotime($doc[$d]->getFechaCompletaRegistro())));
+						if($dias_faltantes <=0)
+							$clase = "Estilo7 fila_peligro";
+						elseif($dias_faltantes > 0 && $dias_faltantes <= 3)
+							$clase = "Estilo7 fila_urgente";
+						else	
+							$clase = "Estilo7 fila_baja";
+					
+					}
+
+					$tooltip_asunto="";
+					$asunto = trim($doc[$d]->getAsunto());                    
+					if(!empty($asunto))
+						$tooltip_asunto="title ='".$asunto."' class='tip'";
+
+                    $tooltip_estado="";
+                    if($estado==14||$estado==15){
+        				$tooltip_estado="title ='".$doc[$d]->ObtenerDescripcionUltimoOriginal($estado)."' class='tip'";
+                    }
+		
+		?>			
+			<tr class="ui-widget-content1 jqgrow <?=$clase?>">
+				<td <?=$tooltip_asunto?> width="17%">
+					<div align="center">
+					  <?php if(($estado != 12&&$estado != 11)||$docs[$d]['original']==2){ ?>
+					  <a href="atencion_acceso_registro.php?opcion=detalle&cat=<?=$docs[$d]['original']?>&id=<?php echo $doc[$d]->getId()?>"><?php echo $doc[$d]->getCodigo()?></a>
+					  <? }
+                    else{
+                        echo $doc[$d]->getCodigo();
+                    }
+                    ?>
+			        </div></td>
+				<td align="left" width="27%">
+					<?php $dtd = $doc[$d]->getRemitente();?>
+					<input type="text" value="<?=$dtd->getNombre()?>" size="40" style="border:none"/></td>
+				<td align="left">
+					<input type="text" value="<?=$doc[$d]->getNumero()?>" size="50" style="border:none"/>
+				</td>
+				<td width="14%">
+					<div align="center">
+						<input type="text" value="<?php echo $doc[$d]->getFechaRegistro()." ".$doc[$d]->getHoraRegistro();?>" style="text-align:center"/>
+					</div>
+				</td>
+				<td <?=$tooltip_estado?> width="6%">
+					<? 
+					$cat = $docs[$d]['original'];
+					if($cat == 1){?>
+                    <div align="center">
+						<input type="text" value="<?php $est = $doc[$d]->getEstado(); echo $est->getAbreviatura(); ?>" size="3"
+						style="text-align:center"/>
+					</div>
+					<? }else{
+						$ids = $doc[$d]->getId();						
+						$estado = $doc[$d]->ObtenerEstadoCopia($ids,2); 
+					?>				
+						<input type="text" value="<?=$estado?>" size="3" style="text-align:center; width:100%"/>
+					<? }?>
+				</td>
+				<td width="5%">
+				  <div align="center">
+					  <input type="text" value="<?php $cat = $docs[$d]['original']; echo ($cat == 1)?"O":"C"; ?>" size="2"
+					  style="text-align:center"/>
+				  </div>
+				</td>
+			</tr>
+			<?php
+				}//Fin del elseif
+				}//Fin de if anterior
+			}//Fin del for			
+			?>
+		 </table>
+		</td>
+	</tr>
+</table>
+</div>
+	<?
+	}
+
+	function detalleDocumentosPorUsuario( $usuario,  $documento ){
+	  $doc = $documento;
+	  $esOriginal=($_REQUEST[cat]==1)?true:false;
+      ?>
+		  <fieldset>
+		  <legend>DATOS DEL DOCUMENTO</legend>
+		  <input id ="id_documento" type="hidden" value="<?php echo $doc->getId;?>">
+		  <input name="hidden" type="hidden" id ="id_area" value="<?php echo $_SESSION['session'][5]?>" />
+		  <table border="0" align="center" bordercolor="#000000" bgcolor="#ffffff" width="100%">
+			<tbody>
+			<tr>
+			  <td width="20%" class="Estilo22"><div align="left">Registro Nro </div></td>
+			  <td width="2%" class="Estilo22"><div align="center">:</div></td>
+			  <td><div align="left"><?php echo $doc->getCodigo();?></div></td>
+			  <td>&nbsp;</td>
+			  <td>&nbsp;</td>
+			  <td width="12%" class="Estilo22"><div align="left">Categor&iacute;a</div></td>
+			  <td width="3%" class="Estilo22"><div align="center">:</div></td>
+			  <td><div align="left"><? echo ($esOriginal)?"Original":"Copia";?></div></td>
+			</tr>
+			<tr>
+			  <td class="Estilo22" ><div align="left">Remitente </div></td>
+			  <td class="Estilo22"><div align="center">:</div></td>
+			  <td ><div align="left"><?php $remit = $doc->getRemitente();echo $remit->getNombre();  ?></div></td>
+			  <td>&nbsp;</td>
+			  <td>&nbsp;</td>
+			  <td class="Estilo22" ><div align="left">Nro de Folios </div></td>
+			  <td class="Estilo22"><div align="center">:</div></td>
+			  <td><div align="left"><?php echo $doc->getNumeroFolio() ?></div></td>
+			</tr>
+			<tr>
+			  <td class="Estilo22"><div align="left">Tipo de Documento </div></td>
+			  <td class="Estilo22"><div align="center">:</div></td>
+			  <td width="45%" colspan="3"><div align="left">
+			    <?php $dtd = $doc->getTipoDocumento(); echo $dtd->getNombre(); ?>
+			  </div>		      </td>
+			  <td class="Estilo22"><div align="left">Fecha de Doc</div></td>
+			  <td class="Estilo22"><div align="center">:</div></td>
+			  <td><div align="left"><?php  echo $doc->getFecha() ?></div></td>
+		    </tr>
+			<tr>
+			  <td class="Estilo22"><div align="left">Nro. Doc </div></td>
+			  <td class="Estilo22"><div align="center">:</div></td>
+			  <td colspan="3"><div align="left"><?php echo $doc->getNumero() ?></div></td>
+			  <td colspan="2"><span class="Estilo32"></span></td>
+			  <td >&nbsp;</td>
+			</tr>
+			<tr>
+			  <td class="Estilo22"><div align="left">Referencia </div></td>
+			  <td class="Estilo22"><div align="center">:</div></td>
+			  <td colspan="6"><div align="left"><?php  echo $doc->getReferencia()?></div></td>
+			</tr>
+			<tr>
+			  <td class="Estilo22"><div align="left">Anexos </div></td>
+			  <td class="Estilo22"><div align="center">:</div></td>
+			  <td colspan="6" ><div align="left"><?php echo $doc->getAnexo() ?> </div></td>
+			</tr>
+
+			<tr>
+			  <td class="Estilo22"><div align="left">Fecha y Hora de Registro</div></td>
+			  <td height="21" class="Estilo22"><div align="center">:</div></td>
+			  <td colspan="6"><div align="left"><?=$doc->getFechaRegistro()." ".$doc->getHoraRegistro()?></div></td>
+		    </tr>
+			<tr>
+			  <td class="Estilo22"><div align="left">Documento Digitalizado</div></td>
+			  <td height="21" class="Estilo22"> <div align="center">: </div></td>
+			  <td colspan="6" ><div align="left">			  
+	      		<?
+					$escaneo = "SELECT *
+								from documentos_escaneados de
+								where de.id_documento = ".$doc->getId();
+
+					$qescaneo = new Consulta($escaneo);
+
+			  		$index = 1;
+
+					while($row_reg = $qescaneo->ConsultaVerRegistro()){
+						if(is_null($row_reg['fecha_escaneo']))
+							$ref = "Escaneo/".$row_reg['nombre_documento_escaneado'];
+						else
+							$ref = "../archivo/Escaneado_completo/".$doc->getCodigo()."/".$row_reg['nombre_documento_escaneado'];
+					?>
+						<a href="<?=$ref?>"	id="<?=$row_reg["id_documento_escaneado"]?>" target="_blank"><?=$index?></a>
+					<?
+						$index++;
+            		}
+				  	?>
+			  </div>
+			  </td>
+			</tr>
+			</tbody>
+		  </table>
+		 <p align="left"><a href="javascript:verDetalleDoc()" id = "control" class="v" >Ver Detalles </a></p>
+		 <div id="detalle_documento" style="display:none">
+		  <table border="0" align="center" bordercolor="#000000" bgcolor="#ffffff" width="100%">
+		  	<tbody>
+            <tr>
+              <td width="20%" class="Estilo22"><div align="left">Asunto </div></td>
+              <td width="2%"  class="Estilo22"><div align="center">:</div></td>
+              <td colspan="5">
+			  	<div align="left">
+					<textarea name="textfield2" id="textfield2" rows="2" cols="100" class="disabled" disabled="disabled"><?=$doc->getAsunto()?></textarea>
+              </div>
+			  </td>
+            </tr>
+            <tr>
+              <td class="Estilo22"><div align="left">Observaci&oacute;n de Registro </div></td>
+              <td class="Estilo22"><div align="center">:</div></td>
+              <td colspan="5">
+			  	<div align="left">
+			  		<textarea name="textfield2" id="textfield2" rows="2" cols="100" class="disabled" disabled="disabled"><?=$doc->getObservacion()?></textarea>
+				</div>
+			</td>
+            </tr>
+            <tr>
+              <td  class="Estilo22"><div align="left">Observaci&oacute;n de Despacho</div></td>
+              <td  class="Estilo22"><div  align="center">:</div></td>
+              <td colspan="5"><div align="left">
+                <?php
+                     $historial=$doc->getHistorial();
+                     foreach($historial as $reg){
+                        $area = $reg["area"];
+                        if($area->getId()==$_SESSION['session'][5]&&$reg["original"]==1){?>
+                            <textarea name="textfield2" id="textfield2" rows="2" cols="100" class="disabled" disabled="disabled"><?=$reg["observacion"]?></textarea>							
+                     <? }
+					 }
+                ?>
+              </div>
+			  </td>
+            </tr>
+            <tr>
+              <td class="Estilo22" ><div align="left">Prioridad </div></td>
+              <td height="21" class="Estilo22"><div align="center">:</div></td>
+              <td colspan="4"><div align="left"><? $pri = $doc->getPrioridad(); echo $pri->getNombre() ?></div></td>
+              <td>&nbsp;</td>
+            </tr>
+            <tr>
+              <td class="Estilo22" ><div align="left">Tiempo de Respuesta </div></td>
+              <td height="21" class="Estilo22"><div align="center">:</div></td>
+              <td width="5%"><div align="left"><?php echo $pri->getTiempoHorasRespuesta() ?></div></td>
+              <td width="40%"><div align="left">horas</div>                </td>
+              <td width="15%" class="Estilo22"><div align="left">Fecha Estimada de Respuesta </div></td>
+              <td width="3%" class="Estilo22"><div align="center">:</div></td>
+              <td width="106" ><div align="left"><?php echo $doc->getFechaRespuesta() ?></div></td>
+            </tr>
+			</tbody>
+          </table>
+		</div>		
+		</fieldset>
+		<?php
+			$tipo = 0;
+			$estado = $doc->getEstado();
+
+			if($_SESSION['session'][6]&&$estado->getId()!=14&&$estado->getId()!=15)
+				$tipo = 1;
+
+		?>	  	
+		<form id="form_borrador_respuesta" name="f1" method="post" action="javascript:mostrar_confirmacion()" >
+		<input type="hidden" id="id_doc" value="<?=$doc->getId()?>">
+		<input type="hidden" id="tipo" value="<?=$tipo?>">
+		<fieldset>
+			<legend >ELABORAR BORRADOR DE RESPUESTA</legend>
+				<table width="100%" border="0" align="center" bordercolor="#FFFFFF" bgcolor="#FFFFFF" id="mantenimientod">
+					<tr>
+						<td width="3%" class="Estilo21" height="25"><div align="center">(*)</div></td>
+						<td width="6%" class="Estilo22"><div align="left">Acci&oacute;n</div></td>
+						<td width="3%" class="Estilo22"><div align="center">:</div></td>
+						<td width="30%" ><div align="left">
+                        <?php
+							$acciones = new Acciones();
+							if($_REQUEST['cat']==1){
+								$accions = $acciones->getAcciones(2,$_SESSION['session'][0]);
+							}else{
+								$accions = $acciones->getAcciones(6,$_SESSION['session'][0]);
+							}
+
+							$tacciones = sizeof($accions);
+                            
+						?>
+                        <select name="accion" style="width:200px" id="accion_borrador">
+                          <option value="">--Seleccione Accion--</option>
+                          <?php
+								for($u = 0; $u < $tacciones; $u++){ ?>
+                          <option value="<?php echo $accions[$u]['id']?>" <?=$visible?>>
+                            <?php echo $accions[$u]['nombre']?>
+                          </option>
+                          <?php	}?>
+                        </select>
+                      	</div></td>
+						<td width="2%" align="left" class="Estilo21"><div align="center">(*)</div></td>
+						<td width="3%" align="left" class="22">
+                            <div align="center">
+							<input name="categoria" type="radio" value="1" id="original"/>
+                                <?
+                                    if(!$esOriginal){
+									?>
+                                        <script>javascript:deshabilitado();</script>
+                  				<? }?>
+                            </div>
+                        </td>
+						<td width="26%" align="left" class="Estilo22"><div align="left">Original</div></td>
+						<td width="27%">&nbsp;</td>
+					</tr>
+					<tr>
+						<td height="26" class="Estilo21" ><div align="center">(*)</div></td>
+						<td class="Estilo22" ><div align="left">Pase a</div></td>
+						<td class="Estilo22"><div align="center">:</div></td>
+						<td ><div align="left">
+                          <?php
+							$area = new Area($_SESSION['session'][5]);
+							$usuarios = $area->getUsuarios();
+							$tusuarios = sizeof($usuarios);
+							//Vemos si se activaran o no los combos
+							$visible = "";
+							if($_REQUEST["cat"]==2)
+								$visible="class='disabled' disabled='disabled'";													
+							?>
+                          <select name="usuario" style="width:200px" id="usuario" <?=$visible?>>
+                            <option value="">--Seleccione un Usuario--</option>
+                            <?php
+	  							for($u = 0; $u < $tusuarios; $u++){ ?>
+                            <option value="<?php echo $usuarios[$u]['id']?>"> <?php echo $usuarios[$u]['nombre'].' '.$usuarios[$u]['apellidos'] ?> </option>
+                            <?php
+  								}
+								?>
+                          </select>
+                          <input type="hidden" name="area" value="<?php echo $_SESSION['session'][5] ?>" />
+                          <input type="hidden" name="user" value="<?php echo $_SESSION['session'][0] ?>" id="user"/>
+                          <input type="hidden" name="cat" value="<?=$_REQUEST['cat']?>" id="cat"/>
+                        </div>
+						</td>
+						<td align="left">&nbsp;</td>
+						<td align="left">
+							<div align="center">
+								<input name="categoria" type="radio" id="copia" value="2" <?=($_REQUEST["cat"]==2)?"checked='checked'":""?>/>
+							</div>						
+						</td>
+						<td align="left" class="Estilo22"><div align="left">Copia</div></td>
+						<td>
+							<div align="right">
+								<input type="submit" name="guarda_historial" value="Agregar" class="boton" <?=$deshabilitado?>/>
+							</div>
+						</td>
+					</tr>
+			  </table>			
+		</fieldset>
+		</form>
+		<br/>
+		<table width="100%" border="0" align="center" cellpadding="0" cellspacing="1" class="formularios"  id="lista_borradores">
+		<tr bgcolor="#6699CC" class="Estilo7">
+		  <td width="4%" height="25"><div align="center" class="msgok1"><strong>N&ordm;</strong></div></td>
+			<td width="21%" ><div align="center" class="msgok1"><strong>ORIGEN</strong></div></td>
+			<td width="21%"><div align="center" class="msgok1"><strong>DESTINO</strong></div></td>
+			<td width="16%" ><div align="center" class="msgok1"><strong>Fecha y Hora</strong></div></td>
+			<td width="16%"><div align="center" class="msgok1"><strong>Acci&oacute;n</strong></div></td>
+			<td width="8%" ><div align="center" class="msgok1"><strong>Categor&iacute;a</strong></div></td>
+			<td width="14%"><div align="center" class="msgok1"><strong>Opciones</strong></div></td>
+		</tr>
+		<?php
+            $his_base = $doc->getHistorialAtencionDocumentos();
+			$this_base = count($his_base);
+			$ultimo_original = 0;
+			
+			for($i = 0 ; $i < $this_base ;$i++){
+				if($his_base[$i]["original"] == 1 && $his_base[$i]["tipo"] != 6)
+					$ultimo_original = $i;
+			}
+			
+        	$cont = 0;
+        
+
+        for( $h = 0; $h < $this_base; $h++ ){
+            $clase = "class='historial'";
+            $archivo=array();
+            $observacion = trim($his_base[$h]['comentario']);
+            
+			if($his_base[$h]['tipo']==1){//Area a Area (Derivacion de documento)
+				$origen=$his_base[$h]['area']->GetNombre();
+				$destino=$his_base[$h]['area_destino']->GetNombre();
+			}
+			elseif($his_base[$h]['tipo']==0){//Area a Usuario
+					$origen=$his_base[$h]['area']->GetNombre();				
+					$destino=$his_base[$h]['destino']->GetNombreCompleto();
+				}
+				elseif($his_base[$h]['tipo']==2){//Usuario a su Area
+					$origen=$his_base[$h]['usuario']->GetNombreCompleto();
+					$destino=$his_base[$h]['area_destino']->GetNombre();
+					$archivo = $doc->obtenerJustificacionesEscaneadas($his_base[$h]['id']);
+				}
+				elseif($his_base[$h]['tipo']==3){//Usuario a Usuario en borradores
+                    $origen=$his_base[$h]['usuario']->GetNombreCompleto();
+					$destino=$his_base[$h]['destino']->GetNombreCompleto();
+                    $archivo = $doc->obtenerBorradoresEscaneados($his_base[$h]['id']);
+                    $clase = "class='filas'";
+                }
+				elseif($his_base[$h]['tipo']==4 ||$his_base[$h]['tipo']==5){//Usuario a Usuario en historial de atencion
+                    $origen=$his_base[$h]['usuario']->GetNombreCompleto();
+					$destino=$his_base[$h]['destino']->GetNombreCompleto();	
+					$archivo = $doc->obtenerJustificacionesEscaneadas($his_base[$h]['id']);				
+                }	
+				elseif($his_base[$h]['tipo']==6){//Es de MESA a AREA
+                    $origen="DESPACHO GENERAL";
+					$destino=$his_base[$h]['area_destino']->GetNombre();
+                }
+				elseif($his_base[$h]['tipo']==7){//Es de AREA a MESA
+                    $origen=$his_base[$h]['area']->GetNombre();
+					$destino="DESPACHO GENERAL";
+                }						
+		?>
+		<tr <?=$clase?>>
+			<td><?php echo ++$cont ?></td>
+			<td><?php echo $origen?></td>
+			<td><?php echo $destino ?></td>
+			<td><?php echo $his_base[$h]['fecha'] ?></td>
+			<td><?php echo ($his_base[$h]['tipo']!=7)?$his_base[$h]['accion']->GetNombre():"DEVOLVER A DESPACHO" ?></td>
+			<td><?php if($his_base[$h]['original']==1){echo "Original";}else{echo "Copia";}?></td>
+			<td>
+                <div align="center">
+					<?                                        
+                    //Observacion - comentario
+                    if($his_base[$h]['tipo']==3&&!empty($observacion)){?>                  
+                    <a href="javascript:VerComentario(<?php echo $h + 1 ?>)">
+                        <img src="public_root/imgs/b_search.png" border="0" alt="Ver Detalle" title="Ver Comentario"/>
+					</a>
+                    <? }elseif($his_base[$h]['tipo']==3&&empty($observacion)){
+                    ?>                    
+                        <img src="public_root/imgs/b_search_d.png" border="0" alt="Ver Detalle" title="Ver Comentario"/>                    <? }
+                    elseif(!empty($observacion)){?>                    
+                    <a href="javascript:VerDetalleObservacion(<?php echo $h + 1 ?>)">
+                    	<img src="public_root/imgs/b_search.png" border="0" alt="Ver Detalle" title="Ver Comentario"/>
+					</a>
+                    <? }else{?>
+                        <img src="public_root/imgs/b_search_d.png" border="0" alt="Ver Detalle"/>
+                    <? } ?>
+					<?
+                    //Detalle Borrador
+                    if($his_base[$h]['tipo']==3){?>
+                    <a href="javascript:VerDetalleBorrador(<?=$his_base[$h]['id']?>)">
+                        <img src="public_root/imgs/file.gif" border="0" alt="Ver Detalle" title="Ver Borrador de Respuesta"/>
+					</a>
+                    <? } else{?>
+						<img src="public_root/imgs/file_d.png" border="0" alt="Ver Detalle" title="Ver Borrador de Respuesta"/>
+		            <? }
+                    //Archivo Escaneado					
+                    if(count($archivo)>0){
+						if($his_base[$h]['tipo']==2||$his_base[$h]['tipo']==5)
+							$ruta = 'Justificados/';
+						else
+							$ruta = 'Archivados/';					
+					?>					
+                    <a href="javascript:void(0)" onclick="ver_mas_adjuntos($(this))">
+                        <img src="public_root/imgs/attach.png" alt="Documento" border="0" title="Ver Documento Adjunto">                    </a>
+					<div id="doc_adjuntos<?php echo ($cont) ?>" class="doc_adjuntos">
+						<p>Documentos Adjuntos : </p>
+						<? 						
+							for($i = 0; $i < count($archivo); $i++){								
+							?>
+								<p><a href="<?=$ruta.rawurlencode($archivo[$i])?>" target="_blank"><?=$archivo[$i]?></a></p>
+						<? }?>
+					</div>	
+                    <? }else{?>
+                        <img src="public_root/imgs/attach_d.png" alt="Documento" border="0" title="Ver Documento Adjunto">
+                    <? }					
+					//Editar
+					if($his_base[$h]['tipo']==3){
+					if($_SESSION['session'][6]||$his_base[$h]['usuario']->getId()==$_SESSION['session'][0]){?>
+                    <a href="javascript:EditarBorrador(<?=$his_base[$h]['id']?>);">
+					<img src="public_root/imgs/b_edit.png" alt="Ver Documento" border="0" title="Editar Documento">                    </a>
+                    <? 
+					}else{?>
+					<img src="public_root/imgs/b_edit_d.png" alt="Ver Documento" border="0" title="Editar Documento">	
+						<? }
+					}else{?>
+					<img src="public_root/imgs/b_edit_d.png" alt="Ver Documento" border="0" title="Editar Documento">	
+					<? }
+					//Eliminar
+					if(($his_base[$h]['usuario']->getId()==$_SESSION['session'][0]||
+						$his_base[$h]['destino']->getId()==$_SESSION['session'][0])&&$his_base[$h]['original'] != 1){?>
+                    <a href="atencion_acceso_registro.php?opcion=deleteha&id=<?=$doc->getId()?>&idb=<?=$his_base[$h]['id']?>&cat=<?=$_REQUEST["cat"]?>&tipo=<?=$his_base[$h]['tipo']?>">
+                        <img src="public_root/imgs/b_drop.png" alt="Eliminar" border="0" title="Eliminar">
+					</a>
+                    <? }elseif(($his_base[$h]['usuario']->getId()==$_SESSION['session'][0]||
+						$his_base[$h]['destino']->getId()==$_SESSION['session'][0])&& $ultimo_original == $h ){?>
+                    <a href="atencion_acceso_registro.php?opcion=deleteha&id=<?=$doc->getId()?>&idb=<?=$his_base[$h]['id']?>&cat=<?=$_REQUEST["cat"]?>&tipo=<?=$his_base[$h]['tipo']?>">
+                        <img src="public_root/imgs/b_drop.png" alt="Eliminar" border="0" title="Eliminar">
+					</a>
+                    <? }else{?>
+						<img src="public_root/imgs/b_drop_d.png" alt="Eliminar" border="0" title="Eliminar">
+                    <? } 
+					?>       
+				</div>			</td>
+		</tr>
+        <? if($his_base[$h]['tipo']==3){?>
+        <tr>
+			<td colspan="7" align="justify">
+				<div style="display:none; margin-left:35px;" id="detalle_borrador<?php echo $h + 1; ?>">
+					<?=$his_base[$h]['comentario']?>				
+			  </div>			</td>
+		</tr>
+        <? }else{?>
+		<tr>
+			<td colspan="7" align="justify">
+				<div style="display:none; margin-left:35px;" id="detalle_observacion<?php echo $h + 1; ?>">
+					<?=$his_base[$h]['comentario']?>
+			  </div>
+			</td>
+		</tr>
+        <? }
+       }
+       if($esOriginal){
+           $estado =  $doc->getEstado();
+           if($estado->getId()==4&&!$doc->TengoElDocDAOriginal($_SESSION['session'][0])){
+            ?> <script>javascript:deshabilitado();</script>
+            <?
+            }elseif($estado->getId()==6&&!$doc->TengoElBorradorOriginal($_SESSION['session'][0])){
+            ?> <script>javascript:deshabilitado();</script>
+            <?}
+            else{?> <script>
+                javascript:habilitado();
+                javascript:deshabilita_copia();
+           </script>
+            <? }?>
+            <script>
+                javascript:accion_por_defecto(<?=$estado->getId()?>);
+            </script>
+       <?
+       }
+    ?>
+    </table>
+	<div id="question" style="display:none; cursor: default"> 
+		<p class="Estilo22">
+				&iquest;Est&aacute; seguro que desea enviar un 
+				<span id="conf_categoria" style="font-weight:bold; color: #D3455A">a</span> 
+				del documento a <span id="conf_usuario" style="font-weight:bold; color:#D3455A">b</span>?
+		</p>
+		<p class="Estilo22">
+			<input type="button" id="yes_a_d" value="Si" class="boton"/> 
+			<input type="button" id="no_a_d" value="No" class="boton"/> 
+		</p>
+	</div>
+	<?php
+    }
+
+    function getDocumentosConFiltro(){
+
+		$where = $campo != "" ? " AND d.$campo like '%$valor%' " : ""  ;
+
+		$sql = " SELECT * FROM documentos  ";
+		$query = new Consulta($sql);
+	}
+		
+	function GuardarArchivo($borrador){
+	
+	if($_FILES['doc']){
+	$keys = array_keys($_FILES['doc']);
+	$destino = "Archivados/";
+	
+	echo  "<div id='error'>";
+
+    for($u=0; $u < count($keys); $u++){
+		if(!empty($_FILES['doc']['name'][$u])){				
+			if( $_FILES['doc']['size'][$u] > ( 2*1024*1024 ) ){
+				echo "El tamao del archivo supera al permitido";
+			}
+			elseif(!move_uploaded_file($_FILES['doc']['tmp_name'][$u], $destino.$_FILES['doc']['name'][$u])){
+				echo "ocurrio error al subir archivo " . $_FILES['doc']['name'][$u] ;			 				
+			}else{
+				$sql = " INSERT INTO borrador_escaneado VALUES( '', ".$borrador.",'".$_FILES['doc']['name'][$u]."') ";
+				$query = new Consulta($sql);
+				echo "se subio el archivo <b>" . $_FILES['doc']['name'][$u] . "</b> satisfactoriamente <br>" ;	
+			}	
+		}
+	}
+	}
+	else{
+		echo  "<div id='error'>";
+	}	 	
+    }
+
+	function GuardarArchivoJustificacion($atencion){
+	
+	if($_FILES['doc']){
+	$keys = array_keys($_FILES['doc']);
+	$destino = "Justificados/";
+	
+	echo  "<div id='error'>";
+
+    for($u=0; $u < count($keys); $u++){
+		if(!empty($_FILES['doc']['name'][$u])){
+			if( $_FILES['doc']['size'][$u] > ( 2*1024*1024 ) ){
+				echo "El tamao del archivo supera al permitido";
+			}
+			elseif(!move_uploaded_file($_FILES['doc']['tmp_name'][$u], $destino.$_FILES['doc']['name'][$u])){
+				echo "ocurrio error al subir archivo " . $_FILES['doc']['name'][$u] ;			 				
+			}else{
+				$sql = " INSERT INTO justificado_escaneado VALUES( '', ".$atencion.",'".$_FILES['doc']['name'][$u]."') ";
+				$query = new Consulta($sql);
+				echo "se subio el archivo <b>" . $_FILES['doc']['name'][$u] . "</b> satisfactoriamente <br>" ;	
+			}	
+		}
+	}
+	}
+	else{
+		echo  "<div id='error'>";
+	}	 	
+    }
+
+}
+?>
diff -r 82e55d328c8c -r 9881d5db150a class.escaneos.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/class.escaneos.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,430 @@
+<?php 
+
+class Escaneos {
+
+
+function EscaneaEditar($id){
+
+    $doc = new Documento($id);
+    $escaneos = $doc->getEscaneos();  ?>
+
+    <form id="fe" name="fe" method="post" action="<?php echo $_SERVER['PHP_SELF']?>?opcion=add&id=<?php echo $id?>" enctype="multipart/form-data">
+    <br/>
+        <div style="float:left; width:33%; text-align:left">
+            <fieldset style="width:100%; margin:0px 0px 15px 10px; padding:8px;">
+                <legend>DATOS DOCUMENTO</legend>				
+                <p><label class="primera_columna Estilo22" >N&ordm; Registro</label>
+				<span style="float:left" class="Estilo22">:</span>
+				<span style="margin-left:10px;"><?php echo $doc->getCodigo()?></span>                
+                </p>
+                <p><label class="primera_columna Estilo22">Remitente</label>
+				<span style="float:left" class="Estilo22">:</span>
+                <?php $remitente = $doc->getRemitente();?>
+				<input type="text" style="margin-left:10px; width:157px;border:none;color:#666666" value="<? echo $remitente->getNombre();?>">
+                </p>
+                <p><label class="primera_columna Estilo22">N&ordm; Documento</label>
+				<span style="float:left" class="Estilo22">:</span>
+				<input type="text" style="margin-left:10px; width:157px;border:none;color:#666666" value="<?php echo $doc->getNumero()?>">	
+                </p>
+                <p><label class="primera_columna Estilo22">Folios</label>
+				<span style="float:left" class="Estilo22">:</span>
+				<span style="margin-left:10px;"><?php echo $doc->getNumeroFolio()?></span>
+                </p>
+                <p><label class="primera_columna Estilo22">Fecha</label>
+				<span style="float:left" class="Estilo22">:</span>
+				<span style="margin-left:10px;"><?php echo cambiar_caracter('-','/',$doc->getFecha())?></span>                
+                </p>
+            </fieldset>
+        </div>
+
+    <fieldset id="marco_file">
+   		<legend>SUBIR ARCHIVOS ESCANEADOS</legend>
+		
+		<div class="Estilo21 both" style="margin-top:7px; margin-bottom:7px;">
+		  <div align="left"><strong> (*) Tama&ntilde;o M&aacute;ximo 2Mb </strong></div>
+		</div>
+		<div class="ileft_img" style="margin-top:0.5em;">	
+            <div id='cp_item_0' ><label for="imagen" class="Estilo22">Documento : </label><input id="doc[]" type="file" name="doc[]" size="40"/></div>
+		</div>		
+        <div class="iright_img"> <span onclick="crearCarchivo(0)"> [ + Agregar ] </span> </div>
+		<div class="iright_img"> <span onclick="quitarCarchivo(0)">  [ - Quitar ] </span> </div>
+		<div class="both Estilo2"> </div>
+		<p onclick="javascript: return valida_archivos(0)" class="boton"> SUBIR ARCHIVO(S)</p>					
+    </fieldset>
+
+    <fieldset>
+   		<legend>LISTA DE DOCUMENTOS ESCANEADOS</legend>
+		<ul>
+                <div align="left">
+                  <?php
+    			for($d = 0; $d < count($escaneos); $d++ ){ ?>
+                </div>
+                <li class="escaneo<?php echo  $escaneos[$d]['id'];?>">
+                  <div align="left">
+                    <input type="checkbox" name="qdocumento" id="qdocumento" value="<?php echo  $escaneos[$d]['id'];?>" /> 
+                    <?php echo  $escaneos[$d]['nombre'];?> </div>
+                </li> 
+                <div align="left">
+                  <?php				
+            }?>
+                        </div>
+		</ul>
+    </fieldset>
+
+    <div id="images" style="margin-left:40px">
+        <div class="bottom"><img src="public_root/imgs/arrow_ltr.png" border="0" height="13"/> Para eliminar un archivo activa su(s) respectiva(s) casilla de verificacion y haz cilck en [ <span onclick="javascript: delete_escaneo()" >ELIMINAR <img src="public_root/imgs/b_deltbl.png" width="16" height="16" /></span>].</div>
+    </div>
+</form>
+
+<?php 
+}
+
+function EscaneaGuardar(){ 		 
+	
+	$doc = new Documento ($_GET['id']);
+	$targetPath = $_SERVER['DOCUMENT_ROOT']."/archivo/Escaneado_completo/".$doc->getCodigo()."/";
+
+	if ( !is_dir ($targetPath))
+		mkdir(str_replace('//','/',$targetPath), 0755);
+		
+	$keys = array_keys($_FILES['doc']);
+	$destino = "../archivo/Escaneado_completo/".$doc->getCodigo()."/";
+	echo  "<div id='error'>";
+
+    for($u=0; $u < count($keys); $u++){
+		if(!empty($_FILES['doc']['name'][$u])){
+			if(!move_uploaded_file($_FILES['doc']['tmp_name'][$u], $destino.$_FILES['doc']['name'][$u])){
+				echo "ocurrio error al subir archivo " . $_FILES['doc']['name'][$u] ;			 				
+			}else{
+				$sql = " INSERT INTO documentos_escaneados VALUES( '', '".$_GET['id']."','".$_FILES['doc']['name'][$u]."','".date("Y-m-d H:i:s")."') ";
+				$query = new Consulta($sql);
+				echo "se subio el archivo <b>" . $_FILES['doc']['name'][$u] . "</b> satisfactoriamente <br>" ;	
+			}	
+		}
+	}
+	echo "</div>"; 	
+    }
+
+ function EscaneaUpdate($id){
+
+    $num_folio	= $_POST["num_folio"];
+	$remit1		= $_POST["remit1"]; 
+	$tipo		= $_POST["tipo"]; 
+	$num_doc2	= $_POST["num_doc2"]; 
+	$FechaSol2	= $_POST["FechaSol2"]; 
+	$refe		= $_POST["refe"]; 
+	$anexo		= $_POST["anexo"]; 
+	$destino	= $_POST["destino"]; 
+	$observ1	= $_POST["observ1"]; 
+ 	$var_estado = 1;
+    
+    $actualiza  = " UPDATE documentos SET
+    				documentos.id_tipo_documento='".$tipo."',
+					documentos.`numero_documento`='".$num_doc2."',
+					documentos.`referencia_documento`='".$refe."',
+					documentos.`anexo_documento`='".$anexo."',
+					documentos.`numero_folio_documento`='".$num_folio."',
+					documentos.`fecha_documento`='".$FechaSol2."',
+					documentos.`observacion_documento`='".$observ1."',
+					documentos.`id_remitente`='".$remit1."'
+                    Where documentos.id_documento='".$id."'";
+
+    $actua = new Consulta($actualiza);
+
+}
+
+function EscaneaListado($ide){	  
+
+    if($ide=='')
+		$ide='LE';
+	else{
+		if($ide=='LT')
+			$where="";
+		else{
+			if($ide!='LE') //No escogio Listar por no escaneados
+				$where=" WHERE estados.id_estado='".$ide."' ";
+		}	
+	} 
+	
+	if($ide=='LE'){
+		/*
+		QUERY ESCANEADOS
+		
+		$sql = "SELECT *
+				FROM
+				documentos AS d
+				Inner Join remitentes AS r ON r.id_remitente = d.id_remitente
+				Inner Join estados AS e ON d.id_estado = e.id_estado
+				Inner Join tipos_documento AS td ON d.id_tipo_documento = td.id_tipo_documento
+				Inner Join documentos_escaneados ON documentos_escaneados.id_documento = d.id_documento
+				group by d.id_documento
+				ORDER BY d.id_documento DESC";	*/
+				
+		$sql = "SELECT *
+				FROM
+				documentos AS d
+				Inner Join remitentes AS r ON r.id_remitente = d.id_remitente
+				Inner Join estados AS e ON d.id_estado = e.id_estado
+				Inner Join tipos_documento AS td ON d.id_tipo_documento = td.id_tipo_documento
+				WHERE
+				d.id_documento NOT IN  
+				(SELECT distinct id_documento from documentos_escaneados)
+				AND d.id_estado <> 12 AND d.id_estado <> 11
+				group by d.id_documento
+				ORDER BY d.id_documento DESC";		
+	}else{			
+		$sql = "SELECT * FROM documentos
+				Inner Join remitentes ON remitentes.id_remitente = documentos.id_remitente
+				Inner Join estados ON estados.id_estado = documentos.id_estado
+				Inner Join tipos_documento ON tipos_documento.id_tipo_documento = 				
+				documentos.id_tipo_documento 	
+				".$where."	
+				ORDER BY documentos.id_documento DESC";
+	}
+    $query = new Consulta($sql); ?>
+
+<div class="ui-jqgrid ui-widget ui-widget-content ui-corner-all">
+<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" id="tabla_despacho" class="gview_frmgrid">
+	<tr>
+		<td>
+			<table width="100%" class="ui-jqgrid-htable" cellpadding="0" cellspacing="0">
+				<tr bgcolor="#6699CC" class="ui-widget-header ui-th-column grid_resize" height="25">
+					<th width="10%" class="ui-widget-header ui-th-column grid_resize">Reg. Nro</th>
+					<th width="26%" class="ui-widget-header ui-th-column grid_resize">Remitente</th>
+					<th width="31%" class="ui-widget-header ui-th-column grid_resize">Documento</th>
+					<th width="13%" class="ui-widget-header ui-th-column grid_resize">Registrado</th>
+					<th width="6%" class="ui-widget-header ui-th-column grid_resize">Estado</th>
+					<th class="ui-widget-header ui-th-column grid_resize">Ubicacion  Original</th>
+				</tr>			
+			</table>
+		</td>
+	</tr>
+	<tr class="ui-jqgrid-bdiv">
+		<td>
+			<table id="frmgrid" width="100%" class="ui-jqgrid-btable" cellpadding="0" cellspacing="0">			
+    <?php
+		while($row_reg=$query->ConsultaVerRegistro()){
+    	$id = $row_reg[0];
+        $estado = $row_reg["id_estado"];
+		$tooltip = "";
+		if(!empty($row_reg['asunto_documento']))
+			$tooltip="title ='".$row_reg['asunto_documento']."' class='tip'";
+    ?>
+    <tr class="ui-widget-content1 jqgrow <? echo ($estado==12)?"Estilo2 fila_finalizada":"Estilo2";?>">
+    <td <?=$tooltip?> width="10%">
+		<div align="center">
+		<?php
+			$cod = $row_reg[1];
+	
+			if($estado != 12&&$estado != 11){?>
+				<a href="escaneo_acceso_registro.php?opcion=edit&id=<?php echo $id?>">
+					<?=$cod?>
+				</a>
+				<?
+			}
+			else{
+			   echo $cod;
+			}
+		  ?>
+		  </div>      </td>
+      <td width="26%"><input size="50" value="<?php echo $row_reg[nombre_remitente]?>"/></td>
+      <td width="31%"><input size="45" value="<?php echo $row_reg[3]?>"/></td> 
+      <td  width="13%">
+	  	<div align="center">
+	  	  <input type="text" style="text-align:center; width:100%" value="<?=date('d/m/Y H:i',strtotime($row_reg['fecha_registro_documento']))?>" size="3"/>
+	  	</div>
+	  </td>
+      <td align="center"  width="6%">
+	  	<div align="center">
+			<input type="text" style="text-align:center; width:100%" value="<?=$row_reg['abrev_nombre_estado']?>" size="3"/>        
+      	</div>
+		</td> <?php   
+
+        $sql_ultimo = " SELECT Max(`hd`.`id_historial_documento`) AS `ultimo`
+						FROM `historial_documentos` AS `hd`
+						WHERE hd.id_documento='".$row_reg['id_documento']."'
+						GROUP BY `hd`.`id_documento`";
+
+		$query_ultimo = new Consulta($sql_ultimo);		
+		$ultimo = $query_ultimo->ConsultaVerRegistro();
+
+		$sql_data=" SELECT hd.id_documento,a.nombre_area, a.abve_nombre_area FROM historial_documentos AS hd 
+            		Inner Join areas AS a ON a.id_area = hd.id_area
+            		where hd.id_historial_documento='".$ultimo['ultimo']."'";
+
+        $query_data=new Consulta($sql_data);
+		$data=$query_data->ConsultaVerRegistro();		
+
+		$sql_usu = "SELECT Max(`ha`.`id_historial_atencion`) AS `ultimo`, `ha`.`id_documento`
+    				FROM
+    				`historial_atencion` AS `ha`
+    				WHERE
+                    ha.original_historial_atencion =  '1' and
+    				ha.id_documento='".$row_reg['id_documento']."'
+    				GROUP BY
+    				`ha`.`id_documento`	";
+
+		$query_usu=new Consulta($sql_usu);		
+		$usu=$query_usu->ConsultaVerRegistro();
+
+		$susu ="SELECT `u`.`login_usuario`, `a`.`abve_nombre_area`
+    			FROM
+    			`historial_atencion` AS `ha`
+				Inner Join `usuarios` AS `u` ON `u`.`id_usuario` = `ha`.`id_usuario_destino`
+				Inner Join `areas` AS `a` ON `a`.`id_area` = `u`.`id_area`
+				WHERE
+				`ha`.`id_historial_atencion` = '".$usu['ultimo']."' ";
+
+				$qusu=new Consulta($susu);		
+				$u=$qusu->ConsultaVerRegistro(); ?>
+		<td>
+			<div align="center">
+			<?
+			$documento = new Documento($row_reg['id_documento']);
+			?>
+			<input name="text4" type="text" value="<?=$documento->UltimaUbicacionReporte()?>" />
+			</div>
+		  </td>
+    	</tr>
+		<?php }?>
+		 </table>
+		</td>
+	</tr>
+</table>
+</div>
+<?php 
+}
+
+function Busqueda($campo, $valor){	 
+
+	if($campo == "nombre_remitente"){
+		$where = $campo == "nombre_remitente" ? " AND remitentes.nombre_remitente like '%$valor%' " : "";
+	}else{
+		$where = $campo != "" ? " AND d.$campo like '%$valor%' " : ""  ;
+	}
+
+	$sql_reg = "SELECT * FROM documentos d
+                Inner Join remitentes ON remitentes.id_remitente = d.id_remitente
+                Inner Join estados ON estados.id_estado = d.id_estado
+                Inner Join tipos_documento ON tipos_documento.id_tipo_documento = d.id_tipo_documento
+                ".$where." ORDER BY d.id_documento DESC";
+
+    $query_reg=new Consulta($sql_reg);
+?>
+
+<div class="ui-jqgrid ui-widget ui-widget-content ui-corner-all">
+<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" id="tabla_despacho" class="gview_frmgrid">
+	<tr>
+		<td>
+			<table width="100%" class="ui-jqgrid-htable" cellpadding="0" cellspacing="0">
+				<tr bgcolor="#6699CC" class="ui-widget-header ui-th-column grid_resize" height="25">
+					<th width="10%" class="ui-widget-header ui-th-column grid_resize">Reg. Nro</th>
+					<th width="26%" class="ui-widget-header ui-th-column grid_resize">Remitente</th>
+					<th width="31%" class="ui-widget-header ui-th-column grid_resize">Documento</th>
+					<th width="13%" class="ui-widget-header ui-th-column grid_resize">Registrado</th>
+					<th width="6%" class="ui-widget-header ui-th-column grid_resize">Estado</th>
+					<th class="ui-widget-header ui-th-column grid_resize">Ubicacion  Original</th>
+				</tr>			
+			</table>
+		</td>
+	</tr>
+	<tr class="ui-jqgrid-bdiv">
+		<td>
+			<table id="frmgrid" width="100%" class="ui-jqgrid-btable" cellpadding="0" cellspacing="0">
+
+        <? while($row_reg=$query_reg->ConsultaVerRegistro()){
+            $id=$row_reg[0];
+            $estado = $row_reg["id_estado"];
+			$tooltip = "";
+			if(!empty($row_reg['asunto_documento']))
+				$tooltip="title ='".$row_reg['asunto_documento']."' class='tip'";
+        ?>
+        <tr class="ui-widget-content1 jqgrow <? echo ($estado==12)?"Estilo2 fila_finalizada":"Estilo2";?>">
+            <td <?=$tooltip?> width="10%">
+				<div align="center">
+				<?php
+					$cod = $row_reg[1];
+					if($estado != 12){?>
+						<a href="escaneo_acceso_registro.php?opcion=edit&id=<?php echo $id?>">
+						<?=$cod?></a>
+					 <? }
+					else{
+						echo $cod;
+					}
+				?>
+				</div>
+			</td>
+            <td width="26%">
+				<input size="48"  value="<?=$row_reg[nombre_remitente]?>"/>
+			</td>
+            <td width="31%">
+				<input size="43" value="<?=$row_reg[3]?>"/>
+			</td>
+            <td width="13%">
+				<input name="text" type="text" style="text-align:center; width:100%" value="<?=date('d/m/Y H:i',strtotime($row_reg['fecha_registro_documento']))?>" size="3"/>
+			</td>
+            <td width="6%" align="center">
+				<input name="text2" type="text" style="text-align:center; width:100%" value="<?=$row_reg['abrev_nombre_estado']?>" size="3"/>
+			</td>
+            <?php
+
+                $sql_ultimo="SELECT Max(`hd`.`id_historial_documento`) AS `ultimo`
+                            FROM
+                            `historial_documentos` AS `hd`
+                            where hd.id_documento='".$row_reg['id_documento']."'
+                            GROUP BY
+                            `hd`.`id_documento`";
+
+                $query_ultimo=new Consulta($sql_ultimo);
+                $ultimo=$query_ultimo->ConsultaVerRegistro();
+                
+                $sql_data=" SELECT hd.id_documento,
+                            a.nombre_area,
+                            a.abve_nombre_area
+                            FROM historial_documentos AS hd
+                            Inner Join areas AS a ON a.id_area = hd.id_area
+                            where hd.id_historial_documento='".$ultimo['ultimo']."'";
+
+                $query_data=new Consulta($sql_data);
+                $data=$query_data->ConsultaVerRegistro();
+
+                $sql_usu = "SELECT Max(`ha`.`id_historial_atencion`) AS `ultimo`,
+                            `ha`.`id_documento`
+                            FROM `historial_atencion` AS `ha`
+                            WHERE ha.original_historial_atencion =  '1' and
+                            ha.id_documento='".$row_reg['id_documento']."'
+                            GROUP BY
+                            `ha`.`id_documento`	";
+
+                $query_usu=new Consulta($sql_usu);
+                $usu=$query_usu->ConsultaVerRegistro();
+
+                $susu= "SELECT `u`.`login_usuario`, `a`.`abve_nombre_area`
+                        FROM `historial_atencion` AS `ha`
+                        Inner Join `usuarios` AS `u` ON `u`.`id_usuario` = `ha`.`id_usuario_destino`
+                        Inner Join `areas` AS `a` ON `a`.`id_area` = `u`.`id_area`
+                        WHERE
+                        `ha`.`id_historial_atencion` = '".$usu['ultimo']."' ";
+
+                $qusu=new Consulta($susu);
+				$u=$qusu->ConsultaVerRegistro();
+            ?>
+            <td><div align="center">
+              <?
+			$documento = new Documento($row_reg['id_documento']);
+			?>
+              <input name="text42" type="text" value="<?=$documento->UltimaUbicacionReporte()?>" />
+            </div></td>
+        </tr>
+        <? }
+        ?>
+		 </table>
+		</td>
+	</tr>
+</table>
+</div>
+<?
+}
+
+}
+?>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a class.menu.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/class.menu.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,69 @@
+<?php 
+
+class Menu{
+
+	function MenuIzquierdo(){
+
+	if($_SESSION['session'][0]){
+
+		/* SECCIONES */
+
+        $array=Acceso::AccesoSecciones($_SESSION['session'][0]);
+
+        if(is_array($array)){ ?>
+			<table cellpadding="0" cellspacing="0"  width="100%" id="menu_izquierdo" >
+    		<tr>
+				<td class="date"><a href="javascript:history.go(-1)"><img src="public_root/imgs/back.png" alt="Retroceder" width="16" height="16" border="0" align="absmiddle" style="margin-bottom:4px"/></a> <strong>MODULOS DEL SISTEMA</strong> <a href="javascript:history.go(1)"><img src="public_root/imgs/forward.png" alt="Retroceder" width="16" height="16" border="0" align="absmiddle" style="margin-bottom:4px"/></a></td>
+			</tr>
+			<tr>
+				<td>
+            		<?php
+					for($c=0;$c<sizeof($array);$c++){
+					/*   PAGINAS  */
+    				$paginas=Acceso::AccesoPaginasSecciones($array[$c]['id_modulo'], $_SESSION['session'][0]);
+
+					if(is_array($paginas)){ 
+						$submenu = array();
+					?>
+					<div style="float: left" id="my_menu" class="sdmenu">
+					<?
+                    for($z=0;$z<sizeof($paginas);$z++){?>                        
+						<?
+							if(!StartsWith(strtolower($paginas[$z]['pagina']),'administracion')){
+						?>
+							<div>
+								<div class="item" id="menu<?=$paginas[$z]['id']?>">
+									  <a href="<?php echo $paginas[$z]['url']?>"> <?php echo $paginas[$z]['pagina']?></a>								</div>
+							</div>
+							<? 
+							}else{
+							 	$submenu[]=$z;//guardamos los indices
+							}
+							?>								                      
+                        <?php
+					}
+					if(count($submenu)>0){?>
+						<div>
+							<div class="item cerrado" id="admin"><a href="javascript:VerSubMenu()">Administraci&oacute;n</a></div>
+							<div style="display:none" id="submenu">
+							<? for($z=0;$z<sizeof($submenu);$z++){ 
+								$index = $submenu[$z];
+							?>
+								<div class="item subitem">
+									<a href="<?php echo $paginas[$index]['url']?>"> <?php echo $paginas[$index]['pagina']?></a>								</div>	
+							<? }?>
+							</div>
+						</div>
+					    <?
+					}					
+				}?>
+				</div>
+            <? }?>				</td>
+			</tr>
+        </table>
+        <?php
+		}
+	}
+    }
+}
+ ?>
diff -r 82e55d328c8c -r 9881d5db150a class.plantilla.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/class.plantilla.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,136 @@
+<?php 
+
+class Plantilla{
+
+    function PlantillaEncabezado($title){
+
+        $area = new Area($_SESSION['session'][5]); ?>
+
+        <table id="cabecera" cellpadding="0" cellspacing="0" width="100%" style="margin:0px;">
+    		<tr>
+    			<td class="superior"><img src="public_root/imgs/cabecera.jpg" alt="cabecera" border="0" style="margin:0px" width="1000" height="80"/> </td>
+    		</tr>
+    		<tr>
+    			<td class="vertical_line">
+                    <table  cellpadding="0" cellspacing="0" width="100%">
+                    <tr>
+                        <td class="home">  </td>
+                        <td align="left" class="usuario"><?php echo ucwords($_SESSION['session'][1])?></td>
+                        <td align="center" class="titulo"><?php echo $title ?> - <?php echo $area->getNombre()?></td>
+                        <td align="right" class="cerrar_sesion"><a href="#" onclick="javascript:eliminar_sesion()">CERRAR SESION</a></td>
+                    </tr>
+                    </table>
+                </td>
+            </tr>
+    	</table>
+    	<?php
+        }
+
+	function menuSuperior($url, $menu, $id, $escaneo){ ?>
+
+        <table width="100%" id="menuSuperior">
+			<tr>
+				<td width="13%" class="item"><?php if($menu[0]==1){?><a href="<?php echo $url?>?opcion=new"> NUEVO </a><?php }else{?> NUEVO <?php  }?></td>
+				<td width="13%" class="item"><?php if($menu[1]==1){?><a href="<?php echo $url?>?opcion=list"> LISTAR </a><?php }else{?> LISTAR <?php  }?></td>
+				<td width="28%" class="item"> <a href="#" id="clb"> BUSCAR </a> 
+				  <div id="cbusqueda">
+					<form name="f3" method="post" action="?opcion=busqueda" id="form_buscar_superior">
+    					<label>Campo: </label>
+						<select name="campo" class="inpb">
+    						<option value="">--Seleccione un campo--</option>
+							<option value="codigo_documento"> Nro Registro.</option>
+							<option value="nombre_remitente"> Remitente</option>
+							<option value="numero_documento"> Documento</option>
+							<option value="asunto_documento"> Asunto</option>
+						</select>
+						 <br />
+						<label>Buscar: </label> <input type="text" name="valor" class="inpb" />	
+						<input type="submit" name="buscar" value="BUSCAR" />			 
+					</form>
+					</div>
+					</td>
+                <td width="30%" class="item"><a href="#" id="fil"> FILTRAR </a>
+            	  	<div id="cfiltrar">
+                        <form action="<?=$_SESSION['PHP_SELF']?>?opcion=filtrar">
+						<?php
+
+                            $sql_estado =  "SELECT *
+											FROM estados AS e
+										 	WHERE e.display = 1
+        									ORDER BY
+        									e.nombre_estado ASC";
+											
+                            $q_estado=new Consulta($sql_estado);
+
+							?>
+            				<table width="280" border="0">
+                            <tr>
+                                <td width="51"><label>Estado: </label></td>
+                                <td width="219">
+								<select id="ide" name="ide" style="width:200px">
+										<option value="">--Tipo de Estado--</option>
+                              			<?
+				       					while($row_estado=$q_estado->ConsultaVerRegistro()){
+                				           $ide=$row_estado[0];
+                             			?>
+			                              <option value="<?=$row_estado[0]?>">
+			                              <?=$row_estado[1]?>
+            			                  </option>
+                        		      <?  } 
+									  	if($escaneo){
+									   ?>	
+									   <option value="LE">LISTAR NO ESCANEADOS</option>
+									   <? }
+									   ?>
+									   <option value="LT">LISTAR TODOS</option>
+		                            </select>
+								</td>
+                            </tr>
+							<tr>
+								<td colspan="2"></td>
+                            </tr>
+                            <tr>
+                                <td></td>
+                            </tr>
+                            <tr>
+                            	<td>&nbsp;</td>
+                                <td><div align="right">
+                                  <input type="submit" name="filtro" value="FILTRAR" />
+                                </div></td>
+                            </tr>
+						</table>            				                           
+					</form>
+				</div>
+				</td>
+    			<td width="7%" class="item" style="cursor:help"><?php  if($menu[5]==1){?><a href="<?php echo $url?>?opcion=help"> AYUDA </a><?php  }else{?> AYUDA <?php  }?>                </td>
+            </tr>
+        </table>
+	<?php 	
+	}
+
+	function PlantillaIzquierdo(){?>
+
+		<table cellpadding="0" cellspacing="0" width="100%"> 
+			<tr>
+				<td><?php Menu::MenuIzquierdo();?></td>
+			</tr>
+			<tr>
+				<td class="inferior">&nbsp; </td>
+			</tr>	
+		</table><?php
+	}	
+
+function PlantillaPie(){?>
+
+    <table align="center" cellpadding="0"  width="765">
+        <tr>
+            <td align="center" > SERNANP &copy; <?php  echo date('Y'); ?>  </td>
+        </tr>
+    </table>
+  
+    <?php
+}
+
+}
+
+?>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a delete_escaneo.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/delete_escaneo.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,32 @@
+<?php include("includes.php"); 
+	$id = isset($_GET['id']) ? $_GET['id'] : 0; 
+	
+	unlink('../sad/Escaneado_completo/'.$_REQUEST["cod"].'/'.$_REQUEST["nom"]);
+	
+
+/*
+/////////////////////7
+
+
+        $sql_Big="SELECT id_documento,nombre_documento_escaneado  FROM documentos_escaneados    WHERE id_documento_escaneado = '".$id."' ";
+             //   SELECT id_documento,nombre_documento_escaneado  FROM documentos_escaneados    WHERE id_documento_escaneado = '17456'
+   $queryB = new Consulta($sql_Big);
+
+
+$row_reg=$queryB->ConsultaVerRegistro();
+
+$sql2 = " DELETE FROM arch_documentos_escaneados_completos   where id_documento='".$row_reg['0']."' and nombre_documento_escaneado_completo='".$row_reg['1']."' ";
+        //DELETE FROM arch_documentos_escaneados_completos   where id_documento='17676'           and nombre_documento_escaneado_completo='big_17687_.pdf'
+$query = new Consulta($sql2);
+
+
+
+
+        ///////////////////////////////
+*/
+
+
+        $sql = " DELETE FROM documentos_escaneados WHERE id_documento_escaneado = '".$id."' ";
+        $query = new Consulta($sql);
+	echo "Se eliminaron correctamente lo(s) documentos escaneados";	
+?>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a delete_escaneo.php.old
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/delete_escaneo.php.old	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,8 @@
+<?php include("includes.php"); 
+	$id = isset($_GET['id']) ? $_GET['id'] : 0; 
+	
+	unlink('../sad/Escaneado_completo/'.$_REQUEST["cod"].'/'.$_REQUEST["nom"]);
+	$sql = " DELETE FROM documentos_escaneados WHERE id_documento_escaneado = '".$id."' ";
+	$query = new Consulta($sql);
+	echo "Se eliminaron correctamente lo(s) documentos escaneados";	
+?>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a detalle_borrador.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/detalle_borrador.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,124 @@
+<?php	 	
+	include_once("includes.php");
+	include_once("cls/class.documentos.php");
+    include_once("cls/class.borrador.php");
+	include_once("cls/class.documento_finalizado.php");
+	
+	if(!$_SESSION['session'][3] == "SI" ){
+		header("location: error_permisos.php");
+ 	}
+?>
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
+<?php include_once("includes/inc.header.php"); ?>
+<style>
+	input:file{
+		height:21px;
+	}
+	td{
+		vertical-align:middle;
+	}
+</style>
+<title>STD .:. Visualizar Borrador de Respuesta</title>
+</head>
+<body>	
+	<fieldset>
+		<legend>Borrador de Respuesta</legend>
+		<?
+		if($_REQUEST["idb"]){?>
+		<?php
+			$borrador = new Borrador($_REQUEST["idb"]);
+            $usuario = $borrador->getUsuario();
+            $categoria = $borrador->getCategoria();
+            $destino = $borrador->getDestino();
+            $accion = $borrador->getAccion();
+            $descripcion = $borrador->getDescripcion();
+            $doc = new Documento($borrador->getIdDocumento());
+            $finalizado = $doc->ObtenerIdFinalizado();
+			
+			$documento = new DocumentoFinalizado($finalizado);
+			$destinatario = $documento->getDestinatario();							
+			$referencia = $documento->getReferencia();
+			$asunto = $documento->getAsunto();
+		?>
+		<table width="100%" height="360" border="0">
+		<tr>
+			<td width="10%" height="20" class="Estilo22">Origen</td>
+		  <td width="1%" class="Estilo22"><div align="center">:</div></td>
+			<td colspan="2"><?=$usuario->getNombreCompleto()?></td>
+		    <td width="12%" class="Estilo22">Destino</td>
+	      <td width="2%" class="Estilo22"><div align="center">:</div></td>
+		    <td colspan="2"><?=$destino->getNombreCompleto()?></td>
+		    <td width="1%">&nbsp;</td>
+		</tr>		
+		<tr>
+		  <td class="Estilo22" height="19">Asunto</td>
+		  <td height="19" class="Estilo22"><div align="center">:</div></td>
+		  <td colspan="8"><?=$asunto?></td>
+		  </tr>
+	  <? if(count($referencia)>0){
+			for($i = 0; $i < count($referencia); $i++){
+		?>
+		<tr>		
+		  <td class="Estilo22" height="19"><? if($i==0){?>Referencia<? }?></td>
+		  <td height="19" class="Estilo22"><div align="center">:</div></td>
+		  <td colspan="8"><?=$referencia[$i]["descripcion"]?></td>
+		</tr>
+		<?  }
+		}
+		?>
+		<? if(count($destinatario)>0){
+			for($i = 0; $i < count($destinatario); $i++){
+		?>
+		<tr>
+		  <td class="Estilo22" height="19"><? if($i==0){?>Destinatario<? }?></td>
+		  <td height="19" class="Estilo22"><div align="center">:</div></td>
+		  <td><?=$destinatario[$i]["descripcion"]?></td>
+		  <td>&nbsp;</td>
+		  <td class="Estilo22"><? if($i==0){?>Cargo<? }?></td>
+		  <td class="Estilo22"><div align="center">:</div></td>
+		  <td colspan="2"><?=$destinatario[$i]["cargo"]?></td>
+		  <td>&nbsp;</td>
+		</tr>
+		<?  }
+		}
+		?>
+		<tr>
+			<td class="Estilo22" height="19"> Respuesta</td>
+			<td height="19" class="Estilo22"><div align="center">:</div></td>
+			<td colspan="8">&nbsp;</td>
+		</tr>
+		<tr>
+			<td height="183" colspan="10">
+				<div id="borrador_rpa_view" style="border:#74AFCF solid 1px;height:200px; width:570px">
+	             <?=$descripcion?>
+				</div>		  </td>
+		</tr>
+		<tr>
+			<td height="36" colspan="2" align="center" style="vertical-align:middle">
+			<td width="32%">&nbsp;</td>
+			<td width="18%">&nbsp;</td>
+			<td colspan="3">
+				<?
+				if($_SESSION['session'][6]&&$categoria==1){?>					   
+						<form method="post" id="form_finalizar_documento" name="form_finalizar_documento" action="javascript:finalizar_documento(<?=$borrador->getIdDocumento()?>,<?=$borrador->getId()?>)">
+					  <input type="submit" name="finalizar" id = "finalizar" value="Finalizar" class="boton"/>
+					  </form>
+			  <? } ?>			</td>
+			<td width="20%"><div align="right">
+			<input name="cancelar" type="button" class="boton" id="cerrar_b" value="Cerrar" />
+			</div></td>
+			<td>&nbsp;</td>
+		</tr>
+	</table>
+	<? }	
+	else{
+	?>
+	<script>javascript:cerrar_popups</script>
+	<? }
+	?>
+	</fieldset>	
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a detalle_documento.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/detalle_documento.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,188 @@
+<?php	 	
+	include_once("includes.php");
+	require_once("cls/class.documento_reporte.php");
+	if(!$_SESSION['session'][3] == "SI" ){
+		header("location: error_permisos.php");
+ 	}
+?>
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
+<title>STD .:. Impresion Documento Finalizado</title>
+<?php include_once("includes/inc.header.php"); ?>
+<link href="public_root/css/impresion_movimiento.css" media="print" rel="stylesheet">  
+</head>
+<body>
+<?
+    $doc_reporte = new Documento_Reporte($_REQUEST["id"]);
+	$verComentario = false;
+	$comentario = "";
+	
+    if($doc_reporte->getEstado()=="A"){
+        $textRpta = "Fecha de Respuesta";		
+		$verComentario = true;
+		$comentario = $doc_reporte->getComentarioArchivo();
+	}
+    else{
+        $textRpta = "Fecha Estimada de Respuesta";		
+	}
+	   
+?>
+<form id="form_detalle_documento" name="form_detalle_documento" method="post" action="">
+  <fieldset>
+  <legend>DATOS DEL DOCUMENTO</legend>
+  <table border="0" align="center" class="formularios" width="100%">
+    <tr>
+      <td width="15%"  height="21" align="center" class="Estilo22"><div align="left">N&ordm; Registro</div></td>
+      <td width="2%" align="center" class="Estilo22"><div align="center">:</div></td>
+      <td width="53%" align="center"><div align="left">
+        <?=$doc_reporte->getCodigo()?>
+      </div>      </td>
+      <td width="13%" align="center" class="Estilo22"><div align="left" class="Estilo22">Fecha de Registro</div></td>
+      <td width="1%" align="center"><div align="center" class="Estilo22">:</div></td>
+      <td width="16%" align="center"><div align="left">
+        <?=$doc_reporte->getFechaRegistro()?>
+      </div></td>
+    </tr>
+    <tr>
+      <td  height="21" align="center" class="Estilo22"><div align="left">N&ordm; Documento </div></td>
+      <td align="center" class="Estilo22"><div align="center">:</div></td>
+      <td  height="21" align="center"><div align="left">
+        <?=$doc_reporte->getNumero()?>
+      </div>      </td>
+      <td  height="21" align="center"><div align="left" class="Estilo22"><?=$textRpta?></div></td>
+      <td  height="21" align="center"><div align="center" class="Estilo22">:</div></td>
+      <td  height="21" align="center"><div align="left">
+        <?=$doc_reporte->getFechaRespuesta()?>
+      </div></td>
+    </tr>
+    <tr>
+      <td  height="21" align="center"><div align="left" class="Estilo22">Remitente</div></td>
+      <td align="center"><div align="center" class="Estilo22">:</div></td>
+      <td  height="21" colspan="4" align="center"><div align="left">
+        <?=$doc_reporte->getRemitente()?>
+      </div></td>
+    </tr>
+    <tr>
+      <td  height="21" align="center"><div align="left" class="Estilo22">Asunto </div></td>
+      <td align="center"><div align="center" class="Estilo22">:</div></td>
+      <td  height="21" colspan="4" align="center"><div align="left">
+        <?=$doc_reporte->getAsunto()?>
+      </div></td>
+    </tr>
+    <tr>
+      <td  height="21" align="center"><div align="left" class="Estilo22">Doc. Digitalizado </div></td>
+      <td align="center"><div align="center" class="Estilo22">:</div></td>
+      <td  height="21" colspan="4" align="center">
+	  <div align="left">
+        <?
+			$escaneo = "SELECT *
+						from documentos_escaneados de
+						where de.id_documento = ".$doc_reporte->getIdDocumento();
+			$qescaneo = new Consulta($escaneo);
+	  		$index = 1;
+			
+			$doc = new Documento ($doc_reporte->getIdDocumento());
+			
+			while($row_reg = $qescaneo->ConsultaVerRegistro()){
+				if(is_null($row_reg['fecha_escaneo']))
+					$ref = "Escaneo/".$row_reg['nombre_documento_escaneado'];
+				else
+					$ref = "../sad/Escaneado_completo/".$doc->getCodigo()."/".$row_reg['nombre_documento_escaneado'];
+			?>
+			<a href="<?=$ref?>"	id="<?=$row_reg["id_documento_escaneado"]?>" target="_blank"><?=$index?></a>
+			<?
+				$index++;
+			} ?>
+		</div>
+	</td>
+    </tr>
+	<? if($verComentario){?>
+    <tr>
+      <td  height="21" align="center"><div align="left" class="Estilo22">Comentario de Archivo </div></td>
+      <td align="center"><div align="center" class="Estilo22">:</div></td>
+      <td  height="21" colspan="4" align="center"><div align="left">
+        <?=$comentario?>
+      </div>      </td>
+    </tr>
+	<? } ?>
+  </table>
+  <p align="left" id="verDetalles"><a href="javascript:verDetalleDoc()" id = "control" class="v" >Ver Detalles </a></p>
+  <div id="detalle_documento" style="display:none">
+    <table border="0" align="center" bordercolor="#000000" bgcolor="#ffffff" width="100%">
+      <tr>
+        <td width="15%" class="Estilo22"><div align="left" class="Estilo22">Referencia</div></td>
+        <td width="2%"  class="Estilo22"><div align="center" class="Estilo22">:</div></td>
+        <td width="60%"><div align="left">
+          <?=$doc_reporte->getReferencia()?>
+        </div></td>
+        <td width="18%"><div align="left" class="Estilo22">Tipo</div></td>
+        <td width="2%"><div align="center" class="Estilo22">:</div></td>
+        <td><div align="left">
+          <?=$doc_reporte->getTipoDocumento()?>
+        </div></td>
+      </tr>
+      <tr>
+        <td class="Estilo22"><div align="left" class="Estilo22">Anexo</div></td>
+        <td  class="Estilo22"><div align="center" class="Estilo22">:</div></td>
+        <td><div align="left">
+          <?=$doc_reporte->getAnexo()?>
+        </div></td>
+        <td><div align="left" class="Estilo22">Folio</div></td>
+        <td><div align="center" class="Estilo22">:</div></td>
+        <td><div align="left">
+          <?=$doc_reporte->getNumeroFolio()?>
+        </div></td>
+      </tr>
+      <tr>
+        <td class="Estilo22"><div align="left">Observaci&oacute;n de Registro</div></td>
+        <td  class="Estilo22"><div align="center">:</div></td>
+        <td colspan="4"><div align="left"><?=$doc_reporte->getObservacion()?></div></td>
+      </tr>     
+    </table>
+  </div>
+  </fieldset>  
+  <div align="center">
+  	<br/>
+    <table width="98%" border="0"  align="center" cellpadding="0" cellspacing="0" class="formularios" id="movimientos">
+      <tr bgcolor="#6699CC" class="Estilo7">
+        <td width="4%"><div align="center"><span class="msgok1">N&ordm; </span></div></td>
+        <td width="23%"><div align="center"><span class="msgok1">Origen</span></div></td>
+        <td width="23%"><div align="center"><span class="msgok1"> Destino</span></div></td>
+        <td width="15%"><div align="center"><span class="msgok1">Accion</span></div></td>
+        <td width="5%" align="center"><span class="msgok1">Categoria</span></td>
+        <td width="13%" align="center"><span class="msgok1">Fecha Movimiento</span></td>
+        <td align="center"><span class="msgok1">Estado</span></td>
+      </tr>
+      <? 
+	  	 $movimientos = $doc_reporte->getMovimientos();
+		
+		 $tmov = count($movimientos);
+         $cont = 1;
+         for( $h = 0; $h < $tmov; $h++ ){
+      ?>
+      <tr>
+        <td>
+          <div align="center">
+            <?=$h+1?>
+          </div></td>
+        <td><?=$movimientos[$h]["origen"]?></td>
+        <td><?=$movimientos[$h]["destino"]?></td>
+        <td><div align="center">
+          <?=$movimientos[$h]["accion"]?>
+        </div></td>
+        <td align="center" ><?=($movimientos[$h]["categoria"]==1)?"Original":"Copia"?></td>
+        <td align="center" ><?=$movimientos[$h]["fecha"]?></td>
+        <td align="center" ><?=$movimientos[$h]["estado"]?></td>
+      </tr>
+      <? }?>
+    </table>
+	<br/>
+    <p align="right" style="width:98%;">
+      <input name="imprimir" type="submit" class="boton" onclick="javascript:imprimirDocumento()" value="Imprimir" id="imprimir"/>
+    </p>
+  </div>
+</form>
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a devolver_documento_comentario.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/devolver_documento_comentario.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,54 @@
+<?php  
+	include("includes.php");
+?>
+
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head> 
+<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
+<title>STD .:. Devolver Documento</title>
+<?php include_once("includes/inc.header.php"); ?>
+</head>
+<body>
+<?php  
+	if( $_SESSION['session'][3] == "SI" ){  
+?>
+<fieldset>
+	<legend>Devolver Documento</legend>
+	<form id="form2" name="form2" method="post" action="javascript:DevolverCompletado(<?=$_REQUEST['id']?>)">																
+	
+	<br/>
+	<br/>
+	<table width="100%" border="0">
+	<tr>
+		<td width="14%" height="26" class="Estilo22">Descripci&oacute;n</td>
+	  <td width="2%" height="26" class="Estilo22"><div align="center">:</div></td>
+		<td colspan="2">&nbsp;</td>
+	</tr>
+	<tr>
+		<td height="62" colspan="4">			
+			<div align="center">
+				<textarea name="textarea" cols="55" rows="6" id="comentario" class="caja"></textarea>
+			</div>
+		</td>
+	</tr>
+	<tr>
+		<td colspan="2"></td>
+		<td width="68%"><div align="right">
+		  <input name="Submit" type="submit" class="boton" value="Devolver" />
+	    </div></td>
+	    <td width="16%"><div align="right">
+	      <input name="Submit2" type="button" class="boton" value="Cancelar" onclick="cerrar_popups();"/>
+      </div></td>
+	</tr>
+</table>
+<?
+	}else if($_SESSION['session'][3]=="NO") {
+		echo "<div id='error'> CUIDADO: Usted es Usuario del sistema pero no esta Autorizado para ver esta informacin </div><br><br>";		
+	}else{
+		echo " ERROR: Usted esta entrando de manera Incorrecta !!! " ;
+	}	?>
+	</form>
+</fieldset>
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a documento_finalizado.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/documento_finalizado.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,196 @@
+<?php	 	
+	include_once("includes.php");
+	include_once("cls/class.accion.php");
+	include_once("cls/class.usuario.php");
+	include_once("cls/class.documentos.php");
+	include_once("cls/class.plantilla_finalizado.php");
+	
+	if(!$_SESSION['session'][3] == "SI" ){
+		header("location: error_permisos.php");
+ 	}
+?>
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
+<title>STD .:. Impresion Documento Finalizado</title>
+<?php include_once("includes/inc.header.php"); ?>
+<style type="text/css">
+	body, table{
+		color:#000000;
+		font-family:Arial;
+		font-size:13px
+	}
+	table h1{
+		font-weight:bold;
+		font-family:Arial, Helvetica, sans-serif;
+		font-size:15px;
+	}	
+	p{
+		margin: 3px auto 3px auto;
+	}
+	.firma{
+		font-size:11px;
+	}
+</style>
+<link href="public_root/css/impresion.css" media="print" rel="stylesheet">  
+</head>
+<body>
+<?
+if($_REQUEST["id"]){
+	
+	$doc = new Documento($_REQUEST["id"]);
+	$id_fin = $doc->ObtenerIdFinalizado();
+	
+	$codigo = ObtenerCodigoFinalizado($_REQUEST["id"]);
+	
+	$sql_borrador = "SELECT * 
+					FROM borradores_respuesta 
+					where id_documento = '".$_REQUEST["id"]."' and
+					aprobacion_respuesta_borrador=1";
+						
+	$query_borrador = new Consulta($sql_borrador);
+	$row_borrador = $query_borrador->verRegistro();	
+	
+	$sql_des = "SELECT descripcion
+				FROM saludo_despedida
+				WHERE id_saludo_despedida='".$_REQUEST["despedida"]."'";
+					
+	$query_sql_des = new Consulta($sql_des);
+	$row_des = $query_sql_des->verRegistro();			
+	
+	$despedida_doc=$row_des["descripcion"];	
+	
+	$jefe = new Usuario(ObtenerJefe());
+    $nombre = $jefe->getNombreCompleto();
+    $iniciales = $jefe->getIniciales();
+    $cargo_j = $jefe->getCargo();
+    $usuario = new Usuario($_SESSION['session'][0]);
+	
+	$tipo_doc = new TipoDocumento($_REQUEST["tipo"]);
+		
+?>
+		<input type="hidden" name="asunto" id="asunto" value="<?=$_REQUEST["asunto"]?>">
+		<input type="hidden" name="referencia" id="referencia" value="<?=$_REQUEST["referencia"]?>">
+		<input type="hidden" name="tipo" id="tipo" value="<?=$_REQUEST["tipo"]?>">
+		<input type="hidden" name="saludo" id="saludo" value="<?=$_REQUEST["saludo"]?>">
+		<input type="hidden" name="despedida" id="despedida" value="<?=$_REQUEST["despedida"]?>">
+		<input type="hidden" name="remitente" id="remitente" value="<?=$_REQUEST["destinatario"]?>">						
+		<input type="hidden" name="cargo" id="cargo" value="<?=$_REQUEST["cargo"]?>">
+		<input type="hidden" name="id_fin" id="id_fin" value="<?=$id_fin?>">						
+		<input type="hidden" name="codigo_fin" id="codigo_fin" value="<?=$codigo?>">						
+		
+		<script>//javascript:CargarPlantilla();</script>
+				
+		<div id="contenido_documento">
+			<table width="100%" border="0" id="contenedor">
+              <tr>
+                <td width="3%" height="17">&nbsp;</td>
+                <td width="90%">&nbsp;</td>
+                <td width="3%">&nbsp;</td>
+              </tr>
+              <tr>
+                <td colspan="3"><div id="membretado" style="display:none; height:80px;"></div></td>
+              </tr>
+              <tr>
+                <td height="18">&nbsp;</td>
+                <td>
+				  <div id="cabecera_documento">
+                  		<p>Lima, <?=ObtenerFecha()?> </p>
+                  		<h1 style="text-decoration:underline">
+							<strong>
+							<?=$tipo_doc->getNombre()?> 
+							<? if(sizeof($_REQUEST["destinatario"]) > 1){?> MLTIPLE <? }?> SGD  N&ordm;
+							<? if(empty($codigo)){?><span id = "codigo" style="color:#FFFFFF;"> 00000-2009</span><? }else{
+							echo $codigo;}?>-SERNANP-
+       		                </strong>
+       		                <?=ObtenerAbreviaturaArea()?>
+	                	</h1>
+                  		<p>Se&ntilde;or<p/>
+						 <? if(sizeof($_REQUEST["destinatario"])>0){
+						  		for($j=0; $j<sizeof($_REQUEST['destinatario']);$j++){
+						  ?>
+						<p>
+                      		<strong><?=strtoupper($_REQUEST["destinatario"][$j])?></strong><br />
+							<strong><?=strtoupper($_REQUEST["cargo"][$j])?></strong>
+						</p>
+						<? 		}
+							}
+						?>	
+                      	<br/>
+                      	<p><u>Presente</u>.-</p>
+					    <table border="0" cellspacing="0" cellpadding="0" width="468" align="right">
+						  <tr>
+						    <td width="93" valign="top"><p><strong>Asunto</strong></p></td>
+							  <td width="30" valign="top"><div align="center"><strong>:</strong></div></td>
+						    <td width="343" valign="top"><p><?=$_REQUEST["asunto"]?></p></td>
+						  </tr>
+						  
+						  <?
+						  	$reft = sizeof($_REQUEST["referencia"]);
+						  	if($reft>0){
+						  		for($j=0; $j<sizeof($_REQUEST['referencia']);$j++){
+						  ?>
+						  <tr>
+						    <td width="93" valign="top"><p><strong>Referencia <? echo ($reft > 1)?($j+1):""?></strong></p></td>
+						    <td width="30" valign="top"><div align="center"><strong>:</strong></div></td>
+						    <td width="343" valign="top"><p><?=$_REQUEST["referencia"][$j]?></p></td>
+						  </tr>
+						  <? 	}
+						  	}
+						  ?>
+					    </table>
+                  <p></p>
+                </div></td>
+                <td>&nbsp;</td>
+              </tr>
+              <tr>
+			  	<td>&nbsp;</td>
+                <td>
+					<div style="margin-top: 15px;">
+						<?=$row_borrador["descripcion_borrador_respuesta"]?>
+                	</div>				</td>
+                <td>&nbsp;</td>
+              </tr>
+              <tr>
+                <td>&nbsp;</td>
+                <td>
+					<div id="despedida_documento"><?=$despedida_doc?></div>				</td>
+                <td>&nbsp;</td>
+              </tr>
+              <tr>
+			  	<td>&nbsp;</td>
+                <td>
+					<div id="pie_documento">
+						<p align="left">Atentamente,</p>
+						<p>&nbsp;</p>
+						<? if($_REQUEST["tipo"] < 6){?>
+						<div id="inferior" style="width:200px;">
+						<? }?>
+						<p align="center"><strong><?=$nombre?></strong><br />
+						  <span class="firma"><?=$cargo_j?></span><br />
+						  <span class="firma">Servicio  Nacional de &Aacute;reas Naturales </span><br />
+						<span class="firma">Protegidas por el  Estado</span></p>
+						<? if($_REQUEST["tipo"] < 6){?>
+					  </div>
+						<? }?>
+						<p align="left"><?=$iniciales?>/<?=$usuario->getIniciales()?></p>
+                	</div>				</td>
+                <td>&nbsp;</td>
+              </tr>
+              <tr>
+                <td height="32">&nbsp;</td>
+                <td colspan="2">&nbsp;</td>
+              </tr>
+              <tr>
+                <td>&nbsp;</td>
+                <td colspan="2">
+					<div align="right">
+                  		<input type="submit" name="imprimir" id="imprimir" value="Imprimir" class="boton" onclick="javascript:imprimirDocumento()"/>
+                	</div>				</td>
+              </tr>
+            </table>
+		</div>
+<? }?>		
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a editar_borrador_respuesta.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/editar_borrador_respuesta.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,181 @@
+<?php	 	
+	include_once("includes.php");
+	include_once("cls/class.accion.php");
+	include_once("cls/class.usuario.php");
+	include_once("cls/class.documentos.php");
+    include_once("cls/class.borrador.php");
+	include_once("cls/class.documento_finalizado.php");
+	
+	if(!$_SESSION['session'][3] == "SI" ){
+		header("location: error_permisos.php");
+ 	}
+?>
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
+<script type="text/javascript" src="public_root/js/Editor/jscripts/tiny_mce/tiny_mce.js"></script>
+<script type="text/javascript">
+tinyMCE.init({
+	language : 'es',
+	mode : "exact",
+	elements : "rpt_borrador",
+	theme : "advanced",
+	skin : "o2k7",
+
+		plugins : "safari,spellchecker,pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template,imagemanager,filemanager",
+
+	// Theme options
+	theme_advanced_buttons1 : "newdocument,|,bold,italic,underline,strikethrough,|,cut,copy,paste,pastetext,pasteword,|,undo,redo,|,fontselect,fontsizeselect,|,forecolor,backcolor,|,print,|,fullscreen",
+	theme_advanced_buttons2 :"replace,|,justifyleft,justifycenter,justifyright,justifyfull,|,bullist,numlist,|,outdent,indent,|,tablecontrols,|,hr,|,template,pagebreak,|,spellchecker",
+	theme_advanced_buttons3 : "sub,sup,charmap,|,visualchars,template,blockquote",
+	theme_advanced_toolbar_location : "top",
+	theme_advanced_toolbar_align : "left",
+	theme_advanced_statusbar_location : "bottom",
+	spellchecker_languages : "+Espanol=es"
+});
+</script>
+<?php include_once("includes/inc.header.php"); ?>
+<style>
+	input:file{
+		height:21px;
+	}
+	td{
+		vertical-align:middle;
+	}
+
+</style>
+<title>STD .:. Editar Borrador de Respuesta</title>
+</head>
+<body>	
+	<fieldset>
+		<legend>Editar Borrador de Respuesta</legend>
+	<?
+	if($_REQUEST["opcion"]=='editrpta'){
+		$borrador = new Borrador($_REQUEST['idb']);
+		$id_doc = $borrador->getIdDocumento();
+		$doc = new Documento($id_doc);
+		$finalizado = $doc->ObtenerIdFinalizado();
+        $rpta=$borrador->EditarDescripcion($_REQUEST["rpt_borrador"],$finalizado);
+        if($rpta){            
+            echo  "<div id='error'><p>Se modifico la respuesta correctamente</p></div>";
+        }else{
+            echo  "<div id='error'>Hubo un error al procesar su consulta</div>";
+        }
+    ?>
+    <br/>
+    <br/>
+    <input name="cancelar" type="button" class="boton" id="cerrar_b" value="Cerrar" />
+    <?
+	}else{
+		if($_REQUEST["idb"]){?>
+		<?php
+			$borrador = new Borrador($_REQUEST["idb"]);
+            $usuario = $borrador->getUsuario();
+            $categoria = $borrador->getCategoria();
+            $destino = $borrador->getDestino();
+            $accion = $borrador->getAccion();
+            $descripcion = $borrador->getDescripcion();
+            $doc = new Documento($borrador->getIdDocumento());
+            $finalizado = $doc->ObtenerIdFinalizado();
+			
+			$documento = new DocumentoFinalizado($finalizado);
+			$destinatario = $documento->getDestinatario();							
+			$referencia = $documento->getReferencia();
+			$asunto = $documento->getAsunto();
+		?>
+			<form id="form_borrador" name="form_borrador" method="post" action="javascript:validar_edicion_borrador(<?= $_REQUEST["idb"]?>)">				
+
+		<table width="100%" border="0">
+		<tr>
+			<td width="10%" height="20" class="Estilo22">Origen</td>
+			<td width="2%" class="Estilo22"><div align="center">:</div></td>
+			<td width="28%"><?=$usuario->getNombreCompleto()?></td>
+		  <td width="7%" class="Estilo22"><div align="left">Categoria</div></td>
+		  <td width="2%" class="Estilo22"><div align="center">:</div></td>
+			<td colspan="2"><?=($categoria==1)?"Original":"Copia"?></td>
+	      </tr>
+		<tr>
+		  <td height="20" class="Estilo22">Destino</td>
+		  <td class="Estilo22"><div align="center">:</div></td>
+		  <td><?=$destino->getNombreCompleto()?></td>
+		  <td><div align="left" class="Estilo22">Accion</div></td>
+		  <td><div align="center" class="Estilo22">:</div></td>
+		  <td colspan="2"><?=$accion->getNombre()?></td>
+		  </tr>
+		<? if(count($destinatario)>0){
+			for($i = 0; $i < count($destinatario); $i++){
+		?>  
+		<tr>
+		  <td class="Estilo22" height="19"><? if($i==0){?>Destinatario<? }?></td>
+		  <td height="19" class="Estilo22"><div align="center">:</div></td>
+		  <td>		  
+		  <div align="left">
+		    <input name="destinatario[]" type="text" id="destinatario" size="38" value="<?=$destinatario[$i]["descripcion"]?>" class="caja"/>
+		  </div>		  </td>
+		  <td class="Estilo22"><? if($i==0){?><div align="left">Cargo</div><? }?></td>
+		  <td><div align="center" class="Estilo22">:</div></td>
+		  <td colspan="2">
+	        <div align="left">
+	          <input name="cargo[]" type="text" id="cargo" size="43" value="<?=$destinatario[$i]["cargo"]?>" class="caja"/>
+          	</div>		  </td>
+		</tr>
+		<?  }
+		  }
+		?>
+		<tr>
+		  <td class="Estilo22" height="19">Asunto</td>
+		  <td height="19" class="Estilo22"><div align="center">:</div></td>
+		  <td colspan="5"><div align="left">
+		    <input name="asunto" type="text" id="asunto" size="105" value="<?=$asunto?>" class="caja"/>
+		    </div></td>
+		  </tr>
+		<tr>
+		<? if(count($referencia)>0){
+				for($i = 0; $i < count($referencia); $i++){
+			?>
+		  <td class="Estilo22" height="19"><? if($i==0){?>Referencia<? }?></td>
+		  <td height="19" class="Estilo22"><div align="center">:</div></td>
+		  <td colspan="5">		  	
+		  	<div align="left">
+		    	<input name="referencia[]" type="text" id="referencia" size="105" value="<?=$referencia[$i]["descripcion"]?>" class="caja"/>
+		    </div>		  </td>
+		</tr>
+		<?  }
+		}
+		?>
+		<tr>
+			<td class="Estilo22" height="19"> Respuesta</td>
+			<td height="19" class="Estilo22"><div align="center">:</div></td>
+			<td colspan="5">&nbsp;</td>
+		</tr>
+		<tr>
+			<td height="371" colspan="7">
+				<div align="center">
+                    <textarea name="rpt_borrador" cols="120" rows="25" id="rpt_borrador">
+                        <?=$descripcion?>
+                    </textarea>
+				</div>                </td>
+		</tr>
+		<tr>
+			<td height="36" colspan="2" align="center" style="vertical-align:middle">
+		  <td>&nbsp;</td>
+		  <td colspan="3"><div align="right">
+            <input name="aceptar" type="submit" class="boton" id="modificar_b" value="Modificar"/>
+          </div></td>
+		  <td width="23%"><div align="right">
+            <input name="cancelar2" type="button" class="boton" id="cancelar_b" value="Cancelar" />
+          </div></td>
+		</tr>
+	</table>
+	</form>
+	<? }	
+	else{
+	?>
+	<script>javascript:cerrar_popups</script>
+	<? }
+	}
+	?>
+	</fieldset>	
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a elaborar_borrador.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/elaborar_borrador.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,252 @@
+<?php  
+	include_once("includes.php");
+	include_once("cls/class.accion.php");
+    include_once("cls/class.documento_finalizado.php");
+	include_once("cls/class.usuario.php");
+	include_once("cls/class.documentos.php");
+	
+	if(!$_SESSION['session'][3] == "SI" ){
+		header("location: error_permisos.php");
+ 	}		
+?>
+
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
+<script type="text/javascript" src="public_root/js/Editor/jscripts/tiny_mce/tiny_mce.js"></script>
+<script>
+tinyMCE.init({
+	language : 'es',
+	mode : "exact",
+	elements : "rpt_borrador",
+	theme : "advanced",
+	skin : "o2k7",
+	
+		plugins : "safari,spellchecker,pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template,imagemanager,filemanager",
+
+	// Theme options
+	theme_advanced_buttons1 : "newdocument,|,bold,italic,underline,strikethrough,|,cut,copy,paste,pastetext,pasteword,|,undo,redo,|,fontselect,fontsizeselect,|,forecolor,backcolor,|,sub,sup,charmap,|,print,|,fullscreen",
+	theme_advanced_buttons2 :"replace,|,justifyleft,justifycenter,justifyright,justifyfull,|,bullist,numlist,|,outdent,indent,|,tablecontrols,|,hr,|,template,pagebreak,|,spellchecker",
+	theme_advanced_buttons3 : "visualchars,template,blockquote",
+	theme_advanced_toolbar_location : "top",
+	theme_advanced_toolbar_align : "left",
+	theme_advanced_statusbar_location : "bottom",
+	spellchecker_languages : "+Espanol=es"
+});	
+</script>
+<?php include_once("includes/inc.header.php"); ?>
+<style>
+	input:file{
+		height:21px;
+	}
+	td{
+		vertical-align:top;
+		padding-top:3px;
+	}
+</style>
+<title>STD .:. Elaborar Borrador de Respuesta</title>
+</head>
+<body>
+	<fieldset>
+		<legend>Borrador de Respuesta</legend>							
+
+	<?
+	if($_REQUEST["opcion"]=='addha'){
+		$documento = new Documento($_REQUEST['id']);
+        $borr=$documento->addHistorialBorrador();
+        if($borr!=0){
+            Documentos::GuardarArchivo($borr);
+            echo  "<p>Se Elaboro el borrador correctamente</p></div>";
+        }else{
+            echo  "<div id='error'>Hubo un error al procesar su consulta</div>";
+        }
+    ?>
+    <br/>
+    <br/>
+    <input name="cancelar" type="button" class="boton" id="cerrar_b" value="Cerrar" />
+    <?
+	}else{
+		$usuario= new Usuario($_REQUEST["usu"]);
+		$accion= new Accion($_REQUEST["acc"]);
+		$categoria=($_REQUEST["cat"]==1)?"Original":"Copia";
+		
+		if($_REQUEST["id"]){
+			
+			$documento = new Documento($_REQUEST["id"]);
+            $finalizado = $documento->ObtenerIdFinalizado();
+			
+            if($finalizado==0){ //No existe				
+                $remitente = $documento->getRemitente();
+                $dest = $remitente->getNombre();				
+                $ref = $documento->getReferencia();	
+                $asunto = "";
+				$cargo = "";
+            }else{			
+                $cls_finalizado = new DocumentoFinalizado($finalizado);				
+				$destinatario = $cls_finalizado->getDestinatario();							
+				$referencia = $cls_finalizado->getReferencia();
+				$asunto = $cls_finalizado->getAsunto();			
+            }
+			
+		?>
+		
+		<?php  
+			if( $_SESSION['session'][3] == "SI" ){  
+		?>
+			<form id="form_borrador" name="form_borrador" method="post" action="javascript:validar_historial_atencion(<?= $_REQUEST["id"]?>)" enctype="multipart/form-data">			
+				<input type="hidden" id="area" name="area" value="<?php echo $_SESSION['session'][5] ?>" />
+				<input type="hidden" id="user" name="user" value="<?php echo $_SESSION['session'][0] ?>" />			
+				<input type="hidden" id="usuario" name="usuario" value="<?=$usuario->getId()?>" readonly="readonly"/>
+				<input type="hidden" id="categoria" name="categoria" size="30" value="<?=$_REQUEST["cat"]?>"/>
+				<input type="hidden" id="accion" name="accion" value="<?=$accion->getId()?>"/>			
+				<textarea id="comentario" name="comentario" style="display:none"></textarea>			
+
+		<table width="100%" border="0">
+		<tr>
+			<td width="11%" class="Estilo22">Pase a </td>
+	  	  	<td width="3%" class="Estilo22"><div align="center">:</div></td>
+			<td><?=$usuario->getNombreCompleto()?></td>
+		    <td class="Estilo22" width="8%">Categoria</td>
+      	  <td class="Estilo22" width="3%"><div align="center">:</div></td>
+		    <td width="44%" colspan="2"><?=$categoria?></td>
+		</tr>
+		<tr>
+			<td class="Estilo22">Accion</td>
+			<td class="Estilo22"><div align="center">:</div></td>
+			<td colspan="5"><?=$accion->getNombre()?></td>
+		</tr>
+		<tr>
+			<td><span class="Estilo22">Comentario</span></td>
+			<td class="Estilo22" style="vertical-align:top; text-align:center;padding-top:4px;"><div align="center">:</div></td>
+			<td colspan="5"><input name="adicional" type="text" id="adicional" style="width:645px" class="caja"/></td>
+		</tr>
+		<tr>
+			<td class="Estilo22">Asunto</td>
+			<td class="Estilo22"><div align="center">:</div></td>
+			<td colspan="5"><input name="asunto" type="text" id="asunto"  style="width:645px"value="<?=$asunto?>" class="caja"/></td>
+		</tr>
+		<tr>
+			<td class="Estilo22">Referencia</td>
+			<td class="Estilo22"><div align="center">:</div></td>
+			<td colspan="4">
+				<div class="contenedor">
+				<? if(count($referencia)>0){
+					for($i = 0; $i < count($referencia); $i++){
+				?>
+				<div align="left" class="item" id="primero">
+				  <input name="referencia[]" type="text" id="referencia"  style="width:645px" value="<?=$referencia[$i]["descripcion"]?>"/>
+				  <span>
+				  <img src="public_root/imgs/edit_remove.png" onclick="quita_item_borrador(this)" style="margin-top:1px;" border="none"/>
+				  </span>
+				 </div>
+				 <? }?>
+				<? }else{?>
+				<div align="left" class="item" id="primero">
+				  <input name="referencia[]" type="text" id="referencia"  style="width:645px" value="<?=$ref?>" class="caja"/>
+				  <span>
+				  <img src="public_root/imgs/edit_remove.png" onclick="quita_item_borrador(this)" style="margin-top:1px;" border="none"/>
+				  </span>
+				 </div>
+				<? }?> 
+				</div>
+			</td>
+			<td width="5%" style="vertical-align:top;">
+		    	<div align="center">
+					<img src="public_root/imgs/edit_add.png" onclick="agrega_item_borrador(this)" style="margin-top:1px;" border="none"/>				</div>
+			</td>
+		</tr>
+		<tr>
+			<td class="Estilo22">Destinatario</td>
+			<td class="Estilo22"><div align="center">:</div></td>
+			<td colspan="4">				
+				<div class="contenedor">
+				<? if(count($destinatario)>0){
+					for($i = 0; $i < count($destinatario); $i++){
+				?>
+				<table border="0" width="100%" cellspacing="0" cellpadding="0" class="item" id="primero">
+              	<tr>
+                	<td width="48%">
+					<input name="destinatario[]" type="text" id="destinatario" size="54" value="<?=$destinatario[$i]["descripcion"]?>" class="caja"/>
+					</td>
+					<td width="9%" class="Estilo22"> Cargo </td>
+					<td width="3%" class="Estilo22"><div align="center">:</div></td>
+					<td width="40%">
+						<input type="text" name="cargo[]" id="cargo" style="width:241px" value="<?=$destinatario[$i]["cargo"]?>" class="caja"/>
+						<img src="public_root/imgs/edit_remove.png" onclick="quita_item_borrador(this)" style="margin-top:1px;" border="none"/>
+					</td>
+              </tr>
+            </table>			
+				 	<? }?>
+				<? }else{?>
+					<table border="0" width="100%" cellspacing="0" cellpadding="0" class="item" id="primero">
+              		<tr>
+                		<td width="48%">
+							<input name="destinatario[]" type="text" id="destinatario" size="54" value="<?=$dest?>"/>
+						</td>
+						<td width="9%" class="Estilo22"> Cargo </td>
+						<td width="3%" class="Estilo22"><div align="center">:</div></td>
+						<td width="40%">
+							<input type="text" name="cargo[]" id="cargo" style="width:241px" value="<?=$cargo?>" class="caja"/>
+							<img src="public_root/imgs/edit_remove.png" onclick="quita_item_borrador(this)" style="margin-top:1px;" border="none"/>
+						</td>
+              		</tr>
+            		</table>
+				<? }?>
+			</div>
+			</td>
+			<td style="vertical-align:top;">		  	
+				<div align="center"><img src="public_root/imgs/edit_add.png" onclick="agrega_item_borrador(this)" style="margin-top:1px;" border="none"/>			</div></td>
+		</tr>
+		<tr>
+			<td>
+				<label class="Estilo22" >Documento</label>			</td>
+			<td class="Estilo22" style="vertical-align:top;"><div align="center">:</div></td>
+			<td>
+				<div class="contenedor">
+					<div style="float:left" class="item"  id="primero">
+					  <input id="doc[]" type="file" name="doc[]" size="39" /> 
+					  <span><img src="public_root/imgs/edit_remove.png" onclick="quita_item_borrador(this)" style="margin-top:1px;" border="none"/></span>				</div>
+				</div>			</td>
+			<td style="vertical-align:top;">
+		  		<div align="left">
+					<img src="public_root/imgs/edit_add.png" onclick="agrega_item_borrador(this)" style="margin-top:1px;" border="none"/>				</div>			</td>
+			<td colspan="3" class="Estilo21" style="vertical-align:top; padding-top:2px;">
+			<strong>(*) Tama&ntilde;o M&aacute;ximo 2Mb </strong>			</td>
+	      </tr>
+		<tr>
+			<td class="Estilo22"><a href="javascript:mostrar_word()" class="oculto" id="ver_mas">Ver M&aacute;s</a></td>
+			<td class="Estilo22"><div align="center">:</div></td>
+			<td colspan="5"></td>
+		</tr>
+		<tr>
+			<td colspan="8">
+				<div align="center" id="word"></div>			</td>
+		</tr>
+		<tr>
+			<td colspan="7" align="center" style="vertical-align:middle">
+				<div align="right" style="float:left; width:80%">
+				  <input name="aceptar" type="submit" class="boton" id="aceptar_b" value="Aceptar"/>
+				</div>
+				<div align="right">
+				  <input name="cancelar2" type="button" class="boton" id="cancelar_b" value="Cancelar" />
+				</div>			</td>
+		  </tr>
+	</table>
+	</form>
+	<?
+	}else if($_SESSION['session'][3]=="NO") {
+		echo "<div id='error'> CUIDADO: Usted es Usuario del sistema pero no esta Autorizado para ver esta informacin </div><br><br>";		
+			}else{
+				echo " ERROR: Usted esta entrando de manera Incorrecta !!! " ;
+			}	?>
+	<? }
+	else{
+	?>
+	<script>javascript:cerrar_popups</script>
+	<? }
+	}
+	?>
+	</fieldset>
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a elaborar_borrador.php.LCK
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/elaborar_borrador.php.LCK	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,1 @@
+mayra||mayra2589@hotmail.com
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a envio_reportes.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/envio_reportes.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,226 @@
+<?php
+/** Error reporting */
+error_reporting(E_ALL);
+ini_set("memory_limit","256M");
+ini_set('max_execution_time', 3000);
+ini_set('include_path', ini_get('include_path').':libs/');
+ini_set('display_errors',1);
+include("includes.php");
+require 'class.phpmailer.php';
+// load library
+echo  mktime();
+/** PHPExcel */
+include 'PHPExcel.php';
+/** PHPExcel_Writer_Excel5 */
+include 'PHPExcel/Writer/Excel5.php';
+
+
+$sql =  "
+    SELECT 
+        nombre,
+        apellido,
+        email,
+        a.nombre_area as area,
+        a.abve_nombre_area as abr_area
+    FROM (
+        SELECT 
+            u.id_area as id,
+            u.nombre_usuario as nombre,
+            u.apellidos_usuario as apellido,
+            u.email_usuario as email
+        FROM usuarios u 
+        WHERE id_rol = 3 
+        ) as u	
+    INNER JOIN areas a ON a.id_area = u.id              
+";
+					
+$q = new Consulta($sql);
+$users = $q->getRows();
+// mailer
+ob_start();
+$fecha = date("d-m-Y");
+require 'Templates/mail/reporte.php'; 
+$content = ob_get_contents();
+ob_end_clean();
+#dump($users); exit;
+
+# Create a excel file!
+
+
+
+$mail = new PHPMailer();
+
+$mail->WordWrap = 50;
+$mail->IsSMTP();
+$mail->Host = "10.10.11.5";
+$mail->SetFrom('webmaster@sernanp.gob.pe', 'Webmaster SERNANP');
+# Loop the user to sent a email;
+
+foreach($users as $k=>$user){
+    # SQL to the report
+    $sql = "
+        SELECT
+            dr.id_documento_reporte AS id,
+            dr.numero_registro AS registro,
+            dr.numero_documento AS documento,
+            dr.remitente AS remitente,
+            DATE_FORMAT( dr.fecha_registro , '%d-%m-%Y ' ) AS fecha,
+			dr.ubicacion AS ubicacion, 
+            IF( p.tiempo_horas_respuesta_prioridad, 
+                DATE_FORMAT( ADDDATE(dr.fecha_registro, 
+                    p.tiempo_horas_respuesta_prioridad/24  ) , '%d-%m-%Y ' )
+                , '-')  AS fecha_r,
+            dr.estado,
+            dr.asunto AS asunto,
+            dr.prioridad,
+            IF( p.tiempo_horas_respuesta_prioridad, (
+                    DATEDIFF( 
+                        ADDDATE(dr.fecha_registro, 
+                          p.tiempo_horas_respuesta_prioridad/24  ),
+                        CURDATE() 
+                          ) 
+                      ) , 0) AS dias_faltantes  
+		FROM
+            documentos_reporte AS dr
+        LEFT JOIN 
+            prioridades as p ON p.nombre_prioridad = dr.prioridad
+		WHERE 
+            dr.ubicacion like '$user->abr_area%'
+            AND dr.estado not like 'A'
+        ORDER BY
+            dias_faltantes DESC
+    ";
+    
+    $q = new Consulta($sql);
+    $docs = $q->getRows();
+    
+    
+    if( count($docs) > 0) {
+    
+        // Create new PHPExcel object
+        echo date('H:i:s') . " Create new PHPExcel object - <b>$user->nombre</b>\n<br />";
+        $objPHPExcel = new PHPExcel();
+
+        // Set properties
+        echo date('H:i:s') . " Set properties\n<br />";
+        $objPHPExcel->getProperties()->setCreator("Enrique Juan de Dios");
+        $objPHPExcel->getProperties()->setLastModifiedBy("Enrique Juan de Dios");
+        $objPHPExcel->getProperties()->setTitle ("Reporte de".date("d-m-Y")." - Area" ) ;
+        $objPHPExcel->getProperties()->setSubject("Reporte de".date("d-m-Y"));
+        $objPHPExcel->getProperties()->setDescription("Reporte de".date("d-m-Y")." - Area");
+        
+        $boldFont = array(
+            'borders' => array(
+                'outline' => array(
+                    'style' => PHPExcel_Style_Border::BORDER_THIN,
+                    'color' => array('argb' => 'FF000000'),
+                ),
+            ),
+            'font'=>array(
+                'bold'=>true
+            )
+        );
+        
+
+        // Add some data
+        echo date('H:i:s') . " Add some data\n<br />";
+        $objPHPExcel->setActiveSheetIndex(0);
+        $aSheet = $objPHPExcel->getActiveSheet();
+        $aSheet->SetCellValue("A1", "N. Registro" );
+        $aSheet->SetCellValue("B1", "Remitente" );
+        $aSheet->SetCellValue("C1", "Documento" );
+        $aSheet->SetCellValue("D1", "Registrado");
+        $aSheet->SetCellValue("E1", "Resp. Aprox" );
+        $aSheet->SetCellValue("F1", "Estado" );
+        $aSheet->SetCellValue("G1", "Ubicacion" );
+        $aSheet->SetCellValue("H1", "Dias" );
+        $aSheet->getStyle('A1:H1')->applyFromArray($boldFont);
+        
+        foreach( $docs as $i=>$doc ){
+            $c=$i+2;
+            $aSheet->SetCellValue("A$c", $doc->registro );
+            $aSheet->SetCellValue("B$c", $doc->remitente );
+        /* 
+          */  
+            $aSheet->SetCellValue("C$c", $doc->documento );
+            $aSheet->SetCellValue("D$c", $doc->fecha);
+            $aSheet->SetCellValue("E$c", $doc->fecha_r );
+            $aSheet->SetCellValue("F$c", $doc->estado );
+            $aSheet->SetCellValue("G$c", $doc->ubicacion );
+            $aSheet->SetCellValue("H$c", $doc->dias_faltantes );
+        }
+        $aSheet->getStyle("A2:H$c")->getFont()->setSize(9);
+        
+        $aSheet->getColumnDimension('A')->setWidth (20);
+        $aSheet->getColumnDimension('B')->setWidth (50);
+        $aSheet->getColumnDimension('C')->setWidth (40);
+        $aSheet->getColumnDimension('D')->setWidth (12);
+        $aSheet->getColumnDimension('E')->setWidth (12);
+        $aSheet->getColumnDimension('F')->setWidth (10);
+        $aSheet->getColumnDimension('G')->setWidth (10);
+        $aSheet->getColumnDimension('H')->setWidth (6);
+
+        //-----Put in a Title-----
+        $aSheet->insertNewRowBefore(1, 2);//Some empty rows for space 
+        $aSheet->insertNewRowBefore(1, 2);//Some empty rows for space 
+        $aSheet->insertNewRowBefore(1, 2);//Some empty rows for space 
+        $aSheet->setCellValue('A4', $user->area );
+        $aSheet->setCellValue('A5', 'Reporte de Atencin de documentos'.date("d-m-Y")." $user->abr_area" );
+        $aSheet->getStyle('A4')->getFont()->getColor()->setARGB(PHPExcel_Style_Color::COLOR_DARKYELLOW);
+        $aSheet->getStyle('A4')->getFont()->setSize(16); 
+        $aSheet->getStyle('A5')->getFont()->setSize(12); 
+        
+        // Add a drawing to the worksheet
+        echo date('H:i:s') . " Add a drawing to the worksheet\n<br/>";
+        $objDrawing = new PHPExcel_Worksheet_Drawing();
+        $objDrawing->setName('Logo');
+        $objDrawing->setDescription('Logo');
+        $objDrawing->setPath('./public_root/imgs/logo-oficial.jpg');
+        $objDrawing->setHeight(46);
+        $objDrawing->setCoordinates('A1');
+        $objDrawing->setResizeProportional(false);
+        $objDrawing->setWorksheet( $aSheet );
+        
+        // Rename sheet
+        echo date('H:i:s') . " Rename sheet\n<br />";
+        $aSheet->setTitle("Area $user->abr_area"); 
+
+                
+        // Save Excel 2000 file
+        echo date('H:i:s') . " Write to Excel5 format\n<br />";
+        $objWriter = new PHPExcel_Writer_Excel5($objPHPExcel);
+        $objWriter->save("temp/reporte$k.xls");
+
+        /**************End save*****************/
+
+        
+
+        /*
+    */
+        #$xls->generateAndSaveXML($_SERVER['DOCUMENT_ROOT'] . '/temp/', 'my-test.xls');
+        $mail->Subject = $user->abr_area.": Reporte de Atencion de Documentos:".date('d-m-Y');
+        $mail->Body = $content;
+        #echo $user->email;
+        $mail->AddAddress('juandedioz@gmail.com');
+        $mail->AddAddress('jcondori@sernanp.gob.pe');
+        $mail->AddAddress('ycoyla@sernanp.gob.pe');
+        #$mail->AddAddress($user->email);
+        $mail->IsHTML(true);
+        $mail->AddAttachment("./temp/reporte$k.xls","reporte-$user->abr_area.xls");
+        if(!$mail->Send()){
+           echo 'Message was not sent.';
+           echo 'Mailer error: ' . $mail->ErrorInfo;
+        }else{
+           echo 'Message has been sent.<br /><br />';
+        }
+        $mail->ClearAddresses();
+        $mail->ClearAttachments();
+        # Delete created File
+        @unlink("/temp/reporte$k.xls");
+    }
+    sleep(1);
+}
+
+
+?>
+  
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a error_permisos.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/error_permisos.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,57 @@
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
+<link href="public_root/css/admin.css" type="text/css" rel="stylesheet" />
+<link href="public_root/css/start/ui.all.css" rel="stylesheet">
+<style>
+	html,body{
+		height:100%;
+	}
+	#contenido{
+		width:100%;
+		height:100%;
+	}
+	#contenido div{
+		width:30%;
+		padding:10px;
+		position:absolute; 
+		top:35%; 
+		left:35%; 
+	}
+	
+	#contenido p{
+		margin : 3px;
+	}
+	
+	#contenido a{
+		text-decoration:none;
+	}
+	
+</style>
+</head>
+<body>
+<div id="contenido">
+<div class='ui-state-error ui-corner-all' align='center'>
+<table width="100%" border="0">
+  <tr>
+    <td style="vertical-align:middle"><img src="public_root/imgs/warning_1.png"/></td>
+    <td style="vertical-align:middle">
+	  <p>
+	    <?
+		if($_SESSION['session'][3]=="NO") {?>
+	    <strong>CUIDADO : </strong> Usted es Usuario del sistema pero no esta Autorizado para ver esta informacion	
+	    <?
+		}else{?>	
+	    <strong>ALERTA </strong>Su tiempo de sesion ha expirado </p>
+	  <p style="margin-left:100px;">&nbsp;o </p>
+	  <p> Usted esta entrando de manera Incorrecta</p>
+			<?
+		}
+	?>	</td>
+  </tr>
+</table>
+<br><a href='index.php'><strong>Regresar</strong></a></div>
+</div>
+</body>
+
diff -r 82e55d328c8c -r 9881d5db150a escaneo_acceso_registro.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/escaneo_acceso_registro.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,100 @@
+<?php
+
+include("includes.php");
+require_once("cls/class.documentos.php");
+require_once("cls/class.escaneos.php");
+
+	if(!$_SESSION['session'][3] == "SI" ){?>
+		<script>location.href="error_permisos.php";</script>
+ 	<?
+	}
+
+$escaneo = true;
+$usuario = new Usuario($_SESSION['session'][0]);
+$menu = array(0,1,1,0,0,0); 
+set_time_limit(300);
+?>
+
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+    <?php include("includes/inc.header.php"); ?>
+	<script src="public_root/js/jquery.blockUI.js" type="text/javascript"></script>
+	<script type="text/javascript" src="public_root/js/leyendas/cargar_estados.js"></script>
+<title>Administraci&oacute;n</title>
+</head>
+<body>
+    <span id="toolTipBox" width="200"></span>
+	<table  id="principal"  align="left" cellpadding="0" cellspacing="0" width="100%" style="margin:0px; vertical-align:top">
+        <tr>
+    		<td colspan="2" align="left"><?php Plantilla::PlantillaEncabezado("ESCANEO DE DOCUMENTOS")?></td>
+    	</tr>
+		<tr>
+			<td class="menu"><?php Plantilla::PlantillaIzquierdo();?></td>	
+			<td>
+				<table  class="contenido" cellpadding="0" cellspacing="0" width="100%" align="left">	
+					<tr>
+						<td><?php  Plantilla::menuSuperior("areas_acceso_registro.php",$menu,$_GET['id'],false);?></td>
+					</tr>									
+													
+					<tr>								
+						<td style="width:100%; height:417px">
+				<?php 
+					$escaneos = new Escaneos();
+					$campo=$_REQUEST['campo'];
+					$valor=$_REQUEST['valor'];
+					switch($_GET['opcion']){
+
+                        case 'add':
+							$escaneos->EscaneaGuardar();
+							$escaneos->EscaneaEditar($_GET['id']);															
+						break;	
+
+						case 'edit':																			
+							$escaneos->EscaneaEditar($_GET['id']);	
+						break;								
+
+						case 'detalle':		
+							$documento = new Documento($_GET['id']);																	
+							$docs->detalleDocumentosPorUsuario($usuario, $documento);	
+						break;
+
+						case 'addha':
+							$documento = new Documento($_GET['id']);
+							$documento->addHistorialAtencion();	?> 
+							<script type="text/javascript"> 
+								location.replace("atencion_acceso_registro.php?opcion=detalle&id=<?php echo $_GET['id']?>");
+							</script><?php 	
+						break;
+
+						case 'list':											
+							Escaneos::EscaneaListado($_GET['ide']);				
+						break;
+
+						case 'activar':	
+							$documento = new Documento($_GET['id']);												
+							$documento->ActivarDocumento($usuario);	
+							$docs->listarDocumentosPorUsuario($usuario);		
+						break;
+
+						case 'busqueda';
+							Escaneos::Busqueda($campo, $valor);
+							break;	
+
+						default:											
+							Escaneos::EscaneaListado($_GET['ide']);											
+
+						break;
+					}
+					?>							
+					</td>					
+				</tr>			
+			</table>
+		</td>		
+	</tr>
+	<tr>
+		<td colspan="2" class="pie"><?php Plantilla::PlantillaPie();?>	</td>
+	</tr>	
+</table>	
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a ft2.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/ft2.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,3 @@
+<?php 
+echo phpinfo();
+?>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a includes.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/includes.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,29 @@
+<?php
+require_once("libs/lib.php");
+require_once("cls/conexion.cls.php");
+require_once("cls/conexion_selpo.cls.php");
+require_once("cls/consulta.cls.php");
+require_once("cls/class.sesion.php");
+require_once("cls/class.acceso.php");
+require_once("cls/class.usuarios.php");
+require_once("cls/class.plantilla.php");
+require_once("cls/class.menu.php");
+require_once('cls/class.usuario.php');
+require_once('cls/class.area.php');
+require_once('cls/class.rol.php');
+require_once('cls/class.accion.php');
+require_once('cls/class.acciones.php');
+require_once('cls/class.anp.php');
+require_once('cls/class.documento.php');
+require_once('cls/class.estado.php');
+require_once('cls/class.prioridad.php');
+require_once('cls/class.remitente.php');
+require_once('cls/class.tipo_documento.php');
+
+session_start();
+
+$link_selpo=new Conexion("areaspro_dbsiganp1");
+$link=new Conexion("sernanp");
+
+
+?>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a index.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/index.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,60 @@
+<?php 
+
+include("includes.php"); 
+/*
+//Yonny
+//Agregado 04/02/2010
+if(!$_SESSION['session'] && !isset($_GET["error"])){
+    if(!isset($_REQUEST["access"]) || $_REQUEST["access"]!=md5("20AcCeSso10")){
+        Header("Location: ../sistemas/index.php");
+    }
+}
+//---
+*/
+?>
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+
+<!--Yonny -->
+<!--Agregado 04/02/2010 
+<base href="http://intranet.sernanp.gob.pe/std/" />
+// -->
+
+<?php include("includes/inc.header.php"); ?>
+<title>Administraci&oacute;n</title>
+</head>
+<body>
+<table  id="principal"  align="left" cellpadding="0" cellspacing="0" width="100%" style="margin:0px; vertical-align:top">
+	<tr>		
+		<td align="left" colspan="2"> <?php Plantilla::PlantillaEncabezado("ACCESO AL SISTEMA");?> </td>		
+	</tr>
+	<tr>
+		<td class="menu"><?php Plantilla::PlantillaIzquierdo();?></td>	
+		<td>
+			<table  class="contenido" cellpadding="0" cellspacing="0" width="100%" align="left">									
+				<tr>								
+					<td style="width:100%; height:417px">								
+					  <p>
+					    <?php 
+					if($_GET['opcion'] == 'recuperar'){
+						include("recuperar_acceso.php");
+					}else if($_SESSION['session']){
+						include("inicio.php");
+						
+				
+					}else(
+						include("acceso.php")
+					) ?></p>
+				      
+			        </td>					
+				</tr>			
+			</table>
+		</td>		
+	</tr>
+	<tr>
+		<td colspan="2" class="pie"><?php Plantilla::PlantillaPie();?>	</td>
+	</tr>	
+</table>	
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a inicio.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/inicio.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,21 @@
+  <?php 	
+    require_once 'cls/Big_Consultador.cls.php';  
+	$usuario = new Usuario($_SESSION['session'][0]);
+	$docs = new Documentos();
+  ?>
+
+
+<table id="contenido" height="100%" width="100%" align="center"  >
+	<tr>
+	  <td align="center" valign="top" width="50%">   </td>	  	
+	<td width="50%"></td>		
+	</tr>		
+	<tr>
+		<td width="50%" align="center">	</td>
+		<td width="50%"></td>
+	</tr>	
+	<tr>
+		<td align="center"></td><td align="center"></td>
+	</tr>	
+	<tr>	
+</table>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a mail.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/mail.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,57 @@
+<?
+require("includes.php");
+require("cls/index.cls.php");
+///////////
+if(empty($_SESSION[acc])&&empty($_POST)) require("error_s.php");
+/////////
+$link= new Conexion();
+?>
+
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
+
+<html>
+<head>
+	<title>Envo de mails con PHP</title>
+</head>
+
+<body>
+
+<?
+$destinatario = "ecrsoluciones@gmail.com";
+$asunto = "Este mensaje es de prueba";
+$cuerpo = '
+<html>
+<head>
+ <title>Prueba de correo</title>
+</head>
+<body>
+<h1>Hola amigos!</h1>
+<p>
+<b>Bienvenidos a mi correo electrnico de prueba</b>. Estoy encantado de tener tantos lectores.
+</p>
+</body>
+</html>
+';
+
+//para el envo en formato HTML
+$headers  = "MIME-Version: 1.0\r\n";
+$headers .= "Content-type: text/html; charset=iso-8859-1\r\n";
+
+//direccin del remitente
+$headers .= "From: Miguel Angel Alvarez <danicks1020@hotmail.com>\r\n";
+
+//direccin de respuesta, si queremos que sea distinta que la del remitente
+$headers .= "Reply-To: maria@desarrolloweb.com\r\n";
+
+//direcciones que recibin copia
+$headers .= "Cc: danicks1020@hotmail.com\r\n";
+
+//direcciones que recibirn copia oculta
+$headers .= "Bcc: ecrsoluciones@gmail.com\r\n";
+
+mail($destinatario,$asunto,$cuerpo,$headers)
+?>
+
+</body>
+</html>
+
diff -r 82e55d328c8c -r 9881d5db150a mesa_acceso_registro.cls.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/mesa_acceso_registro.cls.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,918 @@
+<?
+
+class Registro {
+
+function Busqueda($campo, $valor){	
+
+	if($campo == "nombre_remitente"){
+		$where = $campo == "nombre_remitente" ? " AND r.nombre_remitente like '%$valor%' " : "";
+	}else{
+		$where = $campo != "" ? " AND d.$campo like '%$valor%' " : ""  ;
+	}
+
+	$sql_reg = "SELECT *
+				FROM
+				documentos AS d
+				Inner Join remitentes AS r ON r.id_remitente = d.id_remitente
+				Inner Join estados AS e ON e.id_estado = d.id_estado
+				".$where."
+				ORDER BY d.id_documento DESC";
+			
+	$query_reg=new Consulta($sql_reg);		
+	?>
+<div class="ui-jqgrid ui-widget ui-widget-content ui-corner-all">	
+	<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" id="tabla_despacho" class="gview_frmgrid">
+	<tr>
+	  <td>
+			<table width="100%" class="ui-jqgrid-htable" cellpadding="0" cellspacing="0">
+				<tr bgcolor="#6699CC" class="ui-widget-header ui-th-column grid_resize" height="25">
+					<th width="16%" class="ui-widget-header ui-th-column grid_resize">Reg. Nro</th>
+					<th width="27%" class="ui-widget-header ui-th-column grid_resize">Remitente</th>
+					<th width="28%" class="ui-widget-header ui-th-column grid_resize">Documento</th>
+					<th width="13%" class="ui-widget-header ui-th-column grid_resize">Registrado</th>
+					<th width="6%" class="ui-widget-header ui-th-column grid_resize">Estado</th>
+					<th class="ui-widget-header ui-th-column grid_resize">Ubicacion</th>
+				</tr>			
+			</table>
+		    </td>
+	</tr>
+	<tr class="ui-jqgrid-bdiv">
+		<td>
+			<table id="frmgrid" width="100%" class="ui-jqgrid-btable" cellpadding="0" cellspacing="0">		
+			<?	
+			while($row_reg=$query_reg->ConsultaVerRegistro()){
+				$ids=$row_reg[0];
+				$estado = $row_reg["id_estado"];
+				$tooltip_asunto = "";
+				if(!empty($row_reg['asunto_documento']))
+					$tooltip_asunto="title ='".$row_reg['asunto_documento']."' class='tip'";
+			?>
+	
+    <tr class="ui-widget-content1 jqgrow <? echo ($estado==12)?"Estilo7 fila_finalizada":"Estilo7";?>">
+      <td width="16%" <?=$tooltip_asunto?>>
+			<div align="center">
+      		<?php
+				$cod = $row_reg["codigo_documento"];
+           
+				if($estado != 12&&$estado != 11){ ?>
+				<a href="mesa_acceso_registro.php?opcion=despachar&ids=<?=$ids?>">
+                <?=$cod?></a>				
+              <? }
+				else{
+					echo $cod;
+           		}
+				?>
+          </div>	  </td>
+		<td width="27%"><input size="48" value="<?=$row_reg[nombre_remitente]?>"/></td>
+		<td width="28%"><input size="43" value="<?=$row_reg[numero_documento]?>"/></td>
+		<td width="13%">
+			<div align="center">
+			  <input name="text2" type="text" style="text-align:center;width:100%;" value="<?=date('d/m/Y H:i',strtotime($row_reg['fecha_registro_documento']))?>"/>
+			</div>		</td>
+		<td align="center" width="6%">
+		<div align="center">
+		  <input name="text3" type="text" style="text-align:center; width:100%" value="<?=$row_reg['abrev_nombre_estado']?>"/>
+		</div>		</td>
+
+		<?php
+			$sql_ultimo="SELECT Max(`hd`.`id_historial_documento`) AS `ultimo`
+						FROM
+						`historial_documentos` AS `hd`
+						where hd.id_documento='".$row_reg['id_documento']."'
+						GROUP BY
+						`hd`.`id_historial_documento`";
+						
+			$query_ultimo=new Consulta($sql_ultimo);		
+			$ultimo=$query_ultimo->ConsultaVerRegistro();
+
+			$sql_data = "SELECT hd.id_documento,
+						a.nombre_area, 
+						a.abve_nombre_area 
+						FROM 
+						historial_documentos AS hd 
+						Inner Join areas AS a ON a.id_area = hd.id_area 
+						where hd.id_historial_documento='".$ultimo['ultimo']."'";
+						
+			$query_data=new Consulta($sql_data);		
+			$data=$query_data->ConsultaVerRegistro();
+		
+			$sql_usu = "SELECT 
+						Max(`ha`.`id_historial_atencion`) AS `ultimo`, 
+						`ha`.`id_documento` 
+						FROM
+						`historial_atencion` AS `ha`
+						WHERE
+						ha.original_historial_atencion =  '1' and 
+						ha.id_documento='".$row_reg['id_documento']."' 
+						GROUP BY 
+						`ha`.`id_historial_atencion`";
+						
+			$query_usu=new Consulta($sql_usu);		
+			$usu=$query_usu->ConsultaVerRegistro();
+
+			$susu = "SELECT `u`.`login_usuario`, 
+					`a`.`abve_nombre_area` 
+					FROM 
+					`historial_atencion` AS `ha`
+					Inner Join `usuarios` AS `u` 
+					ON `u`.`id_usuario` = `ha`.`id_usuario_destino` 
+					Inner Join `areas` AS `a` ON `a`.`id_area` = `u`.`id_area`
+					WHERE
+					`ha`.`id_historial_atencion` = '".$usu['ultimo']."' ";
+
+			$qusu=new Consulta($susu);		
+			$u=$qusu->ConsultaVerRegistro();
+	?>
+		<td>
+		  <div align="center">
+		    <?
+            	$documento = new Documento($row_reg['id_documento']);
+        	?>
+            <input name="text4" type="text" value="<?=$documento->UltimaUbicacionReporte()?>" />
+		  </div>
+		</td>
+	</tr>
+	<? }?>
+	</table>
+	</td>
+	</tr>
+</table>
+</div>
+<? }
+
+function RegistraListado($ide){	 
+	
+	if ($ide==''){
+	
+		$sql_reg = "SELECT
+					d.id_documento,
+					d.codigo_documento,
+					r.nombre_remitente,
+					d.numero_documento,
+					e.nombre_estado,
+					e.abrev_nombre_estado,
+					d.fecha_registro_documento,
+					d.id_estado,
+					d.asunto_documento
+					FROM
+					documentos AS d
+					LEFT Join remitentes AS r ON r.id_remitente = d.id_remitente
+					LEFT Join estados AS e ON e.id_estado = d.id_estado
+					LEFT Join usuarios u ON d.id_usuario = u.id_usuario
+					WHERE
+					(d.id_estado =  1 OR
+					d.id_estado =  5)
+					AND u.id_anp = ".$_SESSION['session'][7]."
+					ORDER BY
+					d.id_documento DESC";
+	
+		$query_reg=new Consulta($sql_reg);			
+		
+	}
+	else { 
+		
+		$where = ($ide=="LT")?"":"d.id_estado =$ide AND";
+		
+		$sql_reg = "SELECT
+					d.id_documento,	
+					d.codigo_documento,
+					r.nombre_remitente,
+					d.numero_documento,
+					e.nombre_estado,
+					e.abrev_nombre_estado,
+					d.fecha_registro_documento,
+					d.id_estado,
+					d.asunto_documento
+					FROM
+					documentos AS d
+					LEFT Join remitentes AS r ON r.id_remitente = d.id_remitente
+					LEFT Join usuarios u ON d.id_usuario = u.id_usuario
+					Inner Join estados AS e ON e.id_estado = d.id_estado 
+					WHERE
+					$where
+					u.id_anp = ".$_SESSION['session'][7]."
+					ORDER BY
+					d.id_documento DESC";
+		
+		$query_reg=new Consulta($sql_reg);		
+		
+		}
+	?>
+	
+<div class="ui-jqgrid ui-widget ui-widget-content ui-corner-all">	
+	<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" id="tabla_despacho" class="gview_frmgrid">
+	<tr>
+	  <td>
+			<table width="100%" class="ui-jqgrid-htable" cellpadding="0" cellspacing="0">
+				<tr bgcolor="#6699CC" class="ui-widget-header ui-th-column grid_resize" height="25">
+					<th width="16%" class="ui-widget-header ui-th-column grid_resize">Reg. Nro</th>
+					<th width="27%" class="ui-widget-header ui-th-column grid_resize">Remitente</th>
+					<th width="28%" class="ui-widget-header ui-th-column grid_resize">Documento</th>
+					<th width="13%" class="ui-widget-header ui-th-column grid_resize">Registrado</th>
+					<th width="6%" class="ui-widget-header ui-th-column grid_resize">Estado</th>
+					<th class="ui-widget-header ui-th-column grid_resize">Ubicacion</th>
+				</tr>			
+			</table>
+		    </td>
+	</tr>
+	<tr class="ui-jqgrid-bdiv">
+		<td>
+			<table id="frmgrid" width="100%" class="ui-jqgrid-btable" cellpadding="0" cellspacing="0">		
+		<? 
+		while($row_reg=$query_reg->ConsultaVerRegistro()){
+			$ids=$row_reg['id_documento'];
+			$_POST[remi]=$row_reg['nombre_remitente'];
+			$estado = $row_reg['id_estado'];
+            $descripcion_dev="";
+			$clase = "Estilo7";
+						
+			if($estado==12){
+				$clase = "Estilo7 fila_finalizada";
+			}else{
+				$dias = resta_fechas(date("d/m/Y"),date('d/m/Y',strtotime($row_reg['fecha_registro_documento'])));
+				if($dias > 0)
+					$clase = "Estilo7 fila_peligro";
+				else	
+					$clase = "Estilo7 fila_baja";
+			}
+
+            if($estado==5){
+                $sql_dev = "SELECT
+                            v.descripcion,
+                            v.id_devuelto
+                            FROM
+                            devuelto AS v
+                            Inner Join documentos AS d ON v.id_documento = d.id_documento
+                            WHERE
+                            d.id_documento =  '$ids'
+                            ORDER BY
+                            v.id_devuelto DESC
+                            LIMIT 0, 1";
+
+                $query_dev = new Consulta($sql_dev);
+                $row_dev = $query_dev->VerRegistro();
+                $descripcion_dev=$row_dev['descripcion'];
+            }
+			
+			$tooltip_asunto = "";
+			if(!empty($row_reg['asunto_documento']))
+				$tooltip_asunto="title ='".$row_reg['asunto_documento']."' class='tip'";
+		
+		?>
+	<tr class="ui-widget-content1 jqgrow <?=$clase?>">
+    	<td <?=$tooltip_asunto?> width="16%">
+		<div align="center">
+      <?php
+
+           $cod = $row_reg["codigo_documento"];
+           if($estado != 12&&$estado != 11){ ?>
+              <a href="mesa_acceso_registro.php?opcion=despachar&ids=<?=$ids?>">
+				<?=$cod?>
+              </a>
+              <? }
+			else{
+              echo $cod;
+			}
+            ?>
+			</div>    	</td>
+		<td width="27%"><input size="40" value="<?=$row_reg[nombre_remitente]?>"/></td>
+    	<td width="28%"><input size="47" value="<?=$row_reg[numero_documento]?>"/></td>
+    	<td width="13%">		
+			<div align="center">
+				<input type="text" value="<?=date('d/m/Y H:i',strtotime($row_reg['fecha_registro_documento']))?>" style="text-align:center;width:100%;"/>				
+			</div>		</td>
+    	<td align="center" <? if(!empty($descripcion_dev)){echo "title ='".$descripcion_dev."' class='tip'";}?> width="6%"><input name="text" type="text" style="text-align:center; width:100%" value="<?=$row_reg['abrev_nombre_estado']?>"/></td>
+      	<td>	  
+        <?
+            $documento = new Documento($row_reg['id_documento']);
+        ?>
+		<input type="text" value="<?=$documento->UltimaUbicacionReporte()?>" />     </td>
+    </tr>
+	<? }?>
+	</table>
+	</td>
+	</tr>
+</table>
+</div>
+
+<? }
+
+function ConsultarDocumento($ids){
+
+	$sql_resumen="SELECT
+				documentos.id_documento,
+				documentos.codigo_documento,
+				remitentes.nombre_remitente,
+				tipos_documento.nombre_tipo_documento,
+				documentos.numero_documento,
+				documentos.referencia_documento,
+				documentos.anexo_documento,
+				documentos.numero_folio_documento,
+				documentos.fecha_documento,
+				documentos.fecha_registro_documento
+				FROM
+				documentos
+				LEFT Join remitentes ON remitentes.id_remitente = documentos.id_remitente
+				Inner Join tipos_documento ON tipos_documento.id_tipo_documento = documentos.id_tipo_documento
+				WHERE
+				documentos.id_documento = '".$ids."'";
+
+	$query_resumen=new Consulta($sql_resumen);
+	$row_resumen=$query_resumen->ConsultaVerRegistro(); 
+
+	$_POST['nombre']=$row_resumen[2];
+	$_POST['ids']=$row_resumen[0];
+
+	$documento = new Documento($ids);
+		?>
+
+
+<fieldset>
+
+  <legend class="Estilo9">DATOS DEL DOCUMENTO</legend>
+  <table width="98%" border="0" align="center" bordercolor="#000000" bgcolor="#ffffff">
+    <tbody>
+      <tr>
+        <td width="223" class="Estilo22"><div align="left">N&ordm; Registro</div></td>
+        <td width="10" class="Estilo22"><div align="center">:</div></td>
+        <td width="98" bgcolor="#ffffff"><div align="left">
+          <?=$row_resumen[1]?>
+        </div></td>
+        <td width="139" bordercolor="#D6D3CE" bgcolor="#ffffff">&nbsp;</td>
+        <td width="113" bgcolor="#ffffff">&nbsp;</td>
+        <td bgcolor="#ffffff" class="Estilo22"><div align="left"></div></td>
+        <td class="Estilo22" bgcolor="#ffffff"><div align="left"></div></td>
+        <td width="211" >&nbsp;</td>
+      </tr>
+      <tr>
+        <td width="223"class="Estilo22"><div align="left">Remitente</div></td>
+        <td width="10" bgcolor="#ffffff" class="Estilo22"><div align="center">:</div></td>
+        <td colspan="3" bgcolor="#ffffff"><div align="left">
+          <?=$row_resumen[2]?>
+        </div></td>
+        <td width="98" class="Estilo22"><div align="left"><span>Nro de Folios</span></div></td>
+        <td width="11" class="Estilo22"><div align="center">:</div></td>
+        <td><div align="left">
+          <?=$row_resumen[numero_folio_documento]?>
+        </div></td>
+      </tr>
+      <tr>
+        <td width="223" bgcolor="#ffffff"><div align="right">
+            <div align="left" class="Estilo22">Nro. Documento</div>
+        </div></td>
+        <td width="10" class="Estilo22" ><div align="center">:</div></td>
+        <td colspan="3" bgcolor="#ffffff"><div align="left">
+          <?=$row_resumen[numero_documento]?>
+        </div></td>
+        <td class="Estilo22"><div align="left">Fecha de Doc </div></td>
+        <td class="Estilo22"><div align="center">:</div></td>
+        <td><div align="left"><?php echo date('d/m/Y',strtotime($row_resumen[fecha_documento]))?></div></td>
+      </tr>
+      <tr>
+        <td class="Estilo22"><div align="left">Tipo de Documento</div></td>
+        <td class="Estilo22"><div align="center">:</div></td>
+        <td colspan="6"><div align="left">
+          <?=$row_resumen[nombre_tipo_documento]?>
+        </div>
+        <div align="left"></div></td>
+      </tr>
+      <tr>
+        <td  width="223" class="Estilo22"><div align="right">
+            <div align="left">Referencia</div>
+        </div></td>
+        <td  width="10" class="Estilo22"><div align="center">:</div></td>
+        <td colspan="6"><div align="left">
+          <?=$row_resumen[referencia_documento]?>
+        </div></td>
+      </tr>
+      <tr>
+        <td  width="223" class="Estilo22"><div align="right">
+            <div align="left">Anexos</div>
+        </div></td>
+        <td  width="10" class="Estilo22"><div align="center">:</div></td>
+        <td colspan="6"><div align="left">
+          <?=$row_resumen[anexo_documento]?>
+        </div></td>
+      </tr>
+      <tr>
+        <td class="Estilo22"><div align="left">Documento Digitalizado </div></td>
+        <td class="Estilo22"><div align="center">:</div></td>
+        <td colspan="6">
+			  <div align="left"><span class="Estilo7">
+			    <?
+					$escaneo = "SELECT * 
+								from documentos_escaneados de
+								where de.id_documento = ".$ids;
+							
+					$qescaneo = new Consulta($escaneo);
+				
+			  		$index = 1;
+			
+					while($row_reg = $qescaneo->ConsultaVerRegistro()){
+						if(is_null($row_reg['fecha_escaneo']))
+							$ref = "Escaneo/".$row_reg['nombre_documento_escaneado'];
+						else
+							$ref = "../archivo/Escaneado_completo/".$row_resumen[1]."/".$row_reg['nombre_documento_escaneado'];
+					?>
+			    		<a href="<?=$ref?>" id="<?=$row_reg["id_documento_escaneado"]?>" target="_blank"><?=$index?></a>		
+			        <?
+						$index++;
+            		}
+				  	?>               
+		      </span>
+			  </div>
+		</td>
+      </tr>
+      <tr>
+        <td height="28" ><div align="right" class="Estilo22">
+          <div align="left">Fecha y Hora de Registro</div>
+        </div></td>
+        <td height="28"  class="Estilo22"><div align="center">:</div></td>
+        <td height="28" ><div align="left"><?php echo date('d/m/Y H:i',strtotime($row_resumen[fecha_registro_documento]))?></div></td>
+        <td height="28" ><div align="left"></div></td>
+        <td><div align="left"></div></td>
+        <td colspan="2" bordercolor="#D6D3CE" bgcolor="#ffffff"><div align="left"></div></td>
+		<td><div align="left"></div></td>
+      </tr>
+      <tr>
+  	<? $edi="SELECT
+			`td`.`asunto_documento`,
+			`td`.`observacion_documento`,
+			`td`.`id_prioridad`
+			FROM
+			`documentos` AS `td`
+			WHERE
+			`td`.`id_documento` =  '".$ids."'";
+			$qedit=new Consulta($edi);	
+			$row_edit=$qedit->ConsultaVerRegistro();
+			$cboprioridad=$row_edit['id_prioridad'];
+			?>    
+
+      <td height="28" bgcolor="#ffffff" class="Estilo22"><div align="left">Observaci&oacute;n de Registro</div></td>
+      <td height="28" bgcolor="#ffffff" class="Estilo22"><div align="center">:</div></td>
+      <td colspan="6"><div align="left">
+        <textarea name="textarea2" id="textarea2" rows="3" cols="100" disabled="disabled" class="disabled"><?=$row_edit[1]?>
+      </textarea>
+      </div></td>
+      </tr>
+    </tbody>
+</table>
+</fieldset>
+
+ <form name="form_despacho" id="form_despacho" method="post"  action="<?php echo $_SERVER['PHP_SELF']?>?opcion=des_guard&ids=<?=$_REQUEST['ids']?>" >  
+
+  <fieldset>
+  <legend >ESTABLECER ASUNTO Y PRIORIDAD</legend>
+  <table width="98%" border="0" align="center" bordercolor="#000000" bgcolor="#ffffff">
+    <tr>
+      <td width="18" height="56" rowspan="2" bgcolor="#ffffff" class="Estilo22">&nbsp;</td>
+      <td width="202" height="56" rowspan="2" bgcolor="#ffffff" class="Estilo22"><div align="left">Asunto:</div></td>
+      <td width="12" rowspan="2" bgcolor="#ffffff" class="Estilo22"><div align="center">:</div></td>
+      <td colspan="5" rowspan="2"><div align="left">
+        <textarea name="textfield2" id="asunto" rows="3" style="width:536px;"><?=$row_edit[0]?></textarea>
+      </div></td>
+      <td width="130">
+	  	<div align="left" id="editar_guardar_asunto" style="display:none">			
+		</div>
+	  </td>
+    </tr>
+    <tr>
+      <td><input type="hidden" id="asunto_anterior" value="<?=$row_edit[0]?>" /></td>
+    </tr>
+    <tr>
+      <td colspan="3" bgcolor="#ffffff" class="Estilo22">&nbsp;</td>
+      <td colspan="6">&nbsp;</td>
+    </tr>
+    <tr>
+      <td bgcolor="#ffffff" class="Estilo21"><span class="Estilo26" style="vertical-align:middle">(*)</span></td>
+      <td bgcolor="#ffffff" class="Estilo22"><div align="left">Prioridad</div></td>
+      <td bgcolor="#ffffff" class="Estilo22"><div align="center">:</div></td>
+      <td width="210" ><?
+		$sql_prioridad="SELECT prioridades.id_prioridad, prioridades.nombre_prioridad, prioridades.tiempo_horas_respuesta_prioridad
+						FROM prioridades
+						ORDER BY prioridades.id_prioridad ASC";
+		$query_prioridad=new Consulta($sql_prioridad);
+		?>
+          <div align="left">
+            <select name="cboprioridad"  id="cboprioridad" onchange="cambia_saldo(this.value)" style="width:200px;">
+              <option value="">--- Seleccione Prioridad ---</option>
+              <? while($row_prioridad=$query_prioridad->ConsultaVerRegistro()){?>
+              <option value="<?=$row_prioridad[0]?>"<? if($row_prioridad[0]==$cboprioridad){ /*echo "selected";*/ } ?>>
+              <?=$row_prioridad[1]?>
+              </option>
+              <? } ?>
+            </select>
+            <input type="hidden" name="id_documento" id="id_documento" value="<?=$ids?>" />
+      </div></td>
+      <td width="215" class="Estilo22"><div align="left">Tiempo de Respuesta</div></td>
+      <td width="5" class="Estilo22"><div align="center">:</div></td>
+      <td width="24" align="left"><div align="left" id="capa_saldo" style="border:none"></div></td>
+      <td width="80" align="left"><div align="left"><?php echo'- Dias.'?></div></td>
+	  <td>&nbsp;</td>
+    </tr>
+    <tr>
+      <td colspan="4" ></td>
+      <td class="Estilo22"><div align="left">Fecha Estimada de Respuesta</div></td>
+      <td class="Estilo22"><div align="center">:</div></td>
+      <td height="21" colspan="2" class="Estilo23"><div id="fecha_respuesta"></div></td>
+	  <td>&nbsp;</td>
+    </tr>
+  </table>
+  </fieldset>
+
+  <fieldset>
+  <legend>ESTABLECER DESTINO Y ACCION A REALIZAR</legend>
+  <table width="99%" border="0" align="center">
+    <tbody>
+        <tr>
+          <td class="Estilo21" style="vertical-align:middle">&nbsp;</td>
+          <td style="vertical-align:middle">&nbsp;</td>
+          <td style="vertical-align:middle">&nbsp;</td>
+          <td style="vertical-align:middle">&nbsp;</td>
+          <td width="39%" bgcolor="#ffffff" class="Estilo22" ><div align="left">Observaci&oacute;n de Despacho:</div>
+  
+          <div align="left"></div>
+          <td align="center" class="Estilo21">&nbsp;</td>
+          <td align="center">&nbsp;</td>
+          <td align="center" class="Estilo22">&nbsp;</td>
+        </tr>
+      <tr>
+        <td width="3%" height="25" class="Estilo21" style="vertical-align:middle">(*)</td>
+        <td width="6%" style="vertical-align:middle"><div align="left" class="Estilo22">Acc&iacute;on</div></td>
+        <td width="2%" style="vertical-align:middle"><div align="center" class="Estilo22" >:</div></td>
+        <td width="31%" style="vertical-align:middle"><div align="left" class="Estilo22" >
+		<?php
+			$acciones = new Acciones();
+			$accions = $acciones->getAcciones(3,$_SESSION['session'][0]);	
+			$tacciones = sizeof($accions);
+		?>
+        	<select name="cboaccion" style="width:200px" id="accion_borrador">
+              <option value="">--Seleccione Accion--</option>
+              <?php                  
+
+				for($u = 0; $u < $tacciones; $u++){ ?>
+              <option value="<?php echo $accions[$u]['id']?>">
+                <?php echo $accions[$u]['nombre']?>
+              </option>
+              <?php
+			}?>
+            </select>
+        </div></td>
+        <td width="39%" rowspan="3" bgcolor="#ffffff" class="Estilo22" ><div align="left">
+          <textarea name="textfield4" id="textfield4" rows="4" cols="50"></textarea>
+        </div>
+        <td height="25" align="center" class="Estilo21"><div align="center"><span >(*)</span></div></td>
+        <td width="3%" align="center"><div align="center"><span class="Estilo22" style="vertical-align:middle">
+            <input name="radiobutton" value="1" type="radio" id="original">
+        </span></div></td>
+        <td width="13%" align="center" class="Estilo22"><div align="left">Original</div></td>
+      </tr>
+	  <tr>
+	    <td class="Estilo21" style="vertical-align:middle">(*)</td>
+	    <td bgcolor="#ffffff" class="Estilo22" style="vertical-align:middle">
+			<div align="left">Pase A</div>			
+			<?
+	      	$sql_areas="SELECT areas.id_area, areas.abve_nombre_area FROM areas";
+    		$query_areas=new Consulta($sql_areas);
+			?>
+		</td>
+	    <td class="Estilo22" style="vertical-align:middle"><div align="center">:</div></td>
+	    <td class="Estilo22" style="vertical-align:middle">
+			<div align="left">
+			<select name="cboareas"  id="cboareas" style="width:200px;">
+	        <option value="">--- Seleccione Destino---</option>
+	        <? while($row_areas=$query_areas->ConsultaVerRegistro()) {?>
+	        <option value="<? echo $row_areas[0]?>"><? echo $row_areas[1]?></option>
+	        <? } ?>
+	        </select>
+        </div>		</td>
+	    <td width="3%" height="24" align="center" class="Estilo21">&nbsp;</td>
+        <td height="24" align="center"><div align="center"><span class="Estilo22" style="vertical-align:middle">
+            <input name="radiobutton" value="2" type="radio" id="copia">
+        </span></div></td>
+        <td height="24" align="center" class="Estilo22"><div align="left">Copia</div></td>
+	  </tr>
+	  <tr>
+	    <td class="Estilo21">&nbsp;</td>
+	    <td colspan="2" bgcolor="#ffffff" class="Estilo22" style="vertical-align:middle">&nbsp;</td>
+	    <td bgcolor="#ffffff" class="Estilo22" style="vertical-align:middle">&nbsp;</td>
+	    <td height="21" align="center">&nbsp;</td>
+        <td height="21" colspan="2" align="center"><div align="center">
+
+            <div align="left">
+              <input type="submit" name="Cargar Lista2" value="Cargar Lista" class="boton"/>
+              </div>
+        </div></td>
+      </tr>
+	  <tr>
+	   <td width="3%" class="Estilo21">&nbsp;</td> 
+         <td colspan="2" bgcolor="#ffffff" class="Estilo22" style="vertical-align:middle">&nbsp;</td>
+        <td width="31%" bgcolor="#ffffff" class="Estilo22" style="vertical-align:middle">&nbsp;</td>
+         <td width="39%" bgcolor="#ffffff" class="Estilo22" >
+        <td height="21" colspan="3" align="center">&nbsp;</td>
+      </tr>
+    </tbody>
+  </table>
+  </fieldset>
+</form>
+  <? }
+
+function DespacharListarDestino($ids)  {
+    $documento = new Documento ($ids);
+    $cls_estado = $documento->getEstado();
+    $estado = $cls_estado->getId();
+?>
+
+
+<table width="99%" border="0" align="center" cellpadding="0" cellspacing="1" class="formularios" id="tabla_despacho">
+    <tr bgcolor="#6699CC" class="Estilo7">
+        <td width="3%" height="25" ><div align="center" class="msgok1">Nro</div></td>
+        <td width="23%"><div align="center" class="msgok1">ORIGEN</div></td>
+        <td width="24%"><div align="center" class="msgok1">DESTINO</div></td>
+        <td width="13%"><div align="center" class="msgok1">Fecha y Hora </div></td>
+        <td width="13%"><div align="center" class="msgok1">Accion</div></td>
+        <td width="11%"><div align="center" class="msgok1">Categor&iacute;a</div></td>
+        <td width="13%"><div align="center" class="msgok1">Opciones </div></td>
+  </tr>
+
+	<?
+	$sql_origen="SELECT * FROM
+                `historial_documentos` AS `th`
+                Inner Join `estados` AS `te` ON `te`.`id_estado` = `th`.`id_estado`
+                LEFT Join `accion` AS `tac` ON `tac`.`id_accion` = `th`.`id_accion`
+                LEFT Join `areas` AS `ta` ON `ta`.`id_area` = `th`.`id_area`
+                WHERE
+                `th`.`id_documento` =  '".$ids."'
+                ORDER BY
+                th.original_historial_documento ASC,
+                th.fecha_historial_documento ASC";
+
+   		$query_origen=new Consulta($sql_origen);
+		$hayOriginal=0;
+		$cont = 0;
+
+		while($row_org=$query_origen->ConsultaVerRegistro()){
+		$cont++;
+		$id=$row_org[0];
+	  ?>	
+      <tr>
+        <td bgcolor="#ffffff"><input type="hidden" value="<?=$id?>"><div align="center"><?=$row_org[0]?></div></td>
+        <td bgcolor="#ffffff"><?=$_POST[nombre]?></td>
+        <td bgcolor="#ffffff"><?=$row_org['nombre_area']?></td>
+        <td bgcolor="#ffffff">
+		<div align="center">
+			<?=date('d/m/Y H:i',strtotime($row_org['fecha_historial_documento']))?>
+		</div>
+		</td>
+        <td bgcolor="#ffffff"><div align="center"><?=$row_org['nombre_accion']?></div></td>
+        <td bgcolor="#ffffff"><div align="center">
+			<? if($row_org['original_historial_documento']=='1'){
+					echo 'ORIGINAL'; 
+					$hayOriginal++;
+				} else {
+					echo 'COPIA';
+				}?></div>        </td>
+        <td bgcolor="#ffffff"><div align="center">
+			<a href="mesa_acceso_registro.php?opcion=eliminar&ids=<?=$ids?>&id=<?=$id?>">
+				<img src="public_root/imgs/b_drop.png" alt="Eliminar" width="16" height="16" border="0">
+			</a>
+		
+		<? 
+			$observacion = trim($row_org['observacion_historial_documento']);
+			
+                if(!empty($observacion)){?>
+                   <a href="javascript:VerDetalleObservacion(<?php echo $cont ?>)">
+                     <img src="public_root/imgs/b_search.png" width="16" height="16" border="0" alt="Ver Detalle" />
+                   </a>
+                <?
+                }
+                   else{
+                ?>
+                   <img src="public_root/imgs/b_search.png" width="16" height="16" border="0" alt="Ver Detalle" />
+                <? }?>
+		
+		</div></td>
+      </tr>
+	  <tr>
+		<td colspan="7" align="justify">
+			<div style="display:none" id="detalle_observacion<?php echo $cont; ?>">
+					<?=$observacion?>
+			</div>
+		</td>
+	</tr>
+     <? } ?>
+</table> 
+<?
+    
+	if($hayOriginal > 0&&$estado!=5){
+            $sql_prioridad = "SELECT id_prioridad
+                        FROM documentos
+                        WHERE id_documento = $ids";
+            $query_prioridad=new Consulta($sql_prioridad);
+            $row_prioridad=$query_prioridad->VerRegistro();
+	?>
+		<script>
+            deshabilitado();
+            deshabilita_prioridad(<?=$row_prioridad["id_prioridad"]?>);//Coge la prioridad del original
+            deshabilita_asunto(<?=$ids?>);
+            habilita_copia();
+        </script>
+	<?
+    }else{
+         ?>
+		<script>
+            javascript:deshabilita_copia(); 
+        </script>
+	<? }
+    }
+
+function DespacharGuardarDestino($ids) {
+
+	$nombre=$_POST['nombre'];
+	$fecha_actual = time()-3600;
+	$fecha=date("Y-m-d H:i:s",$fecha_actual);
+	$cboareas=$_POST['cboareas'];
+	$radiobutton=$_POST['radiobutton'];
+	$cboaccion=$_POST['cboaccion'];
+	$cboprioridad=$_POST['cboprioridad'];
+	$textfield2=$_POST['textfield2'];
+	$textarea=$_POST['textfield4'];
+	$estado=3;
+	
+	$guades =  "Insert INTO
+				historial_documentos values('',
+				'".$ids."',
+				'',
+				'".$cboareas."',
+				'".$fecha."',
+				'".$radiobutton."',
+				'".$cboaccion."',
+				'".$_SESSION['session'][0]."',
+				'".$estado."',
+				'".$textarea."')";
+	
+	$qdest=new Consulta($guades);
+    $id_hist=$qdest->NuevoId();
+
+	$sqlrep =  "SELECT id_documento_reporte as id
+				FROM documentos_reporte
+				WHERE id_documento=$ids";
+	
+	$qrep=new Consulta($sqlrep);
+	$rowrep=$qrep->VerRegistro();
+	$documento = new Documento($ids);
+	$remitente = $documento->getRemitente();
+	$area = new Area($cboareas);
+	$accion = new Accion($cboaccion);
+	$usuario = new Usuario($_SESSION['session'][0]);
+	$ubicacion = "";
+	
+	
+	$est='D';
+    $esta='DESPACHADO';
+	$ubicacion = $area->getAbreviatura();
+	/*}else{
+		$cl_est=$documento->getEstado();
+		$est=$cl_est->getAbreviatura();
+        $esta=$cl_est->getNombre();
+	}*/
+	
+	//Para el reporte
+	$sql_mov = "Insert INTO
+				movimientos values('',
+				'".$rowrep['id']."',
+                '".$id_hist."',
+				'DESPACHO GENERAL',
+				'".$area->getNombre()."',            
+				'".$accion->getNombre()."',
+				'".$radiobutton."',
+				'".$usuario->getLogin()."',
+				'".$textarea."',
+				'".$fecha."',
+				'".$esta."',
+				'".$ubicacion."',				
+				'1')";
+	
+	$q_mov=new Consulta($sql_mov);
+	
+	if($radiobutton==1){
+	
+		$prioridad = new Prioridad($cboprioridad);
+	
+		$s_act="Update documentos 
+				SET id_prioridad='".$cboprioridad."', 
+				asunto_documento='".$textfield2."',
+				id_estado='".$estado."'
+				WHERE id_documento='".$ids."'";
+				$qact=new Consulta($s_act);
+	
+		 $s_mov="Update documentos_reporte
+				SET prioridad='".$prioridad->getNombre()."',
+				asunto='".$textfield2."',
+				estado='".$est."',                
+				ubicacion='".$ubicacion."'
+				WHERE id_documento='".$ids."'";
+				$qact_mov=new Consulta($s_mov);
+	}
+}
+
+function DespacharEliminarDestino($id,$ids){
+
+    $sql   = "SELECT 
+              original_historial_documento AS categoria
+              FROM historial_documentos 
+			  WHERE id_historial_documento='".$id."'";
+
+	$q     = new Consulta($sql);
+    $row   = $q->ConsultaVerRegistro();
+
+	$sst_r = "DELETE FROM historial_documentos 
+			  where id_historial_documento='".$id."'";
+			 
+	$qt_r  = new Consulta($sst_r);
+
+    $sst_r = "DELETE FROM movimientos 
+			  WHERE id_historial='".$id."' AND tipo=1";
+	$qt_r=new Consulta($sst_r);
+
+    if($row['categoria']==1){		
+        /*$actua="Update documentos SET 
+                id_prioridad='',
+                asunto_documento=''
+            	WHERE id_documento='".$ids."'";
+
+        $q_actua=new Consulta($actua);
+
+        $actua_r = "Update documentos_reporte SET
+                    prioridad='',
+                    asunto='',
+                    ubicacion=''
+                    WHERE id_documento='".$ids."'";
+
+        $q_actua_r=new Consulta($actua_r);*/
+	}
+
+    //Vemos si no tiene historial de originales
+    $sql_t="SELECT  id_historial_documento
+            from historial_documentos
+            WHERE id_documento='".$ids."'
+            AND original_historial_documento=1";
+
+     $query_t=new Consulta($sql_t);
+
+    if($query_t->NumeroRegistros()==0){
+	
+        $actua = "UPDATE documentos 
+				  SET id_estado=1
+				  WHERE id_documento='".$ids."'";
+
+        $q_actua=new Consulta($actua);
+
+        $actua_r = "UPDATE documentos_reporte 
+					SET estado='R'
+                    WHERE id_documento='".$ids."'";
+
+        $q_actua_r=new Consulta($actua_r);
+    }
+
+}
+
+function RegistraFiltrar(){
+
+    $sql_estado =  "SELECT *
+					FROM estados AS e
+					WHERE e.display = 1
+					ORDER BY e.nombre_estado ASC";
+					
+    $q_estado=new Consulta($sql_estado);
+    ?>
+
+<form name="f5" method="post" action="<?=$_SESSION['PHP_SELF']?>?opcion=list&ide=<?=$ide?>">
+
+    <table width="100%" height="50" border="0" >
+        <tr>
+            <td>&nbsp;</td>
+        </tr>
+        <tr>
+            <td align="center">
+			<select name="ide">
+            <option value="">---Estado---</option>
+              <?
+                        while($row_estado=$q_estado->ConsultaVerRegistro()){
+                    		$ide=$row_estado[0];?>
+            <option value="<?=$row_estado[0]?>"<? if(isset($ide) && $ide== $row_estado[0]){ echo "selected";} ?>>
+              <?=$row_estado[1]?>
+            </option>
+			<option value="LT">LISTAR TODOS</option>
+              <?}?>
+            </select></td>
+        </tr>
+        <tr>
+              <td align="center" ><input name="Filtrar" type="submit"  value="Filtrar"/></td>
+        </tr>
+</table>
+</form>
+<?
+}
+}
+?>
diff -r 82e55d328c8c -r 9881d5db150a mesa_acceso_registro.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/mesa_acceso_registro.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,89 @@
+<?php  
+	include("includes.php");
+	require_once("cls/mesa_acceso_registro.cls.php");
+
+	if(!$_SESSION['session'][3] == "SI" ){?>
+		<script>location.href="error_permisos.php";</script>
+ 	<?
+	}
+	$menu = array(0,1,0,0,1,0);
+	
+	$unload = "";
+	//if(isset($_REQUEST["opcion"])&&$_REQUEST["opcion"]!="list"&&$_REQUEST["opcion"]!="busqueda") 
+		//$unload = "onunload=verificar_asunto()";
+?>
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+<title>M&Oacute;DULO DE TRAMITE DOCUMENTARIO/ MESA DE PARTES </title>
+<?php include("includes/inc.header.php"); ?>
+<script type="text/javascript" src="public_root/js/leyendas/cargar_estados.js"></script>
+<script type="text/javascript">
+function cambia_saldo(id_total){
+	var id_doc = $("#id_documento").val();
+	$("#capa_saldo").load("carga_saldo.php?horas=s&id_total="+id_total).fadeIn("slow");
+	$("#fecha_respuesta").load("carga_saldo.php?fechar="+id_total+"&id="+id_doc).fadeIn("slow");
+}
+</script>
+</head>
+<body <?=$unload?>>
+
+<table  id="principal"  align="left" cellpadding="0" cellspacing="0" width="100%" style="margin:0px; vertical-align:top">
+	<tr>		
+		<td colspan="2" align="left"> <?php Plantilla::PlantillaEncabezado("DESPACHO GENERAL ");?> </td>		
+	</tr>
+	<tr>
+		<td class="menu"><?php Plantilla::PlantillaIzquierdo();?></td>	
+		<td>
+			<table  class="contenido" cellpadding="0" cellspacing="0" width="100%" align="left">	
+            <tr>
+				<td><?php  Plantilla::menuSuperior("mesa_acceso_registro.php",$menu,$_GET['id'],false);?></td>
+			</tr>									
+				<tr>								
+					<td style="width:100%; height:417px"><?php
+ 							
+						$opcion = $_REQUEST['opcion'];
+						$ide = $_REQUEST['ide'];
+						$ids = $_REQUEST['ids'];
+						$campo = $_REQUEST['campo'];
+						$valor = $_REQUEST['valor'];
+
+
+							switch($opcion){
+										case 'list':
+											Registro::RegistraListado($ide);	
+										break;	
+										case 'despachar':	
+											Registro::ConsultarDocumento($ids);	
+											Registro::DespacharListarDestino($ids);			
+										break;	
+										case 'des_guard':	
+											Registro::DespacharGuardarDestino($ids);
+											Registro::ConsultarDocumento($ids);		
+											Registro::DespacharListarDestino($ids);		
+										break;	
+										case 'eliminar':	
+											Registro::DespacharEliminarDestino($_REQUEST["id"],$_REQUEST["ids"]);
+											Registro::ConsultarDocumento($_REQUEST["ids"]);		
+											Registro::DespacharListarDestino($ids);		
+										break;											
+										case 'busqueda';
+											Registro::Busqueda($campo, $valor);
+										break;			
+										default:	
+											Registro::RegistraListado($ide);
+										break;
+
+										}
+							?>							
+					</td>					
+				</tr>			
+			</table>
+		</td>		
+	</tr>
+	<tr>
+		<td colspan="2" class="pie"><?php Plantilla::PlantillaPie();?>	</td>
+	</tr>	
+</table>	
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a mockup.xml
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/mockup.xml	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,34 @@
+<mockup version="1.0" skin="sketch" measuredW="614" measuredH="506" mockupW="525" mockupH="475">
+  <controls>
+    <control controlID="13" controlTypeID="com.balsamiq.mockups::DataGrid" x="79" y="53" w="525" h="116" measuredW="341" measuredH="236" zOrder="0" locked="false" isInGroup="-1">
+      <controlProperties>
+        <text>Name%5Cr%28job%20title%29%20%5E%2C%20Age%2C%20Nickname%2C%20Employee%0AGiacomo%20Guilizzoni%5CrFounder%20%26%20CEO%2C%2034%2C%20Peldi%2C%20%5Bx%5D%0AGuido%20Jack%20Guilizzoni%2C%204%2C%20The%20Guids%2C%20%5B%5D%0AMarco%20Botton%5CrTuttofare%2C%2031%2C%20%2C%20%5Bx%5D%0AMariah%20Maclachlan%5CrBetter%20Half%2C%2035%2C%20Patata%2C%20%5Bx%5D%0AValerie%20Liberty%5CrCOO%5C%2C%20WOW%21%20Division%2C%20%3A%29%2C%20Val%2C%20%5Bx%5D%0A%7B75L%2C%200R%2C%2025%2C%200C%7D</text>
+      </controlProperties>
+    </control>
+    <control controlID="14" controlTypeID="com.balsamiq.mockups::Label" x="79" y="21" w="-1" h="-1" measuredW="113" measuredH="25" zOrder="1" locked="false" isInGroup="-1">
+      <controlProperties>
+        <text>Despacho%20General</text>
+      </controlProperties>
+    </control>
+    <control controlID="15" controlTypeID="com.balsamiq.mockups::DataGrid" x="79" y="216" w="525" h="116" measuredW="341" measuredH="236" zOrder="2" locked="false" isInGroup="-1">
+      <controlProperties>
+        <text>Name%5Cr%28job%20title%29%20%5E%2C%20Age%2C%20Nickname%2C%20Employee%0AGiacomo%20Guilizzoni%5CrFounder%20%26%20CEO%2C%2034%2C%20Peldi%2C%20%5Bx%5D%0AGuido%20Jack%20Guilizzoni%2C%204%2C%20The%20Guids%2C%20%5B%5D%0AMarco%20Botton%5CrTuttofare%2C%2031%2C%20%2C%20%5Bx%5D%0AMariah%20Maclachlan%5CrBetter%20Half%2C%2035%2C%20Patata%2C%20%5Bx%5D%0AValerie%20Liberty%5CrCOO%5C%2C%20WOW%21%20Division%2C%20%3A%29%2C%20Val%2C%20%5Bx%5D%0A%7B75L%2C%200R%2C%2025%2C%200C%7D</text>
+      </controlProperties>
+    </control>
+    <control controlID="16" controlTypeID="com.balsamiq.mockups::Label" x="79" y="184" w="-1" h="-1" measuredW="123" measuredH="25" zOrder="3" locked="false" isInGroup="-1">
+      <controlProperties>
+        <text>Secretar%EDa%20General</text>
+      </controlProperties>
+    </control>
+    <control controlID="17" controlTypeID="com.balsamiq.mockups::DataGrid" x="79" y="380" w="525" h="116" measuredW="341" measuredH="236" zOrder="4" locked="false" isInGroup="-1">
+      <controlProperties>
+        <text>Name%5Cr%28job%20title%29%20%5E%2C%20Age%2C%20Nickname%2C%20Employee%0AGiacomo%20Guilizzoni%5CrFounder%20%26%20CEO%2C%2034%2C%20Peldi%2C%20%5Bx%5D%0AGuido%20Jack%20Guilizzoni%2C%204%2C%20The%20Guids%2C%20%5B%5D%0AMarco%20Botton%5CrTuttofare%2C%2031%2C%20%2C%20%5Bx%5D%0AMariah%20Maclachlan%5CrBetter%20Half%2C%2035%2C%20Patata%2C%20%5Bx%5D%0AValerie%20Liberty%5CrCOO%5C%2C%20WOW%21%20Division%2C%20%3A%29%2C%20Val%2C%20%5Bx%5D%0A%7B75L%2C%200R%2C%2025%2C%200C%7D</text>
+      </controlProperties>
+    </control>
+    <control controlID="18" controlTypeID="com.balsamiq.mockups::Label" x="79" y="348" w="-1" h="-1" measuredW="90" measuredH="25" zOrder="5" locked="false" isInGroup="-1">
+      <controlProperties>
+        <text>Interoceanica</text>
+      </controlProperties>
+    </control>
+  </controls>
+</mockup>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a modulo_usuario.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/modulo_usuario.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,68 @@
+<?php  
+	include("includes.php");
+	require_once("cls/class.usuarios.php");
+	require_once("cls/class.pagina.php");
+	require_once("cls/class.modulo_usuario.php");
+	if(!$_SESSION['session'][3] == "SI" ){?>
+		<script>location.href="error_permisos.php";</script>
+ 	<?
+	}
+ ?>
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+<?php include("includes/inc.header.php"); ?>
+<title>Administraci&oacute;n</title>
+</head>
+<body>
+<table  id="principal"  align="left" cellpadding="0" cellspacing="0" width="100%" style="margin:0px; vertical-align:top">
+	<tr>		
+		<td  align="left" colspan="2"><?php  Plantilla::PlantillaEncabezado("ADMINISTRACION DE ACCESO A PAGINAS");?> </td>		
+	</tr>
+	<tr>
+		<td class="menu"><?php  Plantilla::PlantillaIzquierdo();?></td>	
+		<td  style="width:100%">
+			<table  class="contenido" cellpadding="0" cellspacing="0" width="100%" align="left">										
+				<tr>								
+					<td style="width:100%; height:417px">
+					<div id="cuerpo"><?php
+					if($_SESSION['session'][3]=="SI" ){ 
+						SeccionAdmin::SeccionAdminCabezera();
+						switch($_GET['opcion']){																	
+							case 'add':										
+								SeccionAdmin::SeccionAdminAdd($_GET['id'], $_POST);
+							break;
+							case 'addDetail':										
+								SeccionAdmin::SeccionAdminAddDetalle($_POST);
+							break;
+							case 'detail':
+								SeccionAdmin::SeccionAdminDetalle($_GET['id1'],$_GET['id']);	
+							break;							
+							case 'list':
+								SeccionAdmin::SeccionAdminList($_GET['id1']);	
+							break;												
+							default:	
+								SeccionAdmin::SeccionAdminList($_GET['id1']);
+							break; 
+						}	 
+					}else if($_SESSION['session'][3]=="NO") {
+						echo "<div id=error> CUIDADO: Usted es Usuario del sistema pero no esta Autorizado para ver esta informacin </div><br><br>";		
+
+					}else{
+						echo " ERROR: Usted esta entrando de manera Incorrecta !!! " ;
+					}	?>	
+					</div>					
+					</td>					
+				</tr>			
+			</table>
+		</td>		
+	</tr>
+	<tr>
+		<td colspan="2" class="pie"><?php Plantilla::PlantillaPie();?>	</td>
+	</tr>	
+</table>
+	
+</body>
+</html>
+
+
diff -r 82e55d328c8c -r 9881d5db150a plantilla.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/plantilla.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,54 @@
+
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
+<title>Documento sin t&iacute;tulo</title>
+
+<style type="text/css">
+	body{
+		color:#000000;
+		font-family:Arial;
+	}
+	h1{
+		font-size:14px;
+		font-weight:bold;
+	}	
+.firma {font-size: 12px}
+</style>
+</head>
+<body>
+<p align="center"><em>&ldquo;Decenio de las Personas con Discapacidad  en el Per&uacute;&rdquo;</em><br />
+    <em>&ldquo;A&ntilde;o de la Uni&oacute;n Nacional  frente a la Crisis Externa&rdquo;</em></p>
+<p>Lima, txtfecha </p>
+<h1><strong><u>OFICIO N&ordm; txtnumero-2009-SERNANP-txtabreviatura</u></strong></h1>
+<p>Se&ntilde;or<br />
+    <strong>txtdestinatario</strong><br />
+  <br />
+  <u>Presente</u>.-</p>
+<table border="0" cellspacing="0" cellpadding="0" width="468" align="right">
+  <tr>
+    <td width="108" valign="top"><p><strong>Asunto&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    :</strong></p></td>
+    <td width="360" valign="top"><p>txtasunto</p></td>
+  </tr>
+  <tr>
+    <td width="108" valign="top"><p><strong>Referencia :</strong></p></td>
+    <td width="360" valign="top"><p>txtreferencia</p></td>
+  </tr>
+</table>
+<p>&nbsp;</p>
+<p>&nbsp;</p>
+<p>Tengo  el agrado de dirigirme a usted </p>
+<p>&nbsp;</p>
+<p>Hago propicia la ocasi&oacute;n  para expresarle las muestras de mi consideraci&oacute;n. </p>
+<p align="left">Atentamente,</p>
+<p>&nbsp;</p>
+<div id="inferior" style="width:200px;">
+<p align="center"><strong>txtjefe</strong><br />
+  <span class="firma">txtcargo</span><br />
+  <span class="firma">Servicio  Nacional de &Aacute;reas Naturales Protegidas</span><br />
+<span class="firma">por el  Estado</span></p>
+</div>
+<p align="left">txtiniciales/txtusuario</p>
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a proponer_archivar_derivar.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/proponer_archivar_derivar.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,174 @@
+<?php  
+	include_once("includes.php");
+	include_once("cls/class.accion.php");
+	include_once("cls/class.usuario.php");
+	include_once("cls/class.documentos.php");	
+    #ini_set('display_errors',1);
+    #dump($_SERVER);
+    if($_FILES){
+        $counter = 0;
+        foreach( $_FILES['doc']['size'] as $size ){
+            $counter += $size;
+            if( $size > 2000000 || $counter >8000000 ){
+                $error = true;
+                header("Location: ".$_POST['url']."&error=file");
+                exit;
+                break;
+            }
+        }
+        
+        dump($_FILES);
+    }
+?>
+
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
+<?php include_once("includes/inc.header.php"); ?>
+<style>
+	input{
+		height:21px;
+	}
+	td{
+		vertical-align:middle;
+	}
+	fieldset{
+		margin:0px 4px 4px 4px;
+		width:95%;
+	}
+	
+</style>
+<title>STD .:. Elaborar Borrador de Respuesta</title>
+</head>
+<body>
+	<fieldset>
+		<legend>Justificaci&oacute;n de la Acci&oacute;n </legend>	
+    <?if($_GET['error']){?>
+        <div id='error'>El tama&ntilde;o del archivo supera al permitido.</div>
+    <?}?>						
+	    <?
+		if($_REQUEST["opcion"]=='addha'){
+			$documento = new Documento($_REQUEST['id']);
+			$atencion=$documento->addHistorialAtencion();
+			if($atencion!=0){
+				Documentos::GuardarArchivoJustificacion($atencion);
+				echo  "<p>Se propuso correctamente</p></div>";
+			}else{
+				echo  "<div id='error'>Hubo un error al procesar su consulta</div>";
+			}
+		?>
+    <br/>
+    <br/>
+    <input name="cancelar" type="button" class="boton" id="cerrar_j" value="Cerrar" />
+    <?
+	}elseif($_REQUEST["opcion"]=='addhd'){
+        $documento = new Documento($_REQUEST['id']);
+        $atencion=$documento->AprobarDocumento($_REQUEST['comentario']);
+		if($atencion!=0){
+            Documentos::GuardarArchivoJustificacion($atencion);
+			echo  "<p>Se aprobo correctamente</p></div>";
+		}else{
+			echo  "<div id='error'>Hubo un error al procesar su consulta</div>";
+		}
+    ?>
+    <br/>
+    <br/>
+    <input name="cancelar" type="button" class="boton" id="cerrar_j" value="Cerrar" />
+    <?
+    }else{
+		$accion= new Accion($_REQUEST["acc"]);
+		$categoria=($_REQUEST["cat"]==1)?"Original":"Copia";
+		
+		if($_REQUEST["id"]){?>
+		
+		<?php  
+			if( $_SESSION['session'][3] == "SI" ){
+                
+              $tip = "";
+              if(!$_REQUEST["tipo"]){
+                  $estado=($accion->getId()==29)?14:15;
+              }else{
+                  $tip = 1;
+                  $estado=($accion->getId()==35)?16:17;
+              }
+
+			  
+		?>
+			<form id="form_justificacion" name="form_justificacion" method="post" action="javascript:validar_justificacion(<?= $_REQUEST["id"]?>)" enctype="multipart/form-data">			
+				<input type="hidden" id="area" name="area" value="<?php echo $_SESSION['session'][5] ?>" />
+				<input type="hidden" id="user" name="user" value="<?php echo $_SESSION['session'][0] ?>" />			
+				<input type="hidden" id="categoria" name="categoria" size="30" value="<?=$_REQUEST["cat"]?>"/>
+				<input type="hidden" id="accion" name="accion" value="<?=$accion->getId()?>"/>	
+				<input type="hidden" id="estado" name="estado" value="<?=$estado?>"/>
+                <input type="hidden" id="tipo" name="tipo" value="<?=$tip?>"/>
+                <input type="hidden" id="url" name="url" value="<?=$_SERVER['REQUEST_URI']?>"/>
+
+		<table width="100%" height="275" border="0">
+		<tr>
+			<td width="10%" height="21" class="Estilo22">Acci&oacute;n</td>
+			<td width="1%" class="Estilo22"><div align="center">:</div></td>
+			<td ><?=$accion->getNombre()?></td>
+		    <td colspan="3" class="Estilo22" width="7%">Categoria</td>
+		    <td width="1%" class="Estilo22"><div align="center">:</div></td>
+		    <td colspan="2" width="7%"><?=$categoria?></td>
+		</tr>
+		
+		<tr>
+		  <td height="24" colspan="3" class="Estilo21"><strong>(*) Tama&ntilde;o M&aacute;ximo 2Mb </strong></td>
+		  <td colspan="4" style="vertical-align:top;">&nbsp;</td>
+		  <td colspan="2" class="Estilo21" style="vertical-align:top; padding-top:2px;">&nbsp;</td>
+		  </tr>
+		<tr>
+			<td height="24" style="vertical-align:top;"><label style="margin-top:1px;" class="Estilo22">Documento</label></td>
+			<td class="Estilo22" style="vertical-align:top; text-align:center;padding-top:4px;"><div align="center">:</div></td>
+			<td>
+				<div class="ileft_img">
+				<div id='cp_item_0' style="float:left">					
+					<input id="doc[]" type="file" name="doc[]" size="39" />
+				</div>
+				 <div class="iright_img" style="float:left; height:22px;"></div>
+			  </div>			</td>
+		    <td width="3%" style="vertical-align:top;"><img src="public_root/imgs/edit_add.png" alt="" onclick="crearCarchivo(2)" style="margin-top:1px;"/></td>
+		    <td width="3%" style="vertical-align:top;"><img src="public_root/imgs/edit_remove.png" alt="" onclick="quitarCarchivo(2)" style="margin-top:1px;"/></td>
+		    <td style="vertical-align:top;" colspan="2">&nbsp;</td>
+		    <td colspan="2">&nbsp;</td>
+	      </tr>
+		<tr>
+			<td class="Estilo22" height="19"> Respuesta</td>
+			<td height="19" class="Estilo22"><div align="center">:</div></td>
+			<td colspan="7">&nbsp;</td>
+		</tr>
+		<tr>
+			<td height="137" colspan="9">
+				<div align="center"><textarea name="comentario" cols="80" rows="10" id="comentario" class="caja"></textarea>
+				</div>			</td>
+		</tr>
+		<tr>
+			<td height="36" colspan="2" align="center" style="vertical-align:middle">
+		  <td>&nbsp;</td>
+		  <td colspan="5">		    <div align="right">
+		    <input name="aceptar" type="submit" class="boton" id="aceptar_b" value="Aceptar"/>	      
+	      </div></td>
+		  <td width="12%"><div align="right">
+		    <input name="cancelar" type="button" class="boton" id="cancelar_b" value="Cancelar" />
+	      </div></td>
+		</tr>
+	</table>
+	</form>
+	<?
+	}else if($_SESSION['session'][3]=="NO") {
+		echo "<div id='error'> CUIDADO: Usted es Usuario del sistema pero no esta Autorizado para ver esta informacin </div><br><br>";		
+			}else{
+				echo " ERROR: Usted esta entrando de manera Incorrecta !!! " ;
+			}	?>
+	<? }
+	else{
+	?>
+	<script>javascript:cerrar_popups</script>
+	<? }
+	}
+	?>
+	</fieldset>
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a remitentes.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/remitentes.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,77 @@
+<?php  
+	include("includes.php");
+	require_once("cls/class.remitentes.php");
+	if(!$_SESSION['session'][3] == "SI" ){?>
+		<script>location.href="error_permisos.php";</script>
+ 	<?
+	}
+	$menu = array(1,1,0,0,0,0);
+?>
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head> 
+<?php include("includes/inc.header.php"); ?>
+<title>Administraci&oacute;n</title>
+</head>
+<body>
+<table  id="principal"  align="left" cellpadding="0" cellspacing="0" width="100%" style="margin:0px; vertical-align:top">
+	<tr>		
+		<td  align="left" colspan="2"><?php  Plantilla::PlantillaEncabezado("ADMINISTRACION DE REMITENTES");?> </td>		
+	</tr>
+	<tr>
+		<td class="menu"><?php  Plantilla::PlantillaIzquierdo();?></td>	
+		<td style="width:100%">
+			<table  class="contenido" cellpadding="0" cellspacing="0" width="100%" align="left">
+				<tr>
+					<td><?php  Plantilla::menuSuperior("remitentes.php",$menu,$_GET['id'],false);?></td>
+				</tr>
+				<tr>								
+					<td style="width:100%; height:417px">	
+					<div id="cuerpo" > 	<?php  
+					if( $_SESSION['session'][3] == "SI" ){  
+						switch($_GET['opcion']){
+							case 'new':										 
+								Remitentes::RemitentesNew();		
+							break;
+							case 'add':
+								Remitentes::RemitentesAdd($_REQUEST["nom_remi"],$_REQUEST["abrev"],$_REQUEST["tipo_remi"]);
+								Remitentes::RemitentesList();			
+							break;									
+							case 'edit':										
+								Remitentes::RemitentesEdit($_GET['id']);	
+							break;
+							case 'update':
+								Remitentes::RemitentesUpdate($_GET['id'], $_POST);
+								Remitentes::RemitentesList();			
+							break;
+							case 'delete':										 
+								Remitentes::RemitentesDelete($_GET['id']);	
+								Remitentes::RemitentesList();			
+							break;
+							case 'list':
+								Remitentes::RemitentesList();	
+							break;					
+							default:	
+								Remitentes::RemitentesList();
+							 
+							break; 
+						}	
+					}else if($_SESSION['session'][3]=="NO") {
+						echo "<div id='error'> CUIDADO: Usted es Usuario del sistema pero no esta Autorizado para ver esta informacin </div><br><br>";		
+					}else{
+						echo " ERROR: Usted esta entrando de manera Incorrecta !!! " ;
+					}	?>
+					</div>						
+					</td>					
+				</tr>			
+			</table>
+		</td>		
+	</tr>
+	<tr>
+		<td colspan="2" class="pie"><?php Plantilla::PlantillaPie();?>	</td>
+	</tr>	
+</table>
+	
+</body>
+</html>
+
diff -r 82e55d328c8c -r 9881d5db150a reportes.old.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/reportes.old.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,175 @@
+<?php
+	/**
+	 * Edited by Enrique Juan de Dios 
+	 * 12JUL2010
+	 */
+	include("includes.php");
+	include("includes.php");  
+    
+	require_once("cls/atencion.cls.php");
+    require_once('cls/class.areas.php');
+    require_once('cls/class.remitentes.php');
+	
+    if (!ini_get('display_errors')) {
+        ini_set('display_errors', 1);
+    }
+    
+    
+	if(!$_SESSION['session'][3] == "SI" ){
+        ?>
+            <script>location.href="error_permisos.php";</script>
+        <?
+        exit;
+	}
+    $areas = new Areas();
+    $remitentes = new Remitentes();
+    $remitente_etiquetas = array(
+        'MEF'=>'Ministerio de Econom&iacute;a y Finanzas',
+        'CONG'=>"Congreso de la Rep&uacute;blica",
+        'MINAM'=>"Ministerio del Ambiente",
+        'CONT'=>'Contralor&iacute;a general de la Rep&uacute;blica');
+
+    $params = array('pendientes','atendidos','vencidos');
+    $get = (object)$_GET;
+    $filtro = 'atencion';
+    
+    $pendientes = isset($get->pendientes) && $get->pendientes;
+    $vencidos = isset($get->vencidos) && $get->vencidos;
+    $atendidos = isset($get->atendidos) && $get->atendidos;
+    
+    $areas = $areas->lista();
+    
+    $remitentes = $remitentes->urgentes();
+?>
+
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+    <head>
+        <?php include("includes/inc.header.php"); ?>
+		<style type="text/css">
+			@import url(public_root/js/calendar/calendar-blue2.css);
+		</style>
+        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/> 
+		<script type="text/javascript" src="public_root/js/calendar/calendar.js"></script>
+		<script type="text/javascript" src="public_root/js/calendar/calendar-es.js"></script>
+		<script type="text/javascript" src="public_root/js/calendar/calendar-setup.js"></script>
+		<script type="text/javascript" src="public_root/js/jquery.autocomplete.js"></script>
+		<link href="public_root/css/jquery.autocomplete.css" rel="stylesheet">
+		<script>
+			function abre_ventana(ref){
+				screen_width = screen.width;
+				str = 'width='+screen_width+',height=600,top=20,left=3,scrollbars=yes';
+				window.open(ref.href, ref.target,str);
+			}			
+		</script>
+        <title>M&Oacute;DULO DE TRAMITE DOCUMENTARIO</title>
+    </head>
+<body>
+
+<table  id="principal"  align="left" cellpadding="0" cellspacing="0" width="100%" style="margin:0px; vertical-align:top">
+	<tr>		
+		<td colspan="2" align="left"> <?php Plantilla::PlantillaEncabezado("REGISTRO	DE DOCUMENTOS ");?> </td>		
+	</tr>
+	<tr>
+		<td class="menu" ><?php Plantilla::PlantillaIzquierdo();?></td>	
+		<td>
+			<table  class="contenido" cellpadding="0" cellspacing="0" width="100%" align="left">									
+				<tr>								
+					<td style="width:100%; height:417px">	
+						<p class="main_links">
+							<a href="Reportes/Estadisticos/tiempo_espera_usuario.php" 
+								target="_blank" onClick="abre_ventana(this); return false;"
+								>Reporte de Productividad por Usuario</a>			|		 
+							<a href="Reportes/Estadisticos/movimientos_por_usuario.php" 
+								target="_blank" onClick="abre_ventana(this); return false;"
+								>Reporte por Area</a>				|		
+							<a href="reportes.php?atencion=1" class="<?=(isset($get->atencion)? 'active':'')?>"
+								>Reporte por area de atenci&oacute;n</a>		|		
+							<a href="reportes.php?remitentes=1"  class="<?=(isset($get->remitentes)? 'active':'')?>"
+								>Reporte por Remitentes</a>						
+				        </p>
+                        
+                        <?if( isset($get->atencion) || isset($get->remitentes) ){?>
+                        <div id="panel">
+                            <div id="loading" class="hidden">
+                                <div class="overlay">
+                                </div>
+                                <div class="loading_msg">
+                                    Cargando...
+                                </div>
+                            </div>
+                            <form id="filters" action="" method="post">
+                                <p>
+                                <?if( isset($get->remitentes) ){?>
+                                    <label>Remitente</label>
+                                    <select name="remitente" id="remitente">
+                                        <option value="">Seleccionar...</option>
+                                        <?foreach($remitentes as $remitente){?>
+                                            <option value="<?=$remitente->abreviatura_remitente?>"
+                                                <?=($get->remitente == $remitente->abreviatura_remitente)?"selected='selected'":'';?>
+                                                ><?=$remitente_etiquetas[ $remitente->abreviatura_remitente ]?></option>
+                                        <?}?>
+                                    </select>
+                                    <input name="remitentes" value="1" type="hidden" />
+                                <?}else{?>
+                                    <label>Area</label>
+                                    <select name="area" id="area">
+                                        <option value="">Seleccionar...</option>
+                                        <?foreach($areas as $area){?>
+                                            <option value="<?=$area->id_area?>"
+                                                <?=(isset($get->area) && $get->area == $area->id_area)?"selected='selected'":'';?>
+                                                ><?=$area->Nombre?></option>
+                                        <?}?>
+                                    </select>
+                                    <input name="atencion" value="1" type="hidden" />
+                                <?}?>
+                                </p>
+                                <p>
+                                    <span>
+                                        <input name="pendientes" id="pendientes" type="checkbox" value="1"
+                                                <?=($pendientes?"checked='checked'":'')?>
+                                            <?=( $vencidos?"disabled='disabled'":'')?>
+                                            />
+                                        <label for="pendientes" <?=( $vencidos ?"class='disabled'":'')?>>Pendientes (No archivados)</label>
+                                    </span>
+                                    <!--
+                                    -->
+                                    <span>
+                                        <input name="atendidos" id="atendidos" type="checkbox" value="1"
+                                            <?=( $atendidos?"checked='checked'":'')?>
+                                            />
+                                        <label for="atendidos">Atendidos (Archivados)</label>
+                                    </span>
+                                    <span>
+                                        <input name="vencidos" id="vencidos" type="checkbox" value="1" 
+                                            
+                                                <?=( $vencidos ?"checked='checked'":'')?>
+                                            <?=( $pendientes?"disabled='disabled'":'')?>
+                                            />
+                                        <label for="vencidos" <?=( $pendientes ?"class='disabled'":'')?>>Vencidos</label>
+                                    </span>
+                                    <input type="hidden" value="<?=( (isset($get->pag) && is_numeric($get->pag) )? $get->pag :'')?>" name="pag" id="pag" />
+                                </p>
+                            </form>
+                            
+                            <div id="list">
+                                <?			
+                                    Atencion::listado( $filtro ,true);	
+                                ?>
+                            </div>
+                        
+                        </div>
+                        <?}?>
+                        
+						
+					</td>					
+				</tr>			
+			</table>
+		</td>		
+	</tr>
+	<tr>
+		<td colspan="2" class="pie"><?php Plantilla::PlantillaPie();?>	</td>
+	</tr>	
+</table>	
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a reportes.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/reportes.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,363 @@
+<?php
+	/**
+	 * Edited by Enrique Juan de Dios 
+	 * 12JUL2010
+	 */
+	include("includes.php");
+    
+	require_once("cls/atencion.cls.php");
+    require_once('cls/class.areas.php');
+    require_once('cls/class.remitentes.php');
+	require_once("cls/class.documento_reporte.php");
+    
+    
+    if (!ini_get('display_errors')) {
+        ini_set('display_errors', 1);
+    }
+    
+    
+	if(!$_SESSION['session'][3] == "SI" ){
+        ?>
+            <script>location.href="error_permisos.php";</script>
+        <?
+        exit;
+	}
+    $areas = new Areas();
+    $remitentes = new Remitentes();
+    $remitente_etiquetas = array(
+        'MEF'=>'Ministerio de Econom&iacute;a y Finanzas',
+        'CONG'=>"Congreso de la Rep&uacute;blica",
+        'MINAM'=>"Ministerio del Ambiente",
+        'CONT'=>'Contralor&iacute;a general de la Rep&uacute;blica');
+
+    $params = array('pendientes','atendidos','vencidos');
+    $get = (object)$_GET;
+    $filtro = 'atencion';
+    
+    $pendientes = isset($get->pendientes) && $get->pendientes;
+    $vencidos = isset($get->vencidos) && $get->vencidos;
+    $atendidos = isset($get->atendidos) && $get->atendidos;
+    
+    $areas = $areas->lista();
+    
+    $remitentes = $remitentes->urgentes();
+    
+	$table="registro";
+	if(!isset($pag)){ $pag = 1; } 
+	$tampag = 20;
+	$reg1 = ($pag-1) * $tampag;
+	 
+	$pags=array($pag,$tampag,$table,$reg1);
+	set_time_limit(100);
+    $menu = array(0,1,0,0,1,0); 
+?>
+
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+    <head>
+        <?php include("includes/inc.header.php"); ?>
+<script type="text/javascript" src="public_root/js/jquery.autocomplete.js"></script>
+<script type="text/javascript" src="public_root/js/jquery.bgiframe.min.js"></script>
+<script type="text/javascript" src="public_root/js/ui/ui.core.js"></script>
+<script type="text/javascript" src="public_root/js/ui/ui.draggable.js"></script>
+<script type="text/javascript" src="public_root/js/ui/ui.droppable.js"></script>
+<script type="text/javascript" src="public_root/js/ui/ui.datepicker.js"></script>
+<script type="text/javascript" src="public_root/js/ui/ui.datepicker-es.js"></script>
+<script type="text/javascript" src="public_root/js/ui/ui.dialog.js"></script>
+<script src="public_root/js/jgrid/jquery.layout.js" type="text/javascript"></script>
+<script src="public_root/js/jgrid/grid.import.js" type="text/javascript"></script>
+<script src="public_root/js/jgrid/JsonXml.js" type="text/javascript"></script>
+<script src="public_root/js/jgrid/json2.js" type="text/javascript"></script>
+<script src="public_root/js/jgrid/jquery.jqGrid.js" type="text/javascript"></script>
+<script src="public_root/js/jgrid/jqModal.js" type="text/javascript"></script>
+<script src="public_root/js/jgrid/jqDnR.js" type="text/javascript"></script>
+<script src="public_root/js/jgrid/grid.setcolumns.js" type="text/javascript"></script>
+<script type="text/javascript" src="public_root/js/leyendas/cargar_estados.js"></script>
+<link href="public_root/css/jquery.autocomplete.css" rel="stylesheet">
+<link href="public_root/css/start/ui.all.css" rel="stylesheet">
+<link href="public_root/css/ui.jqgrid.css" rel="stylesheet">
+
+<script type="text/javascript">
+var gridimgpath = 'public_root/css/start/images';
+var now = "";
+var list;
+jQuery(document).ready(function(){
+
+    /****************REPORTES****************/
+	list = $(".ch",document);
+	for(var i = 0,t = list.length; i<t; i++){
+		var id = list[i].getAttribute('id');
+		D[ id ] = $('#'+id);
+	}
+	
+    D.loading.removeClass('hidden').hide();
+    D.area = D.filters.find('select').change(changeFilter);
+    D.filters.find('input.checkbox').click(changeFilter);
+    D.filters.submit(changeFilter);
+	
+    function changeFilter(e){
+		
+		var id =this.getAttribute('id');
+		if( id=='filters' ){
+			e.preventDefault();
+		}
+		D.reg.val(D.doc.val());
+		//D.asu.val(D.doc.val());
+		
+		// When Remitents is active, disable search by remitente
+		if( D.rem ){
+			D.rem_bk.attr('disabled','disabled');
+		}else{
+			//D.rem_bk.val(D.reg.val()); 
+		}
+		
+        if(this.getAttribute('id') == "pendientes" || this.getAttribute('id') == "atendidos" ){
+            D.est.val( this.checked? this.value:"" );
+        }
+        if(this.name == 'ubi'){
+
+            if(this.value !="" ){
+                D.usuarios.empty();
+                D.despacho.hide().find('input').removeAttr('checked');
+                var id = this.options[this.selectedIndex].getAttribute('param');
+                $.get('Ajax/AjaxUsuarios.php',{ubi:id},function(r){
+                    if(typeof(r) == 'object' && r.length > 0){
+                        var options = '<option value=""> Todos...</option>';
+                        for(var i=0,t=r.length;i<t;i++){
+                            options +='<option value="'+r[i].login_usuario+'">'+ r[i].nombres +'</option>';
+                        }
+                        D.usuarios.html(options);
+                        D.selectUsuario.show();
+                    }
+                },'json');
+            }else {
+                D.despacho.show();
+                D.selectUsuario.hide();
+                D.usuarios.empty();        
+            }
+                D.selectCopias.hide();
+                D.copias.val("");
+        }
+        if(this.name == 'usuarios' ){
+			if( this.value == ''){
+				D.selectCopias.hide();
+                D.copias.val(""); 
+			}else{
+				D.selectCopias.show();
+			}
+		}
+
+        if(this.name=='nodespachado' && this.checked ){
+            D.doc.val("");
+            if(D.ubi){
+                D.ubi.val("");
+                D.selectUsuario.hide();
+                D.usuarios.empty();
+            }
+            D.vencidos.attr('checked',''); 
+            D.pendientes.attr('checked','');
+        }
+        setFilter();
+    }
+    
+    
+    function setFilter(e){
+        jQuery("#frmgrid").setGridParam({url:"Ajax/AjaxReporte.php?"+D.filters.serialize() ,page:1}).trigger("reloadGrid"); 
+    }
+    
+    /************************************************/
+    
+	$.jgrid.defaults = $.extend($.jgrid.defaults,{loadui:"enable"});	
+
+   	$grid = jQuery("#frmgrid").jqGrid({
+        url:'Ajax/AjaxReporte.php?todos=1',
+        datatype: "json",
+        colNames:['asunto','N&ordm; Registro','Remitente', 'Documento', 'Registrado','Respuesta','Estado','Ubicacion','Dias'],
+        colModel:[
+            {name:'asunto',index:'asunto',hidden:true},
+            {name:'registro',index:'registro', width:135,formatter:'link',formatoptions: {baseLinkUrl: 'VerDetalleBusqueda', addParam: '',showAction: 'popup'},align:"center"},
+            {name:'remitente',index:'remitente', width:190},
+            {name:'documento',index:'documento', width:190},
+            {name:'fecha',index:'fecha', width:70, align:"center"},
+            {name:'fecha_r',index:'fecha_r', width:70, align:"center"},
+            {name:'estado',index:'estado', width:45,align:"center"},
+            {name:'ubicacion',index:'ubicacion',width:70,align:'center'},
+            {name:'dias_faltantes',index:'dias_faltantes',width:30,align:'center'}
+            
+        ],
+        rowNum:15,
+        rowList:[10,15,20],
+        imgpath: gridimgpath,
+        pager: '#pfrmgrid',
+        sortname: 'fecha',
+        viewrecords: true,
+        sortorder: "desc",
+        caption:"",
+        height:330,
+        loadComplete:function(){
+            jQuery("#frmgrid").find('tr td:eq(8)').each(function(i,e){
+                    var el = $(e), dias =  parseInt( $(e).text(),10 );
+                    if (dias<0){ el.parent().addClass('ended');}
+                    else if(dias ==0){el.parent().addClass('warning')}
+            })
+        }
+	});
+
+    
+});
+</script>
+<title>MODULO DE TR&Aacute;MITE DOCUMENTARIO REPORTE DE DOCUMENTOS</title>
+</head>
+<body>
+<table  id="principal"  align="left" cellpadding="0" cellspacing="0" width="100%" style="margin:0px; vertical-align:top">
+	<tr>		
+		<td colspan="2" align="left"> <?php Plantilla::PlantillaEncabezado("REGISTRO	DE DOCUMENTOS ");?> </td>		
+	</tr>
+	<tr>
+		<td class="menu" ><?php Plantilla::PlantillaIzquierdo();?></td>	
+		<td class="wrapper">
+			<table  class="contenido" cellpadding="0" cellspacing="0" width="100%" align="left">
+             
+				<tr>								
+					<td style="width:100%; height:417px">	
+
+						<p class="main_links">
+							<a href="Reportes/Estadisticos/tiempo_espera_usuario.php" 
+								target="_blank" onClick="abre_ventana(this); return false;"
+								>Reporte de Productividad por Usuario</a>
+					<? #print_r($_SESSION);
+
+						if( $_SESSION["session"][2] == "Admin Area" || $_SESSION["session"][2] == "Admin. Total" ) {?>			|		 
+							<a href="reportes.php?atencion=1" class="<?=(isset($get->atencion)? 'active':'')?>"
+								>Reporte por area de atenci&oacute;n</a>		|		
+							<a href="reportes.php?remitentes=1"  class="<?=(isset($get->remitentes)? 'active':'')?>"
+								>Reporte por Remitentes</a>						
+					<?}?>
+				        </p>
+                        
+                        <?if( isset($get->atencion) || isset($get->remitentes) ){?>
+                        <div id="panel">
+                            <div id="loading" class="hidden ch">
+                                <div class="overlay">
+                                </div>
+                                <div class="loading_msg">
+                                    Cargando...
+                                </div>
+                            </div>
+                            <form id="filters" action="" method="post" class="ch">
+                                <p class="busqueda"> 
+                                    <input name="doc" id="doc" class="ch" value="" type="text" size="50" />
+                                    <input type="submit" value="Buscar por No. Registro" />
+                                </p>
+                                <p>
+                                <?if( isset($get->remitentes) ){?>
+                                    <label>Remitente</label>
+                                    <select class="ch" name="rem" id="rem">
+                                        <option value="">Todos...</option>
+                                        <?foreach($remitentes as $remitente){?>
+                                            <option value="<?=$remitente->abreviatura_remitente?>"
+                                                <?=($get->remitente == $remitente->abreviatura_remitente)?"selected='selected'":'';?>
+                                                ><?=$remitente_etiquetas[ $remitente->abreviatura_remitente ]?></option>
+                                        <?}?>
+                                    </select>
+                                    <input name="remitentes" value="1" type="hidden" />
+                                <?}else{?>
+                                    <label>Ubicaci&oacute;n</label>
+                                    <select class="ch" name="ubi" id="ubi">
+                                        <option value="">Todos...</option>
+                                        <?foreach($areas as $area){?>
+                                            <option value="<?=$area->Abreviatura?>"
+                                                <?=(isset($get->ubi) && $get->ubi == $area->Abreviatura)?"selected='selected'":'';?> param="<?=$area->id_area?>"
+                                                ><?=$area->Nombre?></option>
+                                        <?}?>
+                                    </select>
+                                    <span id="selectUsuario" class="hidden ch">
+                                    <label>Usuario</label>
+                                        <select name="usuarios" id="usuarios" class="ch">
+                                            <option value="">Seleccionar...</option>
+                                        </select>
+                                    </span>
+                                    
+                                    <span id="selectCopias" class="hidden ch">
+                                    <label>Ver</label>
+                                        <select name="copias" id="copias" class="ch">
+                                            <option value="">Originales</option>
+                                            <option value="1">Copias</option>
+                                        </select>
+                                    </span>
+                                    
+                                    <input name="atencion" value="1" type="hidden" />
+                                <?}?>
+                                </p>
+                                <p>
+                                    <span id="despacho" class="ch">
+                                        <input class="checkbox ch" id="nodespachado" type="checkbox" value="1" name="nodespachado" />
+                                        <label for="nodespachado" >Por Despachar</label>
+                                    </span>
+                                    
+                                    <span style="display:none;">
+                                        <input class="checkbox ch" id="pendientes" type="checkbox" value="TP"
+                                                <?=($pendientes?"checked='checked'":'')?>
+                                            <?=( $vencidos?"disabled='disabled'":'')?>
+                                            />
+                                        <label for="pendientes" <?=( $vencidos ?"class='disabled'":'')?>>Pendientes (No archivados)</label>
+                                    </span>
+                                    <!--
+                                    <span>
+                                        <input  id="atendidos" type="checkbox" value="1"
+                                            <?=( $atendidos?"checked='checked'":'')?>
+                                            />
+                                        <label for="atendidos">Atendidos (Archivados)</label>
+                                    </span>
+                                    -->
+                                    <span>
+                                        <input class="checkbox ch" name="vencidos" id="vencidos" type="checkbox" value="1" 
+                                            
+                                                <?=( $vencidos ?"checked='checked'":'')?>
+                                            <?=( $pendientes?"disabled='disabled'":'')?>
+                                            />
+                                        <label for="vencidos" <?=( $pendientes ?"class='disabled'":'')?>>Vencidos</label>
+                                    </span>
+                                    <input type="hidden" value="<?=( (isset($get->pag) && is_numeric($get->pag) )? $get->pag :'')?>" name="pag" id="pag" />
+                                    <input type="hidden" value="" name="est" id="est" class="ch" />
+                                    <input type="hidden" value="1" name="todos" id="todos" class="ch" />
+                                    <input type="hidden" value="" name="rem" id="rem_bk" class="ch" />
+                                    <input type="hidden" value="" name="asu" id="asu" class="ch" />
+                                    <input type="hidden" value="" name="reg" id="reg" class="ch" />
+                                </p>
+                            </form>
+                            
+                            <div id="list">
+                             
+                                                  
+                                <div id="resultado" style="text-align:center">
+                                    <table id="frmgrid" class="scroll" cellpadding="0" cellspacing="0" align="left"></table>
+                                    <div id="pfrmgrid" class="scroll" style="text-align:center;"></div>	
+                                </div>
+                                <div id="dialog" title="Mensaje de error" style="display:none">
+                                    <table width="100%" border="0" id="msg">
+                                      <tr>
+                                        <td width="10%" style="vertical-align:middle"><div align="center"><img src="public_root/imgs/warning_2_1.png" border="0" style="border:none"></div></td>
+                                        <td style="vertical-align:middle; padding-left:10px;"><span id="msg_dialogo" style="padding:7px 0 7px 0;"></span></td>
+                                      </tr>
+                                    </table>	
+                                </div>           
+                             
+                             
+                            </div>
+                        
+                        </div>
+                        <?}?>
+                        
+						
+					</td>					
+				</tr>			
+			</table>
+		</td>		
+	</tr>
+	<tr>
+		<td colspan="2" class="pie"><?php Plantilla::PlantillaPie();?>	</td>
+	</tr>	
+</table>	
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a salir.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/salir.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,6 @@
+<?php
+session_start();
+require_once("cls/class.sesion.php");
+Sesion::SessionDelete("index.php");
+
+?>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a tramite_pendiente.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/tramite_pendiente.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,117 @@
+<?php  
+	include_once("includes.php");
+	include_once("cls/class.accion.php");
+	include_once("cls/class.usuario.php");
+	include_once("cls/class.documentos.php");	
+?>
+
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
+<?php include_once("includes/inc.header.php"); ?>
+<style>
+	input{
+		height:21px;
+	}
+	td{
+		vertical-align:middle;
+	}
+	fieldset{
+		margin:0px 4px 4px 4px;
+		width:95%;
+	}
+	
+</style>
+<title>STD .:. Tramitar Pendiente</title>
+</head>
+<body>
+	<fieldset>
+		<legend>Tramitar Pendiente  </legend>							
+	    <?
+		if($_REQUEST["opcion"]=='addha'){
+			$documento = new Documento($_REQUEST['id']);
+			$atencion=$documento->addTramitePendiente();
+			if($atencion!=0){
+				Documentos::GuardarArchivoJustificacion($atencion);
+				echo  "<p>Se termin correctamente</p></div>";
+			}else{
+				echo  "<div id='error'>Hubo un error al procesar su consulta</div>";
+			}
+		?>
+    <br/>
+    <br/>
+    <input name="cancelar" type="button" class="boton" id="cerrar_b" value="Cerrar" />
+    <?
+	}else{
+		if($_REQUEST["id"]){?>
+		<?php  
+			if( $_SESSION['session'][3] == "SI" ){
+			  $accion = new Accion($_REQUEST["acc"]);
+		?>
+			<form id="form_justificacion" name="form_justificacion" method="post" action="javascript:validar_tramitacion(<?= $_REQUEST["id"]?>)" enctype="multipart/form-data">			
+				<input type="hidden" id="area" name="area" value="<?php echo $_SESSION['session'][5] ?>" />
+				<input type="hidden" id="user" name="user" value="<?php echo $_SESSION['session'][0] ?>" />			
+				<input type="hidden" id="accion" name="accion" value="<?=$accion->getId()?>"/>	
+
+		<table width="100%" height="275" border="0">
+		
+		
+		<tr>
+		  <td height="24" colspan="3" class="Estilo21"><strong>(*) Tama&ntilde;o M&aacute;ximo 2Mb </strong></td>
+		  <td width="8%" colspan="4" style="vertical-align:top;">&nbsp;</td>
+		  <td width="7%" colspan="2" class="Estilo21" style="vertical-align:top; padding-top:2px;">&nbsp;</td>
+		  </tr>
+		<tr>
+			<td width="10%" height="24" style="vertical-align:top;"><label style="margin-top:1px;" class="Estilo22">Documento</label></td>
+			<td width="1%" class="Estilo22" style="vertical-align:top; text-align:center;padding-top:4px;"><div align="center">:</div></td>
+			<td>
+				<div class="ileft_img">
+				<div id='cp_item_0' style="float:left">					
+					<input id="doc[]" type="file" name="doc[]" size="39" />
+				</div>
+				 <div class="iright_img" style="float:left; height:22px;"></div>
+			  </div>			</td>
+		    <td width="7%" style="vertical-align:top;"><img src="public_root/imgs/edit_add.png" alt="" onclick="crearCarchivo(2)" style="margin-top:1px;"/></td>
+		    <td width="7%" style="vertical-align:top;"><img src="public_root/imgs/edit_remove.png" alt="" onclick="quitarCarchivo(2)" style="margin-top:1px;"/></td>
+		    <td style="vertical-align:top;" colspan="2">&nbsp;</td>
+		    <td colspan="2">&nbsp;</td>
+	      </tr>
+		<tr>
+			<td class="Estilo22" height="19"> Respuesta</td>
+			<td height="19" class="Estilo22"><div align="center">:</div></td>
+			<td colspan="7">&nbsp;</td>
+		</tr>
+		<tr>
+			<td height="137" colspan="9">
+				<div align="center"><textarea name="comentario" cols="80" rows="10" id="comentario"></textarea>
+				</div>			</td>
+		</tr>
+		<tr>
+			<td height="36" colspan="2" align="center" style="vertical-align:middle">
+		  <td>&nbsp;</td>
+		  <td colspan="5">		    <div align="right">
+		    <input name="aceptar" type="submit" class="boton" id="aceptar_b" value="Aceptar"/>	      
+	      </div></td>
+		  <td width="12%"><div align="right">
+		    <input name="cancelar" type="button" class="boton" id="cancelar_b" value="Cancelar" />
+	      </div></td>
+		</tr>
+	</table>
+	</form>
+	<?
+	}else if($_SESSION['session'][3]=="NO") {
+		echo "<div id='error'> CUIDADO: Usted es Usuario del sistema pero no esta Autorizado para ver esta informacin </div><br><br>";		
+			}else{
+				echo " ERROR: Usted esta entrando de manera Incorrecta !!! " ;
+			}	?>
+	<? }
+	else{
+	?>
+	<script>javascript:cerrar_popups</script>
+	<? }
+	}
+	?>
+	</fieldset>
+</body>
+</html>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a usuarios.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/usuarios.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,78 @@
+<?php  
+	include("includes.php");
+	require_once("cls/class.usuarios.php");
+	require_once("cls/class.modulo_usuario.php");
+	if(!$_SESSION['session'][3] == "SI" ){?>
+		<script>location.href="error_permisos.php";</script>
+ 	<?
+	}		
+	$menu = array(1,1,0,0,0,0);
+?>
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head> 
+<?php include("includes/inc.header.php"); ?>
+<title>Administraci&oacute;n</title>
+</head>
+<body>
+<table  id="principal"  align="left" cellpadding="0" cellspacing="0" width="100%" style="margin:0px; vertical-align:top">
+	<tr>		
+		<td  align="left" colspan="2"><?php  Plantilla::PlantillaEncabezado("ADMINISTRACION DE USUARIOS");?> </td>		
+	</tr>
+	<tr>
+		<td class="menu"><?php  Plantilla::PlantillaIzquierdo();?></td>	
+		<td style="width:100%">
+			<table  class="contenido" cellpadding="0" cellspacing="0" width="100%" align="left">
+				<tr>
+					<td><?php  Plantilla::menuSuperior("usuarios.php",$menu,$_GET['id'],false);?></td>
+				</tr>
+				<tr>								
+					<td style="width:100%; height:417px">	
+					<div id="cuerpo" > 	<?php  
+					
+					if( $_SESSION['session'][3] == "SI" ){  
+						switch($_GET['opcion']){
+							case 'new':										 
+								Usuarios::UsuariosNew();		
+							break;
+							case 'add':
+								Usuarios::UsuariosAdd();
+								Usuarios::UsuariosList();			
+							break;									
+							case 'edit':										
+								Usuarios::UsuariosEdit($_GET['id']);	
+							break;
+							case 'update':
+								Usuarios::UsuariosUpdate($_GET['id'], $_POST);
+								Usuarios::UsuariosList();			
+							break;
+							case 'delete':										 
+								Usuarios::UsuariosDelete($_GET['id']);	
+								Usuarios::UsuariosList();			
+							break;
+							case 'list':
+								Usuarios::UsuariosList();	
+							break;					
+							default:	
+								Usuarios::UsuariosList();
+							 
+							break; 
+						}	
+					}else if($_SESSION['session'][3]=="NO") {
+						echo "<div id='error'> CUIDADO: Usted es Usuario del sistema pero no esta Autorizado para ver esta informacin </div><br><br>";		
+					}else{
+						echo " ERROR: Usted esta entrando de manera Incorrecta !!! " ;
+					}	?>
+					</div>						
+					</td>					
+				</tr>			
+			</table>
+		</td>		
+	</tr>
+	<tr>
+		<td colspan="2" class="pie"><?php Plantilla::PlantillaPie();?>	</td>
+	</tr>	
+</table>
+	
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a usuarios_documentos.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/usuarios_documentos.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,58 @@
+<?php 
+require_once("includes.php");
+$sql_listado = " SELECT * FROM  documentos ";
+$query_listado = new Consulta($sql_listado);
+?>
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
+<title>DOCUMENTOS PENDIENTES</title>
+</head>
+<body>
+<p align="center" class="Estilo9"><img src="CABEZERA.JPG" alt="." width="921" height="78" /></p>
+<table width="100%" border="0">
+  <tr>
+    <td width="71%" class="Estilo9"><a href="http://www.minam.gob.pe/" class="pathway">SERNANP</a> &gt;<a href="http://www.minam.gob.pe/" class="pathway">Sistema de Tr&aacute;mite Documentario</a>&gt;<span class="breadcrumbs pathway">Direcci&oacute;n de Desarrollo Estrat&eacute;gico</span></td>
+    <td width="29%"><div align="right" class="Estilo9">Usuario del Sistema: <?php echo  $_SESSION['usuario']['nombres'] ?></div></td>
+  </tr>
+</table>
+<fieldset>
+<legend class="Estilo9">DOCUMENTOS PENDIENTES </legend>
+<table width="100%" border="1" align="center">
+  <tr>
+    <td width="4%"><div align="center"><span class="Estilo9">Reg. N&ordm;</span></div></td>
+    <td width="7%"><div align="center"><span class="Estilo9">Tipo de Doc.</span></div></td>
+    <td width="9%"><div align="center"><span class="Estilo9">Nro Documento</span></div></td>
+    <td width="11%"><div align="center"><span class="Estilo9">Acci&oacute;n</span></div></td>
+    <td width="28%"><div align="center"><span class="Estilo9">Asunto</span></div></td>
+    <td width="8%"><div align="center"><span class="Estilo9">Estado</span></div></td>
+    <td width="9%" class="Estilo9"><div align="center">Documento Digitalizado (PDF) </div></td>
+    <td width="9%"><div align="center"><span class="Estilo9">Fecha programada de Respuesta </span></div></td>
+    <td width="8%"><div align="center"><span class="Estilo9">Prioridad</span></div></td>
+    <td width="7%" class="Estilo9"><div align="center">Atenci&oacute;n</div></td>
+  </tr><?php
+  while($row = $query_listado->ConsultaVerRegistro()){?>
+  
+  <tr>
+    <td><span class="Estilo7"><a href="detalle_documento.php?<?php echo $row['id_tramite'] ?>"> <?php echo $row[''] ?>0006</a></span></td>
+    <td><span class="Estilo14">INFORME</span></td>
+    <td><span class="Estilo7">015-11-2008-JD</span></td>
+    <td class="Estilo7">Acci&oacute;n Necesaria </td>
+    <td class="Estilo7">REMITE INFORME DE TRABAJOS REALIZADOS SEGUN CONTRATO DE  CONSULTORIA ADDENMUN N&ordm; 1 PRRNP-C-CON-010-2008-PAN</td>
+    <td class="Estilo7"><div align="center">Registrado<br />
+      Derivado<a href="DirectorElaborarBorradorRespuesta.html"><br />
+      Borrador 1</a> </div></td>
+    <td class="Estilo7"><span class="Estilo7"><a href="#">1</a> <a href="#">2</a> <a href="#">3</a> <a href="#">4</a> <a href="#">5</a> <a href="#">6</a> <a href="#">7</a> <a href="#">8</a> <a href="#">9 </a></span></td>
+    <td><span class="Estilo7">12/10/2006</span></td>
+    <td bgcolor="#FF0000" class="Estilo9"><div align="center" class="Estilo15"><span class="Estilo7">ALTA</span></div></td>
+    <td bgcolor="#FFFFFF" class="Estilo9"><div align="center">
+        <input type="checkbox" name="checkbox" value="checkbox" />
+    </div></td>
+  </tr><?php
+  }
+  ?>
+</table>
+</fieldset></p>
+</body>
+</html>
diff -r 82e55d328c8c -r 9881d5db150a validacion.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/validacion.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,22 @@
+<?php
+require_once("includes.php");
+
+
+if(!isset($_SESSION['session'])){ 
+	 
+	$valida = Acceso::AccesoValida();
+
+	if($valida==0){
+		$msg="ERROR: Usuario o Password Incorrecto ";
+		$error=$error+1;
+		header("Location: index.php?error=".$error);	
+	}else{		
+		
+		$_SESSION['session'];
+		Sesion::SesionLogear($valida); 
+		header("Location: index.php");
+	}
+}else{
+	Header("Location: index.php");
+}
+?>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a ventanillas_acceso_registro.cls.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/ventanillas_acceso_registro.cls.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,749 @@
+<?php
+
+class Registro {
+
+function RegistraListado($ide){	
+ 	
+	$calculo = strtotime("-1 days");
+	$fecha_ayer=date("Y-m-d", $calculo);
+
+	if ($ide == ''){
+        $sql_reg =  "SELECT
+					d.id_documento,
+					d.id_estado,
+					d.asunto_documento,
+					d.fecha_registro_documento,
+					e.abrev_nombre_estado,
+					d.numero_documento,
+					d.codigo_documento,
+					r.nombre_remitente
+					FROM 
+					documentos AS d 
+					LEFT Join remitentes AS r
+					ON r.id_remitente = d.id_remitente 
+					Inner Join estados AS e 
+					ON e.id_estado = d.id_estado 
+					LEFT Join tipos_documento td
+					ON td.id_tipo_documento = d.id_tipo_documento
+					LEFT Join usuarios u
+					ON d.id_usuario = u.id_usuario
+					WHERE d.id_estado =  1 AND
+					u.id_anp = ".$_SESSION['session'][7]." AND
+					d.fecha_registro_documento > '$fecha_ayer'
+					ORDER BY 
+					d.id_documento DESC";
+
+		$query_reg = new Consulta($sql_reg);
+		
+	}
+	else 
+	{
+		$where = ($ide=="LT")?"":"WHERE d.id_estado =$ide";
+		
+		$sql_reg = "SELECT
+					d.id_documento,
+					d.id_estado,
+					d.asunto_documento,
+					d.fecha_registro_documento,
+					e.abrev_nombre_estado,
+					d.numero_documento,
+					d.codigo_documento,
+					r.nombre_remitente
+					FROM 
+					documentos AS d 
+					LEFT Join remitentes AS r
+					ON r.id_remitente = d.id_remitente 
+					Inner Join estados AS e 
+					ON e.id_estado = d.id_estado 
+					LEFT Join tipos_documento td
+					ON td.id_tipo_documento = d.id_tipo_documento
+					LEFT Join usuarios u
+					ON d.id_usuario = u.id_usuario					
+					$where  
+					AND u.id_anp = ".$_SESSION['session'][7]."
+					ORDER BY d.id_documento DESC";
+		echo $sql;			
+		$query_reg=new Consulta($sql_reg);		
+	}
+?>
+<div class="ui-jqgrid ui-widget ui-widget-content ui-corner-all">
+<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" id="tabla_despacho" class="gview_frmgrid">
+	<tr>
+		<td>
+			<table width="100%" class="ui-jqgrid-htable" cellpadding="0" cellspacing="0">
+				<tr bgcolor="#6699CC" class="ui-widget-header ui-th-column grid_resize" height="25">
+					<th width="17%" class="ui-widget-header ui-th-column grid_resize">Reg. Nro</th>
+					<th width="27%" class="ui-widget-header ui-th-column grid_resize">Remitente</th>
+					<th class="ui-widget-header ui-th-column grid_resize">Documento</th>
+					<th width="14%" class="ui-widget-header ui-th-column grid_resize">Registrado</th>
+					<th width="6%" class="ui-widget-header ui-th-column grid_resize">Estado</th>
+					<th width="8%" class="ui-widget-header ui-th-column grid_resize">Opciones</th>
+				</tr>			
+			</table>
+		</td>
+	</tr>
+	<tr class="ui-jqgrid-bdiv">
+		<td>
+			<table id="frmgrid" width="100%" class="ui-jqgrid-btable" cellpadding="0" cellspacing="0">
+		    
+			<? while($row_reg=$query_reg->ConsultaVerRegistro()){
+                    $id=$row_reg["id_documento"];
+                    $estado = $row_reg["id_estado"];
+					
+					$tooltip = "";
+					if(!empty($row_reg['asunto_documento']))
+						$tooltip = $row_reg['asunto_documento'];
+            ?>
+					
+	   <tr class="ui-widget-content1 jqgrow <? echo ($estado==12)?"Estilo2 fila_finalizada":"Estilo2";?>">
+	   		<td <?=$tooltip?> width="17%">
+				<div align="center">
+                <?php 
+                $cod = $row_reg["codigo_documento"];
+                if($estado != 12&&$estado != 11){ ?>
+                    <a href="Ventanillas_acceso_registro.php?opcion=edit&id=<?=$id?>">
+                    <?=$cod?></a>
+                <? }
+                    else{
+                        echo $cod;
+                    }
+                ?>
+		        </div></td>
+	      	<td width="27%"><input size="48"  value="<?=$row_reg["nombre_remitente"]?>"/></td>
+		    <td><input size="43" value="<?=$row_reg["numero_documento"]?>"/></td>		    
+		    <td width="14%">
+				<div align="center">
+					<input value="<?=date('d/m/Y H:i',strtotime($row_reg['fecha_registro_documento']))?>" style="width:100%; text-align:center"/>					
+				</div>
+			</td>
+      		<td align="center"  width="6%">
+				<div align="center">
+					<input value="<?=$row_reg['abrev_nombre_estado']?>" style="width:100%; text-align:center"/>	
+      			</div>
+			</td>
+      		<?php 
+
+		  		$sql_ultimo="SELECT Max(`hd`.`id_historial_documento`) AS `ultimo` 
+							FROM `historial_documentos` AS `hd` 
+							where hd.id_documento='".$row_reg['id_documento']."' 
+							GROUP BY `hd`.`id_documento`";
+
+				$query_ultimo=new Consulta($sql_ultimo);		
+				$ultimo=$query_ultimo->ConsultaVerRegistro();
+				
+				$sql_data = "SELECT hd.id_documento,
+							a.nombre_area, 
+							a.abve_nombre_area 
+							FROM historial_documentos AS hd 
+							Inner Join areas AS a ON a.id_area = hd.id_area 
+							where hd.id_historial_documento='".$ultimo['ultimo']."'";
+
+				$query_data=new Consulta($sql_data);		
+				$data=$query_data->ConsultaVerRegistro();
+
+		$sql_usu="SELECT Max(`ha`.`id_historial_atencion`) AS `ultimo`, `ha`.`id_documento` 
+				FROM 
+				`historial_atencion` AS `ha` 
+				WHERE 
+				ha.original_historial_atencion =  '1' and 
+				ha.id_documento='".$row_reg['id_documento']."' 
+				GROUP BY `ha`.`id_documento`	";
+
+		$query_usu=new Consulta($sql_usu);		
+		$usu=$query_usu->ConsultaVerRegistro();
+
+		$susu = "SELECT `u`.`login_usuario`, `a`.`abve_nombre_area`
+                FROM `historial_atencion` AS `ha`
+                Inner Join `usuarios` AS `u` ON `u`.`id_usuario` = `ha`.`id_usuario_destino`
+				Inner Join `areas` AS `a` ON `a`.`id_area` = `u`.`id_area`
+				WHERE `ha`.`id_historial_atencion` = '".$usu['ultimo']."' ";
+
+        $qusu=new Consulta($susu);
+    	$u=$qusu->ConsultaVerRegistro();
+	?>
+				<td width="8%">
+					<div align="center"><a href="javascript:imprimir_documento_reg(<?=$id?>)">
+				    <img src="public_root/imgs/print.gif" border="0" />
+			    </a> </div></td>
+			</tr>
+			<? }?>
+		 </table>
+		</td>
+	</tr>
+</table>
+</div>
+<?php 
+}
+
+function Busqueda($campo, $valor){	 
+
+	if($campo == "nombre_remitente"){
+		$where = $campo == "nombre_remitente" ? " AND remitentes.nombre_remitente like '%$valor%' " : "";
+	}else{
+		$where = $campo != "" ? " AND d.$campo like '%$valor%' " : "";
+	}
+
+	$sql_reg=" SELECT * FROM documentos d
+		LEFT Join remitentes ON remitentes.id_remitente = d.id_remitente
+		LEFT Join estados ON estados.id_estado = d.id_estado
+		LEFT Join tipos_documento ON tipos_documento.id_tipo_documento = d.id_tipo_documento 
+		 ".$where."
+		ORDER BY d.id_documento DESC";
+
+	$query_reg=new Consulta($sql_reg);		
+?>
+
+<div class="ui-jqgrid ui-widget ui-widget-content ui-corner-all">
+<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" id="tabla_despacho" class="gview_frmgrid">
+	<tr>
+		<td>
+			<table width="100%" class="ui-jqgrid-htable" cellpadding="0" cellspacing="0">
+				<tr bgcolor="#6699CC" class="ui-widget-header ui-th-column grid_resize" height="25">
+					<th width="10%" class="ui-widget-header ui-th-column grid_resize">Reg. Nro</th>
+					<th width="27%" class="ui-widget-header ui-th-column grid_resize">Remitente</th>
+					<th class="ui-widget-header ui-th-column grid_resize">Documento</th>
+					<th width="14%" class="ui-widget-header ui-th-column grid_resize">Registrado</th>
+					<th width="6%" class="ui-widget-header ui-th-column grid_resize">Estado</th>
+					<th width="11%" class="ui-widget-header ui-th-column grid_resize">Opciones</th>
+				</tr>			
+			</table>
+		</td>
+	</tr>
+	<tr class="ui-jqgrid-bdiv">
+		<td>
+			<table id="frmgrid" width="100%" class="ui-jqgrid-btable" cellpadding="0" cellspacing="0">
+			<? while($row_reg=$query_reg->ConsultaVerRegistro()){
+					$id=$row_reg[0];
+					$estado = $row_reg["id_estado"];
+					$tooltip = "";
+					if(!empty($row_reg['asunto_documento']))
+						$tooltip = $row_reg['asunto_documento'];
+            ?>
+					
+	   <tr class="ui-widget-content1 jqgrow <? echo ($estado==12)?"Estilo2 fila_finalizada":"Estilo2";?>">
+	   		<td <?=$tooltip?> width="10%">
+				<div align="center">
+                <?php
+                $cod = $row_reg[1];
+                if($estado != 12&&$estado != 11){ ?>
+                    <a href="Ventanillas_acceso_registro.php?opcion=edit&id=<?=$id?>">
+                    <?=$cod?></a>
+                <?}
+                    else{
+                        echo $cod;
+                    }
+                ?>
+	</div></td>
+    <td width="27%"><input size="48"  value="<?=$row_reg[nombre_remitente]?>"/></td>
+    <td><input size="43" value="<?=$row_reg[3]?>"/></td>
+    <td width="14%"> <div align="center">
+      <input name="Input" style="width:100%; text-align:center" value="<?=date('d/m/Y H:i',strtotime($row_reg['fecha_registro_documento']))?>"/>
+    </div></td>
+    <td align="center" width="6%"><div align="center">
+      <input name="Input2" style="width:100%; text-align:center" value="<?=$row_reg['abrev_nombre_estado']?>"/>
+    </div></td>
+    <?php
+        $sql_ultimo="SELECT Max(`hd`.`id_historial_documento`) AS `ultimo`
+                    FROM
+                    `historial_documentos` AS `hd`
+            		where hd.id_documento='".$row_reg['id_documento']."'
+                    GROUP BY
+                    `hd`.`id_documento`";
+
+		$query_ultimo=new Consulta($sql_ultimo);		
+		$ultimo=$query_ultimo->ConsultaVerRegistro();
+		
+        $sql_data = "SELECT hd.id_documento,
+                    a.nombre_area,
+                    a.abve_nombre_area
+                    FROM historial_documentos AS hd
+                    Inner Join areas AS a ON a.id_area = hd.id_area
+                    where hd.id_historial_documento='".$ultimo['ultimo']."'";
+
+		$query_data=new Consulta($sql_data);		
+		$data=$query_data->ConsultaVerRegistro();
+
+		$sql_usu = "SELECT Max(`ha`.`id_historial_atencion`) AS `ultimo`,
+                    `ha`.`id_documento`
+                    FROM
+                    `historial_atencion` AS `ha`
+                    WHERE
+                    ha.original_historial_atencion =  '1' and
+                    ha.id_documento='".$row_reg['id_documento']."'
+                    GROUP BY
+                    `ha`.`id_documento`	";
+
+		$query_usu=new Consulta($sql_usu);		
+		$usu=$query_usu->ConsultaVerRegistro();
+
+		$susu = "SELECT `u`.`login_usuario`,
+                `a`.`abve_nombre_area`
+				FROM
+				`historial_atencion` AS `ha`
+				Inner Join `usuarios` AS `u` ON `u`.`id_usuario` = `ha`.`id_usuario_destino`
+				Inner Join `areas` AS `a` ON `a`.`id_area` = `u`.`id_area`
+				WHERE
+				`ha`.`id_historial_atencion` = '".$usu['ultimo']."' ";
+
+		$qusu=new Consulta($susu);		
+		$u=$qusu->ConsultaVerRegistro();
+    ?>
+
+    <td width="11%">
+	  <div align="center"><a href="javascript:window.open('Ventanillas/ficha_registro.php?id=<?=$id?>','popup','width=500' , 'height=250')" target="_blank">
+	      <img src="public_root/imgs/print.gif" border="0" />	</a></div></td>
+    </tr>
+<? }?>
+		 </table>
+		</td>
+	</tr>
+</table>
+</div>
+
+<? }
+
+function RegistraAgregar(){ ?>
+
+<link href="style.css" type="text/css" rel="stylesheet">
+<link href="style.css" type="text/css" rel="stylesheet">
+<link rel="stylesheet" type="text/css" media="all" href="../libs/calendar/calendar-green.css" title="win2k-cold-1" /> 
+
+<script language="javascript" src="js/js.js"> </script>
+<script language="javascript" src="../js/js.js"> </script>	
+
+<form id="form_registrar_documento" name="form_registrar_documento" method="post" action="<?php echo	$_SERVER['PHP_SELF']?>?opcion=guardar">
+
+  <table width="90%" border="0" align="center" class="formularios">
+
+    <tr class="Estilo2">
+      <td class="Estilo22">&nbsp;</td>
+      <td class="Estilo22">&nbsp;</td>
+      <td class="Estilo22">&nbsp;</td>
+      <td >&nbsp;</td>
+      <td colspan="3" class="Estilo2">&nbsp;</td>
+      <td colspan="2" class="Estilo2">&nbsp;</td>
+    </tr>
+    <tr class="Estilo2">
+      <td class="Estilo22">&nbsp;</td>
+      <td class="Estilo22">&nbsp;</td>
+      <td class="Estilo22">&nbsp;</td>
+      <td >&nbsp;</td>
+      <td colspan="3" class="Estilo2">&nbsp;</td>
+      <td colspan="2" class="Estilo2">&nbsp;</td>
+    </tr>
+    <tr class="Estilo2">
+      <td width="18" class="Estilo22"><div align="left" class="Estilo21" >(*) </div></td>
+      <td width="77" class="Estilo22"><div align="left">Remitente</div></td>
+      <td width="3" class="Estilo22"><div align="center">:</div></td>
+      <td width="296" >
+        <div align="left"><span class="Estilo2">
+          <input name="remitente" type="text" class="doc_remitente" id="text_remitente" style="width:290px">
+          <input name="remit" type="hidden" id="id_remitente" value="">
+          </span>
+        </div></td>
+      <td width="18" class="Estilo2"><div align="left" class="Estilo21">(*)</div></td>
+      <td class="Estilo2"><div align="left"><span class="Estilo22">Tipo de Documento</span></div></td>
+      <td width="5" class="Estilo22"><div align="center">:</div></td>
+      <td colspan="2" class="Estilo2"><?
+      			$sql_tipo ="SELECT * 
+							FROM tipos_documento 
+							WHERE entrada_salida = 0 || entrada_salida = 2
+							ORDER BY tipos_documento.nombre_tipo_documento ASC";
+		    	$query_tipo=new Consulta($sql_tipo);	
+		?>
+        <div align="left">
+          <select name="tipo" class="tipo_doc">
+            <option value="">-Tipo de Documento-</option>
+            <?
+        while($row_tipo=$query_tipo->ConsultaVerRegistro()){?>
+            <option value="<?=$row_tipo[0]?>"<? if(isset($_POST['tipo']) && $_POST['tipo']== $row_tipo[0]){ echo "selected";} ?>>
+            <?=$row_tipo[1]?>
+            </option>
+            <?  } ?>
+            </select>
+      </div></td>
+    </tr>
+   		<tr>
+   		  <td class="Estilo22">&nbsp;</td>
+   		  <td class="Estilo22"><div align="left" class="Estilo22">Documento</div></td>
+   		  <td class="Estilo22"><div align="center">:</div></td>
+   		  <td bgcolor="#FFFFFF"><div align="left"><span class="Estilo2">
+   		    <input name="num_doc" type="text" id="num_doc" value="" style="width:290px"/>
+	      </span></div></td>
+   		  <td class="Estilo2"><div align="left" class="Estilo21">(*)</div></td>
+   		  <td class="Estilo2"><div align="left"><span class="Estilo22">Fecha</span></div></td>
+   		  <td class="Estilo22"><div align="center">:</div></td>
+   		  <td class="Estilo2"><div align="left">
+   		    <input name="date_registrar" type="text" id="date_registrar" class="inputbox" size="15" value="" readonly="readonly"/>
+ 		    </div></td>
+   		  <td width="75" class="Estilo2"><div align="left">
+   		    <input name="image2" type="image" id="trigger_registrar" src="public_root/imgs/calendar.png" width="20" height="20" hspace="1"  border="0" style="border:none"/>
+ 		    </div></td>
+    </tr>
+   		<tr>
+      <td class="Estilo22">&nbsp;</td>
+      <td class="Estilo22"><div align="left">
+        <div align="left" class="Estilo22"> Folios</div>
+      </div></td>
+      <td class="Estilo22"><div align="center">:</div></td>
+      <td bgcolor="#FFFFFF"><div align="left"><span class="Estilo2">
+        <input name="num_folio" type="text" size="12" />
+      </span></div></td>
+      <td width="18" class="Estilo2">&nbsp;</td>
+      <td colspan="2" class="Estilo22">&nbsp;</td>
+      <td width="98" class="Estilo2">&nbsp;</td>
+      <td class="Estilo2"><script type="text/javascript">
+          Calendar.setup(
+            {
+              inputField  : "date_registrar",
+              ifFormat    : "%d/%m/%Y",
+              weekNumbers: false,
+              button      : "trigger_registrar"
+            }
+          );
+	    </script></td>
+    </tr> 
+    <tr>
+      <td class="Estilo2">&nbsp;</td>
+      <td class="Estilo2"><div align="left" class="Estilo22">Referencia</div></td>
+      <td class="Estilo22"><div align="center">:</div></td>
+      <td colspan="7"><div align="left">
+        <input name="refe" value="" type="text" size="110" />
+      </div></td>
+    </tr>
+    <tr>
+      <td class="Estilo22">&nbsp;</td>
+      <td class="Estilo22"><div align="left" class="Estilo22">Anexos</div></td>
+      <td class="Estilo22"><div align="center">:</div></td>
+      <td colspan="7"><div align="left"><span class="Estilo2">
+        <input name="anexo" value="" type="text" size="110" />
+      </span></div></td>
+    </tr>
+    <tr>
+      <td class="Estilo2">&nbsp;</td>
+      <td class="Estilo2"><div align="left" class="Estilo22">Observacion</div></td>
+      <td class="Estilo22"><div align="center">:</div></td>
+      <td colspan="7"><div align="left">
+        <textarea name="observ" cols="110" rows="4" value="" ></textarea>
+      </div></td>
+    </tr>
+    <tr>
+      <td  height="60" colspan="9" align="center">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+        <input class="boton" name="Guardar2" type="submit" value="Guardar" id="btnguardar"/>
+        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input name="Limpiar" type="reset" value="Limpiar" class="boton"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="ficha_registro.php" ></td></tr>
+  </table>
+</form>
+  <? }
+
+function RegistraEditar($id){
+	
+	$doc = new Documento($id);			
+    $remitente = $doc->getRemitente();
+    $tipo = $doc->getTipoDocumento();
+?>
+
+<form id="form_editar_documento" name="form_editar_documento" method="post" action="<?php echo	$_SERVER['PHP_SELF']?>?opcion=update&id=<?=$id?>">
+  <table border="0" align="center" class="formularios" width="90%">
+    <tr class="Estilo2">
+      <td colspan="3" class="Estilo22">&nbsp;</td>
+      <td >&nbsp;</td>
+      <td colspan="2" class="Estilo22">&nbsp;</td>
+      <td colspan="2" class="Estilo2">&nbsp;</td>
+    </tr>
+    <tr class="Estilo2">
+      <td colspan="3" class="Estilo22">&nbsp;</td>
+      <td >&nbsp;</td>
+      <td colspan="2" class="Estilo22">&nbsp;</td>
+      <td colspan="2" class="Estilo2">&nbsp;</td>
+    </tr>
+    <tr class="Estilo2">
+      <td width="18" class="Estilo21">(*)</td>
+      <td width="196" class="Estilo22"><div align="left" class="Estilo22" > Remitente</div></td>
+      <td width="9" class="Estilo22"><div align="center"></div></td>
+      <td width="315" >
+        <div align="left">
+          <input name="remitente" type="text" class="doc_remitente" id="text_remitente" style="width:290px" value="<?=$remitente->getNombre();?>"/>
+		  <input name="remit" type="hidden" id="id_remitente" value="">
+        </div></td>
+      <td colspan="2" class="Estilo22">&nbsp;</td>
+      <td colspan="2" class="Estilo2">&nbsp;</td>
+    </tr>
+   		<tr>
+   		  <td class="Estilo21">(*)</td>
+   		  <td class="Estilo22"><div align="left"> Tipo de Documento </div></td>
+   		  <td class="Estilo22"><div align="center">:</div></td>
+   		  <td bgcolor="#FFFFFF"><div align="left"><span class="Estilo2">
+   		    <?
+				$sql_tipo ="SELECT * 
+							FROM tipos_documento 
+							WHERE entrada_salida = 0 || entrada_salida = 2
+							ORDER BY tipos_documento.nombre_tipo_documento ASC";
+							
+				$query_tipo=new Consulta($sql_tipo);	
+		?>
+   		    <select name="tipo" class="tipo_doc" style="width:200px;">
+   		      <option value="">---Tipo de Documento---</option>
+   		      <? while($row_tipo=$query_tipo->ConsultaVerRegistro()){?>
+   		      <option value="<?=$row_tipo[0]?>"<? if($row_tipo[0]==$tipo->getId()){ echo "selected";} ?>><?php echo $row_tipo[1]?> </option>
+   		      <?  } ?>
+	      </select>
+	      </span></div></td>
+   		  <td bgcolor="#FFFFFF">&nbsp;</td>
+   		  <td bgcolor="#FFFFFF"><div align="left" class="Estilo22">Folios:</div></td>
+   		  <td colspan="2" bgcolor="#FFFFFF"><div align="left"><span class="Estilo2">
+   		    <input name="num_folio" type="text" value="<?=$doc->getNumeroFolio()?>" size="10" />
+	      </span></div></td>
+    </tr>
+   		
+   		<tr>
+   		  <td width="18" class="Estilo22">&nbsp;</td>
+      <td width="196" class="Estilo22"><div align="left" class="Estilo2">Documento</div></td>
+      <td width="9" class="Estilo22"><div align="center">:</div></td>
+      <td bgcolor="#FFFFFF"><div align="left"><span class="Estilo2">
+        <input name="num_doc" type="text" id="num_doc" value="<?=$doc->getNumero();?>" size="48" />
+      </span></div></td>
+      <td width="21" bgcolor="#FFFFFF"><div align="left" class="Estilo21">(*)</div></td>
+      <td width="58" bgcolor="#FFFFFF"><span class="Estilo22"> Fecha:</span></td>
+      <td width="97" bgcolor="#FFFFFF"><div align="left">
+              <input name="date" type="text" id="date" class="inputbox" size="12" value="<?=cambiar_caracter("-","/",$doc->getFecha())?>" readonly="readonly"/>
+      </div></td>
+      <td width="114" bgcolor="#FFFFFF"><div align="left">
+        <input name="image" type="image" id="trigger" src="public_root/imgs/calendar.png" width="20" height="20" hspace="1"  border="0" />
+        <script type="text/javascript">
+              Calendar.setup(
+                {
+                  inputField  : "date",
+                  ifFormat    : "%d/%m/%Y",
+                  weekNumbers: false,
+                  button      : "trigger"
+                }
+              );
+        </script>
+        
+        
+      </div></td>      
+   </tr> 
+    <tr>
+      <td width="18" class="Estilo22">&nbsp;</td>
+      <td width="196" class="Estilo22"><div align="left" class="Estilo2">Referencia</div></td>
+      <td width="9" class="Estilo22"><div align="center">:</div></td>
+      <td colspan="6">        <div align="left">
+        <input name="refe" value="<?=$doc->getReferencia()?>" type="text" size="103" />
+      </div></td>
+    </tr>
+    <tr>
+      <td width="18" class="Estilo22">&nbsp;</td>
+      <td width="196" class="Estilo22"><div align="left" class="Estilo2">Anexos</div></td>
+      <td width="9" class="Estilo2"><div align="center">:</div></td>
+      <td colspan="6"><div align="left"><span class="Estilo23">
+        <input name="anexo" value="<?=$doc->getAnexo()?>" type="text" size="103" />
+      </span></div></td>
+    </tr>
+    <tr>
+      <td class="Estilo22">&nbsp;</td>
+      <td class="Estilo22"><div align="left" class="Estilo2">Observacion</div></td>
+      <td class="Estilo22"><div align="center">:</div></td>
+      <td colspan="6"><div align="left">
+        <textarea name="observ" cols="100" rows="4" ><?=$doc->getObservacion()?>
+      </textarea>
+      </div></td>
+    </tr>
+    <tr>
+      <td  height="60" colspan="8" align="center"><input name="Guardar" type="submit" value="Actualizar" class="boton" id="btnActualizar"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input class="boton" name="imprimir"  type="button" onClick="javascript:window.open('Ventanillas/ficha_registro.php?id=<?php echo $id?>','popup','width=500' , 'height=250')" value="Imprimir" />      </td>
+    </tr>
+  </table>
+</form>
+
+  <? }
+
+function RegistraGuardar(){
+
+	$num_folio=$_POST["num_folio"];
+	$tipo=$_POST["tipo"]; 
+	$num_doc=$_POST["num_doc"]; 
+	$FechaSol=$_POST["date_registrar"]; 
+	$refe=$_POST["refe"]; 
+	$anexo=$_POST["anexo"]; 
+	$destino=$_POST["destino"]; 
+	$observ=$_POST["observ"]; 
+	
+	if($_POST["remit"]!=""){
+		$remits=explode(",",$_POST["remit"]); 
+		$remit=$remits[1];
+	}else{		
+		$remit=Registro::RegistraGuardarRemitente($_POST["remitente"],substr($_POST["remitente"],0,4),2);
+	}
+
+	$sql_cod2 = "SELECT 
+				 Max(td.id_documento) AS codigo3
+				 FROM documentos AS td";
+				
+	$query_codigo2=new Consulta($sql_cod2);		
+	$row_codigo2=$query_codigo2->ConsultaVerRegistro();
+	$codigo21=$row_codigo2['codigo3'];
+	$codigo3=$codigo21+1;
+	
+	$codigo='0'.$codigo3.'-2009';
+	
+	$anp = new Anp($_SESSION['session'][7]);
+	
+	$codigo = $anp->getSiglas()."-".$codigo;
+	$var_estado=1;
+	$fecha_actual = time()-3600;
+	
+	$guarda="INSERT INTO documentos VALUES ('',
+			'".$codigo."',
+			'".$tipo."',
+			'".$num_doc."',
+			'".$refe."',
+			'".$anexo."',
+			'".$num_folio."',
+			'".formato_date('/',$FechaSol)."',
+			'',
+			'".date("Y-m-d H:i:s",$fecha_actual)."',
+			'".$observ."',
+			'',
+			'".$_SESSION['session'][0]."',
+			'".$remit."',
+			'".$var_estado."')";
+
+	$q_guarda=new Consulta($guarda);
+
+    //Insertar en las tablas de busqueda
+    $remitente = new Remitente($remit);
+    $tipo_doc = new TipoDocumento($tipo);
+    $estado = new Estado($var_estado);
+	$usuario= new Usuario($_SESSION['session'][0]);
+
+    $reporte="INSERT INTO documentos_reporte VALUES ('',
+            '".$q_guarda->NuevoId()."',
+			'".$codigo."',
+			'".$num_doc."',
+            '".$remitente->getNombre()."',
+			'',
+            '".$tipo_doc->getNombre()."',			
+			'".$num_folio."',
+			'".$refe."',
+			'".$anexo."',
+			'".$observ."',
+			'',
+			'".formato_date('/',$FechaSol)."',
+			'".date("Y-m-d H:i:s",$fecha_actual)."',
+			'',
+			'".$estado->getAbreviatura()."',							
+            '".$usuario->getLogin()."',
+            '')";
+
+	$q_reporte=new Consulta($reporte);
+
+?>
+
+<script type="text/javascript"> 
+	javascript:imprimir("Ventanillas/ficha_registro.php?id=<?php echo $codigo3?>");
+</script>
+
+<?
+  }
+
+function RegistraUpdate($id){
+ 
+    $num_folio=$_POST["num_folio"];
+	$tipo=$_POST["tipo"]; 
+	$num_doc=$_POST["num_doc"]; 
+	$FechaSol2=$_POST["date"];
+	$refe=$_POST["refe"]; 
+	$anexo=$_POST["anexo"]; 
+	$destino=$_POST["destino"]; 
+	$observ=$_POST["observ"]; 
+ 	$var_estado=1;
+	echo "remitente".$_POST["remit"];
+	if($_POST["remit"]!=""){
+		$remits=explode(",",$_POST["remit"]); 
+		$remit=$remits[1];
+	}else{		
+		$remit=Registro::RegistraGuardarRemitente($_POST["remitente"],substr($_POST["remitente"],0,4),2);
+	}
+	
+	$actualiza="UPDATE documentos SET 
+				documentos.id_tipo_documento='".$tipo."', 
+				documentos.`numero_documento`='".$num_doc."',
+				documentos.`referencia_documento`='".$refe."',
+				documentos.`anexo_documento`='".$anexo."',
+				documentos.`numero_folio_documento`='".$num_folio."',
+				documentos.`fecha_documento`='".formato_date('/',$FechaSol2)."',
+				documentos.`observacion_documento`='".$observ."',
+				documentos.`id_remitente`='".$remit."' 
+				Where documentos.id_documento='".$id."'";
+				
+	$actua=new Consulta($actualiza);
+
+    //Tabla de Busqueda
+    $remitente = new Remitente($remit);
+    $tipo_doc = new TipoDocumento($tipo);
+
+    $actualiza="UPDATE documentos_reporte SET
+				numero_documento='".$num_doc."',
+				tipo='".$tipo_doc->getNombre()."',
+                folio='".$num_folio."',                
+				referencia='".$refe."',
+				anexo='".$anexo."',
+				observacion='".$observ."',
+				fecha_documento='".formato_date('/',$FechaSol2)."',
+                remitente='".$remitente->getNombre()."'				                
+				Where id_documento='".$id."'";
+
+	$actua=new Consulta($actualiza);
+	
+}
+
+function RegistraGuardarRemitente($nom_remi,$abrev,$tipo_remi){
+
+	$sql_re="Insert Into remitentes Values('','".$tipo_remi."','".$nom_remi."','".$abrev."','')";
+	$q_remite=new Consulta($sql_re);
+
+	return 	$q_remite->NuevoId();
+
+}
+
+function RegistraFiltrar(){
+
+	$sql_estado =  "SELECT * 
+					FROM estados AS e
+					WHERE e.display = 1 
+					ORDER BY 
+					e.nombre_estado ASC";
+
+	$q_estado=new Consulta($sql_estado);		
+	?>
+
+	<form name="f5" method="post" action="<?=$_SESSION['PHP_SELF']?>?opcion=list&ide=<?=$ide?>">
+		<table width="100" height="50" border="0" >
+			<tr>
+				<td>&nbsp;</td>
+			</tr>
+			<tr>
+				<td align="center">
+			    <select name="ide">
+			      <option value="">---Estado---</option>
+				       <?
+				        while($row_estado=$q_estado->ConsultaVerRegistro()){
+							$ide=$row_estado[0];?>
+	               <option value="<?=$row_estado[0]?>"<? if(isset($ide) && $ide== $row_estado[0]){ echo "selected";} ?>>
+	                 <?=$row_estado[1]?>
+                  </option>
+				  <option value="LT">LISTAR TODOS</option>
+		      <?  } ?>	
+			      </select>
+				</td>
+    </tr>
+ <tr>
+  <td align="center" ><input name="Filtrar" type="submit"  value="Filtrar" class="boton" /></td>
+  </tr>
+</table>
+</form>
+
+<?
+}
+}
+
+?>
\ No newline at end of file
diff -r 82e55d328c8c -r 9881d5db150a word_borrador.php
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/word_borrador.php	Tue Aug 10 10:51:26 2010 -0500
@@ -0,0 +1,2 @@
+<!--<script type="text/javascript" src="public_root/js/cargar_borrador.js"></script>-->
+<textarea name="rpt_borrador" cols="128" rows="23" id="rpt_borrador"></textarea>
